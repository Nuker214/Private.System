<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Private System | Revamped</title>
  <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
  
  <style>
    /* 
    ========================================
    ROOT & THEME VARIABLES
    ========================================
    */
    :root {
      --font-primary: 'Segoe UI', 'Roboto', sans-serif;
      --font-monospace: 'Fira Code', 'Courier New', monospace;
      --font-display: 'Montserrat', sans-serif;

      --spacing-xs: 4px;
      --spacing-sm: 8px;
      --spacing-md: 16px;
      --spacing-lg: 24px;
      --spacing-xl: 32px;
      --border-radius-sm: 8px;
      --border-radius-md: 12px;
      --transition-speed-fast: 0.2s;
      --transition-speed-med: 0.4s;
      --shadow-sm: 0 2px 8px rgba(0, 0, 0, 0.2);
      --shadow-md: 0 4px 15px rgba(0, 0, 0, 0.3);
    }
    
    /* --- Theme Definitions --- */

    /* Dark Theme (Default) */
    [data-theme="dark"] {
      --c-primary: #ff914d;
      --c-primary-light: #ffb67a;
      --c-primary-dark: #cc743d;
      --c-secondary: #ffd966;
      --c-danger: #e74c3c;
      --c-success: #2ecc71;
      --c-info: #3498db;
      
      --c-bg-deep: #0d0d0d;
      --c-bg-dark: #121212;
      --c-bg-light: #1e1e1e;
      --c-bg-lighter: #2a2a2a;
      --c-surface: #333;
      
      --c-text-light: #f5f5f5;
      --c-text-medium: #a0a0a0;
      --c-text-dark: #121212;
      --c-border: #444;

      --c-glass-bg: rgba(30, 30, 30, 0.6);
      --c-scrollbar-thumb: var(--c-primary);
      --c-scrollbar-track: var(--c-bg-dark);
    }

    /* Light Theme */
    [data-theme="light"] {
      --c-primary: #e67e22;
      --c-primary-light: #f39c12;
      --c-primary-dark: #d35400;
      --c-secondary: #f1c40f;
      --c-danger: #c0392b;
      --c-success: #27ae60;
      --c-info: #2980b9;

      --c-bg-deep: #e9e9e9;
      --c-bg-dark: #f4f4f4;
      --c-bg-light: #ffffff;
      --c-bg-lighter: #f9f9f9;
      --c-surface: #e0e0e0;
      
      --c-text-light: #121212;
      --c-text-medium: #555555;
      --c-text-dark: #ffffff;
      --c-border: #ccc;

      --c-glass-bg: rgba(255, 255, 255, 0.6);
      --c-scrollbar-thumb: var(--c-primary);
      --c-scrollbar-track: var(--c-bg-dark);
    }

    /* 
    ========================================
    GENERAL STYLES & RESETS
    ========================================
    */
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    html { scroll-behavior: smooth; }

    body {
      font-family: var(--font-primary);
      background-color: var(--c-bg-dark);
      background-image: radial-gradient(var(--c-bg-light) 1px, transparent 1px);
      background-size: 20px 20px;
      color: var(--c-text-light);
      transition: background-color var(--transition-speed-med) ease, color var(--transition-speed-med) ease;
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
      overflow-x: hidden;
    }

    button, a {
      cursor: pointer;
      font-family: inherit;
      transition: all var(--transition-speed-fast) ease;
    }
    
    input { font-family: inherit; }
    
    /* Custom Scrollbar */
    ::-webkit-scrollbar { width: 10px; }
    ::-webkit-scrollbar-track { background: var(--c-scrollbar-track); }
    ::-webkit-scrollbar-thumb { background: var(--c-scrollbar-thumb); border-radius: var(--border-radius-sm); }
    ::-webkit-scrollbar-thumb:hover { background: var(--c-primary-light); }

    /* 
    ========================================
    ANIMATIONS & KEYFRAMES
    ========================================
    */
    .animation-enabled {
      --animation-fade-in: fadeIn 0.5s ease forwards;
      --animation-slide-up: slideInUp 0.6s ease forwards;
    }
    body:not(.animation-enabled) * { animation: none !important; transition: none !important; }

    @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
    @keyframes slideInUp {
        from { opacity: 0; transform: translateY(20px); }
        to { opacity: 1; transform: translateY(0); }
    }
    @keyframes pulse { 0%, 100% { transform: scale(1); } 50% { transform: scale(1.05); } }
    @keyframes flashRed {
      0%, 100% { border-color: var(--c-danger); box-shadow: 0 0 15px var(--c-danger); }
      50% { border-color: var(--c-border); box-shadow: 0 0 5px transparent; }
    }
    @keyframes scrollLeft {
      0% { transform: translateX(0%); }
      100% { transform: translateX(-100%); }
    }

    /* 
    ========================================
    PRELOADER
    ========================================
    */
    .preloader {
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background: var(--c-bg-deep);
      z-index: 9999;
      display: flex;
      justify-content: center;
      align-items: center;
      flex-direction: column;
      opacity: 1;
      transition: opacity 0.5s ease, visibility 0.5s ease;
    }
    .preloader.hidden { opacity: 0; visibility: hidden; }
    .loader-cube {
      width: 50px; height: 50px;
      transform-style: preserve-3d;
      transform: rotateX(-35deg) rotateY(-45deg);
      animation: rotate 4s infinite linear;
    }
    .loader-cube-face {
      position: absolute;
      width: 50px; height: 50px;
      border: 2px solid var(--c-primary);
      background: var(--c-glass-bg);
      box-shadow: 0 0 15px var(--c-primary);
    }
    .front { transform: translateZ(25px); } .back { transform: rotateY(180deg) translateZ(25px); }
    .right { transform: rotateY(90deg) translateZ(25px); } .left { transform: rotateY(-90deg) translateZ(25px); }
    .top { transform: rotateX(90deg) translateZ(25px); } .bottom { transform: rotateX(-90deg) translateZ(25px); }
    @keyframes rotate { from { transform: rotateX(-35deg) rotateY(-45deg) rotateY(0); } to { transform: rotateX(-35deg) rotateY(-45deg) rotateY(360deg); } }
    .preloader p { margin-top: 2rem; font-family: var(--font-monospace); color: var(--c-text-medium); }
    
    /* 
    ========================================
    LOGIN SYSTEM STYLES
    ========================================
    */
    .login-container {
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      display: flex;
      justify-content: center;
      align-items: center;
      opacity: 1;
      visibility: visible;
      transition: opacity var(--transition-speed-med) ease, visibility var(--transition-speed-med) ease;
      animation: var(--animation-fade-in);
    }
    .login-container.hidden { opacity: 0; visibility: hidden; }
    
    .login-box {
      background: var(--c-glass-bg);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      border-radius: var(--border-radius-md);
      border: 1px solid var(--c-border);
      box-shadow: var(--shadow-md);
      width: 90%;
      max-width: 400px;
      padding: var(--spacing-xl);
      text-align: center;
      transition: border-color var(--transition-speed-med), box-shadow var(--transition-speed-med);
    }
    .login-box.flashing { animation: flashRed 0.5s ease-in-out; }
    
    .login-box h2 {
      font-size: 2em;
      margin-bottom: var(--spacing-lg);
      font-family: var(--font-monospace);
      color: var(--c-primary);
      text-shadow: 0 0 5px var(--c-primary);
    }
    
    .input-group {
      position: relative;
      margin-bottom: var(--spacing-lg);
    }

    .login-box input[type="text"],
    .login-box input[type="password"] {
      width: 100%;
      padding: 14px;
      background: var(--c-bg-dark);
      border: 1px solid var(--c-border);
      color: var(--c-text-light);
      border-radius: var(--border-radius-sm);
      font-size: 1em;
      transition: all var(--transition-speed-fast) ease;
    }
    .login-box input:focus {
        border-color: var(--c-primary);
        box-shadow: 0 0 10px var(--c-primary);
        outline: none;
    }

    .login-options {
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-size: 0.9em;
      margin-bottom: var(--spacing-lg);
    }
    .login-options label {
      display: flex;
      align-items: center;
      gap: var(--spacing-sm);
      cursor: pointer;
    }
    
    .login-box .login-btn {
      width: 100%;
      padding: 14px;
      background: var(--c-primary);
      color: var(--c-text-dark);
      font-size: 1.1em;
      font-weight: bold;
      border: none;
      border-radius: var(--border-radius-sm);
      text-shadow: 0 1px 2px rgba(0,0,0,0.2);
    }
    .login-box .login-btn:hover {
        background: var(--c-primary-light);
        box-shadow: 0 0 15px var(--c-primary-light);
    }
    
    .login-feedback {
      margin-top: var(--spacing-md);
      min-height: 40px;
    }
    .error-message { color: var(--c-danger); font-size: 0.9em; }
    .attempt-counter { color: var(--c-text-medium); font-size: 0.9em; }

    /* 
    ========================================
    DASHBOARD STYLES
    ========================================
    */
    .dashboard-container {
      display: none;
      width: 100%;
      min-height: 100vh;
      padding: var(--spacing-md);
    }

    .dashboard-grid {
        display: grid;
        grid-template-columns: 280px 1fr;
        grid-template-rows: auto 1fr auto;
        grid-template-areas: 
            "header header"
            "sidebar main"
            "footer footer";
        gap: var(--spacing-lg);
        width: 100%;
        max-width: 1800px;
        margin: 0 auto;
    }
    
    /* Header */
    .dashboard-header {
      grid-area: header;
      display: flex;
      justify-content: space-between;
      align-items: center;
      flex-wrap: wrap;
      background: var(--c-glass-bg);
      backdrop-filter: blur(10px);
      padding: var(--spacing-md) var(--spacing-lg);
      border-radius: var(--border-radius-md);
      border: 1px solid var(--c-border);
      box-shadow: var(--shadow-md);
      animation: var(--animation-slide-up);
    }

    .user-profile { position: relative; }
    .user-profile-btn {
      display: flex;
      align-items: center;
      gap: var(--spacing-md);
      background: var(--c-surface);
      border: 1px solid var(--c-border);
      border-radius: var(--border-radius-sm);
      padding: var(--spacing-sm) var(--spacing-md);
      color: var(--c-text-light);
    }
    .user-profile-btn img {
      width: 32px;
      height: 32px;
      border-radius: 50%;
      border: 2px solid var(--c-primary);
    }
    .user-dropdown {
      position: absolute;
      top: 110%;
      right: 0;
      background: var(--c-bg-light);
      border: 1px solid var(--c-border);
      border-radius: var(--border-radius-sm);
      list-style: none;
      width: 200px;
      z-index: 10;
      opacity: 0;
      visibility: hidden;
      transform: translateY(-10px);
      transition: all var(--transition-speed-fast) ease;
    }
    .user-dropdown.visible { opacity: 1; visibility: visible; transform: translateY(0); }
    .user-dropdown li button {
      width: 100%;
      padding: 12px var(--spacing-md);
      background: none;
      border: none;
      color: var(--c-text-light);
      text-align: left;
    }
    .user-dropdown li button:hover {
      background: var(--c-primary);
      color: var(--c-text-dark);
    }
    .user-dropdown li:not(:last-child) { border-bottom: 1px solid var(--c-border); }

    /* Sidebar */
    .dashboard-sidebar {
        grid-area: sidebar;
        background: var(--c-bg-light);
        padding: var(--spacing-lg);
        border-radius: var(--border-radius-md);
        box-shadow: var(--shadow-md);
        border: 1px solid var(--c-border);
        height: max-content;
        position: sticky;
        top: var(--spacing-lg);
        animation: var(--animation-slide-up);
        animation-delay: 0.1s;
    }
    .dashboard-sidebar h3 {
        color: var(--c-primary);
        margin-bottom: var(--spacing-md);
        border-bottom: 2px solid var(--c-border);
        padding-bottom: var(--spacing-sm);
        font-family: var(--font-display);
    }
    .dashboard-sidebar nav ul { list-style: none; }
    .dashboard-sidebar nav li button {
        width: 100%;
        text-align: left;
        padding: 12px;
        background: none;
        border: none;
        color: var(--c-text-light);
        border-radius: var(--border-radius-sm);
        font-size: 0.95em;
        position: relative;
        overflow: hidden;
    }
    .dashboard-sidebar nav li button::before {
      content: '';
      position: absolute;
      left: -100%;
      top: 0;
      width: 100%;
      height: 100%;
      background: var(--c-primary);
      transition: left var(--transition-speed-fast) ease-in-out;
      z-index: 1;
    }
    .dashboard-sidebar nav li button span { position: relative; z-index: 2; }
    .dashboard-sidebar nav li button:hover::before,
    .dashboard-sidebar nav li button.active::before { left: 0; }
    .dashboard-sidebar nav li button:hover,
    .dashboard-sidebar nav li button.active { color: var(--c-text-dark); }

    /* Main Content */
    .dashboard-main { grid-area: main; }
    .info-panel {
        display: none;
        animation: var(--animation-fade-in);
        animation-delay: 0.2s;
    }
    .info-panel.active { display: block; }
    
    /* Quick Bar */
    .quick-bar {
      display: flex;
      gap: var(--spacing-sm);
      margin-bottom: var(--spacing-md);
      flex-wrap: wrap;
    }
    .quick-bar button {
      background-color: var(--c-surface);
      border: 1px solid var(--c-border);
      padding: var(--spacing-sm) var(--spacing-md);
      border-radius: var(--border-radius-sm);
      color: var(--c-text-light);
      font-weight: bold;
    }
    .quick-bar button:hover { background-color: var(--c-primary); color: var(--c-text-dark); border-color: var(--c-primary-dark); }
    #panicBtn { background: var(--c-danger) !important; color: var(--c-text-dark) !important; border-color: var(--c-danger) !important; }

    /* Generic Box/Card */
    .box {
      background-color: var(--c-bg-light);
      padding: var(--spacing-lg);
      border-radius: var(--border-radius-md);
      box-shadow: var(--shadow-sm);
      border: 1px solid var(--c-border);
      margin-bottom: var(--spacing-md);
    }
    .box h2 {
        font-size: 1.5em;
        margin-bottom: var(--spacing-md);
        color: var(--c-primary);
        font-family: var(--font-display);
    }
    
    /* Grid Layouts */
    .grid-container {
        display: grid;
        gap: var(--spacing-lg);
        grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
    }
    
    /* Calendar */
    .calendar {
      display: grid;
      grid-template-columns: repeat(7, 1fr);
      gap: var(--spacing-sm);
      text-align: center;
    }
    .calendar-day { padding: var(--spacing-sm); background: var(--c-surface); border-radius: var(--spacing-xs); cursor: pointer; border: 1px solid transparent; }
    .calendar-day:hover { border-color: var(--c-primary); background: var(--c-bg-lighter); }
    .calendar .day-name { font-weight: bold; background: none; cursor: default; }
    .calendar .today { background: var(--c-primary) !important; font-weight: bold; color: var(--c-text-dark); animation: pulse 2s infinite; }

    /* Links & Buttons Grids */
    .links-grid {
      display: grid;
      gap: var(--spacing-md);
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    }
    .links-grid a, .links-grid button {
      display: block;
      background-color: var(--c-surface);
      border: 1px solid var(--c-border);
      padding: var(--spacing-md);
      border-radius: var(--border-radius-sm);
      color: var(--c-text-light);
      font-weight: bold;
      text-decoration: none;
      text-align: center;
    }
    .links-grid a:hover, .links-grid button:hover { background-color: var(--c-primary); color: var(--c-text-dark); transform: translateY(-3px); box-shadow: 0 5px 10px rgba(0,0,0,0.2); }
    
    /* Stats Table */
    .stats-table {
        width: 100%;
        border-collapse: collapse;
        margin-top: var(--spacing-md);
    }
    .stats-table th, .stats-table td {
        padding: var(--spacing-sm);
        text-align: left;
        border-bottom: 1px solid var(--c-border);
    }
    .stats-table th { background-color: var(--c-bg-lighter); font-weight: bold; }
    .stats-table td:first-child { font-weight: bold; }

    /* Notes Canvas */
    #canvasContainer {
      display: none;
      margin-top: 20px;
      text-align: center;
    }
    #notesCanvas {
      border: 2px solid #ff914d;
      border-radius: 12px;
      background: #fff;
      cursor: crosshair;
      touch-action: none;
      max-width: 100%;
    }
    #canvasControls { margin-top: 10px; }
    #canvasControls button { background-color: #ff914d; border: none; padding: 8px 16px; border-radius: 8px; color: black; font-weight: bold; cursor: pointer; transition: background 0.2s; margin: 0 5px; }
    #canvasControls button:hover { background-color: #ffb67a; }

    /* Footer */
    .dashboard-footer {
        grid-area: footer;
        text-align: center;
        padding: var(--spacing-md);
        color: var(--c-text-medium);
        font-size: 0.9em;
    }
    
    /* 
    ========================================
    UTILITY & COMPONENT STYLES
    ========================================
    */
    /* Tooltips */
    [data-tooltip] { position: relative; }
    [data-tooltip]::after {
      content: attr(data-tooltip);
      position: absolute;
      bottom: 125%;
      left: 50%;
      transform: translateX(-50%);
      background-color: var(--c-bg-lighter);
      color: var(--c-text-light);
      padding: var(--spacing-sm) var(--spacing-md);
      border-radius: var(--border-radius-sm);
      font-size: 0.85em;
      white-space: nowrap;
      opacity: 0;
      visibility: hidden;
      transition: opacity var(--transition-speed-fast), visibility var(--transition-speed-fast);
      z-index: 100;
    }
    [data-tooltip]:hover::after { opacity: 1; visibility: visible; }
    
    /* Custom Modal */
    .modal-overlay {
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background: rgba(0, 0, 0, 0.8);
      backdrop-filter: blur(5px);
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 1000;
      opacity: 0; visibility: hidden;
      transition: opacity 0.3s, visibility 0.3s;
    }
    .modal-overlay.visible { opacity: 1; visibility: visible; }
    .modal {
      background: var(--c-bg-light);
      border: 1px solid var(--c-border);
      padding: var(--spacing-xl);
      border-radius: var(--border-radius-md);
      width: 90%;
      max-width: 600px;
      box-shadow: var(--shadow-md);
      transform: scale(0.9);
      transition: transform 0.3s;
    }
    .modal-overlay.visible .modal { transform: scale(1); }
    .modal h2 { margin-bottom: var(--spacing-md); color: var(--c-primary); }
    .modal p { margin-bottom: var(--spacing-lg); }
    .modal-buttons { display: flex; gap: var(--spacing-md); justify-content: flex-end; margin-top: var(--spacing-lg); }
    .modal button { padding: 10px 20px; border-radius: var(--border-radius-sm); border: none; font-weight: bold; }
    .modal .confirm-btn { background: var(--c-primary); color: var(--c-text-dark); }
    .modal .cancel-btn { background: var(--c-surface); color: var(--c-text-light); }

    /* Settings Modal Specifics */
    .settings-tabs {
      display: flex;
      border-bottom: 1px solid var(--c-border);
      margin-bottom: var(--spacing-lg);
    }
    .settings-tab {
      padding: var(--spacing-md);
      cursor: pointer;
      border-bottom: 3px solid transparent;
      transition: border-color var(--transition-speed-fast);
    }
    .settings-tab.active { color: var(--c-primary); border-bottom-color: var(--c-primary); }
    .settings-content { display: none; }
    .settings-content.active { display: block; }
    .setting { display: flex; justify-content: space-between; align-items: center; padding: var(--spacing-md) 0; border-bottom: 1px solid var(--c-surface); }
    /* Custom Toggle Switch */
    .toggle-switch { position: relative; display: inline-block; width: 50px; height: 26px; }
    .toggle-switch input { opacity: 0; width: 0; height: 0; }
    .slider { position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: var(--c-surface); transition: .4s; border-radius: 26px; }
    .slider:before { position: absolute; content: ""; height: 20px; width: 20px; left: 3px; bottom: 3px; background-color: white; transition: .4s; border-radius: 50%; }
    input:checked + .slider { background-color: var(--c-success); }
    input:checked + .slider:before { transform: translateX(24px); }

    /* Notifier (Toast) */
    .notifier-container {
      position: fixed;
      bottom: var(--spacing-lg);
      right: var(--spacing-lg);
      z-index: 1001;
    }
    .toast {
      background: var(--c-bg-lighter);
      color: var(--c-text-light);
      padding: var(--spacing-md);
      border-radius: var(--border-radius-sm);
      margin-top: var(--spacing-sm);
      box-shadow: var(--shadow-md);
      opacity: 0;
      transform: translateX(100%);
      animation: slideInToast 0.5s forwards;
      border-left: 5px solid;
    }
    .toast.success { border-color: var(--c-success); }
    .toast.info { border-color: var(--c-info); }
    .toast.error { border-color: var(--c-danger); }
    @keyframes slideInToast { to { opacity: 1; transform: translateX(0); } }

    /* 
    ========================================
    RESPONSIVE STYLES
    ========================================
    */
    @media (max-width: 992px) {
      .dashboard-grid {
        grid-template-columns: 1fr;
        grid-template-areas:
          "header"
          "sidebar"
          "main"
          "footer";
      }
      .dashboard-sidebar {
        position: static;
        top: unset;
      }
    }
    @media (max-width: 576px) {
      body { padding: var(--spacing-sm); }
      .dashboard-header { flex-direction: column; gap: var(--spacing-md); }
      .quick-bar { justify-content: center; }
      .modal { padding: var(--spacing-lg); }
    }
  </style>
</head>
<body>
  
  <!-- Preloader -->
  <div class="preloader" id="preloader">
      <div class="loader-cube">
          <div class="loader-cube-face front"></div><div class="loader-cube-face back"></div>
          <div class="loader-cube-face right"></div><div class="loader-cube-face left"></div>
          <div class="loader-cube-face top"></div><div class="loader-cube-face bottom"></div>
      </div>
      <p>Initializing Private System...</p>
  </div>

  <!-- Login System -->
  <div class="login-container" id="loginContainer">
    <div class="login-box" id="loginBox">
      <h2>Private System</h2>
      <div class="input-group">
        <input type="text" id="username" placeholder="Username" autocomplete="username" />
      </div>
      <div class="input-group">
        <input type="password" id="password" placeholder="Password" autocomplete="current-password" />
      </div>
      <div class="input-group">
        <input type="text" id="userID" placeholder="User Identifier" autocomplete="off" />
      </div>
      <div class="login-options">
        <label for="showPassword">
          <input type="checkbox" id="showPassword" />
          <span>Show Password</span>
        </label>
      </div>
      <button id="submitBtn" class="login-btn">Authenticate</button>
      <div class="login-feedback">
        <div class="error-message" id="errorMsg"></div>
        <div class="attempt-counter" id="attemptsText"></div>
      </div>
    </div>
  </div>

  <!-- Dashboard -->
  <div class="dashboard-container" id="dashboardContainer">
    <div class="dashboard-grid">
        <header class="dashboard-header">
            <div>
                <h1>Private Dashboard GUI</h1>
                <div class="user-info">ID: <span id="loggedInID"></span></div>
            </div>
            <div class="user-profile">
              <button class="user-profile-btn" id="userProfileBtn" data-tooltip="Open User Menu">
                <img src="https://i.pravatar.cc/40" alt="User Avatar">
                <span id="loggedInUser"></span>
              </button>
              <ul class="user-dropdown" id="userDropdown">
                <li><button id="settingsBtn">⚙️ Settings</button></li>
                <li><button id="logoutBtn">🔓 Log Out</button></li>
              </ul>
            </div>
        </header>

        <aside class="dashboard-sidebar">
            <h3>Navigation</h3>
            <nav id="panelNav">
                <ul>
                    <!-- Navigation items will be dynamically inserted here -->
                </ul>
            </nav>
        </aside>

        <main class="dashboard-main">
            <div class="quick-bar">
                <button id="sessionTime" data-tooltip="Session Time">⏳ 00:00:00</button>
                <button id="realTimeClock" data-tooltip="Current Time">🕒 --:--:--</button>
                <button id="themeToggle" data-tooltip="Toggle Theme">🌙</button>
                <button id="fullscreenBtn" data-tooltip="Toggle Fullscreen">🖥️</button>
                <button id="screenshotBtn" data-tooltip="Take Dashboard Screenshot">📸</button>
                <button id="statsBtn" data-tooltip="View System & Browser Stats">📊</button>
                <button id="panicBtn" data-tooltip="Emergency Redirect (Clever)">🚨</button>
            </div>
            
            <div id="infoPanelsContainer">
                <!-- Panel content will be dynamically inserted here -->
            </div>
        </main>

        <footer class="dashboard-footer">
            <p>&copy; 2025 Private System. All rights reserved. | Revamped Edition v2.5.0</p>
        </footer>
    </div>
  </div>

  <!-- Modal and Notifier containers -->
  <div class="modal-overlay" id="modalOverlay"></div>
  <div class="notifier-container" id="notifierContainer"></div>

  <script>
    // --- UTILITY CLASSES ---
    class Notifier {
      constructor(containerId) {
        this.container = document.getElementById(containerId);
      }
      show(message, type = 'info', duration = 3000) {
        const toast = document.createElement('div');
        toast.className = `toast ${type}`;
        toast.textContent = message;
        this.container.appendChild(toast);
        setTimeout(() => {
          toast.remove();
        }, duration);
      }
    }

    class Modal {
      constructor(overlayId) {
        this.overlay = document.getElementById(overlayId);
      }
      _render(content) {
        this.overlay.innerHTML = `<div class="modal">${content}</div>`;
        this.overlay.classList.add('visible');
        this.overlay.querySelector('.modal').addEventListener('click', e => e.stopPropagation());
        this.overlay.addEventListener('click', () => this.hide(), { once: true });
      }
      hide() {
        this.overlay.classList.remove('visible');
        this.overlay.innerHTML = '';
      }
      confirm({ title, message, confirmText = 'Confirm', cancelText = 'Cancel' }) {
        return new Promise(resolve => {
          const content = `
              <h2>${title}</h2><p>${message}</p>
              <div class="modal-buttons">
                <button class="cancel-btn">${cancelText}</button>
                <button class="confirm-btn">${confirmText}</button>
              </div>`;
          this._render(content);
          this.overlay.querySelector('.confirm-btn').onclick = () => { this.hide(); resolve(true); };
          this.overlay.querySelector('.cancel-btn').onclick = () => { this.hide(); resolve(false); };
        });
      }
      prompt({ title, message, inputPlaceholder = 'Enter value...' }) {
        return new Promise(resolve => {
          const content = `
              <h2>${title}</h2><p>${message}</p>
              <input type="password" placeholder="${inputPlaceholder}" id="modalInput" style="width: 100%; padding: 10px; border-radius: 8px; border: 1px solid var(--c-border); background: var(--c-bg-dark); color: var(--c-text-light);">
              <div class="modal-buttons">
                <button class="cancel-btn">Cancel</button>
                <button class="confirm-btn">Submit</button>
              </div>`;
          this._render(content);
          const input = this.overlay.querySelector('#modalInput');
          input.focus();
          const submit = () => { this.hide(); resolve(input.value); };
          this.overlay.querySelector('.confirm-btn').onclick = submit;
          this.overlay.querySelector('.cancel-btn').onclick = () => { this.hide(); resolve(null); };
          input.onkeydown = (e) => { if (e.key === 'Enter') submit(); };
        });
      }
      showCustom(content) { this._render(content); }
    }
    
    class API {
      static async fetchUsers() {
        try {
          const response = await fetch('https://raw.githubusercontent.com/Nuker214/Private.System/refs/heads/main/Whitelist.json');
          if (!response.ok) throw new Error('Network response error');
          return await response.json();
        } catch (error) {
          console.error("Failed to fetch user data:", error);
          return null;
        }
      }
    }

    // --- MANAGER CLASSES ---
    class SettingsManager {
      constructor() {
        this.defaults = { theme: 'dark', animations: true };
        this.settings = this.load();
      }
      load() {
        const stored = localStorage.getItem('appSettings');
        return stored ? { ...this.defaults, ...JSON.parse(stored) } : this.defaults;
      }
      save() { localStorage.setItem('appSettings', JSON.stringify(this.settings)); }
      get(key) { return this.settings[key]; }
      set(key, value) { this.settings[key] = value; this.save(); }
    }

    class UIManager {
      constructor(app) {
        this.app = app;
        this.preloader = document.getElementById('preloader');
        this.userDropdown = document.getElementById('userDropdown');
      }
      init() {
        this.applySettings();
        this.setupEventListeners();
        setTimeout(() => this.hidePreloader(), 1500);
      }
      hidePreloader() { this.preloader.classList.add('hidden'); }
      applySettings() {
        const theme = this.app.settingsManager.get('theme');
        document.documentElement.dataset.theme = theme;
        const animations = this.app.settingsManager.get('animations');
        document.body.classList.toggle('animation-enabled', animations);
      }
      setupEventListeners() {
        document.getElementById('userProfileBtn').addEventListener('click', () => this.userDropdown.classList.toggle('visible'));
        document.addEventListener('click', (e) => {
          if (!e.target.closest('.user-profile')) this.userDropdown.classList.remove('visible');
        });
        document.getElementById('settingsBtn').addEventListener('click', () => this.showSettingsModal());
      }
      showSettingsModal() {
        const { theme, animations } = this.app.settingsManager.settings;
        const content = `
            <h2>⚙️ Settings</h2>
            <div class="settings-tabs">
                <div class="settings-tab active" data-tab="general">General</div>
                <div class="settings-tab" data-tab="appearance">Appearance</div>
            </div>
            <div id="generalContent" class="settings-content active">
                <div class="setting"><label for="animationsToggle">Enable Animations</label><label class="toggle-switch"><input type="checkbox" id="animationsToggle" ${animations ? 'checked' : ''}><span class="slider"></span></label></div>
            </div>
            <div id="appearanceContent" class="settings-content">
                <div class="setting"><label for="themeSelector">Theme</label><select id="themeSelector"><option value="dark" ${theme === 'dark' ? 'selected' : ''}>Dark</option><option value="light" ${theme === 'light' ? 'selected' : ''}>Light</option></select></div>
            </div>
            <div class="modal-buttons">
                <button class="cancel-btn">Close</button>
                <button class="confirm-btn">Save</button>
            </div>`;
        this.app.modal.showCustom(content);
        const modal = document.querySelector('.modal');
        modal.querySelectorAll('.settings-tab').forEach(tab => {
          tab.addEventListener('click', () => {
            modal.querySelectorAll('.settings-tab').forEach(t => t.classList.remove('active'));
            modal.querySelectorAll('.settings-content').forEach(c => c.classList.remove('active'));
            tab.classList.add('active');
            document.getElementById(tab.dataset.tab + 'Content').classList.add('active');
          });
        });
        modal.querySelector('.cancel-btn').addEventListener('click', () => this.app.modal.hide());
        modal.querySelector('.confirm-btn').addEventListener('click', () => {
          this.app.settingsManager.set('theme', modal.querySelector('#themeSelector').value);
          this.app.settingsManager.set('animations', modal.querySelector('#animationsToggle').checked);
          this.applySettings();
          this.app.notifier.show('Settings saved!', 'success');
          this.app.modal.hide();
        });
      }
    }

    // --- WIDGET & FEATURE CLASSES ---
    class WidgetManager {
      constructor(app) {
        this.app = app;
        this.sessionTime = 0;
        this.sessionTimer = null;
      }
      init() {
        this.startTimers();
        this.setupEventListeners();
      }
      startTimers() {
        setInterval(() => { document.getElementById('realTimeClock').textContent = `🕒 ${new Date().toLocaleTimeString()}`; }, 1000);
        this.sessionTimer = setInterval(() => {
          this.sessionTime++;
          const hrs = String(Math.floor(this.sessionTime / 3600)).padStart(2, '0');
          const mins = String(Math.floor((this.sessionTime % 3600) / 60)).padStart(2, '0');
          const secs = String(this.sessionTime % 60).padStart(2, '0');
          document.getElementById('sessionTime').textContent = `⏳ ${hrs}:${mins}:${secs}`;
        }, 1000);
      }
      setupEventListeners() {
        document.getElementById('fullscreenBtn').addEventListener('click', () => this.toggleFullscreen());
        document.getElementById('screenshotBtn').addEventListener('click', () => this.takeScreenshot());
        document.getElementById('panicBtn').addEventListener('click', () => window.open('https://clever.com', '_blank'));
        document.getElementById('logoutBtn').addEventListener('click', () => this.app.logout());
        document.getElementById('statsBtn').addEventListener('click', () => this.app.showStatsModal());
      }
      toggleFullscreen() {
        if (!document.fullscreenElement) document.documentElement.requestFullscreen().catch(err => console.error(err));
        else document.exitFullscreen();
      }
      takeScreenshot() {
        html2canvas(document.body).then(canvas => {
          const link = document.createElement('a');
          link.download = `screenshot-${Date.now()}.png`;
          link.href = canvas.toDataURL('image/png');
          link.click();
          this.app.notifier.show('Screenshot saved!', 'success');
        });
      }
    }

    class Dashboard {
      constructor(app) {
        this.app = app;
        this.container = document.getElementById('dashboardContainer');
        this.navContainer = document.getElementById('panelNav');
        this.panelsContainer = document.getElementById('infoPanelsContainer');
        
        this.panels = [
            { id: 'home', title: '🏠 Home' },
            { id: 'wifi', title: '📡 WiFi Info' },
            { id: 'handbooks', title: '📘 Handbooks' },
            { id: 'links', title: '🌐 Quick Links' },
            { id: 'schoolInfo', title: '🏫 School Info' },
            { id: 'exploitPanel', title: '🧨 Exploits' },
            { id: 'bypassPanel', title: '🚪 Bypass Tools' },
            { id: 'vpnPanel', title: '🔐 VPN Websites' },
            { id: 'gamingPanel', title: '🎮 Gaming Websites' },
            { id: 'musicPanel', title: '🎵 Music Websites' },
            { id: 'keyboardPanel', title: '🎹 Keyboard Tricks' },
        ];
      }

      init(user) {
        this.app.currentUser = user;
        this.container.style.display = 'block';
        document.getElementById('loggedInUser').textContent = user.name || user.username;
        document.getElementById('loggedInID').textContent = user.userID;
        
        this.renderNav();
        this.renderPanels();
        this.showPanel('home');
      }

      renderNav() {
        const ul = this.navContainer.querySelector('ul');
        ul.innerHTML = this.panels.map(p => `<li><button data-panel-id="${p.id}" data-tooltip="${p.title.substring(2)}"><span>${p.title}</span></button></li>`).join('');
        ul.addEventListener('click', e => {
          const button = e.target.closest('button');
          if (button) this.showPanel(button.dataset.panelId);
        });
      }

      renderPanels() {
        this.panelsContainer.innerHTML = this.panels.map(p => `<div id="${p.id}Panel" class="info-panel">${this.getPanelContent(p.id)}</div>`).join('');
        document.getElementById('calendar').addEventListener('click', e => {
          if(e.target.classList.contains('calendar-day') && !e.target.classList.contains('day-name')) {
            this.showCalendarEvent(e.target.textContent);
          }
        });
      }
      
      showPanel(panelId) {
        document.querySelectorAll('.info-panel').forEach(p => p.classList.remove('active'));
        document.querySelector(`#${panelId}Panel`).classList.add('active');
        
        document.querySelectorAll('#panelNav button').forEach(b => b.classList.remove('active'));
        document.querySelector(`#panelNav button[data-panel-id="${panelId}"]`).classList.add('active');
      }

      showCalendarEvent(day) {
        this.app.modal.showCustom(`<h2>Events for the ${day}th</h2><p>No events scheduled. It's a great day to relax!</p><div class="modal-buttons"><button class="confirm-btn">OK</button></div>`);
        document.querySelector('.modal .confirm-btn').onclick = () => this.app.modal.hide();
      }
      
      // --- CONTENT GENERATION METHODS ---
      getPanelContent(panelId) {
        switch(panelId) {
          case 'home': return this.getHomeContent();
          case 'wifi': return this.getWifiContent();
          case 'handbooks': return this.getHandbookContent();
          case 'links': return this.getLinksContent();
          case 'schoolInfo': return this.getSchoolInfoContent();
          case 'exploitPanel': return this.getExploitsContent();
          case 'bypassPanel': return this.getBypassContent();
          case 'vpnPanel': return this.getVpnContent();
          case 'gamingPanel': return this.getGamingContent();
          case 'musicPanel': return this.getMusicContent();
          case 'keyboardPanel': return this.getKeyboardContent();
          default: return `<div class="box"><h2>Coming Soon</h2><p>This section is under construction.</p></div>`;
        }
      }
      
      getHomeContent() {
        const today = new Date();
        const year = today.getFullYear();
        const month = today.getMonth();
        const date = today.getDate();
        const firstDay = new Date(year, month, 1).getDay();
        const lastDate = new Date(year, month + 1, 0).getDate();

        let calendarHtml = `<div class="calendar">`;
        const days = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];
        calendarHtml += days.map(d => `<div class="day-name calendar-day">${d}</div>`).join('');
        
        for (let i = 0; i < firstDay; i++) calendarHtml += `<div class="calendar-day empty"></div>`;
        for (let i = 1; i <= lastDate; i++) {
          calendarHtml += `<div class="calendar-day ${i === date ? 'today' : ''}">${i}</div>`;
        }
        calendarHtml += `</div>`;
        
        return `
            <div class="grid-container">
                <div class="box">
                    <h2>📅 Calendar - ${today.toLocaleString('default', { month: 'long', year: 'numeric' })}</h2>
                    <div id="calendar">${calendarHtml}</div>
                </div>
                <div class="box motivation-box">
                  "The future belongs to those who believe in the beauty of their dreams." – Eleanor Roosevelt
                </div>
            </div>
            <div class="box">
                <h2>🔔 Updates & News</h2>
                <div class="update-entry">System Security Patch Released.</div>
                <div class="update-entry">New interactive features added!</div>
                <div class="update-entry">Performance optimizations deployed.</div>
            </div>
        `;
      }
      
      getWifiContent() {
        return `<div class="box">
                  <h2>📡 School WiFi Information</h2>
                  <p>This list contains known network configurations. Use this information responsibly.</p>
                  <div class="links-grid">
                    <div><h4>Middletown_Core</h4><p>Security: WPA3 Ent.</p></div>
                    <div><h4>Mtown Guest</h4><p>User: msguest, Pass: M@ms2021#</p></div>
                    <div><h4>Radius Test</h4><p>User: msguest, Pass: M@ms2021#</p></div>
                  </div>
              </div>`;
      }

      getHandbookContent() {
           return `<div class="box">
                      <h2>📘 Student Handbooks</h2>
                      <div class="links-grid">
                        <a href="#" target="_blank">Elementary</a>
                        <a href="#" target="_blank">Secondary</a>
                        <a href="#" target="_blank">District</a>
                        <a href="#" target="_blank">RA Academy</a>
                      </div>
                  </div>`;
      }

      getLinksContent() {
           return `<div class="box">
                      <h2>🌐 Student & Teacher Websites</h2>
                      <h3>Student</h3>
                      <div class="links-grid">
                          <a href="#" target="_blank">RaiderWeb</a>
                          <a href="#" target="_blank">Canvas</a>
                          <a href="#" target="_blank">Clever</a>
                          <a href="#" target="_blank">PowerSchool</a>
                      </div>
                      <h3 style="margin-top: 2rem;">Teacher</h3>
                      <div class="links-grid">
                          <a href="#" target="_blank">Canvas (Teacher)</a>
                          <a href="#" target="_blank">PowerSchool (Teacher)</a>
                      </div>
                  </div>`;
      }
      
      getSchoolInfoContent() {
          return `<div class="box">
                      <h2>🏫 School Information</h2>
                      <div class="school-info-grid">
                          <div class="school-info-item"><div class="school-info-label">School Name:</div><div>Middletown Area Middle School</div></div>
                          <div class="school-info-item"><div class="school-info-label">Address:</div><div>215 Oberlin Road Middletown, PA 17057</div></div>
                          <div class="school-info-item"><div class="school-info-label">Phone:</div><div>717-930-0739</div></div>
                          <div class="school-info-item"><div class="school-info-label">Principal:</div><div>Dr. Shannon L. Wevodau</div></div>
                      </div>
                  </div>`;
      }

      getExploitsContent() {
           return `<div class="box">
                      <h2>🧨 Exploits & Tools</h2>
                      <p>Disclaimer: These tools are for educational purposes only.</p>
                      <div class="links-grid">
                          <a href="#" target="_blank">Blooket</a>
                          <a href="#" target="_blank">Kahoot</a>
                          <a href="#" target="_blank">Gimkit</a>
                      </div>
                  </div>`;
      }
      
      getBypassContent() {
        return `<div class="box">
                  <h2>🚪 Bypassing Tools</h2>
                  <div class="bypass-buttons">
                    <button onclick="dashboard.showBypassContent('bathroom')">Bathroom Bypass</button>
                    <button onclick="dashboard.showBypassContent('wifi')">Wifi Bypass</button>
                    <button onclick="dashboard.showBypassContent('monitoring')">Teacher Monitoring Bypass</button>
                  </div>
                  <div id="bathroomBypass" class="bypass-content"><p>COMING SOON</p></div>
                  <div id="wifiBypass" class="bypass-content"><p>Refer to WiFi Info panel.</p></div>
                  <div id="monitoringBypass" class="bypass-content"><p>COMING SOON</p></div>
                </div>`;
      }
      
      getVpnContent() {
        return `<div class="box">
                  <h2>🔐 VPN Websites</h2>
                  <div class="links-list">
                    <a href="#" target="_blank">VPN Service 1</a>
                    <a href="#" target="_blank">VPN Service 2</a>
                    <a href="#" target="_blank">VPN Service 3</a>
                  </div>
                </div>`;
      }
      
      getGamingContent() {
        return `<div class="box"><h2>🎮 Gaming Websites</h2><div class="coming-soon">COMING SOON</div></div>`;
      }
      
      getMusicContent() {
        return `<div class="box"><h2>🎵 Music Websites</h2><div class="coming-soon">COMING SOON</div></div>`;
      }
      
      getKeyboardContent() {
        return `<div class="box">
                  <h2>🎹 Keyboard Tricks (macOS/iPadOS)</h2>
                  <ul>
                    <li><strong>Cmd + Space:</strong> Spotlight Search</li>
                    <li><strong>Cmd + H:</strong> Go to Home Screen</li>
                    <li><strong>Cmd + Tab:</strong> Switch Apps</li>
                  </ul>
                </div>`;
      }
    }

    // --- LOGIN SYSTEM CLASS ---
    class LoginSystem {
      constructor(app) {
        this.app = app;
        this.container = document.getElementById('loginContainer');
        this.loginBox = document.getElementById('loginBox');
        this.usernameInput = document.getElementById('username');
        this.passwordInput = document.getElementById('password');
        this.userIDInput = document.getElementById('userID');
        this.submitBtn = document.getElementById('submitBtn');
        this.errorMsg = document.getElementById('errorMsg');
        this.attemptsText = document.getElementById('attemptsText');
        this.showPasswordCheckbox = document.getElementById('showPassword');
        
        this.maxAttempts = 5;
        this.attempts = this.maxAttempts;
        this.users = [];
        this.isLocked = false;
      }

      async init() {
        this.updateAttemptsText();
        this.addEventListeners();
        this.users = await API.fetchUsers();
        if (!this.users) {
          this.showError('Failed to load user data. Please try again later.');
          this.setInputsDisabled(true);
        }
      }
      
      addEventListeners() {
        this.submitBtn.addEventListener('click', () => this.handleLogin());
        document.addEventListener('keydown', e => {
          if (e.key === 'Enter' && !this.isLocked && this.container.style.display !== 'none') {
            this.handleLogin();
          }
        });
        this.showPasswordCheckbox.addEventListener('change', () => {
          this.passwordInput.type = this.showPasswordCheckbox.checked ? 'text' : 'password';
        });
      }

      async handleLogin() {
        if (this.isLocked) return;
        const [username, password, userID] = [this.usernameInput.value, this.passwordInput.value, this.userIDInput.value];
        if (!username || !password || !userID) {
          this.showError('Please fill in all fields.');
          return;
        }
        const user = this.users.find(u => u.username?.toLowerCase() === username.toLowerCase() && u.userID?.toString() === userID);
        if (user && user.password === password) this.loginSuccess(user);
        else this.loginFail();
      }
      
      loginSuccess(user) {
        this.app.notifier.show(`Authentication successful. Welcome, ${user.name || user.username}!`, 'success');
        this.container.classList.add('hidden');
        setTimeout(() => {
          this.container.style.display = 'none';
          this.app.showDashboard(user);
        }, 500);
      }
      
      async loginFail() {
        this.attempts--;
        this.updateAttemptsText();
        this.loginBox.classList.add('flashing');
        setTimeout(() => this.loginBox.classList.remove('flashing'), 500);

        if (this.attempts > 0) {
          this.showError(`Invalid credentials. ${this.attempts} attempts remaining.`);
        } else {
          this.isLocked = true;
          this.showError('Maximum attempts exceeded. System locked.');
          this.setInputsDisabled(true);
          const resetCode = await this.app.modal.prompt({
            title: 'System Locked',
            message: 'Enter administrative override code to unlock.',
            inputPlaceholder: 'Override Code'
          });
          if (resetCode === 'Reset.Counter.2579') {
            this.reset();
            this.app.notifier.show('System unlocked.', 'success');
          } else if(resetCode !== null) {
            this.app.notifier.show('Incorrect override code.', 'error');
          }
        }
      }

      reset() {
        this.attempts = this.maxAttempts;
        this.isLocked = false;
        this.updateAttemptsText();
        this.showError('');
        this.setInputsDisabled(false);
        this.usernameInput.focus();
      }

      updateAttemptsText() { this.attemptsText.textContent = `Attempts Left: ${this.attempts}`; }
      showError(message) { this.errorMsg.textContent = message; }
      setInputsDisabled(disabled) {
        [this.usernameInput, this.passwordInput, this.userIDInput, this.submitBtn].forEach(el => el.disabled = disabled);
      }
    }
    
    // --- STATS MODAL CLASS ---
    class StatsModal {
      constructor(app) {
        this.app = app;
        this.modalOverlay = document.getElementById('modalOverlay');
      }

      async show() {
        const deviceStats = this.getDeviceStats();
        const browserStats = this.getBrowserStats();
        
        const statsHtml = `
          <h2><span style="color: var(--c-primary);">📊 System & Browser Statistics</span></h2>
          <div class="settings-tabs">
              <div class="settings-tab active" data-tab="device">Device Stats</div>
              <div class="settings-tab" data-tab="browser">Browser Stats</div>
          </div>
          <div id="deviceStatsContent" class="settings-content active">
              <table class="stats-table">
                  <thead><tr><th>Metric</th><th>Value</th></tr></thead>
                  <tbody>${this.renderStatsTable(deviceStats)}</tbody>
              </table>
          </div>
          <div id="browserStatsContent" class="settings-content">
              <table class="stats-table">
                  <thead><tr><th>Metric</th><th>Value</th></tr></thead>
                  <tbody>${this.renderStatsTable(browserStats)}</tbody>
              </table>
          </div>
          <div class="modal-buttons">
              <button class="confirm-btn">Close</button>
          </div>
        `;
        this.app.modal.showCustom(statsHtml);

        const modal = document.querySelector('.modal');
        modal.querySelectorAll('.settings-tab').forEach(tab => {
          tab.addEventListener('click', () => {
            modal.querySelectorAll('.settings-tab').forEach(t => t.classList.remove('active'));
            modal.querySelectorAll('.settings-content').forEach(c => c.classList.remove('active'));
            tab.classList.add('active');
            document.getElementById(tab.dataset.tab + 'StatsContent').classList.add('active');
          });
        });
        modal.querySelector('.confirm-btn').addEventListener('click', () => this.app.modal.hide());
      }

      getDeviceStats() {
        const nav = navigator;
        const screen = window.screen;
        const battery = nav.getBattery ? (() => {
            try { return nav.getBattery(); } catch { return null; }
        })() : null;

        return [
          { metric: 'Platform', value: nav.platform || 'N/A' },
          { metric: 'User Agent', value: nav.userAgent || 'N/A' },
          { metric: 'Vendor', value: nav.vendor || 'N/A' },
          { metric: 'Language', value: nav.language || 'N/A' },
          { metric: 'Languages', value: nav.languages ? nav.languages.join(', ') : 'N/A' },
          { metric: 'On Line', value: nav.onLine ? 'Yes' : 'No' },
          { metric: 'Max Touch Points', value: nav.maxTouchPoints || '0' },
          { metric: 'Hardware Concurrency', value: nav.hardwareConcurrency || 'N/A' },
          { metric: 'Device Memory (GB)', value: nav.deviceMemory || 'N/A' },
          { metric: 'Screen Width', value: screen.width || 'N/A' },
          { metric: 'Screen Height', value: screen.height || 'N/A' },
          { metric: 'Color Depth', value: screen.colorDepth || 'N/A' },
          { metric: 'Pixel Depth', value: screen.pixelDepth || 'N/A' },
          { metric: 'Screen Resolution', value: `${screen.width}x${screen.height}` },
          { metric: 'Device Pixel Ratio', value: window.devicePixelRatio || 'N/A' },
          { metric: 'Screen Orientation', value: screen.orientation?.type || 'N/A' },
          { metric: 'Battery Level', value: battery ? `${Math.round(battery.level * 100)}%` : 'N/A' },
          { metric: 'Battery Charging', value: battery ? (battery.charging ? 'Yes' : 'No') : 'N/A' },
          { metric: 'Cookies Enabled', value: nav.cookieEnabled ? 'Yes' : 'No' },
          { metric: 'Do Not Track', value: nav.doNotTrack || 'N/A' },
          { metric: 'Clipboard API', value: nav.clipboard ? 'Supported' : 'Not Supported' },
          { metric: 'Keyboard Support', value: ('getGamepads' in nav) ? 'Supported' : 'Not Supported' },
          { metric: 'Permissions API', value: ('permissions' in nav) ? 'Supported' : 'Not Supported' },
          { metric: 'WebRTC Support', value: (window.RTCPeerConnection) ? 'Supported' : 'Not Supported' },
          { metric: 'Notification API', value: ('Notification' in window) ? 'Supported' : 'Not Supported' },
          { metric: 'Fullscreen API', value: (document.fullscreenEnabled) ? 'Supported' : 'Not Supported' },
        ];
      }

      getBrowserStats() {
        const nav = navigator;
        const connection = nav.connection || {};
        const stats = [
          { metric: 'Vendor', value: nav.vendor || 'N/A' },
          { metric: 'User Agent', value: nav.userAgent || 'N/A' },
          { metric: 'Product', value: nav.product || 'N/A' },
          { metric: 'Product Sub', value: nav.productSub || 'N/A' },
          { metric: 'App Code Name', value: nav.appCodeName || 'N/A' },
          { metric: 'App Name', value: nav.appName || 'N/A' },
          { metric: 'App Version', value: nav.appVersion || 'N/A' },
          { metric: 'Platform', value: nav.platform || 'N/A' },
          { metric: 'Language', value: nav.language || 'N/A' },
          { metric: 'Languages', value: nav.languages ? nav.languages.join(', ') : 'N/A' },
          { metric: 'On Line', value: nav.onLine ? 'Yes' : 'No' },
          { metric: 'Connection Type', value: connection.type || 'N/A' },
          { metric: 'Effective Type', value: connection.effectiveType || 'N/A' },
          { metric: 'Downlink (Mbps)', value: connection.downlink ? `${connection.downlink} Mbps` : 'N/A' },
          { metric: 'Downlink Max (Mbps)', value: connection.downlinkMax ? `${connection.downlinkMax} Mbps` : 'N/A' },
          { metric: 'RTT (ms)', value: connection.rtt ? `${connection.rtt} ms` : 'N/A' },
          { metric: 'Save Data Mode', value: connection.saveData ? 'Enabled' : 'Disabled' },
          { metric: 'Connection Metered', value: connection.metered ? 'Yes' : 'No' },
          { metric: 'Cookies Enabled', value: nav.cookieEnabled ? 'Yes' : 'No' },
          { metric: 'Do Not Track', value: nav.doNotTrack || 'N/A' },
          { metric: 'Page Visibility', value: document.visibilityState || 'N/A' },
          { metric: 'Browser Window Size', value: `${window.innerWidth}x${window.innerHeight}` },
          { metric: 'Device Pixel Ratio', value: window.devicePixelRatio || 'N/A' },
          { metric: 'Installed Plugins', value: nav.plugins?.length ? `${nav.plugins.length} plugin(s)` : 'None' },
          { metric: 'Clipboard Access', value: nav.clipboard ? 'Supported' : 'Not Supported' },
          { metric: 'WebRTC Support', value: (window.RTCPeerConnection) ? 'Supported' : 'Not Supported' },
          { metric: 'Notification API', value: ('Notification' in window) ? 'Supported' : 'Not Supported' },
          { metric: 'Fullscreen API', value: (document.fullscreenEnabled) ? 'Supported' : 'Not Supported' },
          { metric: 'OffscreenCanvas', value: (window.OffscreenCanvas) ? 'Supported' : 'Not Supported' },
          { metric: 'Web Workers', value: (window.Worker) ? 'Supported' : 'Not Supported' },
          { metric: 'IndexedDB', value: (window.indexedDB) ? 'Supported' : 'Not Supported' },
        ];
        return stats;
      }

      renderStatsTable(stats) {
        return stats.map(stat => `<tr><td>${stat.metric}</td><td>${stat.value === null || stat.value === undefined ? 'N/A' : stat.value}</td></tr>`).join('');
      }
    }

    // --- CORE APP CLASS ---
    class App {
      constructor() {
        this.settingsManager = new SettingsManager();
        this.notifier = new Notifier('notifierContainer');
        this.modal = new Modal('modalOverlay');
        this.uiManager = new UIManager(this);
        this.widgetManager = new WidgetManager(this);
        this.loginSystem = new LoginSystem(this);
        this.dashboard = new Dashboard(this);
        this.statsModal = new StatsModal(this);
        this.currentUser = null;
      }

      init() {
        this.uiManager.init();
        this.loginSystem.init();
      }

      showDashboard(user) {
        this.dashboard.init(user);
        this.widgetManager.init();
      }
      
      async logout() {
        const confirmed = await this.modal.confirm({
          title: 'Confirm Logout',
          message: 'Are you sure you want to log out?',
          confirmText: 'Log Out',
        });
        if (confirmed) window.location.reload();
      }

      showStatsModal() {
        this.statsModal.show();
      }
    }

    // --- INITIALIZE APP ---
    document.addEventListener('DOMContentLoaded', () => {
      const app = new App();
      app.init();
    });
  </script>
</body>
</html>
