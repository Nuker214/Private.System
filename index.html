<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Private System | Refactored</title>
  <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
  
  <style>
    /* 
    ========================================
    ROOT & THEME VARIABLES
    ========================================
    */
    :root {
      /* Color Palette (Dark Theme) */
      --color-primary: #ff914d;
      --color-primary-light: #ffb67a;
      --color-primary-dark: #994d00;
      --color-secondary: #ffd966;
      --color-danger: #ff4c4c;
      --color-success: #2ecc71;
      
      --color-bg-dark: #121212;
      --color-bg-light: #1e1e1e;
      --color-bg-lighter: #2a2a2a;
      --color-surface: #333;
      
      --color-text-light: #f0f0f0;
      --color-text-medium: #a0a0a0;
      --color-text-dark: #121212;

      /* Typography */
      --font-primary: 'Segoe UI', 'Roboto', sans-serif;
      --font-monospace: 'Courier New', monospace;
      --font-display: 'Montserrat', sans-serif;

      /* Layout */
      --spacing-xs: 4px;
      --spacing-sm: 8px;
      --spacing-md: 16px;
      --spacing-lg: 24px;
      --spacing-xl: 32px;
      --border-radius: 12px;
      --transition-speed: 0.3s;
      --shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
    }
    
    [data-theme="light"] {
      --color-primary: #e67e22;
      --color-primary-light: #f39c12;
      --color-primary-dark: #d35400;

      --color-bg-dark: #f4f4f4;
      --color-bg-light: #ffffff;
      --color-bg-lighter: #f9f9f9;
      --color-surface: #e0e0e0;
      
      --color-text-light: #121212;
      --color-text-medium: #555555;
      --color-text-dark: #ffffff;
    }

    /* 
    ========================================
    GENERAL STYLES & RESETS
    ========================================
    */
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    html {
      scroll-behavior: smooth;
    }

    body {
      font-family: var(--font-primary);
      background-color: var(--color-bg-dark);
      color: var(--color-text-light);
      transition: background-color var(--transition-speed) ease, color var(--transition-speed) ease;
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
      overflow-x: hidden;
    }

    button, a {
      cursor: pointer;
      font-family: inherit;
      transition: all var(--transition-speed) ease;
    }
    
    input {
        font-family: inherit;
    }
    
    /* 
    ========================================
    LOGIN SYSTEM STYLES
    ========================================
    */
    .login-container {
      display: flex;
      justify-content: center;
      align-items: center;
      width: 100%;
      height: 100vh;
      position: fixed;
      top: 0;
      left: 0;
      opacity: 1;
      visibility: visible;
      transition: opacity var(--transition-speed) ease, visibility var(--transition-speed) ease;
    }

    .login-container.hidden {
      opacity: 0;
      visibility: hidden;
    }
    
    .login-box {
      background: var(--color-bg-light);
      border-radius: var(--border-radius);
      border: 2px solid var(--color-surface);
      box-shadow: 0 0 25px rgba(255, 145, 77, 0.1);
      width: 90%;
      max-width: 380px;
      padding: var(--spacing-xl);
      text-align: center;
      transition: border-color var(--transition-speed), box-shadow var(--transition-speed);
    }

    .login-box.error-flash {
      animation: flashRed 0.5s ease-in-out;
    }

    @keyframes flashRed {
      0%, 100% { border-color: var(--color-danger); box-shadow: 0 0 15px var(--color-danger); }
      50% { border-color: var(--color-surface); box-shadow: 0 0 5px transparent; }
    }

    .login-box h2 {
      font-size: 1.8em;
      margin-bottom: var(--spacing-lg);
      font-family: var(--font-monospace);
      color: var(--color-primary);
    }
    
    .input-group {
      margin-bottom: var(--spacing-md);
      text-align: left;
    }

    .login-box input[type="text"],
    .login-box input[type="password"] {
      width: 100%;
      padding: 12px;
      background: var(--color-bg-dark);
      border: 2px solid var(--color-surface);
      color: var(--color-text-light);
      border-radius: var(--spacing-sm);
      font-size: 1em;
    }
    
    .login-box input:focus {
        border-color: var(--color-primary);
        outline: none;
    }

    .login-options {
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-size: 0.9em;
      margin-bottom: var(--spacing-lg);
    }
    
    .login-options label {
      display: flex;
      align-items: center;
      gap: var(--spacing-sm);
      cursor: pointer;
    }
    
    .login-box button {
      width: 100%;
      padding: 12px;
      background-color: var(--color-primary);
      color: var(--color-text-dark);
      font-size: 1.1em;
      font-weight: bold;
      border: none;
      border-radius: var(--spacing-sm);
    }
    
    .login-box button:hover {
        background-color: var(--color-primary-light);
    }
    
    .login-feedback {
      margin-top: var(--spacing-md);
      font-size: 0.9em;
      min-height: 40px;
    }
    
    .error-message { color: var(--color-danger); }
    .attempt-counter { color: var(--color-text-medium); }

    /* 
    ========================================
    DASHBOARD STYLES
    ========================================
    */
    .dashboard-container {
      display: none; /* Hidden by default */
      width: 100%;
      min-height: 100vh;
      padding: var(--spacing-md);
    }

    .dashboard-grid {
        display: grid;
        grid-template-columns: 250px 1fr;
        grid-template-rows: auto 1fr;
        grid-template-areas: 
            "header header"
            "sidebar main";
        gap: var(--spacing-md);
        width: 100%;
        max-width: 1600px;
        margin: 0 auto;
    }
    
    /* Header */
    .dashboard-header {
      grid-area: header;
      display: flex;
      justify-content: space-between;
      align-items: center;
      flex-wrap: wrap;
      background: var(--color-bg-light);
      padding: var(--spacing-md);
      border-radius: var(--border-radius);
      box-shadow: var(--shadow);
    }

    .version-box {
      background: var(--color-primary);
      padding: var(--spacing-sm);
      border-radius: var(--spacing-sm);
      color: var(--color-text-dark);
      font-weight: bold;
    }

    /* Sidebar */
    .dashboard-sidebar {
        grid-area: sidebar;
        background: var(--color-bg-light);
        padding: var(--spacing-lg);
        border-radius: var(--border-radius);
        box-shadow: var(--shadow);
        height: max-content;
        position: sticky;
        top: var(--spacing-md);
    }

    .dashboard-sidebar h3 {
        color: var(--color-primary);
        margin-bottom: var(--spacing-md);
        border-bottom: 2px solid var(--color-surface);
        padding-bottom: var(--spacing-sm);
    }
    
    .dashboard-sidebar nav ul {
        list-style: none;
    }
    
    .dashboard-sidebar nav li button {
        width: 100%;
        text-align: left;
        padding: 12px;
        background: none;
        border: none;
        color: var(--color-text-light);
        border-radius: var(--spacing-sm);
        font-size: 0.95em;
    }

    .dashboard-sidebar nav li button:hover,
    .dashboard-sidebar nav li button.active {
        background: var(--color-primary);
        color: var(--color-text-dark);
    }

    /* Main Content */
    .dashboard-main {
      grid-area: main;
    }
    
    .info-panel {
        display: none;
        animation: fadeIn 0.5s ease;
    }

    .info-panel.active {
        display: block;
    }

    @keyframes fadeIn {
        from { opacity: 0; transform: translateY(10px); }
        to { opacity: 1; transform: translateY(0); }
    }
    
    /* Quick Bar */
    .quick-bar {
      display: flex;
      gap: var(--spacing-sm);
      margin-bottom: var(--spacing-md);
      flex-wrap: wrap;
    }

    .quick-bar button {
      background-color: var(--color-surface);
      border: none;
      padding: var(--spacing-sm) var(--spacing-md);
      border-radius: var(--spacing-sm);
      color: var(--color-text-light);
      font-weight: bold;
    }
    
    .quick-bar button:hover { background-color: var(--color-primary); color: var(--color-text-dark); }
    #panicBtn { background: var(--color-danger) !important; color: var(--color-text-dark) !important; }

    /* Generic Box/Card */
    .box {
      background-color: var(--color-bg-light);
      padding: var(--spacing-lg);
      border-radius: var(--border-radius);
      box-shadow: var(--shadow);
      margin-bottom: var(--spacing-md);
    }
    
    .box h2 {
        font-size: 1.25em;
        margin-bottom: var(--spacing-md);
        color: var(--color-primary);
    }
    
    /* Grid Layouts */
    .grid-container {
        display: grid;
        gap: var(--spacing-md);
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    }
    
    /* Calendar */
    .calendar {
      display: grid;
      grid-template-columns: repeat(7, 1fr);
      gap: var(--spacing-sm);
      text-align: center;
    }
    .calendar div { padding: var(--spacing-sm); background: var(--color-surface); border-radius: var(--spacing-xs); }
    .calendar .day-name { font-weight: bold; background: none; }
    .calendar .today { background: var(--color-primary) !important; font-weight: bold; color: var(--color-text-dark); }

    /* Links & Buttons Grids */
    .links-grid {
      display: grid;
      gap: var(--spacing-md);
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    }
    .links-grid a, .links-grid button {
      display: block;
      background-color: var(--color-primary);
      padding: var(--spacing-md);
      border-radius: var(--spacing-sm);
      color: var(--color-text-dark);
      font-weight: bold;
      text-decoration: none;
      text-align: center;
      border: none;
    }
    .links-grid a:hover, .links-grid button:hover { background-color: var(--color-primary-light); }
    
    /* WiFi Table */
    .wifi-table {
        width: 100%;
        border-collapse: collapse;
        overflow-x: auto;
        display: block;
    }
    .wifi-table th, .wifi-table td {
        padding: 12px;
        text-align: left;
        border-bottom: 1px solid var(--color-surface);
    }
    .wifi-table th { background-color: var(--color-bg-lighter); }
    
    /* Notes Canvas */
    #canvasContainer { text-align: center; }
    #notesCanvas {
      border: 2px solid var(--color-primary);
      border-radius: var(--border-radius);
      background: #fff;
      cursor: crosshair;
      touch-action: none;
      max-width: 100%;
    }
    
    /* 
    ========================================
    UTILITY & COMPONENT STYLES
    ========================================
    */
    /* Custom Modal */
    .modal-overlay {
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background: rgba(0, 0, 0, 0.7);
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 1000;
      opacity: 0; visibility: hidden;
      transition: opacity 0.3s, visibility 0.3s;
    }
    .modal-overlay.visible { opacity: 1; visibility: visible; }
    .modal {
      background: var(--color-bg-light);
      padding: var(--spacing-xl);
      border-radius: var(--border-radius);
      width: 90%;
      max-width: 500px;
      text-align: center;
      transform: scale(0.9);
      transition: transform 0.3s;
    }
    .modal-overlay.visible .modal { transform: scale(1); }
    .modal h2 { margin-bottom: var(--spacing-md); color: var(--color-primary); }
    .modal p { margin-bottom: var(--spacing-lg); }
    .modal-buttons { display: flex; gap: var(--spacing-md); justify-content: center; }
    .modal button { padding: 10px 20px; border-radius: var(--spacing-sm); border: none; font-weight: bold; }
    .modal .confirm-btn { background: var(--color-primary); color: var(--color-text-dark); }
    .modal .cancel-btn { background: var(--color-surface); color: var(--color-text-light); }

    /* Notifier (Toast) */
    .notifier-container {
      position: fixed;
      bottom: var(--spacing-lg);
      right: var(--spacing-lg);
      z-index: 1001;
    }
    .toast {
      background: var(--color-bg-lighter);
      color: var(--color-text-light);
      padding: var(--spacing-md);
      border-radius: var(--spacing-sm);
      margin-top: var(--spacing-sm);
      box-shadow: var(--shadow);
      opacity: 0;
      transform: translateX(100%);
      animation: slideIn 0.5s forwards;
    }
    .toast.success { border-left: 5px solid var(--color-success); }
    .toast.info { border-left: 5px solid var(--color-primary); }
    @keyframes slideIn { to { opacity: 1; transform: translateX(0); } }

    /* 
    ========================================
    RESPONSIVE STYLES
    ========================================
    */
    @media (max-width: 992px) {
      .dashboard-grid {
        grid-template-columns: 1fr;
        grid-template-areas:
          "header"
          "sidebar"
          "main";
      }
      .dashboard-sidebar {
        position: static;
        top: unset;
      }
    }

    @media (max-width: 576px) {
      body {
        padding: var(--spacing-sm);
      }
      .dashboard-header {
        flex-direction: column;
        gap: var(--spacing-md);
      }
      .quick-bar {
        justify-content: center;
      }
    }

  </style>
</head>
<body>

  <!-- Login System -->
  <div class="login-container" id="loginContainer">
    <div class="login-box" id="loginBox">
      <h2>Private System</h2>
      <div class="input-group">
        <input type="text" id="username" placeholder="Username" autocomplete="username" />
      </div>
      <div class="input-group">
        <input type="password" id="password" placeholder="Password" autocomplete="current-password" />
      </div>
      <div class="input-group">
        <input type="text" id="userID" placeholder="User Identifier" autocomplete="off" />
      </div>
      <div class="login-options">
        <label for="showPassword">
          <input type="checkbox" id="showPassword" />
          <span>Show Password</span>
        </label>
      </div>
      <button id="submitBtn">Login</button>
      <div class="login-feedback">
        <div class="error-message" id="errorMsg"></div>
        <div class="attempt-counter" id="attemptsText"></div>
      </div>
    </div>
  </div>

  <!-- Dashboard -->
  <div class="dashboard-container" id="dashboardContainer">
    <div class="dashboard-grid">
        <header class="dashboard-header">
            <div>
                <h1>Dashboard GUI</h1>
                <div class="user-info">User: <span id="loggedInUser"></span> | ID: <span id="loggedInID"></span></div>
            </div>
            <div class="version-box">Version 2.0.0</div>
        </header>

        <aside class="dashboard-sidebar">
            <h3>Navigation</h3>
            <nav id="panelNav">
                <ul>
                    <!-- Navigation items will be dynamically inserted here -->
                </ul>
            </nav>
        </aside>

        <main class="dashboard-main">
            <div class="quick-bar">
                <button id="sessionTime" title="Session Time">⏳ 00:00:00</button>
                <button id="realTimeClock" title="Current Time">🕒 --:--:--</button>
                <button id="themeToggle" title="Toggle Theme">🌙</button>
                <button id="fullscreenBtn" title="Toggle Fullscreen">🖥️</button>
                <button id="screenshotBtn" title="Take Screenshot">📸</button>
                <button id="logoutBtn" title="Log Out">🔓</button>
                <button id="panicBtn" title="Panic Button">🚨</button>
            </div>
            
            <div id="infoPanelsContainer">
                <!-- Panel content will be dynamically inserted here -->
            </div>
        </main>
    </div>
  </div>

  <!-- Modal and Notifier containers -->
  <div class="modal-overlay" id="modalOverlay"></div>
  <div class="notifier-container" id="notifierContainer"></div>

  <script>
    document.addEventListener('DOMContentLoaded', () => {

      /*******************************************************
       *                  SECURITY WARNING
       *******************************************************
       * This is a CLIENT-SIDE ONLY login system. It is     
       * fundamentally INSECURE and should NEVER be used for
       * a real application. 
       *
       * 1. User data, including passwords, is fetched from a
       *    public URL and stored in the browser's memory.
       * 2. Password comparison happens in the browser, making
       *    it trivial to bypass.
       * 3. Discord Webhook URLs are exposed client-side, 
       *    allowing anyone to spam your channels.
       *
       * A secure system requires a BACKEND server to handle
       * authentication, hash passwords, and protect sensitive
       * information and credentials. This implementation is for
       * DEMONSTRATION purposes only.
       *******************************************************/

      // --- UTILITY CLASSES ---

      class Notifier {
        constructor(containerId) {
          this.container = document.getElementById(containerId);
        }
        show(message, type = 'info', duration = 3000) {
          const toast = document.createElement('div');
          toast.className = `toast ${type}`;
          toast.textContent = message;
          this.container.appendChild(toast);
          setTimeout(() => {
            toast.remove();
          }, duration);
        }
      }

      class Modal {
        constructor(overlayId) {
          this.overlay = document.getElementById(overlayId);
        }
        confirm({ title, message, confirmText = 'Confirm', cancelText = 'Cancel' }) {
          return new Promise(resolve => {
            this.overlay.innerHTML = `
              <div class="modal">
                <h2>${title}</h2>
                <p>${message}</p>
                <div class="modal-buttons">
                  <button class="cancel-btn">${cancelText}</button>
                  <button class="confirm-btn">${confirmText}</button>
                </div>
              </div>
            `;
            this.overlay.classList.add('visible');
            this.overlay.querySelector('.confirm-btn').onclick = () => {
              this.hide();
              resolve(true);
            };
            this.overlay.querySelector('.cancel-btn').onclick = () => {
              this.hide();
              resolve(false);
            };
          });
        }
        
        prompt({ title, message, inputPlaceholder = 'Enter value...' }) {
            return new Promise(resolve => {
                this.overlay.innerHTML = `
                    <div class="modal">
                        <h2>${title}</h2>
                        <p>${message}</p>
                        <input type="password" placeholder="${inputPlaceholder}" id="modalInput" style="width: 100%; padding: 10px; margin-bottom: 16px; border-radius: 8px; border: 1px solid var(--color-surface); background: var(--color-bg-dark); color: var(--color-text-light);">
                        <div class="modal-buttons">
                            <button class="cancel-btn">Cancel</button>
                            <button class="confirm-btn">Submit</button>
                        </div>
                    </div>
                `;
                this.overlay.classList.add('visible');
                const input = this.overlay.querySelector('#modalInput');
                input.focus();

                const submit = () => {
                    this.hide();
                    resolve(input.value);
                };

                this.overlay.querySelector('.confirm-btn').onclick = submit;
                this.overlay.querySelector('.cancel-btn').onclick = () => {
                    this.hide();
                    resolve(null);
                };
                input.onkeydown = (e) => {
                    if (e.key === 'Enter') submit();
                };
            });
        }

        hide() {
          this.overlay.classList.remove('visible');
          this.overlay.innerHTML = '';
        }
      }


      // --- DASHBOARD CLASS ---

      class Dashboard {
        constructor(app) {
          this.app = app;
          this.container = document.getElementById('dashboardContainer');
          this.navContainer = document.getElementById('panelNav');
          this.panelsContainer = document.getElementById('infoPanelsContainer');
          this.sessionTime = 0;
          this.sessionTimer = null;
          this.zoomLevel = 1;

          this.panels = [
              { id: 'home', title: '🏠 Home', content: this.getHomeContent() },
              { id: 'wifi', title: '📡 WiFi Info', content: this.getWifiContent() },
              { id: 'handbooks', title: '📘 Handbooks', content: this.getHandbookContent() },
              { id: 'studentSites', title: '🌐 Student Sites', content: this.getStudentSitesContent() },
              { id: 'teacherSites', title: '👩‍🏫 Teacher Sites', content: this.getTeacherSitesContent() },
              { id: 'schoolInfo', title: '🏫 School Info', content: this.getSchoolInfoContent() },
              { id: 'exploits', title: '🧨 Exploits', content: this.getExploitsContent() },
              { id: 'keyboard', title: '🎹 Keyboard Tricks', content: this.getKeyboardContent() },
              // Add other panels similarly
          ];
        }

        init(user) {
          this.container.style.display = 'block';
          document.body.dataset.theme = 'dark';
          document.getElementById('loggedInUser').textContent = user.name || user.username;
          document.getElementById('loggedInID').textContent = user.userID;
          this.startTimers();
          this.setupEventListeners();
          this.renderNav();
          this.renderPanels();
          this.showPanel('home');
        }

        renderNav() {
            const ul = this.navContainer.querySelector('ul');
            ul.innerHTML = this.panels.map(p => `<li><button data-panel-id="${p.id}">${p.title}</button></li>`).join('');
            ul.addEventListener('click', e => {
                if (e.target.tagName === 'BUTTON') {
                    this.showPanel(e.target.dataset.panelId);
                }
            });
        }

        renderPanels() {
            this.panelsContainer.innerHTML = this.panels.map(p => `<div id="${p.id}Panel" class="info-panel">${p.content}</div>`).join('');
        }
        
        showPanel(panelId) {
            document.querySelectorAll('.info-panel').forEach(p => p.classList.remove('active'));
            document.querySelector(`#${panelId}Panel`).classList.add('active');
            
            document.querySelectorAll('#panelNav button').forEach(b => b.classList.remove('active'));
            document.querySelector(`#panelNav button[data-panel-id="${panelId}"]`).classList.add('active');
        }

        startTimers() {
            // Real-time clock
            setInterval(() => {
                const now = new Date();
                document.getElementById('realTimeClock').textContent = `🕒 ${now.toLocaleTimeString()}`;
            }, 1000);

            // Session timer
            this.sessionTimer = setInterval(() => {
                this.sessionTime++;
                const hrs = String(Math.floor(this.sessionTime / 3600)).padStart(2, '0');
                const mins = String(Math.floor((this.sessionTime % 3600) / 60)).padStart(2, '0');
                const secs = String(this.sessionTime % 60).padStart(2, '0');
                document.getElementById('sessionTime').textContent = `⏳ ${hrs}:${mins}:${secs}`;
            }, 1000);
        }

        setupEventListeners() {
            document.getElementById('themeToggle').addEventListener('click', () => this.toggleTheme());
            document.getElementById('fullscreenBtn').addEventListener('click', () => this.toggleFullscreen());
            document.getElementById('screenshotBtn').addEventListener('click', () => this.takeScreenshot());
            document.getElementById('panicBtn').addEventListener('click', () => window.open('https://clever.com', '_blank'));
            document.getElementById('logoutBtn').addEventListener('click', () => this.app.logout());
        }

        toggleTheme() {
            const currentTheme = document.body.dataset.theme;
            document.body.dataset.theme = currentTheme === 'dark' ? 'light' : 'dark';
            this.app.notifier.show(`Switched to ${document.body.dataset.theme} mode`);
        }

        toggleFullscreen() {
            if (!document.fullscreenElement) {
                document.documentElement.requestFullscreen().catch(err => console.error(err));
            } else {
                document.exitFullscreen();
            }
        }

        takeScreenshot() {
            html2canvas(document.body).then(canvas => {
                const link = document.createElement('a');
                link.download = 'dashboard_screenshot.png';
                link.href = canvas.toDataURL('image/png');
                link.click();
                this.app.notifier.show('Screenshot saved!', 'success');
            });
        }
        
        // --- CONTENT GENERATION METHODS ---
        getHomeContent() {
            const today = new Date();
            const year = today.getFullYear();
            const month = today.getMonth();
            const date = today.getDate();
            const firstDay = new Date(year, month, 1).getDay();
            const lastDate = new Date(year, month + 1, 0).getDate();

            let calendarHtml = `<div class="calendar">`;
            const days = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];
            calendarHtml += days.map(d => `<div class="day-name">${d}</div>`).join('');
            
            for (let i = 0; i < firstDay; i++) calendarHtml += `<div></div>`;
            for (let i = 1; i <= lastDate; i++) {
                calendarHtml += `<div class="${i === date ? 'today' : ''}">${i}</div>`;
            }
            calendarHtml += `</div>`;
            
            return `
                <div class="grid-container">
                    <div class="box">
                        <h2>📅 Calendar</h2>
                        ${calendarHtml}
                    </div>
                    <div class="box">
                        <h2>🔔 Notifications</h2>
                        <p>Welcome to the refactored Private Dashboard GUI. The system is now faster, more responsive, and easier to use.</p>
                    </div>
                </div>
            `;
        }
        
        getWifiContent() {
            return `
                <div class="box">
                    <h2>📡 School WiFi Information</h2>
                    <div class="wifi-table">
                        <table>
                            <thead>
                                <tr>
                                    <th>Network Name</th><th>Security</th><th>Hidden</th><th>Monitored</th><th>Username</th><th>Password</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr><td>Middletown_Core</td><td>WPA3 Ent.</td><td>No</td><td>Yes</td><td>Unknown</td><td>Unknown</td></tr>
                                <tr><td>Mtown_Core</td><td>WPA3 Ent.</td><td>Yes</td><td>Unknown</td><td>Unknown</td><td>Unknown</td></tr>
                                <tr><td>Mtown Guest</td><td>WPA3 Ent.</td><td>No</td><td>Rare</td><td>msguest</td><td>M@ms2021#</td></tr>
                                <tr><td>Radius Test</td><td>WPA3 Ent.</td><td>No</td><td>Rarely</td><td>msguest</td><td>M@ms2021#</td></tr>
                            </tbody>
                        </table>
                    </div>
                </div>`;
        }

        getHandbookContent() {
             return `<div class="box">
                        <h2>📘 Student Handbooks</h2>
                        <div class="links-grid">
                          <a href="https://cdnsm5-ss19.sharpschool.com/UserFiles/Servers/Server_344046/File/For%20Parents/Handbooks/JAN2025A%20Elementary%20Handbook.pdf" target="_blank">Elementary</a>
                          <a href="https://www.raiderweb.org/UserFiles/Servers/Server_344046/File/For%20Parents/Handbooks/JAN2025A%20Secondary%20Student%20Handbook.pdf" target="_blank">Secondary</a>
                          <a href="https://www.raiderweb.org/UserFiles/Servers/Server_344046/File/For%20Parents/Handbooks/District%20Handbook%20copy.pdf" target="_blank">District</a>
                          <a href="https://middletown.ss19.sharpschool.com/UserFiles/Servers/Server_344046/File/For%20Parents/Handbooks/JAN2025B%20RA%20Academy%20Handbook%20copy.pdf" target="_blank">RA Academy</a>
                          <a href="https://www.raiderweb.org/UserFiles/Servers/Server_344046/File/For%20Parents/Handbooks/MASD%202024-2025%20Virtual%20Learning%20Plan%20RSVD%20DEC2024.pdf" target="_blank">Virtual Learning</a>
                          <a href="https://www.raiderweb.org/UserFiles/Servers/Server_344046/File/For%20Parents/2024-2025%20Dress%20Code.docx.pdf" target="_blank">Dress Code</a>
                        </div>
                    </div>`;
        }

        getStudentSitesContent() {
             return `<div class="box">
                        <h2>🌐 Student Websites</h2>
                        <div class="links-grid">
                            <a href="https://www.raiderweb.org" target="_blank">RaiderWeb</a>
                            <a href="https://middletownsd.instructure.com/login" target="_blank">Canvas</a>
                            <a href="https://clever.com/in/masd" target="_blank">Clever</a>
                            <a href="https://powerschool.raiderweb.org/public/" target="_blank">PowerSchool</a>
                            <a href="https://mail.google.com/mail/" target="_blank">Gmail</a>
                        </div>
                    </div>`;
        }

        getTeacherSitesContent() {
            return `<div class="box">
                        <h2>👩‍🏫 Teacher Websites</h2>
                        <div class="links-grid">
                            <a href="https://middletownsd.instructure.com/login/ldap" target="_blank">Canvas (Teacher)</a>
                            <a href="https://powerschool.raiderweb.org/teachers/pw.html" target="_blank">PowerSchool (Teacher)</a>
                            <a href="https://login.frontlineeducation.com" target="_blank">Frontline</a>
                        </div>
                    </div>`;
        }
        
        getSchoolInfoContent() {
            return `<div class="box">
                        <h2>🏫 School Information</h2>
                        <p><strong>Principal:</strong> Dr. Shannon L. Wevodau (swevodau@raiderweb.org)</p>
                        <p><strong>Asst. Principal:</strong> Mr. Michael DeFilippo (mdefilippo@raiderweb.org)</p>
                        <p><strong>Address:</strong> 215 Oberlin Road Middletown, PA 17057</p>
                        <p><strong>Phone:</strong> 717-930-0739</p>
                    </div>`;
        }

        getExploitsContent() {
             return `<div class="box">
                        <h2>🧨 Exploits</h2>
                        <p>Note: Links point to the same Blooket exploit as in the original code.</p>
                        <div class="links-grid">
                            <a href="https://sites.google.com/view/tools-2/blooket-exploit" target="_blank">Blooket</a>
                            <a href="https://sites.google.com/view/tools-2/blooket-exploit" target="_blank">Kahoot</a>
                            <a href="https://sites.google.com/view/tools-2/blooket-exploit" target="_blank">Gimkit</a>
                            <a href="https://sites.google.com/view/tools-2/blooket-exploit" target="_blank">Quizlet</a>
                        </div>
                    </div>`;
        }

        getKeyboardContent() {
            return `<div class="box">
                        <h2>🎹 Keyboard Tricks (macOS/iPadOS)</h2>
                        <ul>
                            <li><strong>Cmd + Space:</strong> Spotlight Search</li>
                            <li><strong>Cmd + H:</strong> Go to Home Screen</li>
                            <li><strong>Cmd + Tab:</strong> Switch Apps</li>
                            <li><strong>Globe + Q:</strong> Quick Note</li>
                        </ul>
                    </div>`;
        }
      }

      // --- LOGIN SYSTEM CLASS ---
      
      class LoginSystem {
        constructor(app) {
          this.app = app;
          this.container = document.getElementById('loginContainer');
          this.loginBox = document.getElementById('loginBox');
          this.usernameInput = document.getElementById('username');
          this.passwordInput = document.getElementById('password');
          this.userIDInput = document.getElementById('userID');
          this.submitBtn = document.getElementById('submitBtn');
          this.errorMsg = document.getElementById('errorMsg');
          this.attemptsText = document.getElementById('attemptsText');
          this.showPasswordCheckbox = document.getElementById('showPassword');
          
          this.maxAttempts = 5;
          this.attempts = this.maxAttempts;
          this.users = [];
          this.isLocked = false;
        }

        async init() {
          this.updateAttemptsText();
          this.addEventListeners();
          try {
            const response = await fetch('https://raw.githubusercontent.com/Nuker214/Private.System/refs/heads/main/Whitelist.json');
            if (!response.ok) throw new Error('Network response was not ok');
            this.users = await response.json();
          } catch (error) {
            this.errorMsg.textContent = 'Failed to load user data. Please try again later.';
            console.error('Error fetching user data:', error);
            this.setInputsDisabled(true);
          }
        }
        
        addEventListeners() {
            this.submitBtn.addEventListener('click', () => this.handleLogin());
            document.addEventListener('keydown', e => {
                if (e.key === 'Enter' && !this.isLocked) {
                    this.handleLogin();
                }
            });
            this.showPasswordCheckbox.addEventListener('change', () => {
                this.passwordInput.type = this.showPasswordCheckbox.checked ? 'text' : 'password';
            });
        }

        async handleLogin() {
          if (this.isLocked) return;
          const username = this.usernameInput.value;
          const password = this.passwordInput.value;
          const userID = this.userIDInput.value;

          if (!username || !password || !userID) {
            this.showError('Please fill in all fields.');
            return;
          }

          const user = this.users.find(u =>
            u.username?.toLowerCase() === username.toLowerCase() && u.userID?.toString() === userID
          );

          if (user && user.password === password) {
            this.loginSuccess(user);
          } else {
            this.loginFail();
          }
        }
        
        loginSuccess(user) {
            this.app.notifier.show(`Welcome, ${user.name || user.username}!`, 'success');
            this.container.classList.add('hidden');
            this.app.showDashboard(user);
        }
        
        async loginFail() {
            this.attempts--;
            this.updateAttemptsText();
            this.loginBox.classList.add('error-flash');
            setTimeout(() => this.loginBox.classList.remove('error-flash'), 500);

            if (this.attempts > 0) {
                this.showError(`Invalid credentials. ${this.attempts} attempts remaining.`);
            } else {
                this.isLocked = true;
                this.showError('Too many failed attempts.');
                this.setInputsDisabled(true);
                const resetCode = await this.app.modal.prompt({
                    title: 'Account Locked',
                    message: 'Please enter the reset code to unlock.',
                    inputPlaceholder: 'Reset Code'
                });
                
                if (resetCode === 'Reset.Counter.2579') {
                    this.reset();
                    this.app.notifier.show('Login unlocked.', 'success');
                } else if(resetCode !== null) {
                    this.app.notifier.show('Incorrect reset code.');
                }
            }
        }

        reset() {
            this.attempts = this.maxAttempts;
            this.isLocked = false;
            this.updateAttemptsText();
            this.showError('');
            this.setInputsDisabled(false);
            this.usernameInput.focus();
        }

        updateAttemptsText() {
          this.attemptsText.textContent = `Attempts left: ${this.attempts}`;
        }
        
        showError(message) {
            this.errorMsg.textContent = message;
        }

        setInputsDisabled(disabled) {
          this.usernameInput.disabled = disabled;
          this.passwordInput.disabled = disabled;
          this.userIDInput.disabled = disabled;
          this.submitBtn.disabled = disabled;
        }
      }

      // --- MAIN APP CLASS ---
      
      class App {
        constructor() {
          this.notifier = new Notifier('notifierContainer');
          this.modal = new Modal('modalOverlay');
          this.loginSystem = new LoginSystem(this);
          this.dashboard = new Dashboard(this);
        }

        init() {
          this.loginSystem.init();
        }

        showDashboard(user) {
          this.dashboard.init(user);
        }
        
        async logout() {
            const confirmed = await this.modal.confirm({
                title: 'Confirm Logout',
                message: 'Are you sure you want to log out and end your session?',
                confirmText: 'Log Out',
            });
            if (confirmed) {
                window.location.reload();
            }
        }
      }

      const app = new App();
      app.init();
    });
  </script>
</body>
</html>
